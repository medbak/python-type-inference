Module([Import([alias('asyncore', None)], lineno=1, col_offset=0), Import([alias('email.utils', None)], lineno=2, col_offset=0), Import([alias('socket', None)], lineno=3, col_offset=0), Import([alias('smtpd', None)], lineno=4, col_offset=0), Import([alias('smtplib', None)], lineno=5, col_offset=0), Import([alias('StringIO', None)], lineno=6, col_offset=0), Import([alias('sys', None)], lineno=7, col_offset=0), Import([alias('time', None)], lineno=8, col_offset=0), Import([alias('select', None)], lineno=9, col_offset=0), Import([alias('unittest', None)], lineno=11, col_offset=0), ImportFrom('test', [alias('test_support', None)], 0, lineno=12, col_offset=0), TryExcept([Import([alias('threading', None)], lineno=15, col_offset=4)], [ExceptHandler(Name('ImportError', Load(), lineno=16, col_offset=7), None, [Assign([Name('threading', Store(), lineno=17, col_offset=4)], Name('None', Load(), lineno=17, col_offset=16), lineno=17, col_offset=4)], lineno=16, col_offset=0)], [], lineno=14, col_offset=0), Assign([Name('HOST', Store(), lineno=19, col_offset=0)], Attribute(Name('test_support', Load(), lineno=19, col_offset=7), 'HOST', Load(), lineno=19, col_offset=7), lineno=19, col_offset=0), FunctionDef('server', arguments([Name('evt', Param(), lineno=21, col_offset=11), Name('buf', Param(), lineno=21, col_offset=16), Name('serv', Param(), lineno=21, col_offset=21)], None, None, []), [Expr(Call(Attribute(Name('serv', Load(), lineno=22, col_offset=4), 'listen', Load(), lineno=22, col_offset=4), [Num(5, lineno=22, col_offset=16)], [], None, None, lineno=22, col_offset=4), lineno=22, col_offset=4), Expr(Call(Attribute(Name('evt', Load(), lineno=23, col_offset=4), 'set', Load(), lineno=23, col_offset=4), [], [], None, None, lineno=23, col_offset=4), lineno=23, col_offset=4), TryFinally([TryExcept([Assign([Tuple([Name('conn', Store(), lineno=25, col_offset=8), Name('addr', Store(), lineno=25, col_offset=14)], Store(), lineno=25, col_offset=8)], Call(Attribute(Name('serv', Load(), lineno=25, col_offset=21), 'accept', Load(), lineno=25, col_offset=21), [], [], None, None, lineno=25, col_offset=21), lineno=25, col_offset=8)], [ExceptHandler(Attribute(Name('socket', Load(), lineno=26, col_offset=11), 'timeout', Load(), lineno=26, col_offset=11), None, [Pass( lineno=27, col_offset=8)], lineno=26, col_offset=4)], [Assign([Name('n', Store(), lineno=29, col_offset=8)], Num(500, lineno=29, col_offset=12), lineno=29, col_offset=8), While(BoolOp(And(), [Name('buf', Load(), lineno=30, col_offset=14), Compare(Name('n', Load(), lineno=30, col_offset=22), [Gt()], [Num(0, lineno=30, col_offset=26)], lineno=30, col_offset=22)], lineno=30, col_offset=14), [Assign([Tuple([Name('r', Store(), lineno=31, col_offset=12), Name('w', Store(), lineno=31, col_offset=15), Name('e', Store(), lineno=31, col_offset=18)], Store(), lineno=31, col_offset=12)], Call(Attribute(Name('select', Load(), lineno=31, col_offset=22), 'select', Load(), lineno=31, col_offset=22), [List([], Load(), lineno=31, col_offset=36), List([Name('conn', Load(), lineno=31, col_offset=41)], Load(), lineno=31, col_offset=40), List([], Load(), lineno=31, col_offset=48)], [], None, None, lineno=31, col_offset=22), lineno=31, col_offset=12), If(Name('w', Load(), lineno=32, col_offset=15), [Assign([Name('sent', Store(), lineno=33, col_offset=16)], Call(Attribute(Name('conn', Load(), lineno=33, col_offset=23), 'send', Load(), lineno=33, col_offset=23), [Name('buf', Load(), lineno=33, col_offset=33)], [], None, None, lineno=33, col_offset=23), lineno=33, col_offset=16), Assign([Name('buf', Store(), lineno=34, col_offset=16)], Subscript(Name('buf', Load(), lineno=34, col_offset=22), Slice(Name('sent', Load(), lineno=34, col_offset=26), None, None), Load(), lineno=34, col_offset=22), lineno=34, col_offset=16)], [], lineno=32, col_offset=12), AugAssign(Name('n', Store(), lineno=36, col_offset=12), Sub(), Num(1, lineno=36, col_offset=17), lineno=36, col_offset=12)], [], lineno=30, col_offset=8), Expr(Call(Attribute(Name('conn', Load(), lineno=38, col_offset=8), 'close', Load(), lineno=38, col_offset=8), [], [], None, None, lineno=38, col_offset=8), lineno=38, col_offset=8)], lineno=24, col_offset=4)], [Expr(Call(Attribute(Name('serv', Load(), lineno=40, col_offset=8), 'close', Load(), lineno=40, col_offset=8), [], [], None, None, lineno=40, col_offset=8), lineno=40, col_offset=8), Expr(Call(Attribute(Name('evt', Load(), lineno=41, col_offset=8), 'set', Load(), lineno=41, col_offset=8), [], [], None, None, lineno=41, col_offset=8), lineno=41, col_offset=8)], lineno=24, col_offset=4)], [], lineno=21, col_offset=0), ClassDef('GeneralTests', [Attribute(Name('unittest', Load(), lineno=44, col_offset=19), 'TestCase', Load(), lineno=44, col_offset=19)], [FunctionDef('setUp', arguments([Name('self', Param(), lineno=46, col_offset=14)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=47, col_offset=8), '_threads', Store(), lineno=47, col_offset=8)], Call(Attribute(Name('test_support', Load(), lineno=47, col_offset=24), 'threading_setup', Load(), lineno=47, col_offset=24), [], [], None, None, lineno=47, col_offset=24), lineno=47, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=48, col_offset=8), 'evt', Store(), lineno=48, col_offset=8)], Call(Attribute(Name('threading', Load(), lineno=48, col_offset=19), 'Event', Load(), lineno=48, col_offset=19), [], [], None, None, lineno=48, col_offset=19), lineno=48, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=49, col_offset=8), 'sock', Store(), lineno=49, col_offset=8)], Call(Attribute(Name('socket', Load(), lineno=49, col_offset=20), 'socket', Load(), lineno=49, col_offset=20), [Attribute(Name('socket', Load(), lineno=49, col_offset=34), 'AF_INET', Load(), lineno=49, col_offset=34), Attribute(Name('socket', Load(), lineno=49, col_offset=50), 'SOCK_STREAM', Load(), lineno=49, col_offset=50)], [], None, None, lineno=49, col_offset=20), lineno=49, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=50, col_offset=8), 'sock', Load(), lineno=50, col_offset=8), 'settimeout', Load(), lineno=50, col_offset=8), [Num(15, lineno=50, col_offset=29)], [], None, None, lineno=50, col_offset=8), lineno=50, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=51, col_offset=8), 'port', Store(), lineno=51, col_offset=8)], Call(Attribute(Name('test_support', Load(), lineno=51, col_offset=20), 'bind_port', Load(), lineno=51, col_offset=20), [Attribute(Name('self', Load(), lineno=51, col_offset=43), 'sock', Load(), lineno=51, col_offset=43)], [], None, None, lineno=51, col_offset=20), lineno=51, col_offset=8), Assign([Name('servargs', Store(), lineno=52, col_offset=8)], Tuple([Attribute(Name('self', Load(), lineno=52, col_offset=20), 'evt', Load(), lineno=52, col_offset=20), Str('220 Hola mundo\n', lineno=52, col_offset=30), Attribute(Name('self', Load(), lineno=52, col_offset=50), 'sock', Load(), lineno=52, col_offset=50)], Load(), lineno=52, col_offset=20), lineno=52, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=53, col_offset=8), 'thread', Store(), lineno=53, col_offset=8)], Call(Attribute(Name('threading', Load(), lineno=53, col_offset=22), 'Thread', Load(), lineno=53, col_offset=22), [], [keyword('target', Name('server', Load(), lineno=53, col_offset=46)), keyword('args', Name('servargs', Load(), lineno=53, col_offset=59))], None, None, lineno=53, col_offset=22), lineno=53, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=54, col_offset=8), 'thread', Load(), lineno=54, col_offset=8), 'start', Load(), lineno=54, col_offset=8), [], [], None, None, lineno=54, col_offset=8), lineno=54, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=55, col_offset=8), 'evt', Load(), lineno=55, col_offset=8), 'wait', Load(), lineno=55, col_offset=8), [], [], None, None, lineno=55, col_offset=8), lineno=55, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=56, col_offset=8), 'evt', Load(), lineno=56, col_offset=8), 'clear', Load(), lineno=56, col_offset=8), [], [], None, None, lineno=56, col_offset=8), lineno=56, col_offset=8)], [], lineno=46, col_offset=4), FunctionDef('tearDown', arguments([Name('self', Param(), lineno=58, col_offset=17)], None, None, []), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=59, col_offset=8), 'evt', Load(), lineno=59, col_offset=8), 'wait', Load(), lineno=59, col_offset=8), [], [], None, None, lineno=59, col_offset=8), lineno=59, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=60, col_offset=8), 'thread', Load(), lineno=60, col_offset=8), 'join', Load(), lineno=60, col_offset=8), [], [], None, None, lineno=60, col_offset=8), lineno=60, col_offset=8), Expr(Call(Attribute(Name('test_support', Load(), lineno=61, col_offset=8), 'threading_cleanup', Load(), lineno=61, col_offset=8), [], [], Attribute(Name('self', Load(), lineno=61, col_offset=40), '_threads', Load(), lineno=61, col_offset=40), None, lineno=61, col_offset=8), lineno=61, col_offset=8)], [], lineno=58, col_offset=4), FunctionDef('testBasic1', arguments([Name('self', Param(), lineno=63, col_offset=19)], None, None, []), [Assign([Name('smtp', Store(), lineno=65, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=65, col_offset=15), 'SMTP', Load(), lineno=65, col_offset=15), [Name('HOST', Load(), lineno=65, col_offset=28), Attribute(Name('self', Load(), lineno=65, col_offset=34), 'port', Load(), lineno=65, col_offset=34)], [], None, None, lineno=65, col_offset=15), lineno=65, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=66, col_offset=8), 'close', Load(), lineno=66, col_offset=8), [], [], None, None, lineno=66, col_offset=8), lineno=66, col_offset=8)], [], lineno=63, col_offset=4), FunctionDef('testBasic2', arguments([Name('self', Param(), lineno=68, col_offset=19)], None, None, []), [Assign([Name('smtp', Store(), lineno=70, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=70, col_offset=15), 'SMTP', Load(), lineno=70, col_offset=15), [BinOp(Str('%s:%s', lineno=70, col_offset=28), Mod(), Tuple([Name('HOST', Load(), lineno=70, col_offset=39), Attribute(Name('self', Load(), lineno=70, col_offset=45), 'port', Load(), lineno=70, col_offset=45)], Load(), lineno=70, col_offset=39), lineno=70, col_offset=28)], [], None, None, lineno=70, col_offset=15), lineno=70, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=71, col_offset=8), 'close', Load(), lineno=71, col_offset=8), [], [], None, None, lineno=71, col_offset=8), lineno=71, col_offset=8)], [], lineno=68, col_offset=4), FunctionDef('testLocalHostName', arguments([Name('self', Param(), lineno=73, col_offset=26)], None, None, []), [Assign([Name('smtp', Store(), lineno=75, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=75, col_offset=15), 'SMTP', Load(), lineno=75, col_offset=15), [Name('HOST', Load(), lineno=75, col_offset=28), Attribute(Name('self', Load(), lineno=75, col_offset=34), 'port', Load(), lineno=75, col_offset=34)], [keyword('local_hostname', Str('testhost', lineno=75, col_offset=60))], None, None, lineno=75, col_offset=15), lineno=75, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=76, col_offset=8), 'assertEqual', Load(), lineno=76, col_offset=8), [Attribute(Name('smtp', Load(), lineno=76, col_offset=25), 'local_hostname', Load(), lineno=76, col_offset=25), Str('testhost', lineno=76, col_offset=46)], [], None, None, lineno=76, col_offset=8), lineno=76, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=77, col_offset=8), 'close', Load(), lineno=77, col_offset=8), [], [], None, None, lineno=77, col_offset=8), lineno=77, col_offset=8)], [], lineno=73, col_offset=4), FunctionDef('testTimeoutDefault', arguments([Name('self', Param(), lineno=79, col_offset=27)], None, None, []), [Expr(Call(Attribute(Name('self', Load(), lineno=80, col_offset=8), 'assertTrue', Load(), lineno=80, col_offset=8), [Compare(Call(Attribute(Name('socket', Load(), lineno=80, col_offset=24), 'getdefaulttimeout', Load(), lineno=80, col_offset=24), [], [], None, None, lineno=80, col_offset=24), [Is()], [Name('None', Load(), lineno=80, col_offset=54)], lineno=80, col_offset=24)], [], None, None, lineno=80, col_offset=8), lineno=80, col_offset=8), Expr(Call(Attribute(Name('socket', Load(), lineno=81, col_offset=8), 'setdefaulttimeout', Load(), lineno=81, col_offset=8), [Num(30, lineno=81, col_offset=33)], [], None, None, lineno=81, col_offset=8), lineno=81, col_offset=8), TryFinally([Assign([Name('smtp', Store(), lineno=83, col_offset=12)], Call(Attribute(Name('smtplib', Load(), lineno=83, col_offset=19), 'SMTP', Load(), lineno=83, col_offset=19), [Name('HOST', Load(), lineno=83, col_offset=32), Attribute(Name('self', Load(), lineno=83, col_offset=38), 'port', Load(), lineno=83, col_offset=38)], [], None, None, lineno=83, col_offset=19), lineno=83, col_offset=12)], [Expr(Call(Attribute(Name('socket', Load(), lineno=85, col_offset=12), 'setdefaulttimeout', Load(), lineno=85, col_offset=12), [Name('None', Load(), lineno=85, col_offset=37)], [], None, None, lineno=85, col_offset=12), lineno=85, col_offset=12)], lineno=82, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=86, col_offset=8), 'assertEqual', Load(), lineno=86, col_offset=8), [Call(Attribute(Attribute(Name('smtp', Load(), lineno=86, col_offset=25), 'sock', Load(), lineno=86, col_offset=25), 'gettimeout', Load(), lineno=86, col_offset=25), [], [], None, None, lineno=86, col_offset=25), Num(30, lineno=86, col_offset=49)], [], None, None, lineno=86, col_offset=8), lineno=86, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=87, col_offset=8), 'close', Load(), lineno=87, col_offset=8), [], [], None, None, lineno=87, col_offset=8), lineno=87, col_offset=8)], [], lineno=79, col_offset=4), FunctionDef('testTimeoutNone', arguments([Name('self', Param(), lineno=89, col_offset=24)], None, None, []), [Expr(Call(Attribute(Name('self', Load(), lineno=90, col_offset=8), 'assertTrue', Load(), lineno=90, col_offset=8), [Compare(Call(Attribute(Name('socket', Load(), lineno=90, col_offset=24), 'getdefaulttimeout', Load(), lineno=90, col_offset=24), [], [], None, None, lineno=90, col_offset=24), [Is()], [Name('None', Load(), lineno=90, col_offset=54)], lineno=90, col_offset=24)], [], None, None, lineno=90, col_offset=8), lineno=90, col_offset=8), Expr(Call(Attribute(Name('socket', Load(), lineno=91, col_offset=8), 'setdefaulttimeout', Load(), lineno=91, col_offset=8), [Num(30, lineno=91, col_offset=33)], [], None, None, lineno=91, col_offset=8), lineno=91, col_offset=8), TryFinally([Assign([Name('smtp', Store(), lineno=93, col_offset=12)], Call(Attribute(Name('smtplib', Load(), lineno=93, col_offset=19), 'SMTP', Load(), lineno=93, col_offset=19), [Name('HOST', Load(), lineno=93, col_offset=32), Attribute(Name('self', Load(), lineno=93, col_offset=38), 'port', Load(), lineno=93, col_offset=38)], [keyword('timeout', Name('None', Load(), lineno=93, col_offset=57))], None, None, lineno=93, col_offset=19), lineno=93, col_offset=12)], [Expr(Call(Attribute(Name('socket', Load(), lineno=95, col_offset=12), 'setdefaulttimeout', Load(), lineno=95, col_offset=12), [Name('None', Load(), lineno=95, col_offset=37)], [], None, None, lineno=95, col_offset=12), lineno=95, col_offset=12)], lineno=92, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=96, col_offset=8), 'assertTrue', Load(), lineno=96, col_offset=8), [Compare(Call(Attribute(Attribute(Name('smtp', Load(), lineno=96, col_offset=24), 'sock', Load(), lineno=96, col_offset=24), 'gettimeout', Load(), lineno=96, col_offset=24), [], [], None, None, lineno=96, col_offset=24), [Is()], [Name('None', Load(), lineno=96, col_offset=50)], lineno=96, col_offset=24)], [], None, None, lineno=96, col_offset=8), lineno=96, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=97, col_offset=8), 'close', Load(), lineno=97, col_offset=8), [], [], None, None, lineno=97, col_offset=8), lineno=97, col_offset=8)], [], lineno=89, col_offset=4), FunctionDef('testTimeoutValue', arguments([Name('self', Param(), lineno=99, col_offset=25)], None, None, []), [Assign([Name('smtp', Store(), lineno=100, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=100, col_offset=15), 'SMTP', Load(), lineno=100, col_offset=15), [Name('HOST', Load(), lineno=100, col_offset=28), Attribute(Name('self', Load(), lineno=100, col_offset=34), 'port', Load(), lineno=100, col_offset=34)], [keyword('timeout', Num(30, lineno=100, col_offset=53))], None, None, lineno=100, col_offset=15), lineno=100, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=101, col_offset=8), 'assertEqual', Load(), lineno=101, col_offset=8), [Call(Attribute(Attribute(Name('smtp', Load(), lineno=101, col_offset=25), 'sock', Load(), lineno=101, col_offset=25), 'gettimeout', Load(), lineno=101, col_offset=25), [], [], None, None, lineno=101, col_offset=25), Num(30, lineno=101, col_offset=49)], [], None, None, lineno=101, col_offset=8), lineno=101, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=102, col_offset=8), 'close', Load(), lineno=102, col_offset=8), [], [], None, None, lineno=102, col_offset=8), lineno=102, col_offset=8)], [], lineno=99, col_offset=4)], [Call(Attribute(Name('unittest', Load(), lineno=43, col_offset=1), 'skipUnless', Load(), lineno=43, col_offset=1), [Name('threading', Load(), lineno=43, col_offset=21), Str('Threading required for this test.', lineno=43, col_offset=32)], [], None, None, lineno=43, col_offset=1)], lineno=43, col_offset=0), FunctionDef('debugging_server', arguments([Name('serv', Param(), lineno=106, col_offset=21), Name('serv_evt', Param(), lineno=106, col_offset=27), Name('client_evt', Param(), lineno=106, col_offset=37)], None, None, []), [Expr(Call(Attribute(Name('serv_evt', Load(), lineno=107, col_offset=4), 'set', Load(), lineno=107, col_offset=4), [], [], None, None, lineno=107, col_offset=4), lineno=107, col_offset=4), TryFinally([TryExcept([If(Call(Name('hasattr', Load(), lineno=110, col_offset=11), [Name('select', Load(), lineno=110, col_offset=19), Str('poll', lineno=110, col_offset=27)], [], None, None, lineno=110, col_offset=11), [Assign([Name('poll_fun', Store(), lineno=111, col_offset=12)], Attribute(Name('asyncore', Load(), lineno=111, col_offset=23), 'poll2', Load(), lineno=111, col_offset=23), lineno=111, col_offset=12)], [Assign([Name('poll_fun', Store(), lineno=113, col_offset=12)], Attribute(Name('asyncore', Load(), lineno=113, col_offset=23), 'poll', Load(), lineno=113, col_offset=23), lineno=113, col_offset=12)], lineno=110, col_offset=8), Assign([Name('n', Store(), lineno=115, col_offset=8)], Num(1000, lineno=115, col_offset=12), lineno=115, col_offset=8), While(BoolOp(And(), [Attribute(Name('asyncore', Load(), lineno=116, col_offset=14), 'socket_map', Load(), lineno=116, col_offset=14), Compare(Name('n', Load(), lineno=116, col_offset=38), [Gt()], [Num(0, lineno=116, col_offset=42)], lineno=116, col_offset=38)], lineno=116, col_offset=14), [Expr(Call(Name('poll_fun', Load(), lineno=117, col_offset=12), [Num(0.01, lineno=117, col_offset=21), Attribute(Name('asyncore', Load(), lineno=117, col_offset=27), 'socket_map', Load(), lineno=117, col_offset=27)], [], None, None, lineno=117, col_offset=12), lineno=117, col_offset=12), If(Call(Attribute(Name('client_evt', Load(), lineno=121, col_offset=15), 'is_set', Load(), lineno=121, col_offset=15), [], [], None, None, lineno=121, col_offset=15), [Expr(Call(Attribute(Name('serv', Load(), lineno=122, col_offset=16), 'close', Load(), lineno=122, col_offset=16), [], [], None, None, lineno=122, col_offset=16), lineno=122, col_offset=16), Break( lineno=123, col_offset=16)], [], lineno=121, col_offset=12), AugAssign(Name('n', Store(), lineno=125, col_offset=12), Sub(), Num(1, lineno=125, col_offset=17), lineno=125, col_offset=12)], [], lineno=116, col_offset=8)], [ExceptHandler(Attribute(Name('socket', Load(), lineno=127, col_offset=11), 'timeout', Load(), lineno=127, col_offset=11), None, [Pass( lineno=128, col_offset=8)], lineno=127, col_offset=4)], [], lineno=109, col_offset=4)], [If(UnaryOp(Not(), Call(Attribute(Name('client_evt', Load(), lineno=130, col_offset=15), 'is_set', Load(), lineno=130, col_offset=15), [], [], None, None, lineno=130, col_offset=15), lineno=130, col_offset=11), [Expr(Call(Attribute(Name('time', Load(), lineno=132, col_offset=12), 'sleep', Load(), lineno=132, col_offset=12), [Num(0.5, lineno=132, col_offset=23)], [], None, None, lineno=132, col_offset=12), lineno=132, col_offset=12), Expr(Call(Attribute(Name('serv', Load(), lineno=133, col_offset=12), 'close', Load(), lineno=133, col_offset=12), [], [], None, None, lineno=133, col_offset=12), lineno=133, col_offset=12)], [], lineno=130, col_offset=8), Expr(Call(Attribute(Name('asyncore', Load(), lineno=134, col_offset=8), 'close_all', Load(), lineno=134, col_offset=8), [], [], None, None, lineno=134, col_offset=8), lineno=134, col_offset=8), Expr(Call(Attribute(Name('serv_evt', Load(), lineno=135, col_offset=8), 'set', Load(), lineno=135, col_offset=8), [], [], None, None, lineno=135, col_offset=8), lineno=135, col_offset=8)], lineno=109, col_offset=4)], [], lineno=106, col_offset=0), Assign([Name('MSG_BEGIN', Store(), lineno=137, col_offset=0)], Str('---------- MESSAGE FOLLOWS ----------\n', lineno=137, col_offset=12), lineno=137, col_offset=0), Assign([Name('MSG_END', Store(), lineno=138, col_offset=0)], Str('------------ END MESSAGE ------------\n', lineno=138, col_offset=10), lineno=138, col_offset=0), ClassDef('DebuggingServerTests', [Attribute(Name('unittest', Load(), lineno=147, col_offset=27), 'TestCase', Load(), lineno=147, col_offset=27)], [FunctionDef('setUp', arguments([Name('self', Param(), lineno=149, col_offset=14)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=151, col_offset=8), 'old_stdout', Store(), lineno=151, col_offset=8)], Attribute(Name('sys', Load(), lineno=151, col_offset=26), 'stdout', Load(), lineno=151, col_offset=26), lineno=151, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=152, col_offset=8), 'output', Store(), lineno=152, col_offset=8)], Call(Attribute(Name('StringIO', Load(), lineno=152, col_offset=22), 'StringIO', Load(), lineno=152, col_offset=22), [], [], None, None, lineno=152, col_offset=22), lineno=152, col_offset=8), Assign([Attribute(Name('sys', Load(), lineno=153, col_offset=8), 'stdout', Store(), lineno=153, col_offset=8)], Attribute(Name('self', Load(), lineno=153, col_offset=21), 'output', Load(), lineno=153, col_offset=21), lineno=153, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=155, col_offset=8), '_threads', Store(), lineno=155, col_offset=8)], Call(Attribute(Name('test_support', Load(), lineno=155, col_offset=24), 'threading_setup', Load(), lineno=155, col_offset=24), [], [], None, None, lineno=155, col_offset=24), lineno=155, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=156, col_offset=8), 'serv_evt', Store(), lineno=156, col_offset=8)], Call(Attribute(Name('threading', Load(), lineno=156, col_offset=24), 'Event', Load(), lineno=156, col_offset=24), [], [], None, None, lineno=156, col_offset=24), lineno=156, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=157, col_offset=8), 'client_evt', Store(), lineno=157, col_offset=8)], Call(Attribute(Name('threading', Load(), lineno=157, col_offset=26), 'Event', Load(), lineno=157, col_offset=26), [], [], None, None, lineno=157, col_offset=26), lineno=157, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=159, col_offset=8), 'serv', Store(), lineno=159, col_offset=8)], Call(Attribute(Name('smtpd', Load(), lineno=159, col_offset=20), 'DebuggingServer', Load(), lineno=159, col_offset=20), [Tuple([Name('HOST', Load(), lineno=159, col_offset=43), Num(0, lineno=159, col_offset=49)], Load(), lineno=159, col_offset=43), Tuple([Str('nowhere', lineno=159, col_offset=54), Num(-1, lineno=159, col_offset=66)], Load(), lineno=159, col_offset=54)], [], None, None, lineno=159, col_offset=20), lineno=159, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=161, col_offset=8), 'port', Store(), lineno=161, col_offset=8)], Subscript(Call(Attribute(Attribute(Attribute(Name('self', Load(), lineno=161, col_offset=20), 'serv', Load(), lineno=161, col_offset=20), 'socket', Load(), lineno=161, col_offset=20), 'getsockname', Load(), lineno=161, col_offset=20), [], [], None, None, lineno=161, col_offset=20), Index(Num(1, lineno=161, col_offset=51)), Load(), lineno=161, col_offset=20), lineno=161, col_offset=8), Assign([Name('serv_args', Store(), lineno=162, col_offset=8)], Tuple([Attribute(Name('self', Load(), lineno=162, col_offset=21), 'serv', Load(), lineno=162, col_offset=21), Attribute(Name('self', Load(), lineno=162, col_offset=32), 'serv_evt', Load(), lineno=162, col_offset=32), Attribute(Name('self', Load(), lineno=162, col_offset=47), 'client_evt', Load(), lineno=162, col_offset=47)], Load(), lineno=162, col_offset=21), lineno=162, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=163, col_offset=8), 'thread', Store(), lineno=163, col_offset=8)], Call(Attribute(Name('threading', Load(), lineno=163, col_offset=22), 'Thread', Load(), lineno=163, col_offset=22), [], [keyword('target', Name('debugging_server', Load(), lineno=163, col_offset=46)), keyword('args', Name('serv_args', Load(), lineno=163, col_offset=69))], None, None, lineno=163, col_offset=22), lineno=163, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=164, col_offset=8), 'thread', Load(), lineno=164, col_offset=8), 'start', Load(), lineno=164, col_offset=8), [], [], None, None, lineno=164, col_offset=8), lineno=164, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=167, col_offset=8), 'serv_evt', Load(), lineno=167, col_offset=8), 'wait', Load(), lineno=167, col_offset=8), [], [], None, None, lineno=167, col_offset=8), lineno=167, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=168, col_offset=8), 'serv_evt', Load(), lineno=168, col_offset=8), 'clear', Load(), lineno=168, col_offset=8), [], [], None, None, lineno=168, col_offset=8), lineno=168, col_offset=8)], [], lineno=149, col_offset=4), FunctionDef('tearDown', arguments([Name('self', Param(), lineno=170, col_offset=17)], None, None, []), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=172, col_offset=8), 'client_evt', Load(), lineno=172, col_offset=8), 'set', Load(), lineno=172, col_offset=8), [], [], None, None, lineno=172, col_offset=8), lineno=172, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=174, col_offset=8), 'serv_evt', Load(), lineno=174, col_offset=8), 'wait', Load(), lineno=174, col_offset=8), [], [], None, None, lineno=174, col_offset=8), lineno=174, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=175, col_offset=8), 'thread', Load(), lineno=175, col_offset=8), 'join', Load(), lineno=175, col_offset=8), [], [], None, None, lineno=175, col_offset=8), lineno=175, col_offset=8), Expr(Call(Attribute(Name('test_support', Load(), lineno=176, col_offset=8), 'threading_cleanup', Load(), lineno=176, col_offset=8), [], [], Attribute(Name('self', Load(), lineno=176, col_offset=40), '_threads', Load(), lineno=176, col_offset=40), None, lineno=176, col_offset=8), lineno=176, col_offset=8), Assign([Attribute(Name('sys', Load(), lineno=178, col_offset=8), 'stdout', Store(), lineno=178, col_offset=8)], Attribute(Name('self', Load(), lineno=178, col_offset=21), 'old_stdout', Load(), lineno=178, col_offset=21), lineno=178, col_offset=8)], [], lineno=170, col_offset=4), FunctionDef('testBasic', arguments([Name('self', Param(), lineno=180, col_offset=18)], None, None, []), [Assign([Name('smtp', Store(), lineno=182, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=182, col_offset=15), 'SMTP', Load(), lineno=182, col_offset=15), [Name('HOST', Load(), lineno=182, col_offset=28), Attribute(Name('self', Load(), lineno=182, col_offset=34), 'port', Load(), lineno=182, col_offset=34)], [keyword('local_hostname', Str('localhost', lineno=182, col_offset=60)), keyword('timeout', Num(3, lineno=182, col_offset=81))], None, None, lineno=182, col_offset=15), lineno=182, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=183, col_offset=8), 'quit', Load(), lineno=183, col_offset=8), [], [], None, None, lineno=183, col_offset=8), lineno=183, col_offset=8)], [], lineno=180, col_offset=4), FunctionDef('testNOOP', arguments([Name('self', Param(), lineno=185, col_offset=17)], None, None, []), [Assign([Name('smtp', Store(), lineno=186, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=186, col_offset=15), 'SMTP', Load(), lineno=186, col_offset=15), [Name('HOST', Load(), lineno=186, col_offset=28), Attribute(Name('self', Load(), lineno=186, col_offset=34), 'port', Load(), lineno=186, col_offset=34)], [keyword('local_hostname', Str('localhost', lineno=186, col_offset=60)), keyword('timeout', Num(3, lineno=186, col_offset=81))], None, None, lineno=186, col_offset=15), lineno=186, col_offset=8), Assign([Name('expected', Store(), lineno=187, col_offset=8)], Tuple([Num(250, lineno=187, col_offset=20), Str('Ok', lineno=187, col_offset=25)], Load(), lineno=187, col_offset=20), lineno=187, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=188, col_offset=8), 'assertEqual', Load(), lineno=188, col_offset=8), [Call(Attribute(Name('smtp', Load(), lineno=188, col_offset=25), 'noop', Load(), lineno=188, col_offset=25), [], [], None, None, lineno=188, col_offset=25), Name('expected', Load(), lineno=188, col_offset=38)], [], None, None, lineno=188, col_offset=8), lineno=188, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=189, col_offset=8), 'quit', Load(), lineno=189, col_offset=8), [], [], None, None, lineno=189, col_offset=8), lineno=189, col_offset=8)], [], lineno=185, col_offset=4), FunctionDef('testRSET', arguments([Name('self', Param(), lineno=191, col_offset=17)], None, None, []), [Assign([Name('smtp', Store(), lineno=192, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=192, col_offset=15), 'SMTP', Load(), lineno=192, col_offset=15), [Name('HOST', Load(), lineno=192, col_offset=28), Attribute(Name('self', Load(), lineno=192, col_offset=34), 'port', Load(), lineno=192, col_offset=34)], [keyword('local_hostname', Str('localhost', lineno=192, col_offset=60)), keyword('timeout', Num(3, lineno=192, col_offset=81))], None, None, lineno=192, col_offset=15), lineno=192, col_offset=8), Assign([Name('expected', Store(), lineno=193, col_offset=8)], Tuple([Num(250, lineno=193, col_offset=20), Str('Ok', lineno=193, col_offset=25)], Load(), lineno=193, col_offset=20), lineno=193, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=194, col_offset=8), 'assertEqual', Load(), lineno=194, col_offset=8), [Call(Attribute(Name('smtp', Load(), lineno=194, col_offset=25), 'rset', Load(), lineno=194, col_offset=25), [], [], None, None, lineno=194, col_offset=25), Name('expected', Load(), lineno=194, col_offset=38)], [], None, None, lineno=194, col_offset=8), lineno=194, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=195, col_offset=8), 'quit', Load(), lineno=195, col_offset=8), [], [], None, None, lineno=195, col_offset=8), lineno=195, col_offset=8)], [], lineno=191, col_offset=4), FunctionDef('testNotImplemented', arguments([Name('self', Param(), lineno=197, col_offset=27)], None, None, []), [Assign([Name('smtp', Store(), lineno=199, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=199, col_offset=15), 'SMTP', Load(), lineno=199, col_offset=15), [Name('HOST', Load(), lineno=199, col_offset=28), Attribute(Name('self', Load(), lineno=199, col_offset=34), 'port', Load(), lineno=199, col_offset=34)], [keyword('local_hostname', Str('localhost', lineno=199, col_offset=60)), keyword('timeout', Num(3, lineno=199, col_offset=81))], None, None, lineno=199, col_offset=15), lineno=199, col_offset=8), Assign([Name('expected', Store(), lineno=200, col_offset=8)], Tuple([Num(502, lineno=200, col_offset=20), Str('Error: command "EHLO" not implemented', lineno=200, col_offset=25)], Load(), lineno=200, col_offset=20), lineno=200, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=201, col_offset=8), 'assertEqual', Load(), lineno=201, col_offset=8), [Call(Attribute(Name('smtp', Load(), lineno=201, col_offset=25), 'ehlo', Load(), lineno=201, col_offset=25), [], [], None, None, lineno=201, col_offset=25), Name('expected', Load(), lineno=201, col_offset=38)], [], None, None, lineno=201, col_offset=8), lineno=201, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=202, col_offset=8), 'quit', Load(), lineno=202, col_offset=8), [], [], None, None, lineno=202, col_offset=8), lineno=202, col_offset=8)], [], lineno=197, col_offset=4), FunctionDef('testVRFY', arguments([Name('self', Param(), lineno=204, col_offset=17)], None, None, []), [Assign([Name('smtp', Store(), lineno=206, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=206, col_offset=15), 'SMTP', Load(), lineno=206, col_offset=15), [Name('HOST', Load(), lineno=206, col_offset=28), Attribute(Name('self', Load(), lineno=206, col_offset=34), 'port', Load(), lineno=206, col_offset=34)], [keyword('local_hostname', Str('localhost', lineno=206, col_offset=60)), keyword('timeout', Num(3, lineno=206, col_offset=81))], None, None, lineno=206, col_offset=15), lineno=206, col_offset=8), Assign([Name('expected', Store(), lineno=207, col_offset=8)], Tuple([Num(502, lineno=207, col_offset=20), Str('Error: command "VRFY" not implemented', lineno=207, col_offset=25)], Load(), lineno=207, col_offset=20), lineno=207, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=208, col_offset=8), 'assertEqual', Load(), lineno=208, col_offset=8), [Call(Attribute(Name('smtp', Load(), lineno=208, col_offset=25), 'vrfy', Load(), lineno=208, col_offset=25), [Str('nobody@nowhere.com', lineno=208, col_offset=35)], [], None, None, lineno=208, col_offset=25), Name('expected', Load(), lineno=208, col_offset=58)], [], None, None, lineno=208, col_offset=8), lineno=208, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=209, col_offset=8), 'assertEqual', Load(), lineno=209, col_offset=8), [Call(Attribute(Name('smtp', Load(), lineno=209, col_offset=25), 'verify', Load(), lineno=209, col_offset=25), [Str('nobody@nowhere.com', lineno=209, col_offset=37)], [], None, None, lineno=209, col_offset=25), Name('expected', Load(), lineno=209, col_offset=60)], [], None, None, lineno=209, col_offset=8), lineno=209, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=210, col_offset=8), 'quit', Load(), lineno=210, col_offset=8), [], [], None, None, lineno=210, col_offset=8), lineno=210, col_offset=8)], [], lineno=204, col_offset=4), FunctionDef('testSecondHELO', arguments([Name('self', Param(), lineno=212, col_offset=23)], None, None, []), [Assign([Name('smtp', Store(), lineno=215, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=215, col_offset=15), 'SMTP', Load(), lineno=215, col_offset=15), [Name('HOST', Load(), lineno=215, col_offset=28), Attribute(Name('self', Load(), lineno=215, col_offset=34), 'port', Load(), lineno=215, col_offset=34)], [keyword('local_hostname', Str('localhost', lineno=215, col_offset=60)), keyword('timeout', Num(3, lineno=215, col_offset=81))], None, None, lineno=215, col_offset=15), lineno=215, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=216, col_offset=8), 'helo', Load(), lineno=216, col_offset=8), [], [], None, None, lineno=216, col_offset=8), lineno=216, col_offset=8), Assign([Name('expected', Store(), lineno=217, col_offset=8)], Tuple([Num(503, lineno=217, col_offset=20), Str('Duplicate HELO/EHLO', lineno=217, col_offset=25)], Load(), lineno=217, col_offset=20), lineno=217, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=218, col_offset=8), 'assertEqual', Load(), lineno=218, col_offset=8), [Call(Attribute(Name('smtp', Load(), lineno=218, col_offset=25), 'helo', Load(), lineno=218, col_offset=25), [], [], None, None, lineno=218, col_offset=25), Name('expected', Load(), lineno=218, col_offset=38)], [], None, None, lineno=218, col_offset=8), lineno=218, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=219, col_offset=8), 'quit', Load(), lineno=219, col_offset=8), [], [], None, None, lineno=219, col_offset=8), lineno=219, col_offset=8)], [], lineno=212, col_offset=4), FunctionDef('testHELP', arguments([Name('self', Param(), lineno=221, col_offset=17)], None, None, []), [Assign([Name('smtp', Store(), lineno=222, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=222, col_offset=15), 'SMTP', Load(), lineno=222, col_offset=15), [Name('HOST', Load(), lineno=222, col_offset=28), Attribute(Name('self', Load(), lineno=222, col_offset=34), 'port', Load(), lineno=222, col_offset=34)], [keyword('local_hostname', Str('localhost', lineno=222, col_offset=60)), keyword('timeout', Num(3, lineno=222, col_offset=81))], None, None, lineno=222, col_offset=15), lineno=222, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=223, col_offset=8), 'assertEqual', Load(), lineno=223, col_offset=8), [Call(Attribute(Name('smtp', Load(), lineno=223, col_offset=25), 'help', Load(), lineno=223, col_offset=25), [], [], None, None, lineno=223, col_offset=25), Str('Error: command "HELP" not implemented', lineno=223, col_offset=38)], [], None, None, lineno=223, col_offset=8), lineno=223, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=224, col_offset=8), 'quit', Load(), lineno=224, col_offset=8), [], [], None, None, lineno=224, col_offset=8), lineno=224, col_offset=8)], [], lineno=221, col_offset=4), FunctionDef('testSend', arguments([Name('self', Param(), lineno=226, col_offset=17)], None, None, []), [Assign([Name('m', Store(), lineno=228, col_offset=8)], Str('A test message', lineno=228, col_offset=12), lineno=228, col_offset=8), Assign([Name('smtp', Store(), lineno=229, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=229, col_offset=15), 'SMTP', Load(), lineno=229, col_offset=15), [Name('HOST', Load(), lineno=229, col_offset=28), Attribute(Name('self', Load(), lineno=229, col_offset=34), 'port', Load(), lineno=229, col_offset=34)], [keyword('local_hostname', Str('localhost', lineno=229, col_offset=60)), keyword('timeout', Num(3, lineno=229, col_offset=81))], None, None, lineno=229, col_offset=15), lineno=229, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=230, col_offset=8), 'sendmail', Load(), lineno=230, col_offset=8), [Str('John', lineno=230, col_offset=22), Str('Sally', lineno=230, col_offset=30), Name('m', Load(), lineno=230, col_offset=39)], [], None, None, lineno=230, col_offset=8), lineno=230, col_offset=8), Expr(Call(Attribute(Name('time', Load(), lineno=234, col_offset=8), 'sleep', Load(), lineno=234, col_offset=8), [Num(0.01, lineno=234, col_offset=19)], [], None, None, lineno=234, col_offset=8), lineno=234, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=235, col_offset=8), 'quit', Load(), lineno=235, col_offset=8), [], [], None, None, lineno=235, col_offset=8), lineno=235, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=237, col_offset=8), 'client_evt', Load(), lineno=237, col_offset=8), 'set', Load(), lineno=237, col_offset=8), [], [], None, None, lineno=237, col_offset=8), lineno=237, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=238, col_offset=8), 'serv_evt', Load(), lineno=238, col_offset=8), 'wait', Load(), lineno=238, col_offset=8), [], [], None, None, lineno=238, col_offset=8), lineno=238, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=239, col_offset=8), 'output', Load(), lineno=239, col_offset=8), 'flush', Load(), lineno=239, col_offset=8), [], [], None, None, lineno=239, col_offset=8), lineno=239, col_offset=8), Assign([Name('mexpect', Store(), lineno=240, col_offset=8)], BinOp(Str('%s%s\n%s', lineno=240, col_offset=18), Mod(), Tuple([Name('MSG_BEGIN', Load(), lineno=240, col_offset=32), Name('m', Load(), lineno=240, col_offset=43), Name('MSG_END', Load(), lineno=240, col_offset=46)], Load(), lineno=240, col_offset=32), lineno=240, col_offset=18), lineno=240, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=241, col_offset=8), 'assertEqual', Load(), lineno=241, col_offset=8), [Call(Attribute(Attribute(Name('self', Load(), lineno=241, col_offset=25), 'output', Load(), lineno=241, col_offset=25), 'getvalue', Load(), lineno=241, col_offset=25), [], [], None, None, lineno=241, col_offset=25), Name('mexpect', Load(), lineno=241, col_offset=49)], [], None, None, lineno=241, col_offset=8), lineno=241, col_offset=8)], [], lineno=226, col_offset=4)], [Call(Attribute(Name('unittest', Load(), lineno=146, col_offset=1), 'skipUnless', Load(), lineno=146, col_offset=1), [Name('threading', Load(), lineno=146, col_offset=21), Str('Threading required for this test.', lineno=146, col_offset=32)], [], None, None, lineno=146, col_offset=1)], lineno=146, col_offset=0), ClassDef('NonConnectingTests', [Attribute(Name('unittest', Load(), lineno=244, col_offset=25), 'TestCase', Load(), lineno=244, col_offset=25)], [FunctionDef('testNotConnected', arguments([Name('self', Param(), lineno=246, col_offset=25)], None, None, []), [Assign([Name('smtp', Store(), lineno=251, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=251, col_offset=15), 'SMTP', Load(), lineno=251, col_offset=15), [], [], None, None, lineno=251, col_offset=15), lineno=251, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=252, col_offset=8), 'assertRaises', Load(), lineno=252, col_offset=8), [Attribute(Name('smtplib', Load(), lineno=252, col_offset=26), 'SMTPServerDisconnected', Load(), lineno=252, col_offset=26), Attribute(Name('smtp', Load(), lineno=252, col_offset=58), 'ehlo', Load(), lineno=252, col_offset=58)], [], None, None, lineno=252, col_offset=8), lineno=252, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=253, col_offset=8), 'assertRaises', Load(), lineno=253, col_offset=8), [Attribute(Name('smtplib', Load(), lineno=253, col_offset=26), 'SMTPServerDisconnected', Load(), lineno=253, col_offset=26), Attribute(Name('smtp', Load(), lineno=254, col_offset=26), 'send', Load(), lineno=254, col_offset=26), Str('test msg', lineno=254, col_offset=37)], [], None, None, lineno=253, col_offset=8), lineno=253, col_offset=8)], [], lineno=246, col_offset=4), FunctionDef('testNonnumericPort', arguments([Name('self', Param(), lineno=256, col_offset=27)], None, None, []), [Expr(Call(Attribute(Name('self', Load(), lineno=258, col_offset=8), 'assertRaises', Load(), lineno=258, col_offset=8), [Attribute(Name('socket', Load(), lineno=258, col_offset=26), 'error', Load(), lineno=258, col_offset=26), Attribute(Name('smtplib', Load(), lineno=258, col_offset=40), 'SMTP', Load(), lineno=258, col_offset=40), Str('localhost', lineno=259, col_offset=26), Str('bogus', lineno=259, col_offset=39)], [], None, None, lineno=258, col_offset=8), lineno=258, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=260, col_offset=8), 'assertRaises', Load(), lineno=260, col_offset=8), [Attribute(Name('socket', Load(), lineno=260, col_offset=26), 'error', Load(), lineno=260, col_offset=26), Attribute(Name('smtplib', Load(), lineno=260, col_offset=40), 'SMTP', Load(), lineno=260, col_offset=40), Str('localhost:bogus', lineno=261, col_offset=26)], [], None, None, lineno=260, col_offset=8), lineno=260, col_offset=8)], [], lineno=256, col_offset=4)], [], lineno=244, col_offset=0), ClassDef('BadHELOServerTests', [Attribute(Name('unittest', Load(), lineno=266, col_offset=25), 'TestCase', Load(), lineno=266, col_offset=25)], [FunctionDef('setUp', arguments([Name('self', Param(), lineno=268, col_offset=14)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=269, col_offset=8), 'old_stdout', Store(), lineno=269, col_offset=8)], Attribute(Name('sys', Load(), lineno=269, col_offset=26), 'stdout', Load(), lineno=269, col_offset=26), lineno=269, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=270, col_offset=8), 'output', Store(), lineno=270, col_offset=8)], Call(Attribute(Name('StringIO', Load(), lineno=270, col_offset=22), 'StringIO', Load(), lineno=270, col_offset=22), [], [], None, None, lineno=270, col_offset=22), lineno=270, col_offset=8), Assign([Attribute(Name('sys', Load(), lineno=271, col_offset=8), 'stdout', Store(), lineno=271, col_offset=8)], Attribute(Name('self', Load(), lineno=271, col_offset=21), 'output', Load(), lineno=271, col_offset=21), lineno=271, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=273, col_offset=8), '_threads', Store(), lineno=273, col_offset=8)], Call(Attribute(Name('test_support', Load(), lineno=273, col_offset=24), 'threading_setup', Load(), lineno=273, col_offset=24), [], [], None, None, lineno=273, col_offset=24), lineno=273, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=274, col_offset=8), 'evt', Store(), lineno=274, col_offset=8)], Call(Attribute(Name('threading', Load(), lineno=274, col_offset=19), 'Event', Load(), lineno=274, col_offset=19), [], [], None, None, lineno=274, col_offset=19), lineno=274, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=275, col_offset=8), 'sock', Store(), lineno=275, col_offset=8)], Call(Attribute(Name('socket', Load(), lineno=275, col_offset=20), 'socket', Load(), lineno=275, col_offset=20), [Attribute(Name('socket', Load(), lineno=275, col_offset=34), 'AF_INET', Load(), lineno=275, col_offset=34), Attribute(Name('socket', Load(), lineno=275, col_offset=50), 'SOCK_STREAM', Load(), lineno=275, col_offset=50)], [], None, None, lineno=275, col_offset=20), lineno=275, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=276, col_offset=8), 'sock', Load(), lineno=276, col_offset=8), 'settimeout', Load(), lineno=276, col_offset=8), [Num(15, lineno=276, col_offset=29)], [], None, None, lineno=276, col_offset=8), lineno=276, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=277, col_offset=8), 'port', Store(), lineno=277, col_offset=8)], Call(Attribute(Name('test_support', Load(), lineno=277, col_offset=20), 'bind_port', Load(), lineno=277, col_offset=20), [Attribute(Name('self', Load(), lineno=277, col_offset=43), 'sock', Load(), lineno=277, col_offset=43)], [], None, None, lineno=277, col_offset=20), lineno=277, col_offset=8), Assign([Name('servargs', Store(), lineno=278, col_offset=8)], Tuple([Attribute(Name('self', Load(), lineno=278, col_offset=20), 'evt', Load(), lineno=278, col_offset=20), Str('199 no hello for you!\n', lineno=278, col_offset=30), Attribute(Name('self', Load(), lineno=278, col_offset=57), 'sock', Load(), lineno=278, col_offset=57)], Load(), lineno=278, col_offset=20), lineno=278, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=279, col_offset=8), 'thread', Store(), lineno=279, col_offset=8)], Call(Attribute(Name('threading', Load(), lineno=279, col_offset=22), 'Thread', Load(), lineno=279, col_offset=22), [], [keyword('target', Name('server', Load(), lineno=279, col_offset=46)), keyword('args', Name('servargs', Load(), lineno=279, col_offset=59))], None, None, lineno=279, col_offset=22), lineno=279, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=280, col_offset=8), 'thread', Load(), lineno=280, col_offset=8), 'start', Load(), lineno=280, col_offset=8), [], [], None, None, lineno=280, col_offset=8), lineno=280, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=281, col_offset=8), 'evt', Load(), lineno=281, col_offset=8), 'wait', Load(), lineno=281, col_offset=8), [], [], None, None, lineno=281, col_offset=8), lineno=281, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=282, col_offset=8), 'evt', Load(), lineno=282, col_offset=8), 'clear', Load(), lineno=282, col_offset=8), [], [], None, None, lineno=282, col_offset=8), lineno=282, col_offset=8)], [], lineno=268, col_offset=4), FunctionDef('tearDown', arguments([Name('self', Param(), lineno=284, col_offset=17)], None, None, []), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=285, col_offset=8), 'evt', Load(), lineno=285, col_offset=8), 'wait', Load(), lineno=285, col_offset=8), [], [], None, None, lineno=285, col_offset=8), lineno=285, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=286, col_offset=8), 'thread', Load(), lineno=286, col_offset=8), 'join', Load(), lineno=286, col_offset=8), [], [], None, None, lineno=286, col_offset=8), lineno=286, col_offset=8), Expr(Call(Attribute(Name('test_support', Load(), lineno=287, col_offset=8), 'threading_cleanup', Load(), lineno=287, col_offset=8), [], [], Attribute(Name('self', Load(), lineno=287, col_offset=40), '_threads', Load(), lineno=287, col_offset=40), None, lineno=287, col_offset=8), lineno=287, col_offset=8), Assign([Attribute(Name('sys', Load(), lineno=288, col_offset=8), 'stdout', Store(), lineno=288, col_offset=8)], Attribute(Name('self', Load(), lineno=288, col_offset=21), 'old_stdout', Load(), lineno=288, col_offset=21), lineno=288, col_offset=8)], [], lineno=284, col_offset=4), FunctionDef('testFailingHELO', arguments([Name('self', Param(), lineno=290, col_offset=24)], None, None, []), [Expr(Call(Attribute(Name('self', Load(), lineno=291, col_offset=8), 'assertRaises', Load(), lineno=291, col_offset=8), [Attribute(Name('smtplib', Load(), lineno=291, col_offset=26), 'SMTPConnectError', Load(), lineno=291, col_offset=26), Attribute(Name('smtplib', Load(), lineno=291, col_offset=52), 'SMTP', Load(), lineno=291, col_offset=52), Name('HOST', Load(), lineno=292, col_offset=28), Attribute(Name('self', Load(), lineno=292, col_offset=34), 'port', Load(), lineno=292, col_offset=34), Str('localhost', lineno=292, col_offset=45), Num(3, lineno=292, col_offset=58)], [], None, None, lineno=291, col_offset=8), lineno=291, col_offset=8)], [], lineno=290, col_offset=4)], [Call(Attribute(Name('unittest', Load(), lineno=265, col_offset=1), 'skipUnless', Load(), lineno=265, col_offset=1), [Name('threading', Load(), lineno=265, col_offset=21), Str('Threading required for this test.', lineno=265, col_offset=32)], [], None, None, lineno=265, col_offset=1)], lineno=265, col_offset=0), Assign([Name('sim_users', Store(), lineno=295, col_offset=0)], Dict([Str('Mr.A@somewhere.com', lineno=295, col_offset=13), Str('Ms.B@somewhere.com', lineno=296, col_offset=13), Str('Mrs.C@somewhereesle.com', lineno=297, col_offset=13)], [Str('John A', lineno=295, col_offset=34), Str('Sally B', lineno=296, col_offset=34), Str('Ruth C', lineno=297, col_offset=39)], lineno=295, col_offset=12), lineno=295, col_offset=0), Assign([Name('sim_auth', Store(), lineno=300, col_offset=0)], Tuple([Str('Mr.A@somewhere.com', lineno=300, col_offset=12), Str('somepassword', lineno=300, col_offset=34)], Load(), lineno=300, col_offset=12), lineno=300, col_offset=0), Assign([Name('sim_cram_md5_challenge', Store(), lineno=301, col_offset=0)], Str('PENCeUxFREJoU0NnbmhNWitOMjNGNndAZWx3b29kLmlubm9zb2Z0LmNvbT4=', lineno=301, col_offset=26), lineno=301, col_offset=0), Assign([Name('sim_auth_credentials', Store(), lineno=303, col_offset=0)], Dict([Str('login', lineno=304, col_offset=4), Str('plain', lineno=305, col_offset=4), Str('cram-md5', lineno=306, col_offset=4)], [Str('TXIuQUBzb21ld2hlcmUuY29t', lineno=304, col_offset=13), Str('AE1yLkFAc29tZXdoZXJlLmNvbQBzb21lcGFzc3dvcmQ=', lineno=305, col_offset=13), Str('TXIUQUBZB21LD2HLCMUUY29TIDG4OWQ0MJKWZGQ4ODNMNDA4NTGXMDRLZWMYZJDMODG1', lineno=306, col_offset=17)], lineno=303, col_offset=23), lineno=303, col_offset=0), Assign([Name('sim_auth_login_password', Store(), lineno=309, col_offset=0)], Str('C29TZXBHC3N3B3JK', lineno=309, col_offset=26), lineno=309, col_offset=0), Assign([Name('sim_lists', Store(), lineno=311, col_offset=0)], Dict([Str('list-1', lineno=311, col_offset=13), Str('list-2', lineno=312, col_offset=13)], [List([Str('Mr.A@somewhere.com', lineno=311, col_offset=23), Str('Mrs.C@somewhereesle.com', lineno=311, col_offset=44)], Load(), lineno=311, col_offset=22), List([Str('Ms.B@somewhere.com', lineno=312, col_offset=23)], Load(), lineno=312, col_offset=22)], lineno=311, col_offset=12), lineno=311, col_offset=0), ClassDef('SimSMTPChannel', [Attribute(Name('smtpd', Load(), lineno=316, col_offset=21), 'SMTPChannel', Load(), lineno=316, col_offset=21)], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=318, col_offset=17), Name('extra_features', Param(), lineno=318, col_offset=23)], 'args', 'kw', []), [Assign([Attribute(Name('self', Load(), lineno=319, col_offset=8), '_extrafeatures', Store(), lineno=319, col_offset=8)], Call(Attribute(Str('', lineno=319, col_offset=30), 'join', Load(), lineno=319, col_offset=30), [ListComp(Call(Attribute(Str('250-{0}\r\n', lineno=320, col_offset=14), 'format', Load(), lineno=320, col_offset=14), [Name('x', Load(), lineno=320, col_offset=35)], [], None, None, lineno=320, col_offset=14), [comprehension(Name('x', Store(), lineno=320, col_offset=42), Name('extra_features', Load(), lineno=320, col_offset=47), [])], lineno=320, col_offset=14)], [], None, None, lineno=319, col_offset=30), lineno=319, col_offset=8), Expr(Call(Attribute(Attribute(Name('smtpd', Load(), lineno=321, col_offset=8), 'SMTPChannel', Load(), lineno=321, col_offset=8), '__init__', Load(), lineno=321, col_offset=8), [Name('self', Load(), lineno=321, col_offset=35)], [], Name('args', Load(), lineno=321, col_offset=42), Name('kw', Load(), lineno=321, col_offset=50), lineno=321, col_offset=8), lineno=321, col_offset=8)], [], lineno=318, col_offset=4), FunctionDef('smtp_EHLO', arguments([Name('self', Param(), lineno=323, col_offset=18), Name('arg', Param(), lineno=323, col_offset=24)], None, None, []), [Assign([Name('resp', Store(), lineno=324, col_offset=8)], Str('250-testhost\r\n250-EXPN\r\n250-SIZE 20000000\r\n250-STARTTLS\r\n250-DELIVERBY\r\n', lineno=324, col_offset=16), lineno=324, col_offset=8), Assign([Name('resp', Store(), lineno=329, col_offset=8)], BinOp(BinOp(Name('resp', Load(), lineno=329, col_offset=15), Add(), Attribute(Name('self', Load(), lineno=329, col_offset=22), '_extrafeatures', Load(), lineno=329, col_offset=22), lineno=329, col_offset=15), Add(), Str('250 HELP', lineno=329, col_offset=44), lineno=329, col_offset=42), lineno=329, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=330, col_offset=8), 'push', Load(), lineno=330, col_offset=8), [Name('resp', Load(), lineno=330, col_offset=18)], [], None, None, lineno=330, col_offset=8), lineno=330, col_offset=8)], [], lineno=323, col_offset=4), FunctionDef('smtp_VRFY', arguments([Name('self', Param(), lineno=332, col_offset=18), Name('arg', Param(), lineno=332, col_offset=24)], None, None, []), [Assign([Name('raw_addr', Store(), lineno=333, col_offset=8)], Subscript(Call(Attribute(Attribute(Name('email', Load(), lineno=333, col_offset=19), 'utils', Load(), lineno=333, col_offset=19), 'parseaddr', Load(), lineno=333, col_offset=19), [Name('arg', Load(), lineno=333, col_offset=41)], [], None, None, lineno=333, col_offset=19), Index(Num(1, lineno=333, col_offset=46)), Load(), lineno=333, col_offset=19), lineno=333, col_offset=8), Assign([Name('quoted_addr', Store(), lineno=334, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=334, col_offset=22), 'quoteaddr', Load(), lineno=334, col_offset=22), [Name('arg', Load(), lineno=334, col_offset=40)], [], None, None, lineno=334, col_offset=22), lineno=334, col_offset=8), If(Compare(Name('raw_addr', Load(), lineno=335, col_offset=11), [In()], [Name('sim_users', Load(), lineno=335, col_offset=23)], lineno=335, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=336, col_offset=12), 'push', Load(), lineno=336, col_offset=12), [BinOp(Str('250 %s %s', lineno=336, col_offset=22), Mod(), Tuple([Subscript(Name('sim_users', Load(), lineno=336, col_offset=37), Index(Name('raw_addr', Load(), lineno=336, col_offset=47)), Load(), lineno=336, col_offset=37), Name('quoted_addr', Load(), lineno=336, col_offset=58)], Load(), lineno=336, col_offset=37), lineno=336, col_offset=22)], [], None, None, lineno=336, col_offset=12), lineno=336, col_offset=12)], [Expr(Call(Attribute(Name('self', Load(), lineno=338, col_offset=12), 'push', Load(), lineno=338, col_offset=12), [BinOp(Str('550 No such user: %s', lineno=338, col_offset=22), Mod(), Name('arg', Load(), lineno=338, col_offset=47), lineno=338, col_offset=22)], [], None, None, lineno=338, col_offset=12), lineno=338, col_offset=12)], lineno=335, col_offset=8)], [], lineno=332, col_offset=4), FunctionDef('smtp_EXPN', arguments([Name('self', Param(), lineno=340, col_offset=18), Name('arg', Param(), lineno=340, col_offset=24)], None, None, []), [Assign([Name('list_name', Store(), lineno=341, col_offset=8)], Call(Attribute(Subscript(Call(Attribute(Attribute(Name('email', Load(), lineno=341, col_offset=20), 'utils', Load(), lineno=341, col_offset=20), 'parseaddr', Load(), lineno=341, col_offset=20), [Name('arg', Load(), lineno=341, col_offset=42)], [], None, None, lineno=341, col_offset=20), Index(Num(1, lineno=341, col_offset=47)), Load(), lineno=341, col_offset=20), 'lower', Load(), lineno=341, col_offset=20), [], [], None, None, lineno=341, col_offset=20), lineno=341, col_offset=8), If(Compare(Name('list_name', Load(), lineno=342, col_offset=11), [In()], [Name('sim_lists', Load(), lineno=342, col_offset=24)], lineno=342, col_offset=11), [Assign([Name('user_list', Store(), lineno=343, col_offset=12)], Subscript(Name('sim_lists', Load(), lineno=343, col_offset=24), Index(Name('list_name', Load(), lineno=343, col_offset=34)), Load(), lineno=343, col_offset=24), lineno=343, col_offset=12), For(Tuple([Name('n', Store(), lineno=344, col_offset=16), Name('user_email', Store(), lineno=344, col_offset=19)], Store(), lineno=344, col_offset=16), Call(Name('enumerate', Load(), lineno=344, col_offset=33), [Name('user_list', Load(), lineno=344, col_offset=43)], [], None, None, lineno=344, col_offset=33), [Assign([Name('quoted_addr', Store(), lineno=345, col_offset=16)], Call(Attribute(Name('smtplib', Load(), lineno=345, col_offset=30), 'quoteaddr', Load(), lineno=345, col_offset=30), [Name('user_email', Load(), lineno=345, col_offset=48)], [], None, None, lineno=345, col_offset=30), lineno=345, col_offset=16), If(Compare(Name('n', Load(), lineno=346, col_offset=19), [Lt()], [BinOp(Call(Name('len', Load(), lineno=346, col_offset=23), [Name('user_list', Load(), lineno=346, col_offset=27)], [], None, None, lineno=346, col_offset=23), Sub(), Num(1, lineno=346, col_offset=40), lineno=346, col_offset=23)], lineno=346, col_offset=19), [Expr(Call(Attribute(Name('self', Load(), lineno=347, col_offset=20), 'push', Load(), lineno=347, col_offset=20), [BinOp(Str('250-%s %s', lineno=347, col_offset=30), Mod(), Tuple([Subscript(Name('sim_users', Load(), lineno=347, col_offset=45), Index(Name('user_email', Load(), lineno=347, col_offset=55)), Load(), lineno=347, col_offset=45), Name('quoted_addr', Load(), lineno=347, col_offset=68)], Load(), lineno=347, col_offset=45), lineno=347, col_offset=30)], [], None, None, lineno=347, col_offset=20), lineno=347, col_offset=20)], [Expr(Call(Attribute(Name('self', Load(), lineno=349, col_offset=20), 'push', Load(), lineno=349, col_offset=20), [BinOp(Str('250 %s %s', lineno=349, col_offset=30), Mod(), Tuple([Subscript(Name('sim_users', Load(), lineno=349, col_offset=45), Index(Name('user_email', Load(), lineno=349, col_offset=55)), Load(), lineno=349, col_offset=45), Name('quoted_addr', Load(), lineno=349, col_offset=68)], Load(), lineno=349, col_offset=45), lineno=349, col_offset=30)], [], None, None, lineno=349, col_offset=20), lineno=349, col_offset=20)], lineno=346, col_offset=16)], [], lineno=344, col_offset=12)], [Expr(Call(Attribute(Name('self', Load(), lineno=351, col_offset=12), 'push', Load(), lineno=351, col_offset=12), [Str('550 No access for you!', lineno=351, col_offset=22)], [], None, None, lineno=351, col_offset=12), lineno=351, col_offset=12)], lineno=342, col_offset=8)], [], lineno=340, col_offset=4), FunctionDef('smtp_AUTH', arguments([Name('self', Param(), lineno=353, col_offset=18), Name('arg', Param(), lineno=353, col_offset=24)], None, None, []), [If(Compare(Call(Attribute(Call(Attribute(Name('arg', Load(), lineno=354, col_offset=11), 'strip', Load(), lineno=354, col_offset=11), [], [], None, None, lineno=354, col_offset=11), 'lower', Load(), lineno=354, col_offset=11), [], [], None, None, lineno=354, col_offset=11), [Eq()], [Str('cram-md5', lineno=354, col_offset=32)], lineno=354, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=355, col_offset=12), 'push', Load(), lineno=355, col_offset=12), [Call(Attribute(Str('334 {0}', lineno=355, col_offset=22), 'format', Load(), lineno=355, col_offset=22), [Name('sim_cram_md5_challenge', Load(), lineno=355, col_offset=39)], [], None, None, lineno=355, col_offset=22)], [], None, None, lineno=355, col_offset=12), lineno=355, col_offset=12), Return(None, lineno=356, col_offset=12)], [], lineno=354, col_offset=8), Assign([Tuple([Name('mech', Store(), lineno=357, col_offset=8), Name('auth', Store(), lineno=357, col_offset=14)], Store(), lineno=357, col_offset=8)], Call(Attribute(Name('arg', Load(), lineno=357, col_offset=21), 'split', Load(), lineno=357, col_offset=21), [], [], None, None, lineno=357, col_offset=21), lineno=357, col_offset=8), Assign([Name('mech', Store(), lineno=358, col_offset=8)], Call(Attribute(Name('mech', Load(), lineno=358, col_offset=15), 'lower', Load(), lineno=358, col_offset=15), [], [], None, None, lineno=358, col_offset=15), lineno=358, col_offset=8), If(Compare(Name('mech', Load(), lineno=359, col_offset=11), [NotIn()], [Name('sim_auth_credentials', Load(), lineno=359, col_offset=23)], lineno=359, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=360, col_offset=12), 'push', Load(), lineno=360, col_offset=12), [Str('504 auth type unimplemented', lineno=360, col_offset=22)], [], None, None, lineno=360, col_offset=12), lineno=360, col_offset=12), Return(None, lineno=361, col_offset=12)], [], lineno=359, col_offset=8), If(BoolOp(And(), [Compare(Name('mech', Load(), lineno=362, col_offset=11), [Eq()], [Str('plain', lineno=362, col_offset=19)], lineno=362, col_offset=11), Compare(Name('auth', Load(), lineno=362, col_offset=31), [Eq()], [Subscript(Name('sim_auth_credentials', Load(), lineno=362, col_offset=37), Index(Str('plain', lineno=362, col_offset=58)), Load(), lineno=362, col_offset=37)], lineno=362, col_offset=31)], lineno=362, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=363, col_offset=12), 'push', Load(), lineno=363, col_offset=12), [Str('235 plain auth ok', lineno=363, col_offset=22)], [], None, None, lineno=363, col_offset=12), lineno=363, col_offset=12)], [If(BoolOp(And(), [Compare(Name('mech', Load(), lineno=364, col_offset=13), [Eq()], [Str('login', lineno=364, col_offset=19)], lineno=364, col_offset=13), Compare(Name('auth', Load(), lineno=364, col_offset=31), [Eq()], [Subscript(Name('sim_auth_credentials', Load(), lineno=364, col_offset=37), Index(Str('login', lineno=364, col_offset=58)), Load(), lineno=364, col_offset=37)], lineno=364, col_offset=31)], lineno=364, col_offset=13), [Expr(Call(Attribute(Name('self', Load(), lineno=365, col_offset=12), 'push', Load(), lineno=365, col_offset=12), [Str('334 Password:', lineno=365, col_offset=22)], [], None, None, lineno=365, col_offset=12), lineno=365, col_offset=12)], [Expr(Call(Attribute(Name('self', Load(), lineno=367, col_offset=12), 'push', Load(), lineno=367, col_offset=12), [Str('550 No access for you!', lineno=367, col_offset=22)], [], None, None, lineno=367, col_offset=12), lineno=367, col_offset=12)], lineno=364, col_offset=13)], lineno=362, col_offset=8)], [], lineno=353, col_offset=4), FunctionDef('handle_error', arguments([Name('self', Param(), lineno=369, col_offset=21)], None, None, []), [Raise(None, None, None, lineno=370, col_offset=8)], [], lineno=369, col_offset=4)], [], lineno=316, col_offset=0), ClassDef('SimSMTPServer', [Attribute(Name('smtpd', Load(), lineno=373, col_offset=20), 'SMTPServer', Load(), lineno=373, col_offset=20)], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=375, col_offset=17)], 'args', 'kw', []), [Assign([Attribute(Name('self', Load(), lineno=376, col_offset=8), '_extra_features', Store(), lineno=376, col_offset=8)], List([], Load(), lineno=376, col_offset=31), lineno=376, col_offset=8), Expr(Call(Attribute(Attribute(Name('smtpd', Load(), lineno=377, col_offset=8), 'SMTPServer', Load(), lineno=377, col_offset=8), '__init__', Load(), lineno=377, col_offset=8), [Name('self', Load(), lineno=377, col_offset=34)], [], Name('args', Load(), lineno=377, col_offset=41), Name('kw', Load(), lineno=377, col_offset=49), lineno=377, col_offset=8), lineno=377, col_offset=8)], [], lineno=375, col_offset=4), FunctionDef('handle_accept', arguments([Name('self', Param(), lineno=379, col_offset=22)], None, None, []), [Assign([Tuple([Name('conn', Store(), lineno=380, col_offset=8), Name('addr', Store(), lineno=380, col_offset=14)], Store(), lineno=380, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=380, col_offset=21), 'accept', Load(), lineno=380, col_offset=21), [], [], None, None, lineno=380, col_offset=21), lineno=380, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=381, col_offset=8), '_SMTPchannel', Store(), lineno=381, col_offset=8)], Call(Name('SimSMTPChannel', Load(), lineno=381, col_offset=28), [Attribute(Name('self', Load(), lineno=381, col_offset=43), '_extra_features', Load(), lineno=381, col_offset=43), Name('self', Load(), lineno=382, col_offset=43), Name('conn', Load(), lineno=382, col_offset=49), Name('addr', Load(), lineno=382, col_offset=55)], [], None, None, lineno=381, col_offset=28), lineno=381, col_offset=8)], [], lineno=379, col_offset=4), FunctionDef('process_message', arguments([Name('self', Param(), lineno=384, col_offset=24), Name('peer', Param(), lineno=384, col_offset=30), Name('mailfrom', Param(), lineno=384, col_offset=36), Name('rcpttos', Param(), lineno=384, col_offset=46), Name('data', Param(), lineno=384, col_offset=55)], None, None, []), [Pass( lineno=385, col_offset=8)], [], lineno=384, col_offset=4), FunctionDef('add_feature', arguments([Name('self', Param(), lineno=387, col_offset=20), Name('feature', Param(), lineno=387, col_offset=26)], None, None, []), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=388, col_offset=8), '_extra_features', Load(), lineno=388, col_offset=8), 'append', Load(), lineno=388, col_offset=8), [Name('feature', Load(), lineno=388, col_offset=36)], [], None, None, lineno=388, col_offset=8), lineno=388, col_offset=8)], [], lineno=387, col_offset=4), FunctionDef('handle_error', arguments([Name('self', Param(), lineno=390, col_offset=21)], None, None, []), [Raise(None, None, None, lineno=391, col_offset=8)], [], lineno=390, col_offset=4)], [], lineno=373, col_offset=0), ClassDef('SMTPSimTests', [Attribute(Name('unittest', Load(), lineno=397, col_offset=19), 'TestCase', Load(), lineno=397, col_offset=19)], [FunctionDef('setUp', arguments([Name('self', Param(), lineno=399, col_offset=14)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=400, col_offset=8), '_threads', Store(), lineno=400, col_offset=8)], Call(Attribute(Name('test_support', Load(), lineno=400, col_offset=24), 'threading_setup', Load(), lineno=400, col_offset=24), [], [], None, None, lineno=400, col_offset=24), lineno=400, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=401, col_offset=8), 'serv_evt', Store(), lineno=401, col_offset=8)], Call(Attribute(Name('threading', Load(), lineno=401, col_offset=24), 'Event', Load(), lineno=401, col_offset=24), [], [], None, None, lineno=401, col_offset=24), lineno=401, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=402, col_offset=8), 'client_evt', Store(), lineno=402, col_offset=8)], Call(Attribute(Name('threading', Load(), lineno=402, col_offset=26), 'Event', Load(), lineno=402, col_offset=26), [], [], None, None, lineno=402, col_offset=26), lineno=402, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=404, col_offset=8), 'serv', Store(), lineno=404, col_offset=8)], Call(Name('SimSMTPServer', Load(), lineno=404, col_offset=20), [Tuple([Name('HOST', Load(), lineno=404, col_offset=35), Num(0, lineno=404, col_offset=41)], Load(), lineno=404, col_offset=35), Tuple([Str('nowhere', lineno=404, col_offset=46), Num(-1, lineno=404, col_offset=58)], Load(), lineno=404, col_offset=46)], [], None, None, lineno=404, col_offset=20), lineno=404, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=406, col_offset=8), 'port', Store(), lineno=406, col_offset=8)], Subscript(Call(Attribute(Attribute(Attribute(Name('self', Load(), lineno=406, col_offset=20), 'serv', Load(), lineno=406, col_offset=20), 'socket', Load(), lineno=406, col_offset=20), 'getsockname', Load(), lineno=406, col_offset=20), [], [], None, None, lineno=406, col_offset=20), Index(Num(1, lineno=406, col_offset=51)), Load(), lineno=406, col_offset=20), lineno=406, col_offset=8), Assign([Name('serv_args', Store(), lineno=407, col_offset=8)], Tuple([Attribute(Name('self', Load(), lineno=407, col_offset=21), 'serv', Load(), lineno=407, col_offset=21), Attribute(Name('self', Load(), lineno=407, col_offset=32), 'serv_evt', Load(), lineno=407, col_offset=32), Attribute(Name('self', Load(), lineno=407, col_offset=47), 'client_evt', Load(), lineno=407, col_offset=47)], Load(), lineno=407, col_offset=21), lineno=407, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=408, col_offset=8), 'thread', Store(), lineno=408, col_offset=8)], Call(Attribute(Name('threading', Load(), lineno=408, col_offset=22), 'Thread', Load(), lineno=408, col_offset=22), [], [keyword('target', Name('debugging_server', Load(), lineno=408, col_offset=46)), keyword('args', Name('serv_args', Load(), lineno=408, col_offset=69))], None, None, lineno=408, col_offset=22), lineno=408, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=409, col_offset=8), 'thread', Load(), lineno=409, col_offset=8), 'start', Load(), lineno=409, col_offset=8), [], [], None, None, lineno=409, col_offset=8), lineno=409, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=412, col_offset=8), 'serv_evt', Load(), lineno=412, col_offset=8), 'wait', Load(), lineno=412, col_offset=8), [], [], None, None, lineno=412, col_offset=8), lineno=412, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=413, col_offset=8), 'serv_evt', Load(), lineno=413, col_offset=8), 'clear', Load(), lineno=413, col_offset=8), [], [], None, None, lineno=413, col_offset=8), lineno=413, col_offset=8)], [], lineno=399, col_offset=4), FunctionDef('tearDown', arguments([Name('self', Param(), lineno=415, col_offset=17)], None, None, []), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=417, col_offset=8), 'client_evt', Load(), lineno=417, col_offset=8), 'set', Load(), lineno=417, col_offset=8), [], [], None, None, lineno=417, col_offset=8), lineno=417, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=419, col_offset=8), 'serv_evt', Load(), lineno=419, col_offset=8), 'wait', Load(), lineno=419, col_offset=8), [], [], None, None, lineno=419, col_offset=8), lineno=419, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=420, col_offset=8), 'thread', Load(), lineno=420, col_offset=8), 'join', Load(), lineno=420, col_offset=8), [], [], None, None, lineno=420, col_offset=8), lineno=420, col_offset=8), Expr(Call(Attribute(Name('test_support', Load(), lineno=421, col_offset=8), 'threading_cleanup', Load(), lineno=421, col_offset=8), [], [], Attribute(Name('self', Load(), lineno=421, col_offset=40), '_threads', Load(), lineno=421, col_offset=40), None, lineno=421, col_offset=8), lineno=421, col_offset=8)], [], lineno=415, col_offset=4), FunctionDef('testBasic', arguments([Name('self', Param(), lineno=423, col_offset=18)], None, None, []), [Assign([Name('smtp', Store(), lineno=425, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=425, col_offset=15), 'SMTP', Load(), lineno=425, col_offset=15), [Name('HOST', Load(), lineno=425, col_offset=28), Attribute(Name('self', Load(), lineno=425, col_offset=34), 'port', Load(), lineno=425, col_offset=34)], [keyword('local_hostname', Str('localhost', lineno=425, col_offset=60)), keyword('timeout', Num(15, lineno=425, col_offset=81))], None, None, lineno=425, col_offset=15), lineno=425, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=426, col_offset=8), 'quit', Load(), lineno=426, col_offset=8), [], [], None, None, lineno=426, col_offset=8), lineno=426, col_offset=8)], [], lineno=423, col_offset=4), FunctionDef('testEHLO', arguments([Name('self', Param(), lineno=428, col_offset=17)], None, None, []), [Assign([Name('smtp', Store(), lineno=429, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=429, col_offset=15), 'SMTP', Load(), lineno=429, col_offset=15), [Name('HOST', Load(), lineno=429, col_offset=28), Attribute(Name('self', Load(), lineno=429, col_offset=34), 'port', Load(), lineno=429, col_offset=34)], [keyword('local_hostname', Str('localhost', lineno=429, col_offset=60)), keyword('timeout', Num(15, lineno=429, col_offset=81))], None, None, lineno=429, col_offset=15), lineno=429, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=432, col_offset=8), 'assertEqual', Load(), lineno=432, col_offset=8), [Attribute(Name('smtp', Load(), lineno=432, col_offset=25), 'esmtp_features', Load(), lineno=432, col_offset=25), Dict([], [], lineno=432, col_offset=46)], [], None, None, lineno=432, col_offset=8), lineno=432, col_offset=8), Assign([Name('expected_features', Store(), lineno=435, col_offset=8)], Dict([Str('expn', lineno=435, col_offset=29), Str('size', lineno=436, col_offset=29), Str('starttls', lineno=437, col_offset=29), Str('deliverby', lineno=438, col_offset=29), Str('help', lineno=439, col_offset=29)], [Str('', lineno=435, col_offset=36), Str('20000000', lineno=436, col_offset=37), Str('', lineno=437, col_offset=41), Str('', lineno=438, col_offset=42), Str('', lineno=439, col_offset=37)], lineno=435, col_offset=28), lineno=435, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=442, col_offset=8), 'ehlo', Load(), lineno=442, col_offset=8), [], [], None, None, lineno=442, col_offset=8), lineno=442, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=443, col_offset=8), 'assertEqual', Load(), lineno=443, col_offset=8), [Attribute(Name('smtp', Load(), lineno=443, col_offset=25), 'esmtp_features', Load(), lineno=443, col_offset=25), Name('expected_features', Load(), lineno=443, col_offset=46)], [], None, None, lineno=443, col_offset=8), lineno=443, col_offset=8), For(Name('k', Store(), lineno=444, col_offset=12), Name('expected_features', Load(), lineno=444, col_offset=17), [Expr(Call(Attribute(Name('self', Load(), lineno=445, col_offset=12), 'assertTrue', Load(), lineno=445, col_offset=12), [Call(Attribute(Name('smtp', Load(), lineno=445, col_offset=28), 'has_extn', Load(), lineno=445, col_offset=28), [Name('k', Load(), lineno=445, col_offset=42)], [], None, None, lineno=445, col_offset=28)], [], None, None, lineno=445, col_offset=12), lineno=445, col_offset=12)], [], lineno=444, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=446, col_offset=8), 'assertFalse', Load(), lineno=446, col_offset=8), [Call(Attribute(Name('smtp', Load(), lineno=446, col_offset=25), 'has_extn', Load(), lineno=446, col_offset=25), [Str('unsupported-feature', lineno=446, col_offset=39)], [], None, None, lineno=446, col_offset=25)], [], None, None, lineno=446, col_offset=8), lineno=446, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=447, col_offset=8), 'quit', Load(), lineno=447, col_offset=8), [], [], None, None, lineno=447, col_offset=8), lineno=447, col_offset=8)], [], lineno=428, col_offset=4), FunctionDef('testVRFY', arguments([Name('self', Param(), lineno=449, col_offset=17)], None, None, []), [Assign([Name('smtp', Store(), lineno=450, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=450, col_offset=15), 'SMTP', Load(), lineno=450, col_offset=15), [Name('HOST', Load(), lineno=450, col_offset=28), Attribute(Name('self', Load(), lineno=450, col_offset=34), 'port', Load(), lineno=450, col_offset=34)], [keyword('local_hostname', Str('localhost', lineno=450, col_offset=60)), keyword('timeout', Num(15, lineno=450, col_offset=81))], None, None, lineno=450, col_offset=15), lineno=450, col_offset=8), For(Tuple([Name('email', Store(), lineno=452, col_offset=12), Name('name', Store(), lineno=452, col_offset=19)], Store(), lineno=452, col_offset=12), Call(Attribute(Name('sim_users', Load(), lineno=452, col_offset=27), 'items', Load(), lineno=452, col_offset=27), [], [], None, None, lineno=452, col_offset=27), [Assign([Name('expected_known', Store(), lineno=453, col_offset=12)], Tuple([Num(250, lineno=453, col_offset=30), BinOp(Str('%s %s', lineno=453, col_offset=35), Mod(), Tuple([Name('name', Load(), lineno=453, col_offset=46), Call(Attribute(Name('smtplib', Load(), lineno=453, col_offset=52), 'quoteaddr', Load(), lineno=453, col_offset=52), [Name('email', Load(), lineno=453, col_offset=70)], [], None, None, lineno=453, col_offset=52)], Load(), lineno=453, col_offset=46), lineno=453, col_offset=35)], Load(), lineno=453, col_offset=30), lineno=453, col_offset=12), Expr(Call(Attribute(Name('self', Load(), lineno=454, col_offset=12), 'assertEqual', Load(), lineno=454, col_offset=12), [Call(Attribute(Name('smtp', Load(), lineno=454, col_offset=29), 'vrfy', Load(), lineno=454, col_offset=29), [Name('email', Load(), lineno=454, col_offset=39)], [], None, None, lineno=454, col_offset=29), Name('expected_known', Load(), lineno=454, col_offset=47)], [], None, None, lineno=454, col_offset=12), lineno=454, col_offset=12)], [], lineno=452, col_offset=8), Assign([Name('u', Store(), lineno=456, col_offset=8)], Str('nobody@nowhere.com', lineno=456, col_offset=12), lineno=456, col_offset=8), Assign([Name('expected_unknown', Store(), lineno=457, col_offset=8)], Tuple([Num(550, lineno=457, col_offset=28), BinOp(Str('No such user: %s', lineno=457, col_offset=33), Mod(), Call(Attribute(Name('smtplib', Load(), lineno=457, col_offset=54), 'quoteaddr', Load(), lineno=457, col_offset=54), [Name('u', Load(), lineno=457, col_offset=72)], [], None, None, lineno=457, col_offset=54), lineno=457, col_offset=33)], Load(), lineno=457, col_offset=28), lineno=457, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=458, col_offset=8), 'assertEqual', Load(), lineno=458, col_offset=8), [Call(Attribute(Name('smtp', Load(), lineno=458, col_offset=25), 'vrfy', Load(), lineno=458, col_offset=25), [Name('u', Load(), lineno=458, col_offset=35)], [], None, None, lineno=458, col_offset=25), Name('expected_unknown', Load(), lineno=458, col_offset=39)], [], None, None, lineno=458, col_offset=8), lineno=458, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=459, col_offset=8), 'quit', Load(), lineno=459, col_offset=8), [], [], None, None, lineno=459, col_offset=8), lineno=459, col_offset=8)], [], lineno=449, col_offset=4), FunctionDef('testEXPN', arguments([Name('self', Param(), lineno=461, col_offset=17)], None, None, []), [Assign([Name('smtp', Store(), lineno=462, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=462, col_offset=15), 'SMTP', Load(), lineno=462, col_offset=15), [Name('HOST', Load(), lineno=462, col_offset=28), Attribute(Name('self', Load(), lineno=462, col_offset=34), 'port', Load(), lineno=462, col_offset=34)], [keyword('local_hostname', Str('localhost', lineno=462, col_offset=60)), keyword('timeout', Num(15, lineno=462, col_offset=81))], None, None, lineno=462, col_offset=15), lineno=462, col_offset=8), For(Tuple([Name('listname', Store(), lineno=464, col_offset=12), Name('members', Store(), lineno=464, col_offset=22)], Store(), lineno=464, col_offset=12), Call(Attribute(Name('sim_lists', Load(), lineno=464, col_offset=33), 'items', Load(), lineno=464, col_offset=33), [], [], None, None, lineno=464, col_offset=33), [Assign([Name('users', Store(), lineno=465, col_offset=12)], List([], Load(), lineno=465, col_offset=20), lineno=465, col_offset=12), For(Name('m', Store(), lineno=466, col_offset=16), Name('members', Load(), lineno=466, col_offset=21), [Expr(Call(Attribute(Name('users', Load(), lineno=467, col_offset=16), 'append', Load(), lineno=467, col_offset=16), [BinOp(Str('%s %s', lineno=467, col_offset=29), Mod(), Tuple([Subscript(Name('sim_users', Load(), lineno=467, col_offset=40), Index(Name('m', Load(), lineno=467, col_offset=50)), Load(), lineno=467, col_offset=40), Call(Attribute(Name('smtplib', Load(), lineno=467, col_offset=54), 'quoteaddr', Load(), lineno=467, col_offset=54), [Name('m', Load(), lineno=467, col_offset=72)], [], None, None, lineno=467, col_offset=54)], Load(), lineno=467, col_offset=40), lineno=467, col_offset=29)], [], None, None, lineno=467, col_offset=16), lineno=467, col_offset=16)], [], lineno=466, col_offset=12), Assign([Name('expected_known', Store(), lineno=468, col_offset=12)], Tuple([Num(250, lineno=468, col_offset=30), Call(Attribute(Str('\n', lineno=468, col_offset=35), 'join', Load(), lineno=468, col_offset=35), [Name('users', Load(), lineno=468, col_offset=45)], [], None, None, lineno=468, col_offset=35)], Load(), lineno=468, col_offset=30), lineno=468, col_offset=12), Expr(Call(Attribute(Name('self', Load(), lineno=469, col_offset=12), 'assertEqual', Load(), lineno=469, col_offset=12), [Call(Attribute(Name('smtp', Load(), lineno=469, col_offset=29), 'expn', Load(), lineno=469, col_offset=29), [Name('listname', Load(), lineno=469, col_offset=39)], [], None, None, lineno=469, col_offset=29), Name('expected_known', Load(), lineno=469, col_offset=50)], [], None, None, lineno=469, col_offset=12), lineno=469, col_offset=12)], [], lineno=464, col_offset=8), Assign([Name('u', Store(), lineno=471, col_offset=8)], Str('PSU-Members-List', lineno=471, col_offset=12), lineno=471, col_offset=8), Assign([Name('expected_unknown', Store(), lineno=472, col_offset=8)], Tuple([Num(550, lineno=472, col_offset=28), Str('No access for you!', lineno=472, col_offset=33)], Load(), lineno=472, col_offset=28), lineno=472, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=473, col_offset=8), 'assertEqual', Load(), lineno=473, col_offset=8), [Call(Attribute(Name('smtp', Load(), lineno=473, col_offset=25), 'expn', Load(), lineno=473, col_offset=25), [Name('u', Load(), lineno=473, col_offset=35)], [], None, None, lineno=473, col_offset=25), Name('expected_unknown', Load(), lineno=473, col_offset=39)], [], None, None, lineno=473, col_offset=8), lineno=473, col_offset=8), Expr(Call(Attribute(Name('smtp', Load(), lineno=474, col_offset=8), 'quit', Load(), lineno=474, col_offset=8), [], [], None, None, lineno=474, col_offset=8), lineno=474, col_offset=8)], [], lineno=461, col_offset=4), FunctionDef('testAUTH_PLAIN', arguments([Name('self', Param(), lineno=476, col_offset=23)], None, None, []), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=477, col_offset=8), 'serv', Load(), lineno=477, col_offset=8), 'add_feature', Load(), lineno=477, col_offset=8), [Str('AUTH PLAIN', lineno=477, col_offset=30)], [], None, None, lineno=477, col_offset=8), lineno=477, col_offset=8), Assign([Name('smtp', Store(), lineno=478, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=478, col_offset=15), 'SMTP', Load(), lineno=478, col_offset=15), [Name('HOST', Load(), lineno=478, col_offset=28), Attribute(Name('self', Load(), lineno=478, col_offset=34), 'port', Load(), lineno=478, col_offset=34)], [keyword('local_hostname', Str('localhost', lineno=478, col_offset=60)), keyword('timeout', Num(15, lineno=478, col_offset=81))], None, None, lineno=478, col_offset=15), lineno=478, col_offset=8), Assign([Name('expected_auth_ok', Store(), lineno=480, col_offset=8)], Tuple([Num(235, lineno=480, col_offset=28), Str('plain auth ok', lineno=480, col_offset=33)], Load(), lineno=480, col_offset=28), lineno=480, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=481, col_offset=8), 'assertEqual', Load(), lineno=481, col_offset=8), [Call(Attribute(Name('smtp', Load(), lineno=481, col_offset=25), 'login', Load(), lineno=481, col_offset=25), [Subscript(Name('sim_auth', Load(), lineno=481, col_offset=36), Index(Num(0, lineno=481, col_offset=45)), Load(), lineno=481, col_offset=36), Subscript(Name('sim_auth', Load(), lineno=481, col_offset=49), Index(Num(1, lineno=481, col_offset=58)), Load(), lineno=481, col_offset=49)], [], None, None, lineno=481, col_offset=25), Name('expected_auth_ok', Load(), lineno=481, col_offset=63)], [], None, None, lineno=481, col_offset=8), lineno=481, col_offset=8)], [], lineno=476, col_offset=4), FunctionDef('testAUTH_LOGIN', arguments([Name('self', Param(), lineno=491, col_offset=23)], None, None, []), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=492, col_offset=8), 'serv', Load(), lineno=492, col_offset=8), 'add_feature', Load(), lineno=492, col_offset=8), [Str('AUTH LOGIN', lineno=492, col_offset=30)], [], None, None, lineno=492, col_offset=8), lineno=492, col_offset=8), Assign([Name('smtp', Store(), lineno=493, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=493, col_offset=15), 'SMTP', Load(), lineno=493, col_offset=15), [Name('HOST', Load(), lineno=493, col_offset=28), Attribute(Name('self', Load(), lineno=493, col_offset=34), 'port', Load(), lineno=493, col_offset=34)], [keyword('local_hostname', Str('localhost', lineno=493, col_offset=60)), keyword('timeout', Num(15, lineno=493, col_offset=81))], None, None, lineno=493, col_offset=15), lineno=493, col_offset=8), TryExcept([Expr(Call(Attribute(Name('smtp', Load(), lineno=494, col_offset=13), 'login', Load(), lineno=494, col_offset=13), [Subscript(Name('sim_auth', Load(), lineno=494, col_offset=24), Index(Num(0, lineno=494, col_offset=33)), Load(), lineno=494, col_offset=24), Subscript(Name('sim_auth', Load(), lineno=494, col_offset=37), Index(Num(1, lineno=494, col_offset=46)), Load(), lineno=494, col_offset=37)], [], None, None, lineno=494, col_offset=13), lineno=494, col_offset=13)], [ExceptHandler(Attribute(Name('smtplib', Load(), lineno=495, col_offset=15), 'SMTPAuthenticationError', Load(), lineno=495, col_offset=15), Name('err', Store(), lineno=495, col_offset=50), [If(Compare(Name('sim_auth_login_password', Load(), lineno=496, col_offset=15), [NotIn()], [Call(Name('str', Load(), lineno=496, col_offset=46), [Name('err', Load(), lineno=496, col_offset=50)], [], None, None, lineno=496, col_offset=46)], lineno=496, col_offset=15), [Raise(Str('expected encoded password not found in error message', lineno=497, col_offset=22), None, None, lineno=497, col_offset=16)], [], lineno=496, col_offset=12)], lineno=495, col_offset=8)], [], lineno=494, col_offset=8)], [], lineno=491, col_offset=4), FunctionDef('testAUTH_CRAM_MD5', arguments([Name('self', Param(), lineno=499, col_offset=26)], None, None, []), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=500, col_offset=8), 'serv', Load(), lineno=500, col_offset=8), 'add_feature', Load(), lineno=500, col_offset=8), [Str('AUTH CRAM-MD5', lineno=500, col_offset=30)], [], None, None, lineno=500, col_offset=8), lineno=500, col_offset=8), Assign([Name('smtp', Store(), lineno=501, col_offset=8)], Call(Attribute(Name('smtplib', Load(), lineno=501, col_offset=15), 'SMTP', Load(), lineno=501, col_offset=15), [Name('HOST', Load(), lineno=501, col_offset=28), Attribute(Name('self', Load(), lineno=501, col_offset=34), 'port', Load(), lineno=501, col_offset=34)], [keyword('local_hostname', Str('localhost', lineno=501, col_offset=60)), keyword('timeout', Num(15, lineno=501, col_offset=81))], None, None, lineno=501, col_offset=15), lineno=501, col_offset=8), TryExcept([Expr(Call(Attribute(Name('smtp', Load(), lineno=503, col_offset=13), 'login', Load(), lineno=503, col_offset=13), [Subscript(Name('sim_auth', Load(), lineno=503, col_offset=24), Index(Num(0, lineno=503, col_offset=33)), Load(), lineno=503, col_offset=24), Subscript(Name('sim_auth', Load(), lineno=503, col_offset=37), Index(Num(1, lineno=503, col_offset=46)), Load(), lineno=503, col_offset=37)], [], None, None, lineno=503, col_offset=13), lineno=503, col_offset=13)], [ExceptHandler(Attribute(Name('smtplib', Load(), lineno=504, col_offset=15), 'SMTPAuthenticationError', Load(), lineno=504, col_offset=15), Name('err', Store(), lineno=504, col_offset=50), [If(Compare(Subscript(Name('sim_auth_credentials', Load(), lineno=505, col_offset=15), Index(Str('cram-md5', lineno=505, col_offset=36)), Load(), lineno=505, col_offset=15), [NotIn()], [Call(Name('str', Load(), lineno=505, col_offset=55), [Name('err', Load(), lineno=505, col_offset=59)], [], None, None, lineno=505, col_offset=55)], lineno=505, col_offset=15), [Raise(Str('expected encoded credentials not found in error message', lineno=506, col_offset=22), None, None, lineno=506, col_offset=16)], [], lineno=505, col_offset=12)], lineno=504, col_offset=8)], [], lineno=503, col_offset=8)], [], lineno=499, col_offset=4)], [Call(Attribute(Name('unittest', Load(), lineno=396, col_offset=1), 'skipUnless', Load(), lineno=396, col_offset=1), [Name('threading', Load(), lineno=396, col_offset=21), Str('Threading required for this test.', lineno=396, col_offset=32)], [], None, None, lineno=396, col_offset=1)], lineno=396, col_offset=0), FunctionDef('test_main', arguments([Name('verbose', Param(), lineno=512, col_offset=14)], None, None, [Name('None', Load(), lineno=512, col_offset=22)]), [Expr(Call(Attribute(Name('test_support', Load(), lineno=513, col_offset=4), 'run_unittest', Load(), lineno=513, col_offset=4), [Name('GeneralTests', Load(), lineno=513, col_offset=30), Name('DebuggingServerTests', Load(), lineno=513, col_offset=44), Name('NonConnectingTests', Load(), lineno=514, col_offset=30), Name('BadHELOServerTests', Load(), lineno=515, col_offset=30), Name('SMTPSimTests', Load(), lineno=515, col_offset=50)], [], None, None, lineno=513, col_offset=4), lineno=513, col_offset=4)], [], lineno=512, col_offset=0), If(Compare(Name('__name__', Load(), lineno=517, col_offset=3), [Eq()], [Str('__main__', lineno=517, col_offset=15)], lineno=517, col_offset=3), [Expr(Call(Name('test_main', Load(), lineno=518, col_offset=4), [], [], None, None, lineno=518, col_offset=4), lineno=518, col_offset=4)], [], lineno=517, col_offset=0)])
