Module([Expr(Str('Unpack a MIME message into a directory of files.', lineno=3, col_offset=0), lineno=3, col_offset=0), Import([alias('os', None)], lineno=5, col_offset=0), Import([alias('sys', None)], lineno=6, col_offset=0), Import([alias('email', None)], lineno=7, col_offset=0), Import([alias('errno', None)], lineno=8, col_offset=0), Import([alias('mimetypes', None)], lineno=9, col_offset=0), ImportFrom('optparse', [alias('OptionParser', None)], 0, lineno=11, col_offset=0), FunctionDef('main', arguments([], None, None, []), [Assign([Name('parser', Store(), lineno=15, col_offset=4)], Call(Name('OptionParser', Load(), lineno=15, col_offset=13), [], [keyword('usage', Str('Unpack a MIME message into a directory of files.\n\nUsage: %prog [options] msgfile\n', lineno=19, col_offset=-1))], None, None, lineno=15, col_offset=13), lineno=15, col_offset=4), Expr(Call(Attribute(Name('parser', Load(), lineno=20, col_offset=4), 'add_option', Load(), lineno=20, col_offset=4), [Str('-d', lineno=20, col_offset=22), Str('--directory', lineno=20, col_offset=28)], [keyword('type', Str('string', lineno=21, col_offset=27)), keyword('action', Str('store', lineno=21, col_offset=44)), keyword('help', Str("Unpack the MIME message into the named\n                      directory, which will be created if it doesn't already\n                      exist.", lineno=24, col_offset=-1))], None, None, lineno=20, col_offset=4), lineno=20, col_offset=4), Assign([Tuple([Name('opts', Store(), lineno=25, col_offset=4), Name('args', Store(), lineno=25, col_offset=10)], Store(), lineno=25, col_offset=4)], Call(Attribute(Name('parser', Load(), lineno=25, col_offset=17), 'parse_args', Load(), lineno=25, col_offset=17), [], [], None, None, lineno=25, col_offset=17), lineno=25, col_offset=4), If(UnaryOp(Not(), Attribute(Name('opts', Load(), lineno=26, col_offset=11), 'directory', Load(), lineno=26, col_offset=11), lineno=26, col_offset=7), [Expr(Call(Attribute(Name('parser', Load(), lineno=27, col_offset=8), 'print_help', Load(), lineno=27, col_offset=8), [], [], None, None, lineno=27, col_offset=8), lineno=27, col_offset=8), Expr(Call(Attribute(Name('sys', Load(), lineno=28, col_offset=8), 'exit', Load(), lineno=28, col_offset=8), [Num(1, lineno=28, col_offset=17)], [], None, None, lineno=28, col_offset=8), lineno=28, col_offset=8)], [], lineno=26, col_offset=4), TryExcept([Assign([Name('msgfile', Store(), lineno=31, col_offset=8)], Subscript(Name('args', Load(), lineno=31, col_offset=18), Index(Num(0, lineno=31, col_offset=23)), Load(), lineno=31, col_offset=18), lineno=31, col_offset=8)], [ExceptHandler(Name('IndexError', Load(), lineno=32, col_offset=11), None, [Expr(Call(Attribute(Name('parser', Load(), lineno=33, col_offset=8), 'print_help', Load(), lineno=33, col_offset=8), [], [], None, None, lineno=33, col_offset=8), lineno=33, col_offset=8), Expr(Call(Attribute(Name('sys', Load(), lineno=34, col_offset=8), 'exit', Load(), lineno=34, col_offset=8), [Num(1, lineno=34, col_offset=17)], [], None, None, lineno=34, col_offset=8), lineno=34, col_offset=8)], lineno=32, col_offset=4)], [], lineno=30, col_offset=4), TryExcept([Expr(Call(Attribute(Name('os', Load(), lineno=37, col_offset=8), 'mkdir', Load(), lineno=37, col_offset=8), [Attribute(Name('opts', Load(), lineno=37, col_offset=17), 'directory', Load(), lineno=37, col_offset=17)], [], None, None, lineno=37, col_offset=8), lineno=37, col_offset=8)], [ExceptHandler(Name('OSError', Load(), lineno=38, col_offset=11), Name('e', Store(), lineno=38, col_offset=20), [If(Compare(Attribute(Name('e', Load(), lineno=40, col_offset=11), 'errno', Load(), lineno=40, col_offset=11), [NotEq()], [Attribute(Name('errno', Load(), lineno=40, col_offset=22), 'EEXIST', Load(), lineno=40, col_offset=22)], lineno=40, col_offset=11), [Raise(None, None, None, lineno=41, col_offset=12)], [], lineno=40, col_offset=8)], lineno=38, col_offset=4)], [], lineno=36, col_offset=4), Assign([Name('fp', Store(), lineno=43, col_offset=4)], Call(Name('open', Load(), lineno=43, col_offset=9), [Name('msgfile', Load(), lineno=43, col_offset=14)], [], None, None, lineno=43, col_offset=9), lineno=43, col_offset=4), Assign([Name('msg', Store(), lineno=44, col_offset=4)], Call(Attribute(Name('email', Load(), lineno=44, col_offset=10), 'message_from_file', Load(), lineno=44, col_offset=10), [Name('fp', Load(), lineno=44, col_offset=34)], [], None, None, lineno=44, col_offset=10), lineno=44, col_offset=4), Expr(Call(Attribute(Name('fp', Load(), lineno=45, col_offset=4), 'close', Load(), lineno=45, col_offset=4), [], [], None, None, lineno=45, col_offset=4), lineno=45, col_offset=4), Assign([Name('counter', Store(), lineno=47, col_offset=4)], Num(1, lineno=47, col_offset=14), lineno=47, col_offset=4), For(Name('part', Store(), lineno=48, col_offset=8), Call(Attribute(Name('msg', Load(), lineno=48, col_offset=16), 'walk', Load(), lineno=48, col_offset=16), [], [], None, None, lineno=48, col_offset=16), [If(Compare(Call(Attribute(Name('part', Load(), lineno=50, col_offset=11), 'get_content_maintype', Load(), lineno=50, col_offset=11), [], [], None, None, lineno=50, col_offset=11), [Eq()], [Str('multipart', lineno=50, col_offset=42)], lineno=50, col_offset=11), [Continue( lineno=51, col_offset=12)], [], lineno=50, col_offset=8), Assign([Name('filename', Store(), lineno=54, col_offset=8)], Call(Attribute(Name('part', Load(), lineno=54, col_offset=19), 'get_filename', Load(), lineno=54, col_offset=19), [], [], None, None, lineno=54, col_offset=19), lineno=54, col_offset=8), If(UnaryOp(Not(), Name('filename', Load(), lineno=55, col_offset=15), lineno=55, col_offset=11), [Assign([Name('ext', Store(), lineno=56, col_offset=12)], Call(Attribute(Name('mimetypes', Load(), lineno=56, col_offset=18), 'guess_extension', Load(), lineno=56, col_offset=18), [Call(Attribute(Name('part', Load(), lineno=56, col_offset=44), 'get_content_type', Load(), lineno=56, col_offset=44), [], [], None, None, lineno=56, col_offset=44)], [], None, None, lineno=56, col_offset=18), lineno=56, col_offset=12), If(UnaryOp(Not(), Name('ext', Load(), lineno=57, col_offset=19), lineno=57, col_offset=15), [Assign([Name('ext', Store(), lineno=59, col_offset=16)], Str('.bin', lineno=59, col_offset=22), lineno=59, col_offset=16)], [], lineno=57, col_offset=12), Assign([Name('filename', Store(), lineno=60, col_offset=12)], BinOp(Str('part-%03d%s', lineno=60, col_offset=23), Mod(), Tuple([Name('counter', Load(), lineno=60, col_offset=40), Name('ext', Load(), lineno=60, col_offset=49)], Load(), lineno=60, col_offset=40), lineno=60, col_offset=23), lineno=60, col_offset=12)], [], lineno=55, col_offset=8), AugAssign(Name('counter', Store(), lineno=61, col_offset=8), Add(), Num(1, lineno=61, col_offset=19), lineno=61, col_offset=8), Assign([Name('fp', Store(), lineno=62, col_offset=8)], Call(Name('open', Load(), lineno=62, col_offset=13), [Call(Attribute(Attribute(Name('os', Load(), lineno=62, col_offset=18), 'path', Load(), lineno=62, col_offset=18), 'join', Load(), lineno=62, col_offset=18), [Attribute(Name('opts', Load(), lineno=62, col_offset=31), 'directory', Load(), lineno=62, col_offset=31), Name('filename', Load(), lineno=62, col_offset=47)], [], None, None, lineno=62, col_offset=18), Str('wb', lineno=62, col_offset=58)], [], None, None, lineno=62, col_offset=13), lineno=62, col_offset=8), Expr(Call(Attribute(Name('fp', Load(), lineno=63, col_offset=8), 'write', Load(), lineno=63, col_offset=8), [Call(Attribute(Name('part', Load(), lineno=63, col_offset=17), 'get_payload', Load(), lineno=63, col_offset=17), [], [keyword('decode', Name('True', Load(), lineno=63, col_offset=41))], None, None, lineno=63, col_offset=17)], [], None, None, lineno=63, col_offset=8), lineno=63, col_offset=8), Expr(Call(Attribute(Name('fp', Load(), lineno=64, col_offset=8), 'close', Load(), lineno=64, col_offset=8), [], [], None, None, lineno=64, col_offset=8), lineno=64, col_offset=8)], [], lineno=48, col_offset=4)], [], lineno=14, col_offset=0), If(Compare(Name('__name__', Load(), lineno=67, col_offset=3), [Eq()], [Str('__main__', lineno=67, col_offset=15)], lineno=67, col_offset=3), [Expr(Call(Name('main', Load(), lineno=68, col_offset=4), [], [], None, None, lineno=68, col_offset=4), lineno=68, col_offset=4)], [], lineno=67, col_offset=0)])
