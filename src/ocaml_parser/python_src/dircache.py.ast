Module([Expr(Str('Read and cache directory listings.\n\nThe listdir() routine returns a sorted list of the files in a directory,\nusing a cache to avoid reading the directory more often than necessary.\nThe annotate() routine appends slashes to directories.', lineno=5, col_offset=-1), lineno=5, col_offset=-1), ImportFrom('warnings', [alias('warnpy3k', None)], 0, lineno=6, col_offset=0), Expr(Call(Name('warnpy3k', Load(), lineno=7, col_offset=0), [Str('the dircache module has been removed in Python 3.0', lineno=7, col_offset=9)], [keyword('stacklevel', Num(2, lineno=7, col_offset=74))], None, None, lineno=7, col_offset=0), lineno=7, col_offset=0), Delete([Name('warnpy3k', Del(), lineno=8, col_offset=4)], lineno=8, col_offset=0), Import([alias('os', None)], lineno=10, col_offset=0), Assign([Name('__all__', Store(), lineno=12, col_offset=0)], List([Str('listdir', lineno=12, col_offset=11), Str('opendir', lineno=12, col_offset=22), Str('annotate', lineno=12, col_offset=33), Str('reset', lineno=12, col_offset=45)], Load(), lineno=12, col_offset=10), lineno=12, col_offset=0), Assign([Name('cache', Store(), lineno=14, col_offset=0)], Dict([], [], lineno=14, col_offset=8), lineno=14, col_offset=0), FunctionDef('reset', arguments([], None, None, []), [Expr(Str('Reset the cache completely.', lineno=17, col_offset=4), lineno=17, col_offset=4), Global(['cache'], lineno=18, col_offset=4), Assign([Name('cache', Store(), lineno=19, col_offset=4)], Dict([], [], lineno=19, col_offset=12), lineno=19, col_offset=4)], [], lineno=16, col_offset=0), FunctionDef('listdir', arguments([Name('path', Param(), lineno=21, col_offset=12)], None, None, []), [Expr(Str('List directory contents, using cache.', lineno=22, col_offset=4), lineno=22, col_offset=4), TryExcept([Assign([Tuple([Name('cached_mtime', Store(), lineno=24, col_offset=8), Name('list', Store(), lineno=24, col_offset=22)], Store(), lineno=24, col_offset=8)], Subscript(Name('cache', Load(), lineno=24, col_offset=29), Index(Name('path', Load(), lineno=24, col_offset=35)), Load(), lineno=24, col_offset=29), lineno=24, col_offset=8), Delete([Subscript(Name('cache', Load(), lineno=25, col_offset=12), Index(Name('path', Load(), lineno=25, col_offset=18)), Del(), lineno=25, col_offset=12)], lineno=25, col_offset=8)], [ExceptHandler(Name('KeyError', Load(), lineno=26, col_offset=11), None, [Assign([Tuple([Name('cached_mtime', Store(), lineno=27, col_offset=8), Name('list', Store(), lineno=27, col_offset=22)], Store(), lineno=27, col_offset=8)], Tuple([Num(-1, lineno=27, col_offset=30), List([], Load(), lineno=27, col_offset=33)], Load(), lineno=27, col_offset=29), lineno=27, col_offset=8)], lineno=26, col_offset=4)], [], lineno=23, col_offset=4), Assign([Name('mtime', Store(), lineno=28, col_offset=4)], Attribute(Call(Attribute(Name('os', Load(), lineno=28, col_offset=12), 'stat', Load(), lineno=28, col_offset=12), [Name('path', Load(), lineno=28, col_offset=20)], [], None, None, lineno=28, col_offset=12), 'st_mtime', Load(), lineno=28, col_offset=12), lineno=28, col_offset=4), If(Compare(Name('mtime', Load(), lineno=29, col_offset=7), [NotEq()], [Name('cached_mtime', Load(), lineno=29, col_offset=16)], lineno=29, col_offset=7), [Assign([Name('list', Store(), lineno=30, col_offset=8)], Call(Attribute(Name('os', Load(), lineno=30, col_offset=15), 'listdir', Load(), lineno=30, col_offset=15), [Name('path', Load(), lineno=30, col_offset=26)], [], None, None, lineno=30, col_offset=15), lineno=30, col_offset=8), Expr(Call(Attribute(Name('list', Load(), lineno=31, col_offset=8), 'sort', Load(), lineno=31, col_offset=8), [], [], None, None, lineno=31, col_offset=8), lineno=31, col_offset=8)], [], lineno=29, col_offset=4), Assign([Subscript(Name('cache', Load(), lineno=32, col_offset=4), Index(Name('path', Load(), lineno=32, col_offset=10)), Store(), lineno=32, col_offset=4)], Tuple([Name('mtime', Load(), lineno=32, col_offset=18), Name('list', Load(), lineno=32, col_offset=25)], Load(), lineno=32, col_offset=18), lineno=32, col_offset=4), Return(Name('list', Load(), lineno=33, col_offset=11), lineno=33, col_offset=4)], [], lineno=21, col_offset=0), Assign([Name('opendir', Store(), lineno=35, col_offset=0)], Name('listdir', Load(), lineno=35, col_offset=10), lineno=35, col_offset=0), FunctionDef('annotate', arguments([Name('head', Param(), lineno=37, col_offset=13), Name('list', Param(), lineno=37, col_offset=19)], None, None, []), [Expr(Str("Add '/' suffixes to directories.", lineno=38, col_offset=4), lineno=38, col_offset=4), For(Name('i', Store(), lineno=39, col_offset=8), Call(Name('range', Load(), lineno=39, col_offset=13), [Call(Name('len', Load(), lineno=39, col_offset=19), [Name('list', Load(), lineno=39, col_offset=23)], [], None, None, lineno=39, col_offset=19)], [], None, None, lineno=39, col_offset=13), [If(Call(Attribute(Attribute(Name('os', Load(), lineno=40, col_offset=11), 'path', Load(), lineno=40, col_offset=11), 'isdir', Load(), lineno=40, col_offset=11), [Call(Attribute(Attribute(Name('os', Load(), lineno=40, col_offset=25), 'path', Load(), lineno=40, col_offset=25), 'join', Load(), lineno=40, col_offset=25), [Name('head', Load(), lineno=40, col_offset=38), Subscript(Name('list', Load(), lineno=40, col_offset=44), Index(Name('i', Load(), lineno=40, col_offset=49)), Load(), lineno=40, col_offset=44)], [], None, None, lineno=40, col_offset=25)], [], None, None, lineno=40, col_offset=11), [Assign([Subscript(Name('list', Load(), lineno=41, col_offset=12), Index(Name('i', Load(), lineno=41, col_offset=17)), Store(), lineno=41, col_offset=12)], BinOp(Subscript(Name('list', Load(), lineno=41, col_offset=22), Index(Name('i', Load(), lineno=41, col_offset=27)), Load(), lineno=41, col_offset=22), Add(), Str('/', lineno=41, col_offset=32), lineno=41, col_offset=22), lineno=41, col_offset=12)], [], lineno=40, col_offset=8)], [], lineno=39, col_offset=4)], [], lineno=37, col_offset=0)])
