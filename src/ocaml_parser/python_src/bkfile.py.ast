Module([Assign([Name('_orig_open', Store(), lineno=1, col_offset=0)], Name('open', Load(), lineno=1, col_offset=13), lineno=1, col_offset=0), ClassDef('_BkFile', [], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=4, col_offset=17), Name('file', Param(), lineno=4, col_offset=23), Name('mode', Param(), lineno=4, col_offset=29), Name('bufsize', Param(), lineno=4, col_offset=35)], None, None, []), [Import([alias('os', None)], lineno=5, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=6, col_offset=8), '__filename', Store(), lineno=6, col_offset=8)], Name('file', Load(), lineno=6, col_offset=26), lineno=6, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=7, col_offset=8), '__backup', Store(), lineno=7, col_offset=8)], BinOp(Name('file', Load(), lineno=7, col_offset=24), Add(), Str('~', lineno=7, col_offset=31), lineno=7, col_offset=24), lineno=7, col_offset=8), TryExcept([Expr(Call(Attribute(Name('os', Load(), lineno=9, col_offset=12), 'unlink', Load(), lineno=9, col_offset=12), [Attribute(Name('self', Load(), lineno=9, col_offset=22), '__backup', Load(), lineno=9, col_offset=22)], [], None, None, lineno=9, col_offset=12), lineno=9, col_offset=12)], [ExceptHandler(Attribute(Name('os', Load(), lineno=10, col_offset=15), 'error', Load(), lineno=10, col_offset=15), None, [Pass( lineno=11, col_offset=12)], lineno=10, col_offset=8)], [], lineno=8, col_offset=8), TryExcept([Expr(Call(Attribute(Name('os', Load(), lineno=13, col_offset=12), 'rename', Load(), lineno=13, col_offset=12), [Name('file', Load(), lineno=13, col_offset=22), Attribute(Name('self', Load(), lineno=13, col_offset=28), '__backup', Load(), lineno=13, col_offset=28)], [], None, None, lineno=13, col_offset=12), lineno=13, col_offset=12)], [ExceptHandler(Attribute(Name('os', Load(), lineno=14, col_offset=15), 'error', Load(), lineno=14, col_offset=15), None, [Assign([Attribute(Name('self', Load(), lineno=15, col_offset=12), '__backup', Store(), lineno=15, col_offset=12)], Name('None', Load(), lineno=15, col_offset=28), lineno=15, col_offset=12)], lineno=14, col_offset=8)], [], lineno=12, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=16, col_offset=8), '__file', Store(), lineno=16, col_offset=8)], Call(Name('_orig_open', Load(), lineno=16, col_offset=22), [Name('file', Load(), lineno=16, col_offset=33), Name('mode', Load(), lineno=16, col_offset=39), Name('bufsize', Load(), lineno=16, col_offset=45)], [], None, None, lineno=16, col_offset=22), lineno=16, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=17, col_offset=8), 'closed', Store(), lineno=17, col_offset=8)], Attribute(Attribute(Name('self', Load(), lineno=17, col_offset=22), '__file', Load(), lineno=17, col_offset=22), 'closed', Load(), lineno=17, col_offset=22), lineno=17, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=18, col_offset=8), 'fileno', Store(), lineno=18, col_offset=8)], Attribute(Attribute(Name('self', Load(), lineno=18, col_offset=22), '__file', Load(), lineno=18, col_offset=22), 'fileno', Load(), lineno=18, col_offset=22), lineno=18, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=19, col_offset=8), 'flush', Store(), lineno=19, col_offset=8)], Attribute(Attribute(Name('self', Load(), lineno=19, col_offset=21), '__file', Load(), lineno=19, col_offset=21), 'flush', Load(), lineno=19, col_offset=21), lineno=19, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=20, col_offset=8), 'isatty', Store(), lineno=20, col_offset=8)], Attribute(Attribute(Name('self', Load(), lineno=20, col_offset=22), '__file', Load(), lineno=20, col_offset=22), 'isatty', Load(), lineno=20, col_offset=22), lineno=20, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=21, col_offset=8), 'mode', Store(), lineno=21, col_offset=8)], Attribute(Attribute(Name('self', Load(), lineno=21, col_offset=20), '__file', Load(), lineno=21, col_offset=20), 'mode', Load(), lineno=21, col_offset=20), lineno=21, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=22, col_offset=8), 'name', Store(), lineno=22, col_offset=8)], Attribute(Attribute(Name('self', Load(), lineno=22, col_offset=20), '__file', Load(), lineno=22, col_offset=20), 'name', Load(), lineno=22, col_offset=20), lineno=22, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=23, col_offset=8), 'read', Store(), lineno=23, col_offset=8)], Attribute(Attribute(Name('self', Load(), lineno=23, col_offset=20), '__file', Load(), lineno=23, col_offset=20), 'read', Load(), lineno=23, col_offset=20), lineno=23, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=24, col_offset=8), 'readinto', Store(), lineno=24, col_offset=8)], Attribute(Attribute(Name('self', Load(), lineno=24, col_offset=24), '__file', Load(), lineno=24, col_offset=24), 'readinto', Load(), lineno=24, col_offset=24), lineno=24, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=25, col_offset=8), 'readline', Store(), lineno=25, col_offset=8)], Attribute(Attribute(Name('self', Load(), lineno=25, col_offset=24), '__file', Load(), lineno=25, col_offset=24), 'readline', Load(), lineno=25, col_offset=24), lineno=25, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=26, col_offset=8), 'readlines', Store(), lineno=26, col_offset=8)], Attribute(Attribute(Name('self', Load(), lineno=26, col_offset=25), '__file', Load(), lineno=26, col_offset=25), 'readlines', Load(), lineno=26, col_offset=25), lineno=26, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=27, col_offset=8), 'seek', Store(), lineno=27, col_offset=8)], Attribute(Attribute(Name('self', Load(), lineno=27, col_offset=20), '__file', Load(), lineno=27, col_offset=20), 'seek', Load(), lineno=27, col_offset=20), lineno=27, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=28, col_offset=8), 'softspace', Store(), lineno=28, col_offset=8)], Attribute(Attribute(Name('self', Load(), lineno=28, col_offset=25), '__file', Load(), lineno=28, col_offset=25), 'softspace', Load(), lineno=28, col_offset=25), lineno=28, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=29, col_offset=8), 'tell', Store(), lineno=29, col_offset=8)], Attribute(Attribute(Name('self', Load(), lineno=29, col_offset=20), '__file', Load(), lineno=29, col_offset=20), 'tell', Load(), lineno=29, col_offset=20), lineno=29, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=30, col_offset=8), 'truncate', Store(), lineno=30, col_offset=8)], Attribute(Attribute(Name('self', Load(), lineno=30, col_offset=24), '__file', Load(), lineno=30, col_offset=24), 'truncate', Load(), lineno=30, col_offset=24), lineno=30, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=31, col_offset=8), 'write', Store(), lineno=31, col_offset=8)], Attribute(Attribute(Name('self', Load(), lineno=31, col_offset=21), '__file', Load(), lineno=31, col_offset=21), 'write', Load(), lineno=31, col_offset=21), lineno=31, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=32, col_offset=8), 'writelines', Store(), lineno=32, col_offset=8)], Attribute(Attribute(Name('self', Load(), lineno=32, col_offset=26), '__file', Load(), lineno=32, col_offset=26), 'writelines', Load(), lineno=32, col_offset=26), lineno=32, col_offset=8)], [], lineno=4, col_offset=4), FunctionDef('close', arguments([Name('self', Param(), lineno=34, col_offset=14)], None, None, []), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=35, col_offset=8), '__file', Load(), lineno=35, col_offset=8), 'close', Load(), lineno=35, col_offset=8), [], [], None, None, lineno=35, col_offset=8), lineno=35, col_offset=8), If(Compare(Attribute(Name('self', Load(), lineno=36, col_offset=11), '__backup', Load(), lineno=36, col_offset=11), [Is()], [Name('None', Load(), lineno=36, col_offset=28)], lineno=36, col_offset=11), [Return(None, lineno=37, col_offset=12)], [], lineno=36, col_offset=8), Import([alias('filecmp', None)], lineno=38, col_offset=8), If(Call(Attribute(Name('filecmp', Load(), lineno=39, col_offset=11), 'cmp', Load(), lineno=39, col_offset=11), [Attribute(Name('self', Load(), lineno=39, col_offset=23), '__backup', Load(), lineno=39, col_offset=23), Attribute(Name('self', Load(), lineno=39, col_offset=38), '__filename', Load(), lineno=39, col_offset=38)], [keyword('shallow', Num(0, lineno=39, col_offset=65))], None, None, lineno=39, col_offset=11), [Import([alias('os', None)], lineno=40, col_offset=12), Expr(Call(Attribute(Name('os', Load(), lineno=41, col_offset=12), 'unlink', Load(), lineno=41, col_offset=12), [Attribute(Name('self', Load(), lineno=41, col_offset=22), '__filename', Load(), lineno=41, col_offset=22)], [], None, None, lineno=41, col_offset=12), lineno=41, col_offset=12), Expr(Call(Attribute(Name('os', Load(), lineno=42, col_offset=12), 'rename', Load(), lineno=42, col_offset=12), [Attribute(Name('self', Load(), lineno=42, col_offset=22), '__backup', Load(), lineno=42, col_offset=22), Attribute(Name('self', Load(), lineno=42, col_offset=37), '__filename', Load(), lineno=42, col_offset=37)], [], None, None, lineno=42, col_offset=12), lineno=42, col_offset=12)], [], lineno=39, col_offset=8)], [], lineno=34, col_offset=4)], [], lineno=3, col_offset=0), FunctionDef('open', arguments([Name('file', Param(), lineno=44, col_offset=9), Name('mode', Param(), lineno=44, col_offset=15), Name('bufsize', Param(), lineno=44, col_offset=27)], None, None, [Str('r', lineno=44, col_offset=22), Num(-1, lineno=44, col_offset=38)]), [If(Compare(Str('w', lineno=45, col_offset=7), [NotIn()], [Name('mode', Load(), lineno=45, col_offset=18)], lineno=45, col_offset=7), [Return(Call(Name('_orig_open', Load(), lineno=46, col_offset=15), [Name('file', Load(), lineno=46, col_offset=26), Name('mode', Load(), lineno=46, col_offset=32), Name('bufsize', Load(), lineno=46, col_offset=38)], [], None, None, lineno=46, col_offset=15), lineno=46, col_offset=8)], [], lineno=45, col_offset=4), Return(Call(Name('_BkFile', Load(), lineno=47, col_offset=11), [Name('file', Load(), lineno=47, col_offset=19), Name('mode', Load(), lineno=47, col_offset=25), Name('bufsize', Load(), lineno=47, col_offset=31)], [], None, None, lineno=47, col_offset=11), lineno=47, col_offset=4)], [], lineno=44, col_offset=0)])
