Module([Import([alias('win32com.client.gencache', None)], lineno=4, col_offset=0), Import([alias('win32com.client', None)], lineno=5, col_offset=0), Import([alias('pythoncom', None), alias('pywintypes', None)], lineno=6, col_offset=0), ImportFrom('win32com.client', [alias('constants', None)], 0, lineno=7, col_offset=0), Import([alias('re', None), alias('string', None), alias('os', None), alias('sets', None), alias('glob', None), alias('subprocess', None), alias('sys', None), alias('_winreg', None), alias('struct', None)], lineno=8, col_offset=0), TryExcept([Expr(Name('basestring', Load(), lineno=11, col_offset=4), lineno=11, col_offset=4)], [ExceptHandler(Name('NameError', Load(), lineno=12, col_offset=7), None, [Assign([Name('basestring', Store(), lineno=13, col_offset=4)], Tuple([Name('str', Load(), lineno=13, col_offset=18), Name('unicode', Load(), lineno=13, col_offset=23)], Load(), lineno=13, col_offset=18), lineno=13, col_offset=4)], lineno=12, col_offset=0)], [], lineno=10, col_offset=0), Assign([Name('datasizemask', Store(), lineno=16, col_offset=0)], Num(255, lineno=16, col_offset=19), lineno=16, col_offset=0), Assign([Name('type_valid', Store(), lineno=17, col_offset=0)], Num(256, lineno=17, col_offset=19), lineno=17, col_offset=0), Assign([Name('type_localizable', Store(), lineno=18, col_offset=0)], Num(512, lineno=18, col_offset=19), lineno=18, col_offset=0), Assign([Name('typemask', Store(), lineno=20, col_offset=0)], Num(3072, lineno=20, col_offset=19), lineno=20, col_offset=0), Assign([Name('type_long', Store(), lineno=21, col_offset=0)], Num(0, lineno=21, col_offset=19), lineno=21, col_offset=0), Assign([Name('type_short', Store(), lineno=22, col_offset=0)], Num(1024, lineno=22, col_offset=19), lineno=22, col_offset=0), Assign([Name('type_string', Store(), lineno=23, col_offset=0)], Num(3072, lineno=23, col_offset=19), lineno=23, col_offset=0), Assign([Name('type_binary', Store(), lineno=24, col_offset=0)], Num(2048, lineno=24, col_offset=19), lineno=24, col_offset=0), Assign([Name('type_nullable', Store(), lineno=26, col_offset=0)], Num(4096, lineno=26, col_offset=19), lineno=26, col_offset=0), Assign([Name('type_key', Store(), lineno=27, col_offset=0)], Num(8192, lineno=27, col_offset=19), lineno=27, col_offset=0), Assign([Name('knownbits', Store(), lineno=29, col_offset=0)], BinOp(BinOp(BinOp(BinOp(BinOp(Name('datasizemask', Load(), lineno=29, col_offset=12), BitOr(), Name('type_valid', Load(), lineno=29, col_offset=27), lineno=29, col_offset=12), BitOr(), Name('type_localizable', Load(), lineno=29, col_offset=40), lineno=29, col_offset=38), BitOr(), Name('typemask', Load(), lineno=30, col_offset=12), lineno=29, col_offset=57), BitOr(), Name('type_nullable', Load(), lineno=30, col_offset=23), lineno=30, col_offset=21), BitOr(), Name('type_key', Load(), lineno=30, col_offset=39), lineno=30, col_offset=37), lineno=29, col_offset=0), Assign([Name('PID_CODEPAGE', Store(), lineno=33, col_offset=0)], Num(1, lineno=33, col_offset=13), lineno=33, col_offset=0), Assign([Name('PID_TITLE', Store(), lineno=34, col_offset=0)], Num(2, lineno=34, col_offset=10), lineno=34, col_offset=0), Assign([Name('PID_SUBJECT', Store(), lineno=35, col_offset=0)], Num(3, lineno=35, col_offset=12), lineno=35, col_offset=0), Assign([Name('PID_AUTHOR', Store(), lineno=36, col_offset=0)], Num(4, lineno=36, col_offset=11), lineno=36, col_offset=0), Assign([Name('PID_KEYWORDS', Store(), lineno=37, col_offset=0)], Num(5, lineno=37, col_offset=13), lineno=37, col_offset=0), Assign([Name('PID_COMMENTS', Store(), lineno=38, col_offset=0)], Num(6, lineno=38, col_offset=13), lineno=38, col_offset=0), Assign([Name('PID_TEMPLATE', Store(), lineno=39, col_offset=0)], Num(7, lineno=39, col_offset=13), lineno=39, col_offset=0), Assign([Name('PID_LASTAUTHOR', Store(), lineno=40, col_offset=0)], Num(8, lineno=40, col_offset=15), lineno=40, col_offset=0), Assign([Name('PID_REVNUMBER', Store(), lineno=41, col_offset=0)], Num(9, lineno=41, col_offset=14), lineno=41, col_offset=0), Assign([Name('PID_LASTPRINTED', Store(), lineno=42, col_offset=0)], Num(11, lineno=42, col_offset=16), lineno=42, col_offset=0), Assign([Name('PID_CREATE_DTM', Store(), lineno=43, col_offset=0)], Num(12, lineno=43, col_offset=15), lineno=43, col_offset=0), Assign([Name('PID_LASTSAVE_DTM', Store(), lineno=44, col_offset=0)], Num(13, lineno=44, col_offset=17), lineno=44, col_offset=0), Assign([Name('PID_PAGECOUNT', Store(), lineno=45, col_offset=0)], Num(14, lineno=45, col_offset=14), lineno=45, col_offset=0), Assign([Name('PID_WORDCOUNT', Store(), lineno=46, col_offset=0)], Num(15, lineno=46, col_offset=14), lineno=46, col_offset=0), Assign([Name('PID_CHARCOUNT', Store(), lineno=47, col_offset=0)], Num(16, lineno=47, col_offset=14), lineno=47, col_offset=0), Assign([Name('PID_APPNAME', Store(), lineno=48, col_offset=0)], Num(18, lineno=48, col_offset=12), lineno=48, col_offset=0), Assign([Name('PID_SECURITY', Store(), lineno=49, col_offset=0)], Num(19, lineno=49, col_offset=13), lineno=49, col_offset=0), FunctionDef('reset', arguments([], None, None, []), [Global(['_directories'], lineno=52, col_offset=4), Assign([Name('_directories', Store(), lineno=53, col_offset=4)], Call(Attribute(Name('sets', Load(), lineno=53, col_offset=19), 'Set', Load(), lineno=53, col_offset=19), [], [], None, None, lineno=53, col_offset=19), lineno=53, col_offset=4)], [], lineno=51, col_offset=0), FunctionDef('EnsureMSI', arguments([], None, None, []), [Expr(Call(Attribute(Attribute(Attribute(Name('win32com', Load(), lineno=56, col_offset=4), 'client', Load(), lineno=56, col_offset=4), 'gencache', Load(), lineno=56, col_offset=4), 'EnsureModule', Load(), lineno=56, col_offset=4), [Str('{000C1092-0000-0000-C000-000000000046}', lineno=56, col_offset=42), Num(1033, lineno=56, col_offset=84), Num(1, lineno=56, col_offset=90), Num(0, lineno=56, col_offset=93)], [], None, None, lineno=56, col_offset=4), lineno=56, col_offset=4)], [], lineno=55, col_offset=0), FunctionDef('EnsureMSM', arguments([], None, None, []), [TryExcept([Expr(Call(Attribute(Attribute(Attribute(Name('win32com', Load(), lineno=60, col_offset=8), 'client', Load(), lineno=60, col_offset=8), 'gencache', Load(), lineno=60, col_offset=8), 'EnsureModule', Load(), lineno=60, col_offset=8), [Str('{0ADDA82F-2C26-11D2-AD65-00A0C9AF11A6}', lineno=60, col_offset=46), Num(0, lineno=60, col_offset=88), Num(1, lineno=60, col_offset=91), Num(0, lineno=60, col_offset=94)], [], None, None, lineno=60, col_offset=8), lineno=60, col_offset=8)], [ExceptHandler(Attribute(Name('pywintypes', Load(), lineno=61, col_offset=11), 'com_error', Load(), lineno=61, col_offset=11), None, [Expr(Call(Attribute(Attribute(Attribute(Name('win32com', Load(), lineno=62, col_offset=8), 'client', Load(), lineno=62, col_offset=8), 'gencache', Load(), lineno=62, col_offset=8), 'EnsureModule', Load(), lineno=62, col_offset=8), [Str('{0ADDA82F-2C26-11D2-AD65-00A0C9AF11A6}', lineno=62, col_offset=46), Num(0, lineno=62, col_offset=88), Num(2, lineno=62, col_offset=91), Num(0, lineno=62, col_offset=94)], [], None, None, lineno=62, col_offset=8), lineno=62, col_offset=8)], lineno=61, col_offset=4)], [], lineno=59, col_offset=4)], [], lineno=58, col_offset=0), Assign([Name('_Installer', Store(), lineno=64, col_offset=0)], Name('None', Load(), lineno=64, col_offset=11), lineno=64, col_offset=0), FunctionDef('MakeInstaller', arguments([], None, None, []), [Global(['_Installer'], lineno=66, col_offset=4), If(Compare(Name('_Installer', Load(), lineno=67, col_offset=7), [Is()], [Name('None', Load(), lineno=67, col_offset=21)], lineno=67, col_offset=7), [Expr(Call(Name('EnsureMSI', Load(), lineno=68, col_offset=8), [], [], None, None, lineno=68, col_offset=8), lineno=68, col_offset=8), Assign([Name('_Installer', Store(), lineno=69, col_offset=8)], Call(Attribute(Attribute(Name('win32com', Load(), lineno=69, col_offset=21), 'client', Load(), lineno=69, col_offset=21), 'Dispatch', Load(), lineno=69, col_offset=21), [Str('WindowsInstaller.Installer', lineno=69, col_offset=46)], [keyword('resultCLSID', Str('{000C1090-0000-0000-C000-000000000046}', lineno=70, col_offset=33))], None, None, lineno=69, col_offset=21), lineno=69, col_offset=8)], [], lineno=67, col_offset=4), Return(Name('_Installer', Load(), lineno=71, col_offset=11), lineno=71, col_offset=4)], [], lineno=65, col_offset=0), Assign([Name('_Merge', Store(), lineno=73, col_offset=0)], Name('None', Load(), lineno=73, col_offset=7), lineno=73, col_offset=0), FunctionDef('MakeMerge2', arguments([], None, None, []), [Global(['_Merge'], lineno=75, col_offset=4), If(Compare(Name('_Merge', Load(), lineno=76, col_offset=7), [Is()], [Name('None', Load(), lineno=76, col_offset=17)], lineno=76, col_offset=7), [Expr(Call(Name('EnsureMSM', Load(), lineno=77, col_offset=8), [], [], None, None, lineno=77, col_offset=8), lineno=77, col_offset=8), Assign([Name('_Merge', Store(), lineno=78, col_offset=8)], Call(Attribute(Attribute(Name('win32com', Load(), lineno=78, col_offset=17), 'client', Load(), lineno=78, col_offset=17), 'Dispatch', Load(), lineno=78, col_offset=17), [Str('Msm.Merge2.1', lineno=78, col_offset=42)], [], None, None, lineno=78, col_offset=17), lineno=78, col_offset=8)], [], lineno=76, col_offset=4), Return(Name('_Merge', Load(), lineno=79, col_offset=11), lineno=79, col_offset=4)], [], lineno=74, col_offset=0), ClassDef('Table', [], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=82, col_offset=17), Name('name', Param(), lineno=82, col_offset=23)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=83, col_offset=8), 'name', Store(), lineno=83, col_offset=8)], Name('name', Load(), lineno=83, col_offset=20), lineno=83, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=84, col_offset=8), 'fields', Store(), lineno=84, col_offset=8)], List([], Load(), lineno=84, col_offset=22), lineno=84, col_offset=8)], [], lineno=82, col_offset=4), FunctionDef('add_field', arguments([Name('self', Param(), lineno=86, col_offset=18), Name('index', Param(), lineno=86, col_offset=24), Name('name', Param(), lineno=86, col_offset=31), Name('type', Param(), lineno=86, col_offset=37)], None, None, []), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=87, col_offset=8), 'fields', Load(), lineno=87, col_offset=8), 'append', Load(), lineno=87, col_offset=8), [Tuple([Name('index', Load(), lineno=87, col_offset=28), Name('name', Load(), lineno=87, col_offset=34), Name('type', Load(), lineno=87, col_offset=39)], Load(), lineno=87, col_offset=28)], [], None, None, lineno=87, col_offset=8), lineno=87, col_offset=8)], [], lineno=86, col_offset=4), FunctionDef('sql', arguments([Name('self', Param(), lineno=89, col_offset=12)], None, None, []), [Assign([Name('fields', Store(), lineno=90, col_offset=8)], List([], Load(), lineno=90, col_offset=17), lineno=90, col_offset=8), Assign([Name('keys', Store(), lineno=91, col_offset=8)], List([], Load(), lineno=91, col_offset=15), lineno=91, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=92, col_offset=8), 'fields', Load(), lineno=92, col_offset=8), 'sort', Load(), lineno=92, col_offset=8), [], [], None, None, lineno=92, col_offset=8), lineno=92, col_offset=8), Assign([Name('fields', Store(), lineno=93, col_offset=8)], BinOp(List([Name('None', Load(), lineno=93, col_offset=18)], Load(), lineno=93, col_offset=17), Mult(), Call(Name('len', Load(), lineno=93, col_offset=24), [Attribute(Name('self', Load(), lineno=93, col_offset=28), 'fields', Load(), lineno=93, col_offset=28)], [], None, None, lineno=93, col_offset=24), lineno=93, col_offset=17), lineno=93, col_offset=8), For(Tuple([Name('index', Store(), lineno=94, col_offset=12), Name('name', Store(), lineno=94, col_offset=19), Name('type', Store(), lineno=94, col_offset=25)], Store(), lineno=94, col_offset=12), Attribute(Name('self', Load(), lineno=94, col_offset=33), 'fields', Load(), lineno=94, col_offset=33), [AugAssign(Name('index', Store(), lineno=95, col_offset=12), Sub(), Num(1, lineno=95, col_offset=21), lineno=95, col_offset=12), Assign([Name('unk', Store(), lineno=96, col_offset=12)], BinOp(Name('type', Load(), lineno=96, col_offset=18), BitAnd(), UnaryOp(Invert(), Name('knownbits', Load(), lineno=96, col_offset=26), lineno=96, col_offset=25), lineno=96, col_offset=18), lineno=96, col_offset=12), If(Name('unk', Load(), lineno=97, col_offset=15), [Print(None, [BinOp(Str('%s.%s unknown bits %x', lineno=98, col_offset=22), Mod(), Tuple([Attribute(Name('self', Load(), lineno=98, col_offset=49), 'name', Load(), lineno=98, col_offset=49), Name('name', Load(), lineno=98, col_offset=60), Name('unk', Load(), lineno=98, col_offset=66)], Load(), lineno=98, col_offset=49), lineno=98, col_offset=22)], True, lineno=98, col_offset=16)], [], lineno=97, col_offset=12), Assign([Name('size', Store(), lineno=99, col_offset=12)], BinOp(Name('type', Load(), lineno=99, col_offset=19), BitAnd(), Name('datasizemask', Load(), lineno=99, col_offset=26), lineno=99, col_offset=19), lineno=99, col_offset=12), Assign([Name('dtype', Store(), lineno=100, col_offset=12)], BinOp(Name('type', Load(), lineno=100, col_offset=20), BitAnd(), Name('typemask', Load(), lineno=100, col_offset=27), lineno=100, col_offset=20), lineno=100, col_offset=12), If(Compare(Name('dtype', Load(), lineno=101, col_offset=15), [Eq()], [Name('type_string', Load(), lineno=101, col_offset=24)], lineno=101, col_offset=15), [If(Name('size', Load(), lineno=102, col_offset=19), [Assign([Name('tname', Store(), lineno=103, col_offset=20)], BinOp(Str('CHAR(%d)', lineno=103, col_offset=26), Mod(), Name('size', Load(), lineno=103, col_offset=39), lineno=103, col_offset=26), lineno=103, col_offset=20)], [Assign([Name('tname', Store(), lineno=105, col_offset=20)], Str('CHAR', lineno=105, col_offset=26), lineno=105, col_offset=20)], lineno=102, col_offset=16)], [If(Compare(Name('dtype', Load(), lineno=106, col_offset=17), [Eq()], [Name('type_short', Load(), lineno=106, col_offset=26)], lineno=106, col_offset=17), [Assert(Compare(Name('size', Load(), lineno=107, col_offset=23), [Eq()], [Num(2, lineno=107, col_offset=29)], lineno=107, col_offset=23), None, lineno=107, col_offset=16), Assign([Name('tname', Store(), lineno=108, col_offset=16)], Str('SHORT', lineno=108, col_offset=24), lineno=108, col_offset=16)], [If(Compare(Name('dtype', Load(), lineno=109, col_offset=17), [Eq()], [Name('type_long', Load(), lineno=109, col_offset=26)], lineno=109, col_offset=17), [Assert(Compare(Name('size', Load(), lineno=110, col_offset=23), [Eq()], [Num(4, lineno=110, col_offset=29)], lineno=110, col_offset=23), None, lineno=110, col_offset=16), Assign([Name('tname', Store(), lineno=111, col_offset=16)], Str('LONG', lineno=111, col_offset=22), lineno=111, col_offset=16)], [If(Compare(Name('dtype', Load(), lineno=112, col_offset=17), [Eq()], [Name('type_binary', Load(), lineno=112, col_offset=26)], lineno=112, col_offset=17), [Assert(Compare(Name('size', Load(), lineno=113, col_offset=23), [Eq()], [Num(0, lineno=113, col_offset=29)], lineno=113, col_offset=23), None, lineno=113, col_offset=16), Assign([Name('tname', Store(), lineno=114, col_offset=16)], Str('OBJECT', lineno=114, col_offset=22), lineno=114, col_offset=16)], [Assign([Name('tname', Store(), lineno=116, col_offset=16)], Str('unknown', lineno=116, col_offset=22), lineno=116, col_offset=16), Print(None, [BinOp(Str('%s.%sunknown integer type %d', lineno=117, col_offset=22), Mod(), Tuple([Attribute(Name('self', Load(), lineno=117, col_offset=56), 'name', Load(), lineno=117, col_offset=56), Name('name', Load(), lineno=117, col_offset=67), Name('size', Load(), lineno=117, col_offset=73)], Load(), lineno=117, col_offset=56), lineno=117, col_offset=22)], True, lineno=117, col_offset=16)], lineno=112, col_offset=17)], lineno=109, col_offset=17)], lineno=106, col_offset=17)], lineno=101, col_offset=12), If(BinOp(Name('type', Load(), lineno=118, col_offset=15), BitAnd(), Name('type_nullable', Load(), lineno=118, col_offset=22), lineno=118, col_offset=15), [Assign([Name('flags', Store(), lineno=119, col_offset=16)], Str('', lineno=119, col_offset=24), lineno=119, col_offset=16)], [Assign([Name('flags', Store(), lineno=121, col_offset=16)], Str(' NOT NULL', lineno=121, col_offset=24), lineno=121, col_offset=16)], lineno=118, col_offset=12), If(BinOp(Name('type', Load(), lineno=122, col_offset=15), BitAnd(), Name('type_localizable', Load(), lineno=122, col_offset=22), lineno=122, col_offset=15), [AugAssign(Name('flags', Store(), lineno=123, col_offset=16), Add(), Str(' LOCALIZABLE', lineno=123, col_offset=25), lineno=123, col_offset=16)], [], lineno=122, col_offset=12), Assign([Subscript(Name('fields', Load(), lineno=124, col_offset=12), Index(Name('index', Load(), lineno=124, col_offset=19)), Store(), lineno=124, col_offset=12)], BinOp(Str('`%s` %s%s', lineno=124, col_offset=28), Mod(), Tuple([Name('name', Load(), lineno=124, col_offset=43), Name('tname', Load(), lineno=124, col_offset=49), Name('flags', Load(), lineno=124, col_offset=56)], Load(), lineno=124, col_offset=43), lineno=124, col_offset=28), lineno=124, col_offset=12), If(BinOp(Name('type', Load(), lineno=125, col_offset=15), BitAnd(), Name('type_key', Load(), lineno=125, col_offset=22), lineno=125, col_offset=15), [Expr(Call(Attribute(Name('keys', Load(), lineno=126, col_offset=16), 'append', Load(), lineno=126, col_offset=16), [BinOp(Str('`%s`', lineno=126, col_offset=28), Mod(), Name('name', Load(), lineno=126, col_offset=37), lineno=126, col_offset=28)], [], None, None, lineno=126, col_offset=16), lineno=126, col_offset=16)], [], lineno=125, col_offset=12)], [], lineno=94, col_offset=8), Assign([Name('fields', Store(), lineno=127, col_offset=8)], Call(Attribute(Str(', ', lineno=127, col_offset=17), 'join', Load(), lineno=127, col_offset=17), [Name('fields', Load(), lineno=127, col_offset=27)], [], None, None, lineno=127, col_offset=17), lineno=127, col_offset=8), Assign([Name('keys', Store(), lineno=128, col_offset=8)], Call(Attribute(Str(', ', lineno=128, col_offset=15), 'join', Load(), lineno=128, col_offset=15), [Name('keys', Load(), lineno=128, col_offset=25)], [], None, None, lineno=128, col_offset=15), lineno=128, col_offset=8), Return(BinOp(Str('CREATE TABLE %s (%s PRIMARY KEY %s)', lineno=129, col_offset=15), Mod(), Tuple([Attribute(Name('self', Load(), lineno=129, col_offset=56), 'name', Load(), lineno=129, col_offset=56), Name('fields', Load(), lineno=129, col_offset=67), Name('keys', Load(), lineno=129, col_offset=75)], Load(), lineno=129, col_offset=56), lineno=129, col_offset=15), lineno=129, col_offset=8)], [], lineno=89, col_offset=4), FunctionDef('create', arguments([Name('self', Param(), lineno=131, col_offset=15), Name('db', Param(), lineno=131, col_offset=21)], None, None, []), [Assign([Name('v', Store(), lineno=132, col_offset=8)], Call(Attribute(Name('db', Load(), lineno=132, col_offset=12), 'OpenView', Load(), lineno=132, col_offset=12), [Call(Attribute(Name('self', Load(), lineno=132, col_offset=24), 'sql', Load(), lineno=132, col_offset=24), [], [], None, None, lineno=132, col_offset=24)], [], None, None, lineno=132, col_offset=12), lineno=132, col_offset=8), Expr(Call(Attribute(Name('v', Load(), lineno=133, col_offset=8), 'Execute', Load(), lineno=133, col_offset=8), [Name('None', Load(), lineno=133, col_offset=18)], [], None, None, lineno=133, col_offset=8), lineno=133, col_offset=8), Expr(Call(Attribute(Name('v', Load(), lineno=134, col_offset=8), 'Close', Load(), lineno=134, col_offset=8), [], [], None, None, lineno=134, col_offset=8), lineno=134, col_offset=8)], [], lineno=131, col_offset=4)], [], lineno=81, col_offset=0), ClassDef('Binary', [], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=137, col_offset=17), Name('fname', Param(), lineno=137, col_offset=23)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=138, col_offset=8), 'name', Store(), lineno=138, col_offset=8)], Name('fname', Load(), lineno=138, col_offset=20), lineno=138, col_offset=8)], [], lineno=137, col_offset=4), FunctionDef('__repr__', arguments([Name('self', Param(), lineno=139, col_offset=17)], None, None, []), [Return(BinOp(Str('msilib.Binary(os.path.join(dirname,"%s"))', lineno=140, col_offset=15), Mod(), Attribute(Name('self', Load(), lineno=140, col_offset=61), 'name', Load(), lineno=140, col_offset=61), lineno=140, col_offset=15), lineno=140, col_offset=8)], [], lineno=139, col_offset=4)], [], lineno=136, col_offset=0), FunctionDef('gen_schema', arguments([Name('destpath', Param(), lineno=142, col_offset=15), Name('schemapath', Param(), lineno=142, col_offset=25)], None, None, []), [Assign([Name('d', Store(), lineno=143, col_offset=4)], Call(Name('MakeInstaller', Load(), lineno=143, col_offset=8), [], [], None, None, lineno=143, col_offset=8), lineno=143, col_offset=4), Assign([Name('schema', Store(), lineno=144, col_offset=4)], Call(Attribute(Name('d', Load(), lineno=144, col_offset=13), 'OpenDatabase', Load(), lineno=144, col_offset=13), [Name('schemapath', Load(), lineno=144, col_offset=28), Attribute(Attribute(Attribute(Name('win32com', Load(), lineno=145, col_offset=12), 'client', Load(), lineno=145, col_offset=12), 'constants', Load(), lineno=145, col_offset=12), 'msiOpenDatabaseModeReadOnly', Load(), lineno=145, col_offset=12)], [], None, None, lineno=144, col_offset=13), lineno=144, col_offset=4), Assign([Name('v', Store(), lineno=148, col_offset=4)], Call(Attribute(Name('schema', Load(), lineno=148, col_offset=6), 'OpenView', Load(), lineno=148, col_offset=6), [Str('SELECT * FROM _Columns', lineno=148, col_offset=22)], [], None, None, lineno=148, col_offset=6), lineno=148, col_offset=4), Assign([Name('curtable', Store(), lineno=149, col_offset=4)], Name('None', Load(), lineno=149, col_offset=13), lineno=149, col_offset=4), Assign([Name('tables', Store(), lineno=150, col_offset=4)], List([], Load(), lineno=150, col_offset=13), lineno=150, col_offset=4), Expr(Call(Attribute(Name('v', Load(), lineno=151, col_offset=4), 'Execute', Load(), lineno=151, col_offset=4), [Name('None', Load(), lineno=151, col_offset=14)], [], None, None, lineno=151, col_offset=4), lineno=151, col_offset=4), Assign([Name('f', Store(), lineno=152, col_offset=4)], Call(Name('open', Load(), lineno=152, col_offset=8), [Name('destpath', Load(), lineno=152, col_offset=13), Str('wt', lineno=152, col_offset=23)], [], None, None, lineno=152, col_offset=8), lineno=152, col_offset=4), Expr(Call(Attribute(Name('f', Load(), lineno=153, col_offset=4), 'write', Load(), lineno=153, col_offset=4), [Str('from msilib import Table\n', lineno=153, col_offset=12)], [], None, None, lineno=153, col_offset=4), lineno=153, col_offset=4), While(Num(1, lineno=154, col_offset=10), [Assign([Name('r', Store(), lineno=155, col_offset=8)], Call(Attribute(Name('v', Load(), lineno=155, col_offset=10), 'Fetch', Load(), lineno=155, col_offset=10), [], [], None, None, lineno=155, col_offset=10), lineno=155, col_offset=8), If(UnaryOp(Not(), Name('r', Load(), lineno=156, col_offset=15), lineno=156, col_offset=11), [Break( lineno=156, col_offset=17)], [], lineno=156, col_offset=8), Assign([Name('name', Store(), lineno=157, col_offset=8)], Call(Attribute(Name('r', Load(), lineno=157, col_offset=13), 'StringData', Load(), lineno=157, col_offset=13), [Num(1, lineno=157, col_offset=26)], [], None, None, lineno=157, col_offset=13), lineno=157, col_offset=8), If(Compare(Name('curtable', Load(), lineno=158, col_offset=11), [NotEq()], [Name('name', Load(), lineno=158, col_offset=23)], lineno=158, col_offset=11), [Expr(Call(Attribute(Name('f', Load(), lineno=159, col_offset=12), 'write', Load(), lineno=159, col_offset=12), [BinOp(Str("\n%s = Table('%s')\n", lineno=159, col_offset=20), Mod(), Tuple([Name('name', Load(), lineno=159, col_offset=46), Name('name', Load(), lineno=159, col_offset=51)], Load(), lineno=159, col_offset=46), lineno=159, col_offset=20)], [], None, None, lineno=159, col_offset=12), lineno=159, col_offset=12), Assign([Name('curtable', Store(), lineno=160, col_offset=12)], Name('name', Load(), lineno=160, col_offset=23), lineno=160, col_offset=12), Expr(Call(Attribute(Name('tables', Load(), lineno=161, col_offset=12), 'append', Load(), lineno=161, col_offset=12), [Name('name', Load(), lineno=161, col_offset=26)], [], None, None, lineno=161, col_offset=12), lineno=161, col_offset=12)], [], lineno=158, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=162, col_offset=8), 'write', Load(), lineno=162, col_offset=8), [BinOp(Str("%s.add_field(%d,'%s',%d)\n", lineno=162, col_offset=16), Mod(), Tuple([Name('name', Load(), lineno=163, col_offset=17), Call(Attribute(Name('r', Load(), lineno=163, col_offset=23), 'IntegerData', Load(), lineno=163, col_offset=23), [Num(2, lineno=163, col_offset=37)], [], None, None, lineno=163, col_offset=23), Call(Attribute(Name('r', Load(), lineno=163, col_offset=41), 'StringData', Load(), lineno=163, col_offset=41), [Num(3, lineno=163, col_offset=54)], [], None, None, lineno=163, col_offset=41), Call(Attribute(Name('r', Load(), lineno=163, col_offset=58), 'IntegerData', Load(), lineno=163, col_offset=58), [Num(4, lineno=163, col_offset=72)], [], None, None, lineno=163, col_offset=58)], Load(), lineno=163, col_offset=17), lineno=162, col_offset=16)], [], None, None, lineno=162, col_offset=8), lineno=162, col_offset=8)], [], lineno=154, col_offset=4), Expr(Call(Attribute(Name('v', Load(), lineno=164, col_offset=4), 'Close', Load(), lineno=164, col_offset=4), [], [], None, None, lineno=164, col_offset=4), lineno=164, col_offset=4), Expr(Call(Attribute(Name('f', Load(), lineno=166, col_offset=4), 'write', Load(), lineno=166, col_offset=4), [BinOp(Str('\ntables=[%s]\n\n', lineno=166, col_offset=12), Mod(), Call(Attribute(Str(', ', lineno=166, col_offset=35), 'join', Load(), lineno=166, col_offset=35), [Name('tables', Load(), lineno=166, col_offset=45)], [], None, None, lineno=166, col_offset=35), lineno=166, col_offset=12)], [], None, None, lineno=166, col_offset=4), lineno=166, col_offset=4), Expr(Call(Attribute(Name('f', Load(), lineno=169, col_offset=4), 'write', Load(), lineno=169, col_offset=4), [Str('_Validation_records = [\n', lineno=169, col_offset=12)], [], None, None, lineno=169, col_offset=4), lineno=169, col_offset=4), Assign([Name('v', Store(), lineno=170, col_offset=4)], Call(Attribute(Name('schema', Load(), lineno=170, col_offset=8), 'OpenView', Load(), lineno=170, col_offset=8), [Str('SELECT * FROM _Validation', lineno=170, col_offset=24)], [], None, None, lineno=170, col_offset=8), lineno=170, col_offset=4), Expr(Call(Attribute(Name('v', Load(), lineno=171, col_offset=4), 'Execute', Load(), lineno=171, col_offset=4), [Name('None', Load(), lineno=171, col_offset=14)], [], None, None, lineno=171, col_offset=4), lineno=171, col_offset=4), While(Num(1, lineno=172, col_offset=10), [Assign([Name('r', Store(), lineno=173, col_offset=8)], Call(Attribute(Name('v', Load(), lineno=173, col_offset=12), 'Fetch', Load(), lineno=173, col_offset=12), [], [], None, None, lineno=173, col_offset=12), lineno=173, col_offset=8), If(UnaryOp(Not(), Name('r', Load(), lineno=174, col_offset=15), lineno=174, col_offset=11), [Break( lineno=174, col_offset=17)], [], lineno=174, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=176, col_offset=8), 'write', Load(), lineno=176, col_offset=8), [BinOp(Str('(%s,%s,%s,', lineno=176, col_offset=16), Mod(), Tuple([Repr(Call(Attribute(Name('r', Load(), lineno=177, col_offset=18), 'StringData', Load(), lineno=177, col_offset=18), [Num(1, lineno=177, col_offset=31)], [], None, None, lineno=177, col_offset=18), lineno=177, col_offset=17), Repr(Call(Attribute(Name('r', Load(), lineno=177, col_offset=37), 'StringData', Load(), lineno=177, col_offset=37), [Num(2, lineno=177, col_offset=50)], [], None, None, lineno=177, col_offset=37), lineno=177, col_offset=36), Repr(Call(Attribute(Name('r', Load(), lineno=177, col_offset=56), 'StringData', Load(), lineno=177, col_offset=56), [Num(3, lineno=177, col_offset=69)], [], None, None, lineno=177, col_offset=56), lineno=177, col_offset=55)], Load(), lineno=177, col_offset=17), lineno=176, col_offset=16)], [], None, None, lineno=176, col_offset=8), lineno=176, col_offset=8), FunctionDef('put_int', arguments([Name('i', Param(), lineno=178, col_offset=20)], None, None, []), [If(Call(Attribute(Name('r', Load(), lineno=179, col_offset=15), 'IsNull', Load(), lineno=179, col_offset=15), [Name('i', Load(), lineno=179, col_offset=24)], [], None, None, lineno=179, col_offset=15), [Expr(Call(Attribute(Name('f', Load(), lineno=179, col_offset=27), 'write', Load(), lineno=179, col_offset=27), [Str('None, ', lineno=179, col_offset=35)], [], None, None, lineno=179, col_offset=27), lineno=179, col_offset=27)], [Expr(Call(Attribute(Name('f', Load(), lineno=180, col_offset=17), 'write', Load(), lineno=180, col_offset=17), [BinOp(Str('%d,', lineno=180, col_offset=25), Mod(), Call(Attribute(Name('r', Load(), lineno=180, col_offset=33), 'IntegerData', Load(), lineno=180, col_offset=33), [Name('i', Load(), lineno=180, col_offset=47)], [], None, None, lineno=180, col_offset=33), lineno=180, col_offset=25)], [], None, None, lineno=180, col_offset=17), lineno=180, col_offset=17)], lineno=179, col_offset=12)], [], lineno=178, col_offset=8), FunctionDef('put_str', arguments([Name('i', Param(), lineno=181, col_offset=20)], None, None, []), [If(Call(Attribute(Name('r', Load(), lineno=182, col_offset=15), 'IsNull', Load(), lineno=182, col_offset=15), [Name('i', Load(), lineno=182, col_offset=24)], [], None, None, lineno=182, col_offset=15), [Expr(Call(Attribute(Name('f', Load(), lineno=182, col_offset=27), 'write', Load(), lineno=182, col_offset=27), [Str('None, ', lineno=182, col_offset=35)], [], None, None, lineno=182, col_offset=27), lineno=182, col_offset=27)], [Expr(Call(Attribute(Name('f', Load(), lineno=183, col_offset=17), 'write', Load(), lineno=183, col_offset=17), [BinOp(Str('%s,', lineno=183, col_offset=25), Mod(), Repr(Call(Attribute(Name('r', Load(), lineno=183, col_offset=34), 'StringData', Load(), lineno=183, col_offset=34), [Name('i', Load(), lineno=183, col_offset=47)], [], None, None, lineno=183, col_offset=34), lineno=183, col_offset=33), lineno=183, col_offset=25)], [], None, None, lineno=183, col_offset=17), lineno=183, col_offset=17)], lineno=182, col_offset=12)], [], lineno=181, col_offset=8), Expr(Call(Name('put_int', Load(), lineno=184, col_offset=8), [Num(4, lineno=184, col_offset=16)], [], None, None, lineno=184, col_offset=8), lineno=184, col_offset=8), Expr(Call(Name('put_int', Load(), lineno=185, col_offset=8), [Num(5, lineno=185, col_offset=16)], [], None, None, lineno=185, col_offset=8), lineno=185, col_offset=8), Expr(Call(Name('put_str', Load(), lineno=186, col_offset=8), [Num(6, lineno=186, col_offset=16)], [], None, None, lineno=186, col_offset=8), lineno=186, col_offset=8), Expr(Call(Name('put_int', Load(), lineno=187, col_offset=8), [Num(7, lineno=187, col_offset=16)], [], None, None, lineno=187, col_offset=8), lineno=187, col_offset=8), Expr(Call(Name('put_str', Load(), lineno=188, col_offset=8), [Num(8, lineno=188, col_offset=16)], [], None, None, lineno=188, col_offset=8), lineno=188, col_offset=8), Expr(Call(Name('put_str', Load(), lineno=189, col_offset=8), [Num(9, lineno=189, col_offset=16)], [], None, None, lineno=189, col_offset=8), lineno=189, col_offset=8), Expr(Call(Name('put_str', Load(), lineno=190, col_offset=8), [Num(10, lineno=190, col_offset=16)], [], None, None, lineno=190, col_offset=8), lineno=190, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=191, col_offset=8), 'write', Load(), lineno=191, col_offset=8), [Str('),\n', lineno=191, col_offset=16)], [], None, None, lineno=191, col_offset=8), lineno=191, col_offset=8)], [], lineno=172, col_offset=4), Expr(Call(Attribute(Name('f', Load(), lineno=192, col_offset=4), 'write', Load(), lineno=192, col_offset=4), [Str(']\n\n', lineno=192, col_offset=12)], [], None, None, lineno=192, col_offset=4), lineno=192, col_offset=4), Expr(Call(Attribute(Name('f', Load(), lineno=194, col_offset=4), 'close', Load(), lineno=194, col_offset=4), [], [], None, None, lineno=194, col_offset=4), lineno=194, col_offset=4)], [], lineno=142, col_offset=0), FunctionDef('gen_sequence', arguments([Name('destpath', Param(), lineno=196, col_offset=17), Name('msipath', Param(), lineno=196, col_offset=27)], None, None, []), [Assign([Name('dir', Store(), lineno=197, col_offset=4)], Call(Attribute(Attribute(Name('os', Load(), lineno=197, col_offset=10), 'path', Load(), lineno=197, col_offset=10), 'dirname', Load(), lineno=197, col_offset=10), [Name('destpath', Load(), lineno=197, col_offset=26)], [], None, None, lineno=197, col_offset=10), lineno=197, col_offset=4), Assign([Name('d', Store(), lineno=198, col_offset=4)], Call(Name('MakeInstaller', Load(), lineno=198, col_offset=8), [], [], None, None, lineno=198, col_offset=8), lineno=198, col_offset=4), Assign([Name('seqmsi', Store(), lineno=199, col_offset=4)], Call(Attribute(Name('d', Load(), lineno=199, col_offset=13), 'OpenDatabase', Load(), lineno=199, col_offset=13), [Name('msipath', Load(), lineno=199, col_offset=28), Attribute(Attribute(Attribute(Name('win32com', Load(), lineno=200, col_offset=12), 'client', Load(), lineno=200, col_offset=12), 'constants', Load(), lineno=200, col_offset=12), 'msiOpenDatabaseModeReadOnly', Load(), lineno=200, col_offset=12)], [], None, None, lineno=199, col_offset=13), lineno=199, col_offset=4), Assign([Name('v', Store(), lineno=202, col_offset=4)], Call(Attribute(Name('seqmsi', Load(), lineno=202, col_offset=8), 'OpenView', Load(), lineno=202, col_offset=8), [Str('SELECT * FROM _Tables', lineno=202, col_offset=24)], [], None, None, lineno=202, col_offset=8), lineno=202, col_offset=4), Expr(Call(Attribute(Name('v', Load(), lineno=203, col_offset=4), 'Execute', Load(), lineno=203, col_offset=4), [Name('None', Load(), lineno=203, col_offset=14)], [], None, None, lineno=203, col_offset=4), lineno=203, col_offset=4), Assign([Name('f', Store(), lineno=204, col_offset=4)], Call(Name('open', Load(), lineno=204, col_offset=8), [Name('destpath', Load(), lineno=204, col_offset=13), Str('w', lineno=204, col_offset=23)], [], None, None, lineno=204, col_offset=8), lineno=204, col_offset=4), Print(Name('f', Load(), lineno=205, col_offset=12), [Str('import msilib,os;dirname=os.path.dirname(__file__)', lineno=205, col_offset=15)], True, lineno=205, col_offset=4), Assign([Name('tables', Store(), lineno=206, col_offset=4)], List([], Load(), lineno=206, col_offset=13), lineno=206, col_offset=4), While(Num(1, lineno=207, col_offset=10), [Assign([Name('r', Store(), lineno=208, col_offset=8)], Call(Attribute(Name('v', Load(), lineno=208, col_offset=12), 'Fetch', Load(), lineno=208, col_offset=12), [], [], None, None, lineno=208, col_offset=12), lineno=208, col_offset=8), If(UnaryOp(Not(), Name('r', Load(), lineno=209, col_offset=15), lineno=209, col_offset=11), [Break( lineno=209, col_offset=17)], [], lineno=209, col_offset=8), Assign([Name('table', Store(), lineno=210, col_offset=8)], Call(Attribute(Name('r', Load(), lineno=210, col_offset=16), 'StringData', Load(), lineno=210, col_offset=16), [Num(1, lineno=210, col_offset=29)], [], None, None, lineno=210, col_offset=16), lineno=210, col_offset=8), Expr(Call(Attribute(Name('tables', Load(), lineno=211, col_offset=8), 'append', Load(), lineno=211, col_offset=8), [Name('table', Load(), lineno=211, col_offset=22)], [], None, None, lineno=211, col_offset=8), lineno=211, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=212, col_offset=8), 'write', Load(), lineno=212, col_offset=8), [BinOp(Str('%s = [\n', lineno=212, col_offset=16), Mod(), Name('table', Load(), lineno=212, col_offset=29), lineno=212, col_offset=16)], [], None, None, lineno=212, col_offset=8), lineno=212, col_offset=8), Assign([Name('v1', Store(), lineno=213, col_offset=8)], Call(Attribute(Name('seqmsi', Load(), lineno=213, col_offset=13), 'OpenView', Load(), lineno=213, col_offset=13), [BinOp(Str('SELECT * FROM `%s`', lineno=213, col_offset=29), Mod(), Name('table', Load(), lineno=213, col_offset=52), lineno=213, col_offset=29)], [], None, None, lineno=213, col_offset=13), lineno=213, col_offset=8), Expr(Call(Attribute(Name('v1', Load(), lineno=214, col_offset=8), 'Execute', Load(), lineno=214, col_offset=8), [Name('None', Load(), lineno=214, col_offset=19)], [], None, None, lineno=214, col_offset=8), lineno=214, col_offset=8), Assign([Name('info', Store(), lineno=215, col_offset=8)], Call(Attribute(Name('v1', Load(), lineno=215, col_offset=15), 'ColumnInfo', Load(), lineno=215, col_offset=15), [Attribute(Name('constants', Load(), lineno=215, col_offset=29), 'msiColumnInfoTypes', Load(), lineno=215, col_offset=29)], [], None, None, lineno=215, col_offset=15), lineno=215, col_offset=8), While(Num(1, lineno=216, col_offset=14), [Assign([Name('r', Store(), lineno=217, col_offset=12)], Call(Attribute(Name('v1', Load(), lineno=217, col_offset=16), 'Fetch', Load(), lineno=217, col_offset=16), [], [], None, None, lineno=217, col_offset=16), lineno=217, col_offset=12), If(UnaryOp(Not(), Name('r', Load(), lineno=218, col_offset=19), lineno=218, col_offset=15), [Break( lineno=218, col_offset=21)], [], lineno=218, col_offset=12), Assign([Name('rec', Store(), lineno=219, col_offset=12)], List([], Load(), lineno=219, col_offset=18), lineno=219, col_offset=12), For(Name('i', Store(), lineno=220, col_offset=16), Call(Name('range', Load(), lineno=220, col_offset=21), [Num(1, lineno=220, col_offset=27), BinOp(Attribute(Name('r', Load(), lineno=220, col_offset=29), 'FieldCount', Load(), lineno=220, col_offset=29), Add(), Num(1, lineno=220, col_offset=42), lineno=220, col_offset=29)], [], None, None, lineno=220, col_offset=21), [If(Call(Attribute(Name('r', Load(), lineno=221, col_offset=19), 'IsNull', Load(), lineno=221, col_offset=19), [Name('i', Load(), lineno=221, col_offset=28)], [], None, None, lineno=221, col_offset=19), [Expr(Call(Attribute(Name('rec', Load(), lineno=222, col_offset=20), 'append', Load(), lineno=222, col_offset=20), [Name('None', Load(), lineno=222, col_offset=31)], [], None, None, lineno=222, col_offset=20), lineno=222, col_offset=20)], [If(Compare(Subscript(Call(Attribute(Name('info', Load(), lineno=223, col_offset=21), 'StringData', Load(), lineno=223, col_offset=21), [Name('i', Load(), lineno=223, col_offset=37)], [], None, None, lineno=223, col_offset=21), Index(Num(0, lineno=223, col_offset=40)), Load(), lineno=223, col_offset=21), [In()], [Str('iI', lineno=223, col_offset=46)], lineno=223, col_offset=21), [Expr(Call(Attribute(Name('rec', Load(), lineno=224, col_offset=20), 'append', Load(), lineno=224, col_offset=20), [Call(Attribute(Name('r', Load(), lineno=224, col_offset=31), 'IntegerData', Load(), lineno=224, col_offset=31), [Name('i', Load(), lineno=224, col_offset=45)], [], None, None, lineno=224, col_offset=31)], [], None, None, lineno=224, col_offset=20), lineno=224, col_offset=20)], [If(Compare(Subscript(Call(Attribute(Name('info', Load(), lineno=225, col_offset=21), 'StringData', Load(), lineno=225, col_offset=21), [Name('i', Load(), lineno=225, col_offset=37)], [], None, None, lineno=225, col_offset=21), Index(Num(0, lineno=225, col_offset=40)), Load(), lineno=225, col_offset=21), [In()], [Str('slSL', lineno=225, col_offset=46)], lineno=225, col_offset=21), [Expr(Call(Attribute(Name('rec', Load(), lineno=226, col_offset=20), 'append', Load(), lineno=226, col_offset=20), [Call(Attribute(Name('r', Load(), lineno=226, col_offset=31), 'StringData', Load(), lineno=226, col_offset=31), [Name('i', Load(), lineno=226, col_offset=44)], [], None, None, lineno=226, col_offset=31)], [], None, None, lineno=226, col_offset=20), lineno=226, col_offset=20)], [If(Compare(Subscript(Call(Attribute(Name('info', Load(), lineno=227, col_offset=21), 'StringData', Load(), lineno=227, col_offset=21), [Name('i', Load(), lineno=227, col_offset=37)], [], None, None, lineno=227, col_offset=21), Index(Num(0, lineno=227, col_offset=40)), Load(), lineno=227, col_offset=21), [Eq()], [Str('v', lineno=227, col_offset=44)], lineno=227, col_offset=21), [Assign([Name('size', Store(), lineno=228, col_offset=20)], Call(Attribute(Name('r', Load(), lineno=228, col_offset=27), 'DataSize', Load(), lineno=228, col_offset=27), [Name('i', Load(), lineno=228, col_offset=38)], [], None, None, lineno=228, col_offset=27), lineno=228, col_offset=20), Assign([Name('bytes', Store(), lineno=229, col_offset=20)], Call(Attribute(Name('r', Load(), lineno=229, col_offset=28), 'ReadStream', Load(), lineno=229, col_offset=28), [Name('i', Load(), lineno=229, col_offset=41), Name('size', Load(), lineno=229, col_offset=44), Attribute(Name('constants', Load(), lineno=229, col_offset=50), 'msiReadStreamBytes', Load(), lineno=229, col_offset=50)], [], None, None, lineno=229, col_offset=28), lineno=229, col_offset=20), Assign([Name('bytes', Store(), lineno=230, col_offset=20)], Call(Attribute(Name('bytes', Load(), lineno=230, col_offset=28), 'encode', Load(), lineno=230, col_offset=28), [Str('latin-1', lineno=230, col_offset=41)], [], None, None, lineno=230, col_offset=28), lineno=230, col_offset=20), If(Compare(Name('table', Load(), lineno=231, col_offset=23), [Eq()], [Str('Binary', lineno=231, col_offset=32)], lineno=231, col_offset=23), [Assign([Name('fname', Store(), lineno=232, col_offset=24)], BinOp(Subscript(Name('rec', Load(), lineno=232, col_offset=32), Index(Num(0, lineno=232, col_offset=36)), Load(), lineno=232, col_offset=32), Add(), Str('.bin', lineno=232, col_offset=39), lineno=232, col_offset=32), lineno=232, col_offset=24), Expr(Call(Attribute(Call(Name('open', Load(), lineno=233, col_offset=24), [Call(Attribute(Attribute(Name('os', Load(), lineno=233, col_offset=29), 'path', Load(), lineno=233, col_offset=29), 'join', Load(), lineno=233, col_offset=29), [Name('dir', Load(), lineno=233, col_offset=42), Name('fname', Load(), lineno=233, col_offset=46)], [], None, None, lineno=233, col_offset=29), Str('wb', lineno=233, col_offset=53)], [], None, None, lineno=233, col_offset=24), 'write', Load(), lineno=233, col_offset=24), [Name('bytes', Load(), lineno=233, col_offset=65)], [], None, None, lineno=233, col_offset=24), lineno=233, col_offset=24), Expr(Call(Attribute(Name('rec', Load(), lineno=234, col_offset=24), 'append', Load(), lineno=234, col_offset=24), [Call(Name('Binary', Load(), lineno=234, col_offset=35), [Name('fname', Load(), lineno=234, col_offset=42)], [], None, None, lineno=234, col_offset=35)], [], None, None, lineno=234, col_offset=24), lineno=234, col_offset=24)], [Expr(Call(Attribute(Name('rec', Load(), lineno=236, col_offset=24), 'append', Load(), lineno=236, col_offset=24), [Name('bytes', Load(), lineno=236, col_offset=35)], [], None, None, lineno=236, col_offset=24), lineno=236, col_offset=24)], lineno=231, col_offset=20)], [Raise(Str('Unsupported column type', lineno=238, col_offset=26), Call(Attribute(Name('info', Load(), lineno=238, col_offset=53), 'StringData', Load(), lineno=238, col_offset=53), [Name('i', Load(), lineno=238, col_offset=69)], [], None, None, lineno=238, col_offset=53), None, lineno=238, col_offset=20)], lineno=227, col_offset=21)], lineno=225, col_offset=21)], lineno=223, col_offset=21)], lineno=221, col_offset=16)], [], lineno=220, col_offset=12), Expr(Call(Attribute(Name('f', Load(), lineno=239, col_offset=12), 'write', Load(), lineno=239, col_offset=12), [BinOp(Call(Name('repr', Load(), lineno=239, col_offset=20), [Call(Name('tuple', Load(), lineno=239, col_offset=25), [Name('rec', Load(), lineno=239, col_offset=31)], [], None, None, lineno=239, col_offset=25)], [], None, None, lineno=239, col_offset=20), Add(), Str(',\n', lineno=239, col_offset=37), lineno=239, col_offset=20)], [], None, None, lineno=239, col_offset=12), lineno=239, col_offset=12)], [], lineno=216, col_offset=8), Expr(Call(Attribute(Name('v1', Load(), lineno=240, col_offset=8), 'Close', Load(), lineno=240, col_offset=8), [], [], None, None, lineno=240, col_offset=8), lineno=240, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=241, col_offset=8), 'write', Load(), lineno=241, col_offset=8), [Str(']\n\n', lineno=241, col_offset=16)], [], None, None, lineno=241, col_offset=8), lineno=241, col_offset=8)], [], lineno=207, col_offset=4), Expr(Call(Attribute(Name('v', Load(), lineno=242, col_offset=4), 'Close', Load(), lineno=242, col_offset=4), [], [], None, None, lineno=242, col_offset=4), lineno=242, col_offset=4), Expr(Call(Attribute(Name('f', Load(), lineno=243, col_offset=4), 'write', Load(), lineno=243, col_offset=4), [BinOp(Str('tables=%s\n', lineno=243, col_offset=12), Mod(), Call(Name('repr', Load(), lineno=243, col_offset=28), [Call(Name('map', Load(), lineno=243, col_offset=33), [Name('str', Load(), lineno=243, col_offset=37), Name('tables', Load(), lineno=243, col_offset=41)], [], None, None, lineno=243, col_offset=33)], [], None, None, lineno=243, col_offset=28), lineno=243, col_offset=12)], [], None, None, lineno=243, col_offset=4), lineno=243, col_offset=4), Expr(Call(Attribute(Name('f', Load(), lineno=244, col_offset=4), 'close', Load(), lineno=244, col_offset=4), [], [], None, None, lineno=244, col_offset=4), lineno=244, col_offset=4)], [], lineno=196, col_offset=0), ClassDef('_Unspecified', [], [Pass( lineno=246, col_offset=19)], [], lineno=246, col_offset=0), FunctionDef('change_sequence', arguments([Name('seq', Param(), lineno=247, col_offset=20), Name('action', Param(), lineno=247, col_offset=25), Name('seqno', Param(), lineno=247, col_offset=33), Name('cond', Param(), lineno=247, col_offset=53)], None, None, [Name('_Unspecified', Load(), lineno=247, col_offset=39), Name('_Unspecified', Load(), lineno=247, col_offset=60)]), [Expr(Str('Change the sequence number of an action in a sequence list', lineno=248, col_offset=4), lineno=248, col_offset=4), For(Name('i', Store(), lineno=249, col_offset=8), Call(Name('range', Load(), lineno=249, col_offset=13), [Call(Name('len', Load(), lineno=249, col_offset=19), [Name('seq', Load(), lineno=249, col_offset=23)], [], None, None, lineno=249, col_offset=19)], [], None, None, lineno=249, col_offset=13), [If(Compare(Subscript(Subscript(Name('seq', Load(), lineno=250, col_offset=11), Index(Name('i', Load(), lineno=250, col_offset=15)), Load(), lineno=250, col_offset=11), Index(Num(0, lineno=250, col_offset=18)), Load(), lineno=250, col_offset=11), [Eq()], [Name('action', Load(), lineno=250, col_offset=24)], lineno=250, col_offset=11), [If(Compare(Name('cond', Load(), lineno=251, col_offset=15), [Is()], [Name('_Unspecified', Load(), lineno=251, col_offset=23)], lineno=251, col_offset=15), [Assign([Name('cond', Store(), lineno=252, col_offset=16)], Subscript(Subscript(Name('seq', Load(), lineno=252, col_offset=23), Index(Name('i', Load(), lineno=252, col_offset=27)), Load(), lineno=252, col_offset=23), Index(Num(1, lineno=252, col_offset=30)), Load(), lineno=252, col_offset=23), lineno=252, col_offset=16)], [], lineno=251, col_offset=12), If(Compare(Name('seqno', Load(), lineno=253, col_offset=15), [Is()], [Name('_Unspecified', Load(), lineno=253, col_offset=24)], lineno=253, col_offset=15), [Assign([Name('seqno', Store(), lineno=254, col_offset=16)], Subscript(Subscript(Name('seq', Load(), lineno=254, col_offset=24), Index(Name('i', Load(), lineno=254, col_offset=28)), Load(), lineno=254, col_offset=24), Index(Num(2, lineno=254, col_offset=31)), Load(), lineno=254, col_offset=24), lineno=254, col_offset=16)], [], lineno=253, col_offset=12), Assign([Subscript(Name('seq', Load(), lineno=255, col_offset=12), Index(Name('i', Load(), lineno=255, col_offset=16)), Store(), lineno=255, col_offset=12)], Tuple([Name('action', Load(), lineno=255, col_offset=22), Name('cond', Load(), lineno=255, col_offset=30), Name('seqno', Load(), lineno=255, col_offset=36)], Load(), lineno=255, col_offset=22), lineno=255, col_offset=12), Return(None, lineno=256, col_offset=12)], [], lineno=250, col_offset=8)], [], lineno=249, col_offset=4), Raise(Name('ValueError', Load(), lineno=257, col_offset=10), Str('Action not found in sequence', lineno=257, col_offset=22), None, lineno=257, col_offset=4)], [], lineno=247, col_offset=0), FunctionDef('add_data', arguments([Name('db', Param(), lineno=259, col_offset=13), Name('table', Param(), lineno=259, col_offset=17), Name('values', Param(), lineno=259, col_offset=24)], None, None, []), [Assign([Name('d', Store(), lineno=260, col_offset=4)], Call(Name('MakeInstaller', Load(), lineno=260, col_offset=8), [], [], None, None, lineno=260, col_offset=8), lineno=260, col_offset=4), Assign([Name('v', Store(), lineno=261, col_offset=4)], Call(Attribute(Name('db', Load(), lineno=261, col_offset=8), 'OpenView', Load(), lineno=261, col_offset=8), [BinOp(Str('SELECT * FROM `%s`', lineno=261, col_offset=20), Mod(), Name('table', Load(), lineno=261, col_offset=43), lineno=261, col_offset=20)], [], None, None, lineno=261, col_offset=8), lineno=261, col_offset=4), Assign([Name('count', Store(), lineno=262, col_offset=4)], Attribute(Call(Attribute(Name('v', Load(), lineno=262, col_offset=12), 'ColumnInfo', Load(), lineno=262, col_offset=12), [Num(0, lineno=262, col_offset=25)], [], None, None, lineno=262, col_offset=12), 'FieldCount', Load(), lineno=262, col_offset=12), lineno=262, col_offset=4), Assign([Name('r', Store(), lineno=263, col_offset=4)], Call(Attribute(Name('d', Load(), lineno=263, col_offset=8), 'CreateRecord', Load(), lineno=263, col_offset=8), [Name('count', Load(), lineno=263, col_offset=23)], [], None, None, lineno=263, col_offset=8), lineno=263, col_offset=4), For(Name('value', Store(), lineno=264, col_offset=8), Name('values', Load(), lineno=264, col_offset=17), [Assert(Compare(Call(Name('len', Load(), lineno=265, col_offset=15), [Name('value', Load(), lineno=265, col_offset=19)], [], None, None, lineno=265, col_offset=15), [Eq()], [Name('count', Load(), lineno=265, col_offset=29)], lineno=265, col_offset=15), Name('value', Load(), lineno=265, col_offset=36), lineno=265, col_offset=8), For(Name('i', Store(), lineno=266, col_offset=12), Call(Name('range', Load(), lineno=266, col_offset=17), [Name('count', Load(), lineno=266, col_offset=23)], [], None, None, lineno=266, col_offset=17), [Assign([Name('field', Store(), lineno=267, col_offset=12)], Subscript(Name('value', Load(), lineno=267, col_offset=20), Index(Name('i', Load(), lineno=267, col_offset=26)), Load(), lineno=267, col_offset=20), lineno=267, col_offset=12), If(Call(Name('isinstance', Load(), lineno=268, col_offset=15), [Name('field', Load(), lineno=268, col_offset=26), Tuple([Name('int', Load(), lineno=268, col_offset=34), Name('long', Load(), lineno=268, col_offset=39)], Load(), lineno=268, col_offset=34)], [], None, None, lineno=268, col_offset=15), [Expr(Call(Attribute(Name('r', Load(), lineno=269, col_offset=16), 'SetIntegerData', Load(), lineno=269, col_offset=16), [BinOp(Name('i', Load(), lineno=269, col_offset=33), Add(), Num(1, lineno=269, col_offset=35), lineno=269, col_offset=33), Name('field', Load(), lineno=269, col_offset=37)], [], None, None, lineno=269, col_offset=16), lineno=269, col_offset=16)], [If(Call(Name('isinstance', Load(), lineno=270, col_offset=17), [Name('field', Load(), lineno=270, col_offset=28), Name('basestring', Load(), lineno=270, col_offset=35)], [], None, None, lineno=270, col_offset=17), [Expr(Call(Attribute(Name('r', Load(), lineno=271, col_offset=16), 'SetStringData', Load(), lineno=271, col_offset=16), [BinOp(Name('i', Load(), lineno=271, col_offset=32), Add(), Num(1, lineno=271, col_offset=34), lineno=271, col_offset=32), Name('field', Load(), lineno=271, col_offset=36)], [], None, None, lineno=271, col_offset=16), lineno=271, col_offset=16)], [If(Compare(Name('field', Load(), lineno=272, col_offset=17), [Is()], [Name('None', Load(), lineno=272, col_offset=26)], lineno=272, col_offset=17), [Pass( lineno=273, col_offset=16)], [If(Call(Name('isinstance', Load(), lineno=274, col_offset=17), [Name('field', Load(), lineno=274, col_offset=28), Name('Binary', Load(), lineno=274, col_offset=35)], [], None, None, lineno=274, col_offset=17), [Expr(Call(Attribute(Name('r', Load(), lineno=275, col_offset=16), 'SetStream', Load(), lineno=275, col_offset=16), [BinOp(Name('i', Load(), lineno=275, col_offset=28), Add(), Num(1, lineno=275, col_offset=30), lineno=275, col_offset=28), Attribute(Name('field', Load(), lineno=275, col_offset=33), 'name', Load(), lineno=275, col_offset=33)], [], None, None, lineno=275, col_offset=16), lineno=275, col_offset=16)], [Raise(Name('TypeError', Load(), lineno=277, col_offset=22), BinOp(Str('Unsupported type %s', lineno=277, col_offset=33), Mod(), Attribute(Attribute(Name('field', Load(), lineno=277, col_offset=57), '__class__', Load(), lineno=277, col_offset=57), '__name__', Load(), lineno=277, col_offset=57), lineno=277, col_offset=33), None, lineno=277, col_offset=16)], lineno=274, col_offset=17)], lineno=272, col_offset=17)], lineno=270, col_offset=17)], lineno=268, col_offset=12)], [], lineno=266, col_offset=8), Expr(Call(Attribute(Name('v', Load(), lineno=278, col_offset=8), 'Modify', Load(), lineno=278, col_offset=8), [Attribute(Attribute(Attribute(Name('win32com', Load(), lineno=278, col_offset=17), 'client', Load(), lineno=278, col_offset=17), 'constants', Load(), lineno=278, col_offset=17), 'msiViewModifyInsert', Load(), lineno=278, col_offset=17), Name('r', Load(), lineno=278, col_offset=64)], [], None, None, lineno=278, col_offset=8), lineno=278, col_offset=8), Expr(Call(Attribute(Name('r', Load(), lineno=279, col_offset=8), 'ClearData', Load(), lineno=279, col_offset=8), [], [], None, None, lineno=279, col_offset=8), lineno=279, col_offset=8)], [], lineno=264, col_offset=4), Expr(Call(Attribute(Name('v', Load(), lineno=280, col_offset=4), 'Close', Load(), lineno=280, col_offset=4), [], [], None, None, lineno=280, col_offset=4), lineno=280, col_offset=4)], [], lineno=259, col_offset=0), FunctionDef('add_stream', arguments([Name('db', Param(), lineno=282, col_offset=15), Name('name', Param(), lineno=282, col_offset=19), Name('path', Param(), lineno=282, col_offset=25)], None, None, []), [Assign([Name('d', Store(), lineno=283, col_offset=4)], Call(Name('MakeInstaller', Load(), lineno=283, col_offset=8), [], [], None, None, lineno=283, col_offset=8), lineno=283, col_offset=4), Assign([Name('v', Store(), lineno=284, col_offset=4)], Call(Attribute(Name('db', Load(), lineno=284, col_offset=8), 'OpenView', Load(), lineno=284, col_offset=8), [BinOp(Str("INSERT INTO _Streams (Name, Data) VALUES ('%s', ?)", lineno=284, col_offset=20), Mod(), Name('name', Load(), lineno=284, col_offset=75), lineno=284, col_offset=20)], [], None, None, lineno=284, col_offset=8), lineno=284, col_offset=4), Assign([Name('r', Store(), lineno=285, col_offset=4)], Call(Attribute(Name('d', Load(), lineno=285, col_offset=8), 'CreateRecord', Load(), lineno=285, col_offset=8), [Num(1, lineno=285, col_offset=23)], [], None, None, lineno=285, col_offset=8), lineno=285, col_offset=4), Expr(Call(Attribute(Name('r', Load(), lineno=286, col_offset=4), 'SetStream', Load(), lineno=286, col_offset=4), [Num(1, lineno=286, col_offset=16), Name('path', Load(), lineno=286, col_offset=19)], [], None, None, lineno=286, col_offset=4), lineno=286, col_offset=4), Expr(Call(Attribute(Name('v', Load(), lineno=287, col_offset=4), 'Execute', Load(), lineno=287, col_offset=4), [Name('r', Load(), lineno=287, col_offset=14)], [], None, None, lineno=287, col_offset=4), lineno=287, col_offset=4), Expr(Call(Attribute(Name('v', Load(), lineno=288, col_offset=4), 'Close', Load(), lineno=288, col_offset=4), [], [], None, None, lineno=288, col_offset=4), lineno=288, col_offset=4)], [], lineno=282, col_offset=0), FunctionDef('init_database', arguments([Name('name', Param(), lineno=290, col_offset=18), Name('schema', Param(), lineno=290, col_offset=24), Name('ProductName', Param(), lineno=291, col_offset=18), Name('ProductCode', Param(), lineno=291, col_offset=31), Name('ProductVersion', Param(), lineno=291, col_offset=44), Name('Manufacturer', Param(), lineno=292, col_offset=18), Name('request_uac', Param(), lineno=293, col_offset=18)], None, None, [Name('False', Load(), lineno=293, col_offset=32)]), [TryExcept([Expr(Call(Attribute(Name('os', Load(), lineno=295, col_offset=8), 'unlink', Load(), lineno=295, col_offset=8), [Name('name', Load(), lineno=295, col_offset=18)], [], None, None, lineno=295, col_offset=8), lineno=295, col_offset=8)], [ExceptHandler(Name('OSError', Load(), lineno=296, col_offset=11), None, [Pass( lineno=297, col_offset=8)], lineno=296, col_offset=4)], [], lineno=294, col_offset=4), Assign([Name('ProductCode', Store(), lineno=298, col_offset=4)], Call(Attribute(Name('ProductCode', Load(), lineno=298, col_offset=18), 'upper', Load(), lineno=298, col_offset=18), [], [], None, None, lineno=298, col_offset=18), lineno=298, col_offset=4), Assign([Name('d', Store(), lineno=299, col_offset=4)], Call(Name('MakeInstaller', Load(), lineno=299, col_offset=8), [], [], None, None, lineno=299, col_offset=8), lineno=299, col_offset=4), Assign([Name('db', Store(), lineno=301, col_offset=4)], Call(Attribute(Name('d', Load(), lineno=301, col_offset=9), 'OpenDatabase', Load(), lineno=301, col_offset=9), [Name('name', Load(), lineno=301, col_offset=24), Attribute(Attribute(Attribute(Name('win32com', Load(), lineno=302, col_offset=9), 'client', Load(), lineno=302, col_offset=9), 'constants', Load(), lineno=302, col_offset=9), 'msiOpenDatabaseModeCreate', Load(), lineno=302, col_offset=9)], [], None, None, lineno=301, col_offset=9), lineno=301, col_offset=4), For(Name('t', Store(), lineno=304, col_offset=8), Attribute(Name('schema', Load(), lineno=304, col_offset=13), 'tables', Load(), lineno=304, col_offset=13), [Expr(Call(Attribute(Name('t', Load(), lineno=305, col_offset=8), 'create', Load(), lineno=305, col_offset=8), [Name('db', Load(), lineno=305, col_offset=17)], [], None, None, lineno=305, col_offset=8), lineno=305, col_offset=8)], [], lineno=304, col_offset=4), Expr(Call(Name('add_data', Load(), lineno=307, col_offset=4), [Name('db', Load(), lineno=307, col_offset=13), Str('_Validation', lineno=307, col_offset=17), Attribute(Name('schema', Load(), lineno=307, col_offset=32), '_Validation_records', Load(), lineno=307, col_offset=32)], [], None, None, lineno=307, col_offset=4), lineno=307, col_offset=4), Assign([Name('si', Store(), lineno=309, col_offset=4)], Call(Attribute(Name('db', Load(), lineno=309, col_offset=9), 'GetSummaryInformation', Load(), lineno=309, col_offset=9), [Num(20, lineno=309, col_offset=34)], [], None, None, lineno=309, col_offset=9), lineno=309, col_offset=4), Expr(Call(Attribute(Name('si', Load(), lineno=310, col_offset=4), 'SetProperty', Load(), lineno=310, col_offset=4), [Name('PID_TITLE', Load(), lineno=310, col_offset=19), Str('Installation Database', lineno=310, col_offset=30)], [], None, None, lineno=310, col_offset=4), lineno=310, col_offset=4), Expr(Call(Attribute(Name('si', Load(), lineno=311, col_offset=4), 'SetProperty', Load(), lineno=311, col_offset=4), [Name('PID_SUBJECT', Load(), lineno=311, col_offset=19), Name('ProductName', Load(), lineno=311, col_offset=32)], [], None, None, lineno=311, col_offset=4), lineno=311, col_offset=4), Expr(Call(Attribute(Name('si', Load(), lineno=312, col_offset=4), 'SetProperty', Load(), lineno=312, col_offset=4), [Name('PID_AUTHOR', Load(), lineno=312, col_offset=19), Name('Manufacturer', Load(), lineno=312, col_offset=31)], [], None, None, lineno=312, col_offset=4), lineno=312, col_offset=4), Expr(Call(Attribute(Name('si', Load(), lineno=313, col_offset=4), 'SetProperty', Load(), lineno=313, col_offset=4), [Name('PID_TEMPLATE', Load(), lineno=313, col_offset=19), Name('msi_type', Load(), lineno=313, col_offset=33)], [], None, None, lineno=313, col_offset=4), lineno=313, col_offset=4), Expr(Call(Attribute(Name('si', Load(), lineno=314, col_offset=4), 'SetProperty', Load(), lineno=314, col_offset=4), [Name('PID_REVNUMBER', Load(), lineno=314, col_offset=19), Call(Name('gen_uuid', Load(), lineno=314, col_offset=34), [], [], None, None, lineno=314, col_offset=34)], [], None, None, lineno=314, col_offset=4), lineno=314, col_offset=4), If(Name('request_uac', Load(), lineno=315, col_offset=7), [Assign([Name('wc', Store(), lineno=316, col_offset=8)], Num(2, lineno=316, col_offset=13), lineno=316, col_offset=8)], [Assign([Name('wc', Store(), lineno=318, col_offset=8)], BinOp(Num(2, lineno=318, col_offset=13), BitOr(), Num(8, lineno=318, col_offset=17), lineno=318, col_offset=13), lineno=318, col_offset=8)], lineno=315, col_offset=4), Expr(Call(Attribute(Name('si', Load(), lineno=319, col_offset=4), 'SetProperty', Load(), lineno=319, col_offset=4), [Name('PID_WORDCOUNT', Load(), lineno=319, col_offset=19), Name('wc', Load(), lineno=319, col_offset=34)], [], None, None, lineno=319, col_offset=4), lineno=319, col_offset=4), Expr(Call(Attribute(Name('si', Load(), lineno=320, col_offset=4), 'SetProperty', Load(), lineno=320, col_offset=4), [Name('PID_PAGECOUNT', Load(), lineno=320, col_offset=19), Num(200, lineno=320, col_offset=34)], [], None, None, lineno=320, col_offset=4), lineno=320, col_offset=4), Expr(Call(Attribute(Name('si', Load(), lineno=321, col_offset=4), 'SetProperty', Load(), lineno=321, col_offset=4), [Name('PID_APPNAME', Load(), lineno=321, col_offset=19), Str('Python MSI Library', lineno=321, col_offset=32)], [], None, None, lineno=321, col_offset=4), lineno=321, col_offset=4), Expr(Call(Attribute(Name('si', Load(), lineno=323, col_offset=4), 'Persist', Load(), lineno=323, col_offset=4), [], [], None, None, lineno=323, col_offset=4), lineno=323, col_offset=4), Expr(Call(Name('add_data', Load(), lineno=324, col_offset=4), [Name('db', Load(), lineno=324, col_offset=13), Str('Property', lineno=324, col_offset=17), List([Tuple([Str('ProductName', lineno=325, col_offset=9), Name('ProductName', Load(), lineno=325, col_offset=24)], Load(), lineno=325, col_offset=9), Tuple([Str('ProductCode', lineno=326, col_offset=9), Name('ProductCode', Load(), lineno=326, col_offset=24)], Load(), lineno=326, col_offset=9), Tuple([Str('ProductVersion', lineno=327, col_offset=9), Name('ProductVersion', Load(), lineno=327, col_offset=27)], Load(), lineno=327, col_offset=9), Tuple([Str('Manufacturer', lineno=328, col_offset=9), Name('Manufacturer', Load(), lineno=328, col_offset=25)], Load(), lineno=328, col_offset=9), Tuple([Str('ProductLanguage', lineno=329, col_offset=9), Str('1033', lineno=329, col_offset=28)], Load(), lineno=329, col_offset=9)], Load(), lineno=324, col_offset=29)], [], None, None, lineno=324, col_offset=4), lineno=324, col_offset=4), Expr(Call(Attribute(Name('db', Load(), lineno=330, col_offset=4), 'Commit', Load(), lineno=330, col_offset=4), [], [], None, None, lineno=330, col_offset=4), lineno=330, col_offset=4), Return(Name('db', Load(), lineno=331, col_offset=11), lineno=331, col_offset=4)], [], lineno=290, col_offset=0), FunctionDef('add_tables', arguments([Name('db', Param(), lineno=333, col_offset=15), Name('module', Param(), lineno=333, col_offset=19)], None, None, []), [For(Name('table', Store(), lineno=334, col_offset=8), Attribute(Name('module', Load(), lineno=334, col_offset=17), 'tables', Load(), lineno=334, col_offset=17), [Expr(Call(Name('add_data', Load(), lineno=335, col_offset=8), [Name('db', Load(), lineno=335, col_offset=17), Name('table', Load(), lineno=335, col_offset=21), Call(Name('getattr', Load(), lineno=335, col_offset=28), [Name('module', Load(), lineno=335, col_offset=36), Name('table', Load(), lineno=335, col_offset=44)], [], None, None, lineno=335, col_offset=28)], [], None, None, lineno=335, col_offset=8), lineno=335, col_offset=8)], [], lineno=334, col_offset=4)], [], lineno=333, col_offset=0), FunctionDef('make_id', arguments([Name('str', Param(), lineno=337, col_offset=12)], None, None, []), [Assign([Name('str', Store(), lineno=339, col_offset=4)], Call(Attribute(Name('str', Load(), lineno=339, col_offset=10), 'replace', Load(), lineno=339, col_offset=10), [Str(' ', lineno=339, col_offset=22), Str('_', lineno=339, col_offset=27)], [], None, None, lineno=339, col_offset=10), lineno=339, col_offset=4), Assign([Name('str', Store(), lineno=340, col_offset=4)], Call(Attribute(Name('str', Load(), lineno=340, col_offset=10), 'replace', Load(), lineno=340, col_offset=10), [Str('-', lineno=340, col_offset=22), Str('_', lineno=340, col_offset=27)], [], None, None, lineno=340, col_offset=10), lineno=340, col_offset=4), Assign([Name('str', Store(), lineno=341, col_offset=4)], Call(Attribute(Name('str', Load(), lineno=341, col_offset=10), 'replace', Load(), lineno=341, col_offset=10), [Str('+', lineno=341, col_offset=22), Str('_', lineno=341, col_offset=27)], [], None, None, lineno=341, col_offset=10), lineno=341, col_offset=4), If(Compare(Subscript(Name('str', Load(), lineno=342, col_offset=7), Index(Num(0, lineno=342, col_offset=11)), Load(), lineno=342, col_offset=7), [In()], [Attribute(Name('string', Load(), lineno=342, col_offset=17), 'digits', Load(), lineno=342, col_offset=17)], lineno=342, col_offset=7), [Assign([Name('str', Store(), lineno=343, col_offset=8)], BinOp(Str('_', lineno=343, col_offset=14), Add(), Name('str', Load(), lineno=343, col_offset=18), lineno=343, col_offset=14), lineno=343, col_offset=8)], [], lineno=342, col_offset=4), Assert(Call(Attribute(Name('re', Load(), lineno=344, col_offset=11), 'match', Load(), lineno=344, col_offset=11), [Str('^[A-Za-z_][A-Za-z0-9_.]*$', lineno=344, col_offset=20), Name('str', Load(), lineno=344, col_offset=49)], [], None, None, lineno=344, col_offset=11), BinOp(Str('FILE', lineno=344, col_offset=55), Add(), Name('str', Load(), lineno=344, col_offset=62), lineno=344, col_offset=55), lineno=344, col_offset=4), Return(Name('str', Load(), lineno=345, col_offset=11), lineno=345, col_offset=4)], [], lineno=337, col_offset=0), FunctionDef('gen_uuid', arguments([], None, None, []), [Return(Call(Name('str', Load(), lineno=348, col_offset=11), [Call(Attribute(Name('pythoncom', Load(), lineno=348, col_offset=15), 'CreateGuid', Load(), lineno=348, col_offset=15), [], [], None, None, lineno=348, col_offset=15)], [], None, None, lineno=348, col_offset=11), lineno=348, col_offset=4)], [], lineno=347, col_offset=0), ClassDef('CAB', [], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=351, col_offset=17), Name('name', Param(), lineno=351, col_offset=23)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=352, col_offset=8), 'name', Store(), lineno=352, col_offset=8)], Name('name', Load(), lineno=352, col_offset=20), lineno=352, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=353, col_offset=8), 'file', Store(), lineno=353, col_offset=8)], Call(Name('open', Load(), lineno=353, col_offset=20), [BinOp(Name('name', Load(), lineno=353, col_offset=25), Add(), Str('.txt', lineno=353, col_offset=30), lineno=353, col_offset=25), Str('wt', lineno=353, col_offset=38)], [], None, None, lineno=353, col_offset=20), lineno=353, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=354, col_offset=8), 'filenames', Store(), lineno=354, col_offset=8)], Call(Attribute(Name('sets', Load(), lineno=354, col_offset=25), 'Set', Load(), lineno=354, col_offset=25), [], [], None, None, lineno=354, col_offset=25), lineno=354, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=355, col_offset=8), 'index', Store(), lineno=355, col_offset=8)], Num(0, lineno=355, col_offset=21), lineno=355, col_offset=8)], [], lineno=351, col_offset=4), FunctionDef('gen_id', arguments([Name('self', Param(), lineno=357, col_offset=15), Name('dir', Param(), lineno=357, col_offset=21), Name('file', Param(), lineno=357, col_offset=26)], None, None, []), [Assign([Name('logical', Store(), lineno=358, col_offset=8), Name('_logical', Store(), lineno=358, col_offset=18)], Call(Name('make_id', Load(), lineno=358, col_offset=29), [Name('file', Load(), lineno=358, col_offset=37)], [], None, None, lineno=358, col_offset=29), lineno=358, col_offset=8), Assign([Name('pos', Store(), lineno=359, col_offset=8)], Num(1, lineno=359, col_offset=14), lineno=359, col_offset=8), While(Compare(Name('logical', Load(), lineno=360, col_offset=14), [In()], [Attribute(Name('self', Load(), lineno=360, col_offset=25), 'filenames', Load(), lineno=360, col_offset=25)], lineno=360, col_offset=14), [Assign([Name('logical', Store(), lineno=361, col_offset=12)], BinOp(Str('%s.%d', lineno=361, col_offset=22), Mod(), Tuple([Name('_logical', Load(), lineno=361, col_offset=33), Name('pos', Load(), lineno=361, col_offset=43)], Load(), lineno=361, col_offset=33), lineno=361, col_offset=22), lineno=361, col_offset=12), AugAssign(Name('pos', Store(), lineno=362, col_offset=12), Add(), Num(1, lineno=362, col_offset=19), lineno=362, col_offset=12)], [], lineno=360, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=363, col_offset=8), 'filenames', Load(), lineno=363, col_offset=8), 'add', Load(), lineno=363, col_offset=8), [Name('logical', Load(), lineno=363, col_offset=27)], [], None, None, lineno=363, col_offset=8), lineno=363, col_offset=8), Return(Name('logical', Load(), lineno=364, col_offset=15), lineno=364, col_offset=8)], [], lineno=357, col_offset=4), FunctionDef('append', arguments([Name('self', Param(), lineno=366, col_offset=15), Name('full', Param(), lineno=366, col_offset=21), Name('file', Param(), lineno=366, col_offset=27), Name('logical', Param(), lineno=366, col_offset=33)], None, None, [Name('None', Load(), lineno=366, col_offset=43)]), [If(Call(Attribute(Attribute(Name('os', Load(), lineno=367, col_offset=11), 'path', Load(), lineno=367, col_offset=11), 'isdir', Load(), lineno=367, col_offset=11), [Name('full', Load(), lineno=367, col_offset=25)], [], None, None, lineno=367, col_offset=11), [Return(None, lineno=368, col_offset=12)], [], lineno=367, col_offset=8), If(UnaryOp(Not(), Name('logical', Load(), lineno=369, col_offset=15), lineno=369, col_offset=11), [Assign([Name('logical', Store(), lineno=370, col_offset=12)], Call(Attribute(Name('self', Load(), lineno=370, col_offset=22), 'gen_id', Load(), lineno=370, col_offset=22), [Name('dir', Load(), lineno=370, col_offset=34), Name('file', Load(), lineno=370, col_offset=39)], [], None, None, lineno=370, col_offset=22), lineno=370, col_offset=12)], [], lineno=369, col_offset=8), AugAssign(Attribute(Name('self', Load(), lineno=371, col_offset=8), 'index', Store(), lineno=371, col_offset=8), Add(), Num(1, lineno=371, col_offset=22), lineno=371, col_offset=8), If(Compare(Call(Attribute(Name('full', Load(), lineno=372, col_offset=11), 'find', Load(), lineno=372, col_offset=11), [Str(' ', lineno=372, col_offset=21)], [], None, None, lineno=372, col_offset=11), [NotEq()], [Num(-1, lineno=372, col_offset=28)], lineno=372, col_offset=11), [Print(Attribute(Name('self', Load(), lineno=373, col_offset=20), 'file', Load(), lineno=373, col_offset=20), [BinOp(Str('"%s" %s', lineno=373, col_offset=31), Mod(), Tuple([Name('full', Load(), lineno=373, col_offset=44), Name('logical', Load(), lineno=373, col_offset=50)], Load(), lineno=373, col_offset=44), lineno=373, col_offset=31)], True, lineno=373, col_offset=12)], [Print(Attribute(Name('self', Load(), lineno=375, col_offset=20), 'file', Load(), lineno=375, col_offset=20), [BinOp(Str('%s %s', lineno=375, col_offset=31), Mod(), Tuple([Name('full', Load(), lineno=375, col_offset=42), Name('logical', Load(), lineno=375, col_offset=48)], Load(), lineno=375, col_offset=42), lineno=375, col_offset=31)], True, lineno=375, col_offset=12)], lineno=372, col_offset=8), Return(Tuple([Attribute(Name('self', Load(), lineno=376, col_offset=15), 'index', Load(), lineno=376, col_offset=15), Name('logical', Load(), lineno=376, col_offset=27)], Load(), lineno=376, col_offset=15), lineno=376, col_offset=8)], [], lineno=366, col_offset=4), FunctionDef('commit', arguments([Name('self', Param(), lineno=378, col_offset=15), Name('db', Param(), lineno=378, col_offset=21)], None, None, []), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=379, col_offset=8), 'file', Load(), lineno=379, col_offset=8), 'close', Load(), lineno=379, col_offset=8), [], [], None, None, lineno=379, col_offset=8), lineno=379, col_offset=8), TryExcept([Expr(Call(Attribute(Name('os', Load(), lineno=381, col_offset=12), 'unlink', Load(), lineno=381, col_offset=12), [BinOp(Attribute(Name('self', Load(), lineno=381, col_offset=22), 'name', Load(), lineno=381, col_offset=22), Add(), Str('.cab', lineno=381, col_offset=32), lineno=381, col_offset=22)], [], None, None, lineno=381, col_offset=12), lineno=381, col_offset=12)], [ExceptHandler(Name('OSError', Load(), lineno=382, col_offset=15), None, [Pass( lineno=383, col_offset=12)], lineno=382, col_offset=8)], [], lineno=380, col_offset=8), For(Tuple([Name('k', Store(), lineno=384, col_offset=12), Name('v', Store(), lineno=384, col_offset=15)], Store(), lineno=384, col_offset=12), List([Tuple([Str('Software\\Microsoft\\VisualStudio\\7.1\\Setup\\VS', lineno=384, col_offset=22), Str('VS7CommonBinDir', lineno=384, col_offset=71)], Load(), lineno=384, col_offset=22), Tuple([Str('Software\\Microsoft\\VisualStudio\\8.0\\Setup\\VS', lineno=385, col_offset=22), Str('VS7CommonBinDir', lineno=385, col_offset=71)], Load(), lineno=385, col_offset=22), Tuple([Str('Software\\Microsoft\\VisualStudio\\9.0\\Setup\\VS', lineno=386, col_offset=22), Str('VS7CommonBinDir', lineno=386, col_offset=71)], Load(), lineno=386, col_offset=22), Tuple([Str('Software\\Microsoft\\Win32SDK\\Directories', lineno=387, col_offset=22), Str('Install Dir', lineno=387, col_offset=66)], Load(), lineno=387, col_offset=22)], Load(), lineno=384, col_offset=20), [TryExcept([Assign([Name('key', Store(), lineno=390, col_offset=16)], Call(Attribute(Name('_winreg', Load(), lineno=390, col_offset=22), 'OpenKey', Load(), lineno=390, col_offset=22), [Attribute(Name('_winreg', Load(), lineno=390, col_offset=38), 'HKEY_LOCAL_MACHINE', Load(), lineno=390, col_offset=38), Name('k', Load(), lineno=390, col_offset=66)], [], None, None, lineno=390, col_offset=22), lineno=390, col_offset=16), Assign([Name('dir', Store(), lineno=391, col_offset=16)], Subscript(Call(Attribute(Name('_winreg', Load(), lineno=391, col_offset=22), 'QueryValueEx', Load(), lineno=391, col_offset=22), [Name('key', Load(), lineno=391, col_offset=43), Name('v', Load(), lineno=391, col_offset=48)], [], None, None, lineno=391, col_offset=22), Index(Num(0, lineno=391, col_offset=51)), Load(), lineno=391, col_offset=22), lineno=391, col_offset=16), Expr(Call(Attribute(Name('_winreg', Load(), lineno=392, col_offset=16), 'CloseKey', Load(), lineno=392, col_offset=16), [Name('key', Load(), lineno=392, col_offset=33)], [], None, None, lineno=392, col_offset=16), lineno=392, col_offset=16)], [ExceptHandler(Tuple([Name('WindowsError', Load(), lineno=393, col_offset=20), Name('IndexError', Load(), lineno=393, col_offset=34)], Load(), lineno=393, col_offset=20), None, [Continue( lineno=394, col_offset=16)], lineno=393, col_offset=12)], [], lineno=389, col_offset=12), Assign([Name('cabarc', Store(), lineno=395, col_offset=12)], Call(Attribute(Attribute(Name('os', Load(), lineno=395, col_offset=21), 'path', Load(), lineno=395, col_offset=21), 'join', Load(), lineno=395, col_offset=21), [Name('dir', Load(), lineno=395, col_offset=34), Str('Bin', lineno=395, col_offset=39), Str('cabarc.exe', lineno=395, col_offset=47)], [], None, None, lineno=395, col_offset=21), lineno=395, col_offset=12), If(UnaryOp(Not(), Call(Attribute(Attribute(Name('os', Load(), lineno=396, col_offset=19), 'path', Load(), lineno=396, col_offset=19), 'exists', Load(), lineno=396, col_offset=19), [Name('cabarc', Load(), lineno=396, col_offset=34)], [], None, None, lineno=396, col_offset=19), lineno=396, col_offset=15), [Continue( lineno=397, col_offset=16)], [], lineno=396, col_offset=12), Break( lineno=398, col_offset=12)], [Print(None, [Str('WARNING: cabarc.exe not found in registry', lineno=400, col_offset=18)], True, lineno=400, col_offset=12), Assign([Name('cabarc', Store(), lineno=401, col_offset=12)], Str('cabarc.exe', lineno=401, col_offset=21), lineno=401, col_offset=12)], lineno=384, col_offset=8), Assign([Name('cmd', Store(), lineno=402, col_offset=8)], BinOp(Str('"%s" -m lzx:21 n %s.cab @%s.txt', lineno=402, col_offset=14), Mod(), Tuple([Name('cabarc', Load(), lineno=402, col_offset=52), Attribute(Name('self', Load(), lineno=402, col_offset=60), 'name', Load(), lineno=402, col_offset=60), Attribute(Name('self', Load(), lineno=402, col_offset=71), 'name', Load(), lineno=402, col_offset=71)], Load(), lineno=402, col_offset=52), lineno=402, col_offset=14), lineno=402, col_offset=8), Assign([Name('p', Store(), lineno=403, col_offset=8)], Call(Attribute(Name('subprocess', Load(), lineno=403, col_offset=12), 'Popen', Load(), lineno=403, col_offset=12), [Name('cmd', Load(), lineno=403, col_offset=29)], [keyword('shell', Name('True', Load(), lineno=403, col_offset=40)), keyword('stdin', Attribute(Name('subprocess', Load(), lineno=403, col_offset=52), 'PIPE', Load(), lineno=403, col_offset=52)), keyword('stdout', Attribute(Name('subprocess', Load(), lineno=404, col_offset=36), 'PIPE', Load(), lineno=404, col_offset=36)), keyword('stderr', Attribute(Name('subprocess', Load(), lineno=404, col_offset=60), 'STDOUT', Load(), lineno=404, col_offset=60))], None, None, lineno=403, col_offset=12), lineno=403, col_offset=8), For(Name('line', Store(), lineno=405, col_offset=12), Attribute(Name('p', Load(), lineno=405, col_offset=20), 'stdout', Load(), lineno=405, col_offset=20), [If(Call(Attribute(Name('line', Load(), lineno=406, col_offset=15), 'startswith', Load(), lineno=406, col_offset=15), [Str('  -- adding ', lineno=406, col_offset=31)], [], None, None, lineno=406, col_offset=15), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=407, col_offset=16), 'stdout', Load(), lineno=407, col_offset=16), 'write', Load(), lineno=407, col_offset=16), [Str('.', lineno=407, col_offset=33)], [], None, None, lineno=407, col_offset=16), lineno=407, col_offset=16)], [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=409, col_offset=16), 'stdout', Load(), lineno=409, col_offset=16), 'write', Load(), lineno=409, col_offset=16), [Name('line', Load(), lineno=409, col_offset=33)], [], None, None, lineno=409, col_offset=16), lineno=409, col_offset=16)], lineno=406, col_offset=12), Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=410, col_offset=12), 'stdout', Load(), lineno=410, col_offset=12), 'flush', Load(), lineno=410, col_offset=12), [], [], None, None, lineno=410, col_offset=12), lineno=410, col_offset=12)], [], lineno=405, col_offset=8), If(UnaryOp(Not(), Call(Attribute(Attribute(Name('os', Load(), lineno=411, col_offset=15), 'path', Load(), lineno=411, col_offset=15), 'exists', Load(), lineno=411, col_offset=15), [BinOp(Attribute(Name('self', Load(), lineno=411, col_offset=30), 'name', Load(), lineno=411, col_offset=30), Add(), Str('.cab', lineno=411, col_offset=40), lineno=411, col_offset=30)], [], None, None, lineno=411, col_offset=15), lineno=411, col_offset=11), [Raise(Name('IOError', Load(), lineno=412, col_offset=18), Str('cabarc failed', lineno=412, col_offset=27), None, lineno=412, col_offset=12)], [], lineno=411, col_offset=8), Expr(Call(Name('add_data', Load(), lineno=413, col_offset=8), [Name('db', Load(), lineno=413, col_offset=17), Str('Media', lineno=413, col_offset=21), List([Tuple([Num(1, lineno=414, col_offset=18), Attribute(Name('self', Load(), lineno=414, col_offset=21), 'index', Load(), lineno=414, col_offset=21), Name('None', Load(), lineno=414, col_offset=33), BinOp(Str('#', lineno=414, col_offset=39), Add(), Attribute(Name('self', Load(), lineno=414, col_offset=43), 'name', Load(), lineno=414, col_offset=43), lineno=414, col_offset=39), Name('None', Load(), lineno=414, col_offset=54), Name('None', Load(), lineno=414, col_offset=60)], Load(), lineno=414, col_offset=18)], Load(), lineno=414, col_offset=16)], [], None, None, lineno=413, col_offset=8), lineno=413, col_offset=8), Expr(Call(Name('add_stream', Load(), lineno=415, col_offset=8), [Name('db', Load(), lineno=415, col_offset=19), Attribute(Name('self', Load(), lineno=415, col_offset=23), 'name', Load(), lineno=415, col_offset=23), BinOp(Attribute(Name('self', Load(), lineno=415, col_offset=34), 'name', Load(), lineno=415, col_offset=34), Add(), Str('.cab', lineno=415, col_offset=44), lineno=415, col_offset=34)], [], None, None, lineno=415, col_offset=8), lineno=415, col_offset=8), Expr(Call(Attribute(Name('os', Load(), lineno=416, col_offset=8), 'unlink', Load(), lineno=416, col_offset=8), [BinOp(Attribute(Name('self', Load(), lineno=416, col_offset=18), 'name', Load(), lineno=416, col_offset=18), Add(), Str('.txt', lineno=416, col_offset=28), lineno=416, col_offset=18)], [], None, None, lineno=416, col_offset=8), lineno=416, col_offset=8), Expr(Call(Attribute(Name('os', Load(), lineno=417, col_offset=8), 'unlink', Load(), lineno=417, col_offset=8), [BinOp(Attribute(Name('self', Load(), lineno=417, col_offset=18), 'name', Load(), lineno=417, col_offset=18), Add(), Str('.cab', lineno=417, col_offset=28), lineno=417, col_offset=18)], [], None, None, lineno=417, col_offset=8), lineno=417, col_offset=8), Expr(Call(Attribute(Name('db', Load(), lineno=418, col_offset=8), 'Commit', Load(), lineno=418, col_offset=8), [], [], None, None, lineno=418, col_offset=8), lineno=418, col_offset=8)], [], lineno=378, col_offset=4)], [], lineno=350, col_offset=0), Assign([Name('_directories', Store(), lineno=420, col_offset=0)], Call(Attribute(Name('sets', Load(), lineno=420, col_offset=15), 'Set', Load(), lineno=420, col_offset=15), [], [], None, None, lineno=420, col_offset=15), lineno=420, col_offset=0), ClassDef('Directory', [], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=422, col_offset=17), Name('db', Param(), lineno=422, col_offset=23), Name('cab', Param(), lineno=422, col_offset=27), Name('basedir', Param(), lineno=422, col_offset=32), Name('physical', Param(), lineno=422, col_offset=41), Name('_logical', Param(), lineno=422, col_offset=51), Name('default', Param(), lineno=422, col_offset=61), Name('componentflags', Param(), lineno=422, col_offset=70)], None, None, [Name('None', Load(), lineno=422, col_offset=85)]), [Expr(Str('Create a new directory in the Directory table. There is a current component\n        at each point in time for the directory, which is either explicitly created\n        through start_component, or implicitly when files are added for the first\n        time. Files are added into the current component, and into the cab file.\n        To create a directory, a base directory object needs to be specified (can be\n        None), the path to the physical directory, and a logical directory name.\n        Default specifies the DefaultDir slot in the directory table. componentflags\n        specifies the default flags that new components get.', lineno=430, col_offset=-1), lineno=430, col_offset=-1), Assign([Name('index', Store(), lineno=431, col_offset=8)], Num(1, lineno=431, col_offset=16), lineno=431, col_offset=8), Assign([Name('_logical', Store(), lineno=432, col_offset=8)], Call(Name('make_id', Load(), lineno=432, col_offset=19), [Name('_logical', Load(), lineno=432, col_offset=27)], [], None, None, lineno=432, col_offset=19), lineno=432, col_offset=8), Assign([Name('logical', Store(), lineno=433, col_offset=8)], Name('_logical', Load(), lineno=433, col_offset=18), lineno=433, col_offset=8), While(Compare(Name('logical', Load(), lineno=434, col_offset=14), [In()], [Name('_directories', Load(), lineno=434, col_offset=25)], lineno=434, col_offset=14), [Assign([Name('logical', Store(), lineno=435, col_offset=12)], BinOp(Str('%s%d', lineno=435, col_offset=22), Mod(), Tuple([Name('_logical', Load(), lineno=435, col_offset=32), Name('index', Load(), lineno=435, col_offset=42)], Load(), lineno=435, col_offset=32), lineno=435, col_offset=22), lineno=435, col_offset=12), AugAssign(Name('index', Store(), lineno=436, col_offset=12), Add(), Num(1, lineno=436, col_offset=21), lineno=436, col_offset=12)], [], lineno=434, col_offset=8), Expr(Call(Attribute(Name('_directories', Load(), lineno=437, col_offset=8), 'add', Load(), lineno=437, col_offset=8), [Name('logical', Load(), lineno=437, col_offset=25)], [], None, None, lineno=437, col_offset=8), lineno=437, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=438, col_offset=8), 'db', Store(), lineno=438, col_offset=8)], Name('db', Load(), lineno=438, col_offset=18), lineno=438, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=439, col_offset=8), 'cab', Store(), lineno=439, col_offset=8)], Name('cab', Load(), lineno=439, col_offset=19), lineno=439, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=440, col_offset=8), 'basedir', Store(), lineno=440, col_offset=8)], Name('basedir', Load(), lineno=440, col_offset=23), lineno=440, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=441, col_offset=8), 'physical', Store(), lineno=441, col_offset=8)], Name('physical', Load(), lineno=441, col_offset=24), lineno=441, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=442, col_offset=8), 'logical', Store(), lineno=442, col_offset=8)], Name('logical', Load(), lineno=442, col_offset=23), lineno=442, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=443, col_offset=8), 'component', Store(), lineno=443, col_offset=8)], Name('None', Load(), lineno=443, col_offset=25), lineno=443, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=444, col_offset=8), 'short_names', Store(), lineno=444, col_offset=8)], Call(Attribute(Name('sets', Load(), lineno=444, col_offset=27), 'Set', Load(), lineno=444, col_offset=27), [], [], None, None, lineno=444, col_offset=27), lineno=444, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=445, col_offset=8), 'ids', Store(), lineno=445, col_offset=8)], Call(Attribute(Name('sets', Load(), lineno=445, col_offset=19), 'Set', Load(), lineno=445, col_offset=19), [], [], None, None, lineno=445, col_offset=19), lineno=445, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=446, col_offset=8), 'keyfiles', Store(), lineno=446, col_offset=8)], Dict([], [], lineno=446, col_offset=24), lineno=446, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=447, col_offset=8), 'componentflags', Store(), lineno=447, col_offset=8)], Name('componentflags', Load(), lineno=447, col_offset=30), lineno=447, col_offset=8), If(Name('basedir', Load(), lineno=448, col_offset=11), [Assign([Attribute(Name('self', Load(), lineno=449, col_offset=12), 'absolute', Store(), lineno=449, col_offset=12)], Call(Attribute(Attribute(Name('os', Load(), lineno=449, col_offset=28), 'path', Load(), lineno=449, col_offset=28), 'join', Load(), lineno=449, col_offset=28), [Attribute(Name('basedir', Load(), lineno=449, col_offset=41), 'absolute', Load(), lineno=449, col_offset=41), Name('physical', Load(), lineno=449, col_offset=59)], [], None, None, lineno=449, col_offset=28), lineno=449, col_offset=12), Assign([Name('blogical', Store(), lineno=450, col_offset=12)], Attribute(Name('basedir', Load(), lineno=450, col_offset=23), 'logical', Load(), lineno=450, col_offset=23), lineno=450, col_offset=12)], [Assign([Attribute(Name('self', Load(), lineno=452, col_offset=12), 'absolute', Store(), lineno=452, col_offset=12)], Name('physical', Load(), lineno=452, col_offset=28), lineno=452, col_offset=12), Assign([Name('blogical', Store(), lineno=453, col_offset=12)], Name('None', Load(), lineno=453, col_offset=23), lineno=453, col_offset=12)], lineno=448, col_offset=8), Expr(Call(Name('add_data', Load(), lineno=454, col_offset=8), [Name('db', Load(), lineno=454, col_offset=17), Str('Directory', lineno=454, col_offset=21), List([Tuple([Name('logical', Load(), lineno=454, col_offset=36), Name('blogical', Load(), lineno=454, col_offset=45), Name('default', Load(), lineno=454, col_offset=55)], Load(), lineno=454, col_offset=36)], Load(), lineno=454, col_offset=34)], [], None, None, lineno=454, col_offset=8), lineno=454, col_offset=8)], [], lineno=422, col_offset=4), FunctionDef('start_component', arguments([Name('self', Param(), lineno=456, col_offset=24), Name('component', Param(), lineno=456, col_offset=30), Name('feature', Param(), lineno=456, col_offset=48), Name('flags', Param(), lineno=456, col_offset=64), Name('keyfile', Param(), lineno=456, col_offset=78), Name('uuid', Param(), lineno=456, col_offset=94)], None, None, [Name('None', Load(), lineno=456, col_offset=42), Name('None', Load(), lineno=456, col_offset=58), Name('None', Load(), lineno=456, col_offset=72), Name('None', Load(), lineno=456, col_offset=88), Name('None', Load(), lineno=456, col_offset=99)]), [Expr(Str("Add an entry to the Component table, and make this component the current for this\n        directory. If no component name is given, the directory name is used. If no feature\n        is given, the current feature is used. If no flags are given, the directory's default\n        flags are used. If no keyfile is given, the KeyPath is left null in the Component\n        table.", lineno=461, col_offset=-1), lineno=461, col_offset=-1), If(Compare(Name('flags', Load(), lineno=462, col_offset=11), [Is()], [Name('None', Load(), lineno=462, col_offset=20)], lineno=462, col_offset=11), [Assign([Name('flags', Store(), lineno=463, col_offset=12)], Attribute(Name('self', Load(), lineno=463, col_offset=20), 'componentflags', Load(), lineno=463, col_offset=20), lineno=463, col_offset=12)], [], lineno=462, col_offset=8), If(Compare(Name('uuid', Load(), lineno=464, col_offset=11), [Is()], [Name('None', Load(), lineno=464, col_offset=19)], lineno=464, col_offset=11), [Assign([Name('uuid', Store(), lineno=465, col_offset=12)], Call(Name('gen_uuid', Load(), lineno=465, col_offset=19), [], [], None, None, lineno=465, col_offset=19), lineno=465, col_offset=12)], [Assign([Name('uuid', Store(), lineno=467, col_offset=12)], Call(Attribute(Name('uuid', Load(), lineno=467, col_offset=19), 'upper', Load(), lineno=467, col_offset=19), [], [], None, None, lineno=467, col_offset=19), lineno=467, col_offset=12)], lineno=464, col_offset=8), If(Compare(Name('component', Load(), lineno=468, col_offset=11), [Is()], [Name('None', Load(), lineno=468, col_offset=24)], lineno=468, col_offset=11), [Assign([Name('component', Store(), lineno=469, col_offset=12)], Attribute(Name('self', Load(), lineno=469, col_offset=24), 'logical', Load(), lineno=469, col_offset=24), lineno=469, col_offset=12)], [], lineno=468, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=470, col_offset=8), 'component', Store(), lineno=470, col_offset=8)], Name('component', Load(), lineno=470, col_offset=25), lineno=470, col_offset=8), If(Name('Win64', Load(), lineno=471, col_offset=11), [AugAssign(Name('flags', Store(), lineno=472, col_offset=12), BitOr(), Num(256, lineno=472, col_offset=21), lineno=472, col_offset=12)], [], lineno=471, col_offset=8), If(Name('keyfile', Load(), lineno=473, col_offset=11), [Assign([Name('keyid', Store(), lineno=474, col_offset=12)], Call(Attribute(Attribute(Name('self', Load(), lineno=474, col_offset=20), 'cab', Load(), lineno=474, col_offset=20), 'gen_id', Load(), lineno=474, col_offset=20), [Attribute(Name('self', Load(), lineno=474, col_offset=36), 'absolute', Load(), lineno=474, col_offset=36), Name('keyfile', Load(), lineno=474, col_offset=51)], [], None, None, lineno=474, col_offset=20), lineno=474, col_offset=12), Assign([Subscript(Attribute(Name('self', Load(), lineno=475, col_offset=12), 'keyfiles', Load(), lineno=475, col_offset=12), Index(Name('keyfile', Load(), lineno=475, col_offset=26)), Store(), lineno=475, col_offset=12)], Name('keyid', Load(), lineno=475, col_offset=37), lineno=475, col_offset=12)], [Assign([Name('keyid', Store(), lineno=477, col_offset=12)], Name('None', Load(), lineno=477, col_offset=20), lineno=477, col_offset=12)], lineno=473, col_offset=8), Expr(Call(Name('add_data', Load(), lineno=478, col_offset=8), [Attribute(Name('self', Load(), lineno=478, col_offset=17), 'db', Load(), lineno=478, col_offset=17), Str('Component', lineno=478, col_offset=26), List([Tuple([Name('component', Load(), lineno=479, col_offset=26), Name('uuid', Load(), lineno=479, col_offset=37), Attribute(Name('self', Load(), lineno=479, col_offset=43), 'logical', Load(), lineno=479, col_offset=43), Name('flags', Load(), lineno=479, col_offset=57), Name('None', Load(), lineno=479, col_offset=64), Name('keyid', Load(), lineno=479, col_offset=70)], Load(), lineno=479, col_offset=26)], Load(), lineno=479, col_offset=24)], [], None, None, lineno=478, col_offset=8), lineno=478, col_offset=8), If(Compare(Name('feature', Load(), lineno=480, col_offset=11), [Is()], [Name('None', Load(), lineno=480, col_offset=22)], lineno=480, col_offset=11), [Assign([Name('feature', Store(), lineno=481, col_offset=12)], Name('current_feature', Load(), lineno=481, col_offset=22), lineno=481, col_offset=12)], [], lineno=480, col_offset=8), Expr(Call(Name('add_data', Load(), lineno=482, col_offset=8), [Attribute(Name('self', Load(), lineno=482, col_offset=17), 'db', Load(), lineno=482, col_offset=17), Str('FeatureComponents', lineno=482, col_offset=26), List([Tuple([Attribute(Name('feature', Load(), lineno=483, col_offset=26), 'id', Load(), lineno=483, col_offset=26), Name('component', Load(), lineno=483, col_offset=38)], Load(), lineno=483, col_offset=26)], Load(), lineno=483, col_offset=24)], [], None, None, lineno=482, col_offset=8), lineno=482, col_offset=8)], [], lineno=456, col_offset=4), FunctionDef('make_short', arguments([Name('self', Param(), lineno=485, col_offset=19), Name('file', Param(), lineno=485, col_offset=25)], None, None, []), [Assign([Name('file', Store(), lineno=486, col_offset=8)], Call(Attribute(Name('re', Load(), lineno=486, col_offset=15), 'sub', Load(), lineno=486, col_offset=15), [Str('[\\?|><:/*"+,;=\\[\\]]', lineno=486, col_offset=22), Str('_', lineno=486, col_offset=46), Name('file', Load(), lineno=486, col_offset=51)], [], None, None, lineno=486, col_offset=15), lineno=486, col_offset=8), Assign([Name('parts', Store(), lineno=487, col_offset=8)], Call(Attribute(Name('file', Load(), lineno=487, col_offset=16), 'split', Load(), lineno=487, col_offset=16), [Str('.', lineno=487, col_offset=27)], [], None, None, lineno=487, col_offset=16), lineno=487, col_offset=8), If(Compare(Call(Name('len', Load(), lineno=488, col_offset=11), [Name('parts', Load(), lineno=488, col_offset=15)], [], None, None, lineno=488, col_offset=11), [Gt()], [Num(1, lineno=488, col_offset=22)], lineno=488, col_offset=11), [Assign([Name('suffix', Store(), lineno=489, col_offset=12)], Call(Attribute(Subscript(Name('parts', Load(), lineno=489, col_offset=21), Index(Num(-1, lineno=489, col_offset=28)), Load(), lineno=489, col_offset=21), 'upper', Load(), lineno=489, col_offset=21), [], [], None, None, lineno=489, col_offset=21), lineno=489, col_offset=12)], [Assign([Name('suffix', Store(), lineno=491, col_offset=12)], Name('None', Load(), lineno=491, col_offset=21), lineno=491, col_offset=12)], lineno=488, col_offset=8), Assign([Name('prefix', Store(), lineno=492, col_offset=8)], Call(Attribute(Subscript(Name('parts', Load(), lineno=492, col_offset=17), Index(Num(0, lineno=492, col_offset=23)), Load(), lineno=492, col_offset=17), 'upper', Load(), lineno=492, col_offset=17), [], [], None, None, lineno=492, col_offset=17), lineno=492, col_offset=8), If(BoolOp(And(), [Compare(Call(Name('len', Load(), lineno=493, col_offset=11), [Name('prefix', Load(), lineno=493, col_offset=15)], [], None, None, lineno=493, col_offset=11), [LtE()], [Num(8, lineno=493, col_offset=26)], lineno=493, col_offset=11), BoolOp(Or(), [UnaryOp(Not(), Name('suffix', Load(), lineno=493, col_offset=37), lineno=493, col_offset=33), Compare(Call(Name('len', Load(), lineno=493, col_offset=47), [Name('suffix', Load(), lineno=493, col_offset=51)], [], None, None, lineno=493, col_offset=47), [LtE()], [Num(3, lineno=493, col_offset=60)], lineno=493, col_offset=47)], lineno=493, col_offset=33)], lineno=493, col_offset=11), [If(Name('suffix', Load(), lineno=494, col_offset=15), [Assign([Name('file', Store(), lineno=495, col_offset=16)], BinOp(BinOp(Name('prefix', Load(), lineno=495, col_offset=23), Add(), Str('.', lineno=495, col_offset=30), lineno=495, col_offset=23), Add(), Name('suffix', Load(), lineno=495, col_offset=34), lineno=495, col_offset=33), lineno=495, col_offset=16)], [Assign([Name('file', Store(), lineno=497, col_offset=16)], Name('prefix', Load(), lineno=497, col_offset=23), lineno=497, col_offset=16)], lineno=494, col_offset=12), Assert(Compare(Name('file', Load(), lineno=498, col_offset=19), [NotIn()], [Attribute(Name('self', Load(), lineno=498, col_offset=31), 'short_names', Load(), lineno=498, col_offset=31)], lineno=498, col_offset=19), None, lineno=498, col_offset=12)], [Assign([Name('prefix', Store(), lineno=500, col_offset=12)], Subscript(Name('prefix', Load(), lineno=500, col_offset=21), Slice(None, Num(6, lineno=500, col_offset=29), None), Load(), lineno=500, col_offset=21), lineno=500, col_offset=12), If(Name('suffix', Load(), lineno=501, col_offset=15), [Assign([Name('suffix', Store(), lineno=502, col_offset=16)], Subscript(Name('suffix', Load(), lineno=502, col_offset=25), Slice(None, Num(3, lineno=502, col_offset=33), None), Load(), lineno=502, col_offset=25), lineno=502, col_offset=16)], [], lineno=501, col_offset=12), Assign([Name('pos', Store(), lineno=503, col_offset=12)], Num(1, lineno=503, col_offset=18), lineno=503, col_offset=12), While(Num(1, lineno=504, col_offset=18), [If(Name('suffix', Load(), lineno=505, col_offset=19), [Assign([Name('file', Store(), lineno=506, col_offset=20)], BinOp(Str('%s~%d.%s', lineno=506, col_offset=27), Mod(), Tuple([Name('prefix', Load(), lineno=506, col_offset=41), Name('pos', Load(), lineno=506, col_offset=49), Name('suffix', Load(), lineno=506, col_offset=54)], Load(), lineno=506, col_offset=41), lineno=506, col_offset=27), lineno=506, col_offset=20)], [Assign([Name('file', Store(), lineno=508, col_offset=20)], BinOp(Str('%s~%d', lineno=508, col_offset=27), Mod(), Tuple([Name('prefix', Load(), lineno=508, col_offset=38), Name('pos', Load(), lineno=508, col_offset=46)], Load(), lineno=508, col_offset=38), lineno=508, col_offset=27), lineno=508, col_offset=20)], lineno=505, col_offset=16), If(Compare(Name('file', Load(), lineno=509, col_offset=19), [NotIn()], [Attribute(Name('self', Load(), lineno=509, col_offset=31), 'short_names', Load(), lineno=509, col_offset=31)], lineno=509, col_offset=19), [Break( lineno=509, col_offset=49)], [], lineno=509, col_offset=16), AugAssign(Name('pos', Store(), lineno=510, col_offset=16), Add(), Num(1, lineno=510, col_offset=23), lineno=510, col_offset=16), Assert(Compare(Name('pos', Load(), lineno=511, col_offset=23), [Lt()], [Num(10000, lineno=511, col_offset=29)], lineno=511, col_offset=23), None, lineno=511, col_offset=16), If(Compare(Name('pos', Load(), lineno=512, col_offset=19), [In()], [Tuple([Num(10, lineno=512, col_offset=27), Num(100, lineno=512, col_offset=31), Num(1000, lineno=512, col_offset=36)], Load(), lineno=512, col_offset=27)], lineno=512, col_offset=19), [Assign([Name('prefix', Store(), lineno=513, col_offset=20)], Subscript(Name('prefix', Load(), lineno=513, col_offset=29), Slice(None, Num(-1, lineno=513, col_offset=38), None), Load(), lineno=513, col_offset=29), lineno=513, col_offset=20)], [], lineno=512, col_offset=16)], [], lineno=504, col_offset=12)], lineno=493, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=514, col_offset=8), 'short_names', Load(), lineno=514, col_offset=8), 'add', Load(), lineno=514, col_offset=8), [Name('file', Load(), lineno=514, col_offset=29)], [], None, None, lineno=514, col_offset=8), lineno=514, col_offset=8), Return(Name('file', Load(), lineno=515, col_offset=15), lineno=515, col_offset=8)], [], lineno=485, col_offset=4), FunctionDef('add_file', arguments([Name('self', Param(), lineno=517, col_offset=17), Name('file', Param(), lineno=517, col_offset=23), Name('src', Param(), lineno=517, col_offset=29), Name('version', Param(), lineno=517, col_offset=39), Name('language', Param(), lineno=517, col_offset=53)], None, None, [Name('None', Load(), lineno=517, col_offset=33), Name('None', Load(), lineno=517, col_offset=47), Name('None', Load(), lineno=517, col_offset=62)]), [Expr(Str('Add a file to the current component of the directory, starting a new one\n        one if there is no current component. By default, the file name in the source\n        and the file table will be identical. If the src file is specified, it is\n        interpreted relative to the current directory. Optionally, a version and a\n        language can be specified for the entry in the File table.', lineno=522, col_offset=-1), lineno=522, col_offset=-1), If(UnaryOp(Not(), Attribute(Name('self', Load(), lineno=523, col_offset=15), 'component', Load(), lineno=523, col_offset=15), lineno=523, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=524, col_offset=12), 'start_component', Load(), lineno=524, col_offset=12), [Attribute(Name('self', Load(), lineno=524, col_offset=33), 'logical', Load(), lineno=524, col_offset=33), Name('current_feature', Load(), lineno=524, col_offset=47)], [], None, None, lineno=524, col_offset=12), lineno=524, col_offset=12)], [], lineno=523, col_offset=8), If(UnaryOp(Not(), Name('src', Load(), lineno=525, col_offset=15), lineno=525, col_offset=11), [Assign([Name('src', Store(), lineno=527, col_offset=12)], Name('file', Load(), lineno=527, col_offset=18), lineno=527, col_offset=12), Assign([Name('file', Store(), lineno=528, col_offset=12)], Call(Attribute(Attribute(Name('os', Load(), lineno=528, col_offset=19), 'path', Load(), lineno=528, col_offset=19), 'basename', Load(), lineno=528, col_offset=19), [Name('file', Load(), lineno=528, col_offset=36)], [], None, None, lineno=528, col_offset=19), lineno=528, col_offset=12)], [], lineno=525, col_offset=8), Assign([Name('absolute', Store(), lineno=529, col_offset=8)], Call(Attribute(Attribute(Name('os', Load(), lineno=529, col_offset=19), 'path', Load(), lineno=529, col_offset=19), 'join', Load(), lineno=529, col_offset=19), [Attribute(Name('self', Load(), lineno=529, col_offset=32), 'absolute', Load(), lineno=529, col_offset=32), Name('src', Load(), lineno=529, col_offset=47)], [], None, None, lineno=529, col_offset=19), lineno=529, col_offset=8), Assert(UnaryOp(Not(), Call(Attribute(Name('re', Load(), lineno=530, col_offset=19), 'search', Load(), lineno=530, col_offset=19), [Str('[\\?|><:/*]"', lineno=530, col_offset=29), Name('file', Load(), lineno=530, col_offset=45)], [], None, None, lineno=530, col_offset=19), lineno=530, col_offset=15), None, lineno=530, col_offset=8), If(Call(Attribute(Attribute(Name('self', Load(), lineno=531, col_offset=11), 'keyfiles', Load(), lineno=531, col_offset=11), 'has_key', Load(), lineno=531, col_offset=11), [Name('file', Load(), lineno=531, col_offset=33)], [], None, None, lineno=531, col_offset=11), [Assign([Name('logical', Store(), lineno=532, col_offset=12)], Subscript(Attribute(Name('self', Load(), lineno=532, col_offset=22), 'keyfiles', Load(), lineno=532, col_offset=22), Index(Name('file', Load(), lineno=532, col_offset=36)), Load(), lineno=532, col_offset=22), lineno=532, col_offset=12)], [Assign([Name('logical', Store(), lineno=534, col_offset=12)], Name('None', Load(), lineno=534, col_offset=22), lineno=534, col_offset=12)], lineno=531, col_offset=8), Assign([Tuple([Name('sequence', Store(), lineno=535, col_offset=8), Name('logical', Store(), lineno=535, col_offset=18)], Store(), lineno=535, col_offset=8)], Call(Attribute(Attribute(Name('self', Load(), lineno=535, col_offset=28), 'cab', Load(), lineno=535, col_offset=28), 'append', Load(), lineno=535, col_offset=28), [Name('absolute', Load(), lineno=535, col_offset=44), Name('file', Load(), lineno=535, col_offset=54), Name('logical', Load(), lineno=535, col_offset=60)], [], None, None, lineno=535, col_offset=28), lineno=535, col_offset=8), Assert(Compare(Name('logical', Load(), lineno=536, col_offset=15), [NotIn()], [Attribute(Name('self', Load(), lineno=536, col_offset=30), 'ids', Load(), lineno=536, col_offset=30)], lineno=536, col_offset=15), None, lineno=536, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=537, col_offset=8), 'ids', Load(), lineno=537, col_offset=8), 'add', Load(), lineno=537, col_offset=8), [Name('logical', Load(), lineno=537, col_offset=21)], [], None, None, lineno=537, col_offset=8), lineno=537, col_offset=8), Assign([Name('short', Store(), lineno=538, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=538, col_offset=16), 'make_short', Load(), lineno=538, col_offset=16), [Name('file', Load(), lineno=538, col_offset=32)], [], None, None, lineno=538, col_offset=16), lineno=538, col_offset=8), Assign([Name('full', Store(), lineno=539, col_offset=8)], BinOp(Str('%s|%s', lineno=539, col_offset=15), Mod(), Tuple([Name('short', Load(), lineno=539, col_offset=26), Name('file', Load(), lineno=539, col_offset=33)], Load(), lineno=539, col_offset=26), lineno=539, col_offset=15), lineno=539, col_offset=8), Assign([Name('filesize', Store(), lineno=540, col_offset=8)], Attribute(Call(Attribute(Name('os', Load(), lineno=540, col_offset=19), 'stat', Load(), lineno=540, col_offset=19), [Name('absolute', Load(), lineno=540, col_offset=27)], [], None, None, lineno=540, col_offset=19), 'st_size', Load(), lineno=540, col_offset=19), lineno=540, col_offset=8), Assign([Name('attributes', Store(), lineno=544, col_offset=8)], Num(512, lineno=544, col_offset=21), lineno=544, col_offset=8), Expr(Call(Name('add_data', Load(), lineno=545, col_offset=8), [Attribute(Name('self', Load(), lineno=545, col_offset=17), 'db', Load(), lineno=545, col_offset=17), Str('File', lineno=545, col_offset=26), List([Tuple([Name('logical', Load(), lineno=546, col_offset=26), Attribute(Name('self', Load(), lineno=546, col_offset=35), 'component', Load(), lineno=546, col_offset=35), Name('full', Load(), lineno=546, col_offset=51), Name('filesize', Load(), lineno=546, col_offset=57), Name('version', Load(), lineno=546, col_offset=67), Name('language', Load(), lineno=547, col_offset=25), Name('attributes', Load(), lineno=547, col_offset=35), Name('sequence', Load(), lineno=547, col_offset=47)], Load(), lineno=546, col_offset=26)], Load(), lineno=546, col_offset=24)], [], None, None, lineno=545, col_offset=8), lineno=545, col_offset=8), If(UnaryOp(Not(), Name('version', Load(), lineno=548, col_offset=15), lineno=548, col_offset=11), [Assign([Name('filehash', Store(), lineno=550, col_offset=12)], Call(Attribute(Call(Name('MakeInstaller', Load(), lineno=550, col_offset=23), [], [], None, None, lineno=550, col_offset=23), 'FileHash', Load(), lineno=550, col_offset=23), [Name('absolute', Load(), lineno=550, col_offset=48), Num(0, lineno=550, col_offset=58)], [], None, None, lineno=550, col_offset=23), lineno=550, col_offset=12), Expr(Call(Name('add_data', Load(), lineno=551, col_offset=12), [Attribute(Name('self', Load(), lineno=551, col_offset=21), 'db', Load(), lineno=551, col_offset=21), Str('MsiFileHash', lineno=551, col_offset=30), List([Tuple([Name('logical', Load(), lineno=552, col_offset=23), Num(0, lineno=552, col_offset=32), Call(Attribute(Name('filehash', Load(), lineno=552, col_offset=35), 'IntegerData', Load(), lineno=552, col_offset=35), [Num(1, lineno=552, col_offset=56)], [], None, None, lineno=552, col_offset=35), Call(Attribute(Name('filehash', Load(), lineno=553, col_offset=23), 'IntegerData', Load(), lineno=553, col_offset=23), [Num(2, lineno=553, col_offset=44)], [], None, None, lineno=553, col_offset=23), Call(Attribute(Name('filehash', Load(), lineno=553, col_offset=48), 'IntegerData', Load(), lineno=553, col_offset=48), [Num(3, lineno=553, col_offset=69)], [], None, None, lineno=553, col_offset=48), Call(Attribute(Name('filehash', Load(), lineno=554, col_offset=23), 'IntegerData', Load(), lineno=554, col_offset=23), [Num(4, lineno=554, col_offset=44)], [], None, None, lineno=554, col_offset=23)], Load(), lineno=552, col_offset=23)], Load(), lineno=552, col_offset=21)], [], None, None, lineno=551, col_offset=12), lineno=551, col_offset=12)], [], lineno=548, col_offset=8)], [], lineno=517, col_offset=4), FunctionDef('glob', arguments([Name('self', Param(), lineno=565, col_offset=13), Name('pattern', Param(), lineno=565, col_offset=19), Name('exclude', Param(), lineno=565, col_offset=28)], None, None, [Name('None', Load(), lineno=565, col_offset=38)]), [Expr(Str('Add a list of files to the current component as specified in the\n        glob pattern. Individual files can be excluded in the exclude list.', lineno=567, col_offset=-1), lineno=567, col_offset=-1), Assign([Name('files', Store(), lineno=568, col_offset=8)], Call(Attribute(Name('glob', Load(), lineno=568, col_offset=16), 'glob1', Load(), lineno=568, col_offset=16), [Attribute(Name('self', Load(), lineno=568, col_offset=27), 'absolute', Load(), lineno=568, col_offset=27), Name('pattern', Load(), lineno=568, col_offset=42)], [], None, None, lineno=568, col_offset=16), lineno=568, col_offset=8), For(Name('f', Store(), lineno=569, col_offset=12), Name('files', Load(), lineno=569, col_offset=17), [If(BoolOp(And(), [Name('exclude', Load(), lineno=570, col_offset=15), Compare(Name('f', Load(), lineno=570, col_offset=27), [In()], [Name('exclude', Load(), lineno=570, col_offset=32)], lineno=570, col_offset=27)], lineno=570, col_offset=15), [Continue( lineno=570, col_offset=41)], [], lineno=570, col_offset=12), Expr(Call(Attribute(Name('self', Load(), lineno=571, col_offset=12), 'add_file', Load(), lineno=571, col_offset=12), [Name('f', Load(), lineno=571, col_offset=26)], [], None, None, lineno=571, col_offset=12), lineno=571, col_offset=12)], [], lineno=569, col_offset=8), Return(Name('files', Load(), lineno=572, col_offset=15), lineno=572, col_offset=8)], [], lineno=565, col_offset=4), FunctionDef('remove_pyc', arguments([Name('self', Param(), lineno=574, col_offset=19)], None, None, []), [Expr(Str('Remove .pyc/.pyo files on uninstall', lineno=575, col_offset=8), lineno=575, col_offset=8), Expr(Call(Name('add_data', Load(), lineno=576, col_offset=8), [Attribute(Name('self', Load(), lineno=576, col_offset=17), 'db', Load(), lineno=576, col_offset=17), Str('RemoveFile', lineno=576, col_offset=26), List([Tuple([BinOp(Attribute(Name('self', Load(), lineno=577, col_offset=19), 'component', Load(), lineno=577, col_offset=19), Add(), Str('c', lineno=577, col_offset=34), lineno=577, col_offset=19), Attribute(Name('self', Load(), lineno=577, col_offset=39), 'component', Load(), lineno=577, col_offset=39), Str('*.pyc', lineno=577, col_offset=55), Attribute(Name('self', Load(), lineno=577, col_offset=64), 'logical', Load(), lineno=577, col_offset=64), Num(2, lineno=577, col_offset=78)], Load(), lineno=577, col_offset=19), Tuple([BinOp(Attribute(Name('self', Load(), lineno=578, col_offset=19), 'component', Load(), lineno=578, col_offset=19), Add(), Str('o', lineno=578, col_offset=34), lineno=578, col_offset=19), Attribute(Name('self', Load(), lineno=578, col_offset=39), 'component', Load(), lineno=578, col_offset=39), Str('*.pyo', lineno=578, col_offset=55), Attribute(Name('self', Load(), lineno=578, col_offset=64), 'logical', Load(), lineno=578, col_offset=64), Num(2, lineno=578, col_offset=78)], Load(), lineno=578, col_offset=19)], Load(), lineno=577, col_offset=17)], [], None, None, lineno=576, col_offset=8), lineno=576, col_offset=8)], [], lineno=574, col_offset=4), FunctionDef('removefile', arguments([Name('self', Param(), lineno=580, col_offset=19), Name('key', Param(), lineno=580, col_offset=25), Name('pattern', Param(), lineno=580, col_offset=30)], None, None, []), [Expr(Str('Add a RemoveFile entry', lineno=581, col_offset=8), lineno=581, col_offset=8), Expr(Call(Name('add_data', Load(), lineno=582, col_offset=8), [Attribute(Name('self', Load(), lineno=582, col_offset=17), 'db', Load(), lineno=582, col_offset=17), Str('RemoveFile', lineno=582, col_offset=26), List([Tuple([BinOp(Attribute(Name('self', Load(), lineno=582, col_offset=42), 'component', Load(), lineno=582, col_offset=42), Add(), Name('key', Load(), lineno=582, col_offset=57), lineno=582, col_offset=42), Attribute(Name('self', Load(), lineno=582, col_offset=62), 'component', Load(), lineno=582, col_offset=62), Name('pattern', Load(), lineno=582, col_offset=78), Attribute(Name('self', Load(), lineno=582, col_offset=87), 'logical', Load(), lineno=582, col_offset=87), Num(2, lineno=582, col_offset=101)], Load(), lineno=582, col_offset=42)], Load(), lineno=582, col_offset=40)], [], None, None, lineno=582, col_offset=8), lineno=582, col_offset=8)], [], lineno=580, col_offset=4)], [], lineno=421, col_offset=0), ClassDef('Feature', [], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=586, col_offset=17), Name('db', Param(), lineno=586, col_offset=23), Name('id', Param(), lineno=586, col_offset=27), Name('title', Param(), lineno=586, col_offset=31), Name('desc', Param(), lineno=586, col_offset=38), Name('display', Param(), lineno=586, col_offset=44), Name('level', Param(), lineno=586, col_offset=53), Name('parent', Param(), lineno=587, col_offset=17), Name('directory', Param(), lineno=587, col_offset=30), Name('attributes', Param(), lineno=587, col_offset=48)], None, None, [Num(1, lineno=586, col_offset=61), Name('None', Load(), lineno=587, col_offset=24), Name('None', Load(), lineno=587, col_offset=42), Num(0, lineno=587, col_offset=59)]), [Assign([Attribute(Name('self', Load(), lineno=588, col_offset=8), 'id', Store(), lineno=588, col_offset=8)], Name('id', Load(), lineno=588, col_offset=18), lineno=588, col_offset=8), If(Name('parent', Load(), lineno=589, col_offset=11), [Assign([Name('parent', Store(), lineno=590, col_offset=12)], Attribute(Name('parent', Load(), lineno=590, col_offset=21), 'id', Load(), lineno=590, col_offset=21), lineno=590, col_offset=12)], [], lineno=589, col_offset=8), Expr(Call(Name('add_data', Load(), lineno=591, col_offset=8), [Name('db', Load(), lineno=591, col_offset=17), Str('Feature', lineno=591, col_offset=21), List([Tuple([Name('id', Load(), lineno=592, col_offset=26), Name('parent', Load(), lineno=592, col_offset=30), Name('title', Load(), lineno=592, col_offset=38), Name('desc', Load(), lineno=592, col_offset=45), Name('display', Load(), lineno=592, col_offset=51), Name('level', Load(), lineno=593, col_offset=26), Name('directory', Load(), lineno=593, col_offset=33), Name('attributes', Load(), lineno=593, col_offset=44)], Load(), lineno=592, col_offset=26)], Load(), lineno=592, col_offset=24)], [], None, None, lineno=591, col_offset=8), lineno=591, col_offset=8)], [], lineno=586, col_offset=4), FunctionDef('set_current', arguments([Name('self', Param(), lineno=594, col_offset=20)], None, None, []), [Global(['current_feature'], lineno=595, col_offset=8), Assign([Name('current_feature', Store(), lineno=596, col_offset=8)], Name('self', Load(), lineno=596, col_offset=26), lineno=596, col_offset=8)], [], lineno=594, col_offset=4)], [], lineno=585, col_offset=0), ClassDef('Control', [], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=599, col_offset=17), Name('dlg', Param(), lineno=599, col_offset=23), Name('name', Param(), lineno=599, col_offset=28)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=600, col_offset=8), 'dlg', Store(), lineno=600, col_offset=8)], Name('dlg', Load(), lineno=600, col_offset=19), lineno=600, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=601, col_offset=8), 'name', Store(), lineno=601, col_offset=8)], Name('name', Load(), lineno=601, col_offset=20), lineno=601, col_offset=8)], [], lineno=599, col_offset=4), FunctionDef('event', arguments([Name('self', Param(), lineno=603, col_offset=14), Name('ev', Param(), lineno=603, col_offset=20), Name('arg', Param(), lineno=603, col_offset=24), Name('cond', Param(), lineno=603, col_offset=29), Name('order', Param(), lineno=603, col_offset=41)], None, None, [Str('1', lineno=603, col_offset=36), Name('None', Load(), lineno=603, col_offset=49)]), [Expr(Call(Name('add_data', Load(), lineno=604, col_offset=8), [Attribute(Attribute(Name('self', Load(), lineno=604, col_offset=17), 'dlg', Load(), lineno=604, col_offset=17), 'db', Load(), lineno=604, col_offset=17), Str('ControlEvent', lineno=604, col_offset=30), List([Tuple([Attribute(Attribute(Name('self', Load(), lineno=605, col_offset=19), 'dlg', Load(), lineno=605, col_offset=19), 'name', Load(), lineno=605, col_offset=19), Attribute(Name('self', Load(), lineno=605, col_offset=34), 'name', Load(), lineno=605, col_offset=34), Name('ev', Load(), lineno=605, col_offset=45), Name('arg', Load(), lineno=605, col_offset=49), Name('cond', Load(), lineno=605, col_offset=54), Name('order', Load(), lineno=605, col_offset=60)], Load(), lineno=605, col_offset=19)], Load(), lineno=605, col_offset=17)], [], None, None, lineno=604, col_offset=8), lineno=604, col_offset=8)], [], lineno=603, col_offset=4), FunctionDef('mapping', arguments([Name('self', Param(), lineno=607, col_offset=16), Name('ev', Param(), lineno=607, col_offset=22), Name('attr', Param(), lineno=607, col_offset=26)], None, None, []), [Expr(Call(Name('add_data', Load(), lineno=608, col_offset=8), [Attribute(Attribute(Name('self', Load(), lineno=608, col_offset=17), 'dlg', Load(), lineno=608, col_offset=17), 'db', Load(), lineno=608, col_offset=17), Str('EventMapping', lineno=608, col_offset=30), List([Tuple([Attribute(Attribute(Name('self', Load(), lineno=609, col_offset=19), 'dlg', Load(), lineno=609, col_offset=19), 'name', Load(), lineno=609, col_offset=19), Attribute(Name('self', Load(), lineno=609, col_offset=34), 'name', Load(), lineno=609, col_offset=34), Name('ev', Load(), lineno=609, col_offset=45), Name('attr', Load(), lineno=609, col_offset=49)], Load(), lineno=609, col_offset=19)], Load(), lineno=609, col_offset=17)], [], None, None, lineno=608, col_offset=8), lineno=608, col_offset=8)], [], lineno=607, col_offset=4), FunctionDef('condition', arguments([Name('self', Param(), lineno=611, col_offset=18), Name('action', Param(), lineno=611, col_offset=24), Name('condition', Param(), lineno=611, col_offset=32)], None, None, []), [Expr(Call(Name('add_data', Load(), lineno=612, col_offset=8), [Attribute(Attribute(Name('self', Load(), lineno=612, col_offset=17), 'dlg', Load(), lineno=612, col_offset=17), 'db', Load(), lineno=612, col_offset=17), Str('ControlCondition', lineno=612, col_offset=30), List([Tuple([Attribute(Attribute(Name('self', Load(), lineno=613, col_offset=19), 'dlg', Load(), lineno=613, col_offset=19), 'name', Load(), lineno=613, col_offset=19), Attribute(Name('self', Load(), lineno=613, col_offset=34), 'name', Load(), lineno=613, col_offset=34), Name('action', Load(), lineno=613, col_offset=45), Name('condition', Load(), lineno=613, col_offset=53)], Load(), lineno=613, col_offset=19)], Load(), lineno=613, col_offset=17)], [], None, None, lineno=612, col_offset=8), lineno=612, col_offset=8)], [], lineno=611, col_offset=4)], [], lineno=598, col_offset=0), ClassDef('RadioButtonGroup', [Name('Control', Load(), lineno=615, col_offset=23)], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=616, col_offset=17), Name('dlg', Param(), lineno=616, col_offset=23), Name('name', Param(), lineno=616, col_offset=28), Name('property', Param(), lineno=616, col_offset=34)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=617, col_offset=8), 'dlg', Store(), lineno=617, col_offset=8)], Name('dlg', Load(), lineno=617, col_offset=19), lineno=617, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=618, col_offset=8), 'name', Store(), lineno=618, col_offset=8)], Name('name', Load(), lineno=618, col_offset=20), lineno=618, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=619, col_offset=8), 'property', Store(), lineno=619, col_offset=8)], Name('property', Load(), lineno=619, col_offset=24), lineno=619, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=620, col_offset=8), 'index', Store(), lineno=620, col_offset=8)], Num(1, lineno=620, col_offset=21), lineno=620, col_offset=8)], [], lineno=616, col_offset=4), FunctionDef('add', arguments([Name('self', Param(), lineno=622, col_offset=12), Name('name', Param(), lineno=622, col_offset=18), Name('x', Param(), lineno=622, col_offset=24), Name('y', Param(), lineno=622, col_offset=27), Name('w', Param(), lineno=622, col_offset=30), Name('h', Param(), lineno=622, col_offset=33), Name('text', Param(), lineno=622, col_offset=36), Name('value', Param(), lineno=622, col_offset=42)], None, None, [Name('None', Load(), lineno=622, col_offset=50)]), [If(Compare(Name('value', Load(), lineno=623, col_offset=11), [Is()], [Name('None', Load(), lineno=623, col_offset=20)], lineno=623, col_offset=11), [Assign([Name('value', Store(), lineno=624, col_offset=12)], Name('name', Load(), lineno=624, col_offset=20), lineno=624, col_offset=12)], [], lineno=623, col_offset=8), Expr(Call(Name('add_data', Load(), lineno=625, col_offset=8), [Attribute(Attribute(Name('self', Load(), lineno=625, col_offset=17), 'dlg', Load(), lineno=625, col_offset=17), 'db', Load(), lineno=625, col_offset=17), Str('RadioButton', lineno=625, col_offset=30), List([Tuple([Attribute(Name('self', Load(), lineno=626, col_offset=19), 'property', Load(), lineno=626, col_offset=19), Attribute(Name('self', Load(), lineno=626, col_offset=34), 'index', Load(), lineno=626, col_offset=34), Name('value', Load(), lineno=626, col_offset=46), Name('x', Load(), lineno=627, col_offset=19), Name('y', Load(), lineno=627, col_offset=22), Name('w', Load(), lineno=627, col_offset=25), Name('h', Load(), lineno=627, col_offset=28), Name('text', Load(), lineno=627, col_offset=31), Name('None', Load(), lineno=627, col_offset=37)], Load(), lineno=626, col_offset=19)], Load(), lineno=626, col_offset=17)], [], None, None, lineno=625, col_offset=8), lineno=625, col_offset=8), AugAssign(Attribute(Name('self', Load(), lineno=628, col_offset=8), 'index', Store(), lineno=628, col_offset=8), Add(), Num(1, lineno=628, col_offset=22), lineno=628, col_offset=8)], [], lineno=622, col_offset=4)], [], lineno=615, col_offset=0), ClassDef('Dialog', [], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=631, col_offset=17), Name('db', Param(), lineno=631, col_offset=23), Name('name', Param(), lineno=631, col_offset=27), Name('x', Param(), lineno=631, col_offset=33), Name('y', Param(), lineno=631, col_offset=36), Name('w', Param(), lineno=631, col_offset=39), Name('h', Param(), lineno=631, col_offset=42), Name('attr', Param(), lineno=631, col_offset=45), Name('title', Param(), lineno=631, col_offset=51), Name('first', Param(), lineno=631, col_offset=58), Name('default', Param(), lineno=631, col_offset=65), Name('cancel', Param(), lineno=631, col_offset=74)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=632, col_offset=8), 'db', Store(), lineno=632, col_offset=8)], Name('db', Load(), lineno=632, col_offset=18), lineno=632, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=633, col_offset=8), 'name', Store(), lineno=633, col_offset=8)], Name('name', Load(), lineno=633, col_offset=20), lineno=633, col_offset=8), Assign([Tuple([Attribute(Name('self', Load(), lineno=634, col_offset=8), 'x', Store(), lineno=634, col_offset=8), Attribute(Name('self', Load(), lineno=634, col_offset=16), 'y', Store(), lineno=634, col_offset=16), Attribute(Name('self', Load(), lineno=634, col_offset=24), 'w', Store(), lineno=634, col_offset=24), Attribute(Name('self', Load(), lineno=634, col_offset=32), 'h', Store(), lineno=634, col_offset=32)], Store(), lineno=634, col_offset=8)], Tuple([Name('x', Load(), lineno=634, col_offset=41), Name('y', Load(), lineno=634, col_offset=43), Name('w', Load(), lineno=634, col_offset=45), Name('h', Load(), lineno=634, col_offset=47)], Load(), lineno=634, col_offset=41), lineno=634, col_offset=8), Expr(Call(Name('add_data', Load(), lineno=635, col_offset=8), [Name('db', Load(), lineno=635, col_offset=17), Str('Dialog', lineno=635, col_offset=21), List([Tuple([Name('name', Load(), lineno=635, col_offset=33), Name('x', Load(), lineno=635, col_offset=39), Name('y', Load(), lineno=635, col_offset=41), Name('w', Load(), lineno=635, col_offset=43), Name('h', Load(), lineno=635, col_offset=45), Name('attr', Load(), lineno=635, col_offset=47), Name('title', Load(), lineno=635, col_offset=52), Name('first', Load(), lineno=635, col_offset=58), Name('default', Load(), lineno=635, col_offset=64), Name('cancel', Load(), lineno=635, col_offset=72)], Load(), lineno=635, col_offset=33)], Load(), lineno=635, col_offset=31)], [], None, None, lineno=635, col_offset=8), lineno=635, col_offset=8)], [], lineno=631, col_offset=4), FunctionDef('control', arguments([Name('self', Param(), lineno=637, col_offset=16), Name('name', Param(), lineno=637, col_offset=22), Name('type', Param(), lineno=637, col_offset=28), Name('x', Param(), lineno=637, col_offset=34), Name('y', Param(), lineno=637, col_offset=37), Name('w', Param(), lineno=637, col_offset=40), Name('h', Param(), lineno=637, col_offset=43), Name('attr', Param(), lineno=637, col_offset=46), Name('prop', Param(), lineno=637, col_offset=52), Name('text', Param(), lineno=637, col_offset=58), Name('next', Param(), lineno=637, col_offset=64), Name('help', Param(), lineno=637, col_offset=70)], None, None, []), [Expr(Call(Name('add_data', Load(), lineno=638, col_offset=8), [Attribute(Name('self', Load(), lineno=638, col_offset=17), 'db', Load(), lineno=638, col_offset=17), Str('Control', lineno=638, col_offset=26), List([Tuple([Attribute(Name('self', Load(), lineno=639, col_offset=19), 'name', Load(), lineno=639, col_offset=19), Name('name', Load(), lineno=639, col_offset=30), Name('type', Load(), lineno=639, col_offset=36), Name('x', Load(), lineno=639, col_offset=42), Name('y', Load(), lineno=639, col_offset=45), Name('w', Load(), lineno=639, col_offset=48), Name('h', Load(), lineno=639, col_offset=51), Name('attr', Load(), lineno=639, col_offset=54), Name('prop', Load(), lineno=639, col_offset=60), Name('text', Load(), lineno=639, col_offset=66), Name('next', Load(), lineno=639, col_offset=72), Name('help', Load(), lineno=639, col_offset=78)], Load(), lineno=639, col_offset=19)], Load(), lineno=639, col_offset=17)], [], None, None, lineno=638, col_offset=8), lineno=638, col_offset=8), Return(Call(Name('Control', Load(), lineno=640, col_offset=15), [Name('self', Load(), lineno=640, col_offset=23), Name('name', Load(), lineno=640, col_offset=29)], [], None, None, lineno=640, col_offset=15), lineno=640, col_offset=8)], [], lineno=637, col_offset=4), FunctionDef('text', arguments([Name('self', Param(), lineno=642, col_offset=13), Name('name', Param(), lineno=642, col_offset=19), Name('x', Param(), lineno=642, col_offset=25), Name('y', Param(), lineno=642, col_offset=28), Name('w', Param(), lineno=642, col_offset=31), Name('h', Param(), lineno=642, col_offset=34), Name('attr', Param(), lineno=642, col_offset=37), Name('text', Param(), lineno=642, col_offset=43)], None, None, []), [Return(Call(Attribute(Name('self', Load(), lineno=643, col_offset=15), 'control', Load(), lineno=643, col_offset=15), [Name('name', Load(), lineno=643, col_offset=28), Str('Text', lineno=643, col_offset=34), Name('x', Load(), lineno=643, col_offset=42), Name('y', Load(), lineno=643, col_offset=45), Name('w', Load(), lineno=643, col_offset=48), Name('h', Load(), lineno=643, col_offset=51), Name('attr', Load(), lineno=643, col_offset=54), Name('None', Load(), lineno=643, col_offset=60), Name('text', Load(), lineno=644, col_offset=21), Name('None', Load(), lineno=644, col_offset=27), Name('None', Load(), lineno=644, col_offset=33)], [], None, None, lineno=643, col_offset=15), lineno=643, col_offset=8)], [], lineno=642, col_offset=4), FunctionDef('bitmap', arguments([Name('self', Param(), lineno=646, col_offset=15), Name('name', Param(), lineno=646, col_offset=21), Name('x', Param(), lineno=646, col_offset=27), Name('y', Param(), lineno=646, col_offset=30), Name('w', Param(), lineno=646, col_offset=33), Name('h', Param(), lineno=646, col_offset=36), Name('text', Param(), lineno=646, col_offset=39)], None, None, []), [Return(Call(Attribute(Name('self', Load(), lineno=647, col_offset=15), 'control', Load(), lineno=647, col_offset=15), [Name('name', Load(), lineno=647, col_offset=28), Str('Bitmap', lineno=647, col_offset=34), Name('x', Load(), lineno=647, col_offset=44), Name('y', Load(), lineno=647, col_offset=47), Name('w', Load(), lineno=647, col_offset=50), Name('h', Load(), lineno=647, col_offset=53), Num(1, lineno=647, col_offset=56), Name('None', Load(), lineno=647, col_offset=59), Name('text', Load(), lineno=647, col_offset=65), Name('None', Load(), lineno=647, col_offset=71), Name('None', Load(), lineno=647, col_offset=77)], [], None, None, lineno=647, col_offset=15), lineno=647, col_offset=8)], [], lineno=646, col_offset=4), FunctionDef('line', arguments([Name('self', Param(), lineno=649, col_offset=13), Name('name', Param(), lineno=649, col_offset=19), Name('x', Param(), lineno=649, col_offset=25), Name('y', Param(), lineno=649, col_offset=28), Name('w', Param(), lineno=649, col_offset=31), Name('h', Param(), lineno=649, col_offset=34)], None, None, []), [Return(Call(Attribute(Name('self', Load(), lineno=650, col_offset=15), 'control', Load(), lineno=650, col_offset=15), [Name('name', Load(), lineno=650, col_offset=28), Str('Line', lineno=650, col_offset=34), Name('x', Load(), lineno=650, col_offset=42), Name('y', Load(), lineno=650, col_offset=45), Name('w', Load(), lineno=650, col_offset=48), Name('h', Load(), lineno=650, col_offset=51), Num(1, lineno=650, col_offset=54), Name('None', Load(), lineno=650, col_offset=57), Name('None', Load(), lineno=650, col_offset=63), Name('None', Load(), lineno=650, col_offset=69), Name('None', Load(), lineno=650, col_offset=75)], [], None, None, lineno=650, col_offset=15), lineno=650, col_offset=8)], [], lineno=649, col_offset=4), FunctionDef('pushbutton', arguments([Name('self', Param(), lineno=652, col_offset=19), Name('name', Param(), lineno=652, col_offset=25), Name('x', Param(), lineno=652, col_offset=31), Name('y', Param(), lineno=652, col_offset=34), Name('w', Param(), lineno=652, col_offset=37), Name('h', Param(), lineno=652, col_offset=40), Name('attr', Param(), lineno=652, col_offset=43), Name('text', Param(), lineno=652, col_offset=49), Name('next', Param(), lineno=652, col_offset=55)], None, None, []), [Return(Call(Attribute(Name('self', Load(), lineno=653, col_offset=15), 'control', Load(), lineno=653, col_offset=15), [Name('name', Load(), lineno=653, col_offset=28), Str('PushButton', lineno=653, col_offset=34), Name('x', Load(), lineno=653, col_offset=48), Name('y', Load(), lineno=653, col_offset=51), Name('w', Load(), lineno=653, col_offset=54), Name('h', Load(), lineno=653, col_offset=57), Name('attr', Load(), lineno=653, col_offset=60), Name('None', Load(), lineno=653, col_offset=66), Name('text', Load(), lineno=653, col_offset=72), Name('next', Load(), lineno=653, col_offset=78), Name('None', Load(), lineno=653, col_offset=84)], [], None, None, lineno=653, col_offset=15), lineno=653, col_offset=8)], [], lineno=652, col_offset=4), FunctionDef('radiogroup', arguments([Name('self', Param(), lineno=655, col_offset=19), Name('name', Param(), lineno=655, col_offset=25), Name('x', Param(), lineno=655, col_offset=31), Name('y', Param(), lineno=655, col_offset=34), Name('w', Param(), lineno=655, col_offset=37), Name('h', Param(), lineno=655, col_offset=40), Name('attr', Param(), lineno=655, col_offset=43), Name('prop', Param(), lineno=655, col_offset=49), Name('text', Param(), lineno=655, col_offset=55), Name('next', Param(), lineno=655, col_offset=61)], None, None, []), [Expr(Call(Name('add_data', Load(), lineno=656, col_offset=8), [Attribute(Name('self', Load(), lineno=656, col_offset=17), 'db', Load(), lineno=656, col_offset=17), Str('Control', lineno=656, col_offset=26), List([Tuple([Attribute(Name('self', Load(), lineno=657, col_offset=19), 'name', Load(), lineno=657, col_offset=19), Name('name', Load(), lineno=657, col_offset=30), Str('RadioButtonGroup', lineno=657, col_offset=36), Name('x', Load(), lineno=658, col_offset=19), Name('y', Load(), lineno=658, col_offset=22), Name('w', Load(), lineno=658, col_offset=25), Name('h', Load(), lineno=658, col_offset=28), Name('attr', Load(), lineno=658, col_offset=31), Name('prop', Load(), lineno=658, col_offset=37), Name('text', Load(), lineno=658, col_offset=43), Name('next', Load(), lineno=658, col_offset=49), Name('None', Load(), lineno=658, col_offset=55)], Load(), lineno=657, col_offset=19)], Load(), lineno=657, col_offset=17)], [], None, None, lineno=656, col_offset=8), lineno=656, col_offset=8), Return(Call(Name('RadioButtonGroup', Load(), lineno=659, col_offset=15), [Name('self', Load(), lineno=659, col_offset=32), Name('name', Load(), lineno=659, col_offset=38), Name('prop', Load(), lineno=659, col_offset=44)], [], None, None, lineno=659, col_offset=15), lineno=659, col_offset=8)], [], lineno=655, col_offset=4), FunctionDef('checkbox', arguments([Name('self', Param(), lineno=661, col_offset=17), Name('name', Param(), lineno=661, col_offset=23), Name('x', Param(), lineno=661, col_offset=29), Name('y', Param(), lineno=661, col_offset=32), Name('w', Param(), lineno=661, col_offset=35), Name('h', Param(), lineno=661, col_offset=38), Name('attr', Param(), lineno=661, col_offset=41), Name('prop', Param(), lineno=661, col_offset=47), Name('text', Param(), lineno=661, col_offset=53), Name('next', Param(), lineno=661, col_offset=59)], None, None, []), [Return(Call(Attribute(Name('self', Load(), lineno=662, col_offset=15), 'control', Load(), lineno=662, col_offset=15), [Name('name', Load(), lineno=662, col_offset=28), Str('CheckBox', lineno=662, col_offset=34), Name('x', Load(), lineno=662, col_offset=46), Name('y', Load(), lineno=662, col_offset=49), Name('w', Load(), lineno=662, col_offset=52), Name('h', Load(), lineno=662, col_offset=55), Name('attr', Load(), lineno=662, col_offset=58), Name('prop', Load(), lineno=662, col_offset=64), Name('text', Load(), lineno=662, col_offset=70), Name('next', Load(), lineno=662, col_offset=76), Name('None', Load(), lineno=662, col_offset=82)], [], None, None, lineno=662, col_offset=15), lineno=662, col_offset=8)], [], lineno=661, col_offset=4)], [], lineno=630, col_offset=0), FunctionDef('pe_type', arguments([Name('path', Param(), lineno=664, col_offset=12)], None, None, []), [Assign([Name('header', Store(), lineno=665, col_offset=4)], Call(Attribute(Call(Name('open', Load(), lineno=665, col_offset=13), [Name('path', Load(), lineno=665, col_offset=18), Str('rb', lineno=665, col_offset=24)], [], None, None, lineno=665, col_offset=13), 'read', Load(), lineno=665, col_offset=13), [Num(1000, lineno=665, col_offset=35)], [], None, None, lineno=665, col_offset=13), lineno=665, col_offset=4), Assign([Name('pe_offset', Store(), lineno=667, col_offset=4)], Subscript(Call(Attribute(Name('struct', Load(), lineno=667, col_offset=16), 'unpack', Load(), lineno=667, col_offset=16), [Str('<i', lineno=667, col_offset=30), Subscript(Name('header', Load(), lineno=667, col_offset=36), Slice(Num(60, lineno=667, col_offset=43), Num(64, lineno=667, col_offset=48), None), Load(), lineno=667, col_offset=36)], [], None, None, lineno=667, col_offset=16), Index(Num(0, lineno=667, col_offset=55)), Load(), lineno=667, col_offset=16), lineno=667, col_offset=4), Assert(Compare(Subscript(Name('header', Load(), lineno=668, col_offset=11), Slice(Name('pe_offset', Load(), lineno=668, col_offset=18), BinOp(Name('pe_offset', Load(), lineno=668, col_offset=28), Add(), Num(4, lineno=668, col_offset=38), lineno=668, col_offset=28), None), Load(), lineno=668, col_offset=11), [Eq()], [Str('PE\x00\x00', lineno=668, col_offset=44)], lineno=668, col_offset=11), None, lineno=668, col_offset=4), Assign([Name('machine', Store(), lineno=669, col_offset=4)], Subscript(Call(Attribute(Name('struct', Load(), lineno=669, col_offset=14), 'unpack', Load(), lineno=669, col_offset=14), [Str('<H', lineno=669, col_offset=28), Subscript(Name('header', Load(), lineno=669, col_offset=34), Slice(BinOp(Name('pe_offset', Load(), lineno=669, col_offset=41), Add(), Num(4, lineno=669, col_offset=51), lineno=669, col_offset=41), BinOp(Name('pe_offset', Load(), lineno=669, col_offset=53), Add(), Num(6, lineno=669, col_offset=63), lineno=669, col_offset=53), None), Load(), lineno=669, col_offset=34)], [], None, None, lineno=669, col_offset=14), Index(Num(0, lineno=669, col_offset=67)), Load(), lineno=669, col_offset=14), lineno=669, col_offset=4), Return(Name('machine', Load(), lineno=670, col_offset=11), lineno=670, col_offset=4)], [], lineno=664, col_offset=0), FunctionDef('set_arch_from_file', arguments([Name('path', Param(), lineno=672, col_offset=23)], None, None, []), [Global(['msi_type', 'Win64', 'arch_ext'], lineno=673, col_offset=4), Assign([Name('machine', Store(), lineno=674, col_offset=4)], Call(Name('pe_type', Load(), lineno=674, col_offset=14), [Name('path', Load(), lineno=674, col_offset=22)], [], None, None, lineno=674, col_offset=14), lineno=674, col_offset=4), If(Compare(Name('machine', Load(), lineno=675, col_offset=7), [Eq()], [Num(332, lineno=675, col_offset=18)], lineno=675, col_offset=7), [Assign([Name('msi_type', Store(), lineno=677, col_offset=8)], Str('Intel', lineno=677, col_offset=19), lineno=677, col_offset=8), Assign([Name('Win64', Store(), lineno=678, col_offset=8)], Num(0, lineno=678, col_offset=16), lineno=678, col_offset=8), Assign([Name('arch_ext', Store(), lineno=679, col_offset=8)], Str('', lineno=679, col_offset=19), lineno=679, col_offset=8)], [If(Compare(Name('machine', Load(), lineno=680, col_offset=9), [Eq()], [Num(512, lineno=680, col_offset=20)], lineno=680, col_offset=9), [Assign([Name('msi_type', Store(), lineno=682, col_offset=8)], Str('Intel64', lineno=682, col_offset=19), lineno=682, col_offset=8), Assign([Name('Win64', Store(), lineno=683, col_offset=8)], Num(1, lineno=683, col_offset=16), lineno=683, col_offset=8), Assign([Name('arch_ext', Store(), lineno=684, col_offset=8)], Str('.ia64', lineno=684, col_offset=19), lineno=684, col_offset=8)], [If(Compare(Name('machine', Load(), lineno=685, col_offset=9), [Eq()], [Num(34404, lineno=685, col_offset=20)], lineno=685, col_offset=9), [Assign([Name('msi_type', Store(), lineno=687, col_offset=8)], Str('x64', lineno=687, col_offset=19), lineno=687, col_offset=8), Assign([Name('Win64', Store(), lineno=688, col_offset=8)], Num(1, lineno=688, col_offset=16), lineno=688, col_offset=8), Assign([Name('arch_ext', Store(), lineno=689, col_offset=8)], Str('.amd64', lineno=689, col_offset=19), lineno=689, col_offset=8)], [Raise(Name('ValueError', Load(), lineno=691, col_offset=14), Str('Unsupported architecture', lineno=691, col_offset=26), None, lineno=691, col_offset=8)], lineno=685, col_offset=9)], lineno=680, col_offset=9)], lineno=675, col_offset=4), AugAssign(Name('msi_type', Store(), lineno=692, col_offset=4), Add(), Str(';1033', lineno=692, col_offset=16), lineno=692, col_offset=4)], [], lineno=672, col_offset=0)])
