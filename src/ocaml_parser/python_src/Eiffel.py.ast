Module([Expr(Str('Support Eiffel-style preconditions and postconditions.', lineno=1, col_offset=0), lineno=1, col_offset=0), ImportFrom('types', [alias('FunctionType', 'function')], 0, lineno=3, col_offset=0), ClassDef('EiffelBaseMetaClass', [Name('type', Load(), lineno=5, col_offset=26)], [FunctionDef('__new__', arguments([Name('meta', Param(), lineno=7, col_offset=16), Name('name', Param(), lineno=7, col_offset=22), Name('bases', Param(), lineno=7, col_offset=28), Name('dict', Param(), lineno=7, col_offset=35)], None, None, []), [Expr(Call(Attribute(Name('meta', Load(), lineno=8, col_offset=8), 'convert_methods', Load(), lineno=8, col_offset=8), [Name('dict', Load(), lineno=8, col_offset=29)], [], None, None, lineno=8, col_offset=8), lineno=8, col_offset=8), Return(Call(Attribute(Call(Name('super', Load(), lineno=9, col_offset=15), [Name('EiffelBaseMetaClass', Load(), lineno=9, col_offset=21), Name('meta', Load(), lineno=9, col_offset=42)], [], None, None, lineno=9, col_offset=15), '__new__', Load(), lineno=9, col_offset=15), [Name('meta', Load(), lineno=9, col_offset=56), Name('name', Load(), lineno=9, col_offset=62), Name('bases', Load(), lineno=9, col_offset=68), Name('dict', Load(), lineno=10, col_offset=56)], [], None, None, lineno=9, col_offset=15), lineno=9, col_offset=8)], [], lineno=7, col_offset=4), FunctionDef('convert_methods', arguments([Name('cls', Param(), lineno=13, col_offset=24), Name('dict', Param(), lineno=13, col_offset=29)], None, None, []), [Expr(Str('Replace functions in dict with EiffelMethod wrappers.\n\n        The dict is modified in place.\n\n        If a method ends in _pre or _post, it is removed from the dict\n        regardless of whether there is a corresponding method.\n        ', lineno=20, col_offset=-1), lineno=20, col_offset=-1), Assign([Name('methods', Store(), lineno=22, col_offset=8)], List([], Load(), lineno=22, col_offset=18), lineno=22, col_offset=8), For(Tuple([Name('k', Store(), lineno=23, col_offset=12), Name('v', Store(), lineno=23, col_offset=15)], Store(), lineno=23, col_offset=12), Call(Attribute(Name('dict', Load(), lineno=23, col_offset=20), 'iteritems', Load(), lineno=23, col_offset=20), [], [], None, None, lineno=23, col_offset=20), [If(BoolOp(Or(), [Call(Attribute(Name('k', Load(), lineno=24, col_offset=15), 'endswith', Load(), lineno=24, col_offset=15), [Str('_pre', lineno=24, col_offset=26)], [], None, None, lineno=24, col_offset=15), Call(Attribute(Name('k', Load(), lineno=24, col_offset=37), 'endswith', Load(), lineno=24, col_offset=37), [Str('_post', lineno=24, col_offset=48)], [], None, None, lineno=24, col_offset=37)], lineno=24, col_offset=15), [Assert(Call(Name('isinstance', Load(), lineno=25, col_offset=23), [Name('v', Load(), lineno=25, col_offset=34), Name('function', Load(), lineno=25, col_offset=37)], [], None, None, lineno=25, col_offset=23), None, lineno=25, col_offset=16)], [If(Call(Name('isinstance', Load(), lineno=26, col_offset=17), [Name('v', Load(), lineno=26, col_offset=28), Name('function', Load(), lineno=26, col_offset=31)], [], None, None, lineno=26, col_offset=17), [Expr(Call(Attribute(Name('methods', Load(), lineno=27, col_offset=16), 'append', Load(), lineno=27, col_offset=16), [Name('k', Load(), lineno=27, col_offset=31)], [], None, None, lineno=27, col_offset=16), lineno=27, col_offset=16)], [], lineno=26, col_offset=17)], lineno=24, col_offset=12)], [], lineno=23, col_offset=8), For(Name('m', Store(), lineno=28, col_offset=12), Name('methods', Load(), lineno=28, col_offset=17), [Assign([Name('pre', Store(), lineno=29, col_offset=12)], Call(Attribute(Name('dict', Load(), lineno=29, col_offset=18), 'get', Load(), lineno=29, col_offset=18), [BinOp(Str('%s_pre', lineno=29, col_offset=27), Mod(), Name('m', Load(), lineno=29, col_offset=38), lineno=29, col_offset=27)], [], None, None, lineno=29, col_offset=18), lineno=29, col_offset=12), Assign([Name('post', Store(), lineno=30, col_offset=12)], Call(Attribute(Name('dict', Load(), lineno=30, col_offset=19), 'get', Load(), lineno=30, col_offset=19), [BinOp(Str('%s_post', lineno=30, col_offset=28), Mod(), Name('m', Load(), lineno=30, col_offset=40), lineno=30, col_offset=28)], [], None, None, lineno=30, col_offset=19), lineno=30, col_offset=12), If(BoolOp(Or(), [Name('pre', Load(), lineno=31, col_offset=15), Name('post', Load(), lineno=31, col_offset=22)], lineno=31, col_offset=15), [Assign([Subscript(Name('dict', Load(), lineno=32, col_offset=16), Index(Name('k', Load(), lineno=32, col_offset=21)), Store(), lineno=32, col_offset=16)], Call(Attribute(Name('cls', Load(), lineno=32, col_offset=26), 'make_eiffel_method', Load(), lineno=32, col_offset=26), [Subscript(Name('dict', Load(), lineno=32, col_offset=49), Index(Name('m', Load(), lineno=32, col_offset=54)), Load(), lineno=32, col_offset=49), Name('pre', Load(), lineno=32, col_offset=58), Name('post', Load(), lineno=32, col_offset=63)], [], None, None, lineno=32, col_offset=26), lineno=32, col_offset=16)], [], lineno=31, col_offset=12)], [], lineno=28, col_offset=8)], [Name('classmethod', Load(), lineno=12, col_offset=5)], lineno=12, col_offset=4)], [], lineno=5, col_offset=0), ClassDef('EiffelMetaClass1', [Name('EiffelBaseMetaClass', Load(), lineno=34, col_offset=23)], [FunctionDef('make_eiffel_method', arguments([Name('func', Param(), lineno=38, col_offset=27), Name('pre', Param(), lineno=38, col_offset=33), Name('post', Param(), lineno=38, col_offset=38)], None, None, []), [FunctionDef('method', arguments([Name('self', Param(), lineno=39, col_offset=19)], 'args', 'kwargs', []), [If(Name('pre', Load(), lineno=40, col_offset=15), [Expr(Call(Name('pre', Load(), lineno=41, col_offset=16), [Name('self', Load(), lineno=41, col_offset=20)], [], Name('args', Load(), lineno=41, col_offset=27), Name('kwargs', Load(), lineno=41, col_offset=35), lineno=41, col_offset=16), lineno=41, col_offset=16)], [], lineno=40, col_offset=12), Assign([Name('x', Store(), lineno=42, col_offset=12)], Call(Name('func', Load(), lineno=42, col_offset=16), [Name('self', Load(), lineno=42, col_offset=21)], [], Name('args', Load(), lineno=42, col_offset=28), Name('kwargs', Load(), lineno=42, col_offset=36), lineno=42, col_offset=16), lineno=42, col_offset=12), If(Name('post', Load(), lineno=43, col_offset=15), [Expr(Call(Name('post', Load(), lineno=44, col_offset=16), [Name('self', Load(), lineno=44, col_offset=21), Name('x', Load(), lineno=44, col_offset=27)], [], Name('args', Load(), lineno=44, col_offset=31), Name('kwargs', Load(), lineno=44, col_offset=39), lineno=44, col_offset=16), lineno=44, col_offset=16)], [], lineno=43, col_offset=12), Return(Name('x', Load(), lineno=45, col_offset=19), lineno=45, col_offset=12)], [], lineno=39, col_offset=8), If(Attribute(Name('func', Load(), lineno=47, col_offset=11), '__doc__', Load(), lineno=47, col_offset=11), [Assign([Attribute(Name('method', Load(), lineno=48, col_offset=12), '__doc__', Store(), lineno=48, col_offset=12)], Attribute(Name('func', Load(), lineno=48, col_offset=29), '__doc__', Load(), lineno=48, col_offset=29), lineno=48, col_offset=12)], [], lineno=47, col_offset=8), Return(Name('method', Load(), lineno=50, col_offset=15), lineno=50, col_offset=8)], [Name('staticmethod', Load(), lineno=37, col_offset=5)], lineno=37, col_offset=4)], [], lineno=34, col_offset=0), ClassDef('EiffelMethodWrapper', [], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=54, col_offset=17), Name('inst', Param(), lineno=54, col_offset=23), Name('descr', Param(), lineno=54, col_offset=29)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=55, col_offset=8), '_inst', Store(), lineno=55, col_offset=8)], Name('inst', Load(), lineno=55, col_offset=21), lineno=55, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=56, col_offset=8), '_descr', Store(), lineno=56, col_offset=8)], Name('descr', Load(), lineno=56, col_offset=22), lineno=56, col_offset=8)], [], lineno=54, col_offset=4), FunctionDef('__call__', arguments([Name('self', Param(), lineno=58, col_offset=17)], 'args', 'kwargs', []), [Return(Call(Attribute(Attribute(Name('self', Load(), lineno=59, col_offset=15), '_descr', Load(), lineno=59, col_offset=15), 'callmethod', Load(), lineno=59, col_offset=15), [Attribute(Name('self', Load(), lineno=59, col_offset=38), '_inst', Load(), lineno=59, col_offset=38), Name('args', Load(), lineno=59, col_offset=50), Name('kwargs', Load(), lineno=59, col_offset=56)], [], None, None, lineno=59, col_offset=15), lineno=59, col_offset=8)], [], lineno=58, col_offset=4)], [], lineno=52, col_offset=0), ClassDef('EiffelDescriptor', [Name('object', Load(), lineno=61, col_offset=23)], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=63, col_offset=17), Name('func', Param(), lineno=63, col_offset=23), Name('pre', Param(), lineno=63, col_offset=29), Name('post', Param(), lineno=63, col_offset=34)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=64, col_offset=8), '_func', Store(), lineno=64, col_offset=8)], Name('func', Load(), lineno=64, col_offset=21), lineno=64, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=65, col_offset=8), '_pre', Store(), lineno=65, col_offset=8)], Name('pre', Load(), lineno=65, col_offset=20), lineno=65, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=66, col_offset=8), '_post', Store(), lineno=66, col_offset=8)], Name('post', Load(), lineno=66, col_offset=21), lineno=66, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=68, col_offset=8), '__name__', Store(), lineno=68, col_offset=8)], Attribute(Name('func', Load(), lineno=68, col_offset=24), '__name__', Load(), lineno=68, col_offset=24), lineno=68, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=69, col_offset=8), '__doc__', Store(), lineno=69, col_offset=8)], Attribute(Name('func', Load(), lineno=69, col_offset=23), '__doc__', Load(), lineno=69, col_offset=23), lineno=69, col_offset=8)], [], lineno=63, col_offset=4), FunctionDef('__get__', arguments([Name('self', Param(), lineno=71, col_offset=16), Name('obj', Param(), lineno=71, col_offset=22), Name('cls', Param(), lineno=71, col_offset=27)], None, None, []), [Return(Call(Name('EiffelMethodWrapper', Load(), lineno=72, col_offset=15), [Name('obj', Load(), lineno=72, col_offset=35), Name('self', Load(), lineno=72, col_offset=40)], [], None, None, lineno=72, col_offset=15), lineno=72, col_offset=8)], [], lineno=71, col_offset=4), FunctionDef('callmethod', arguments([Name('self', Param(), lineno=74, col_offset=19), Name('inst', Param(), lineno=74, col_offset=25), Name('args', Param(), lineno=74, col_offset=31), Name('kwargs', Param(), lineno=74, col_offset=37)], None, None, []), [If(Attribute(Name('self', Load(), lineno=75, col_offset=11), '_pre', Load(), lineno=75, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=76, col_offset=12), '_pre', Load(), lineno=76, col_offset=12), [Name('inst', Load(), lineno=76, col_offset=22)], [], Name('args', Load(), lineno=76, col_offset=29), Name('kwargs', Load(), lineno=76, col_offset=37), lineno=76, col_offset=12), lineno=76, col_offset=12)], [], lineno=75, col_offset=8), Assign([Name('x', Store(), lineno=77, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=77, col_offset=12), '_func', Load(), lineno=77, col_offset=12), [Name('inst', Load(), lineno=77, col_offset=23)], [], Name('args', Load(), lineno=77, col_offset=30), Name('kwargs', Load(), lineno=77, col_offset=38), lineno=77, col_offset=12), lineno=77, col_offset=8), If(Attribute(Name('self', Load(), lineno=78, col_offset=11), '_post', Load(), lineno=78, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=79, col_offset=12), '_post', Load(), lineno=79, col_offset=12), [Name('inst', Load(), lineno=79, col_offset=23), Name('x', Load(), lineno=79, col_offset=29)], [], Name('args', Load(), lineno=79, col_offset=33), Name('kwargs', Load(), lineno=79, col_offset=41), lineno=79, col_offset=12), lineno=79, col_offset=12)], [], lineno=78, col_offset=8), Return(Name('x', Load(), lineno=80, col_offset=15), lineno=80, col_offset=8)], [], lineno=74, col_offset=4)], [], lineno=61, col_offset=0), ClassDef('EiffelMetaClass2', [Name('EiffelBaseMetaClass', Load(), lineno=82, col_offset=23)], [Assign([Name('make_eiffel_method', Store(), lineno=85, col_offset=4)], Name('EiffelDescriptor', Load(), lineno=85, col_offset=25), lineno=85, col_offset=4)], [], lineno=82, col_offset=0), FunctionDef('_test', arguments([Name('metaclass', Param(), lineno=87, col_offset=10)], None, None, []), [ClassDef('Eiffel', [], [Assign([Name('__metaclass__', Store(), lineno=89, col_offset=8)], Name('metaclass', Load(), lineno=89, col_offset=24), lineno=89, col_offset=8)], [], lineno=88, col_offset=4), ClassDef('Test', [Name('Eiffel', Load(), lineno=91, col_offset=15)], [FunctionDef('m', arguments([Name('self', Param(), lineno=93, col_offset=14), Name('arg', Param(), lineno=93, col_offset=20)], None, None, []), [Expr(Str('Make it a little larger', lineno=94, col_offset=12), lineno=94, col_offset=12), Return(BinOp(Name('arg', Load(), lineno=95, col_offset=19), Add(), Num(1, lineno=95, col_offset=25), lineno=95, col_offset=19), lineno=95, col_offset=12)], [], lineno=93, col_offset=8), FunctionDef('m2', arguments([Name('self', Param(), lineno=97, col_offset=15), Name('arg', Param(), lineno=97, col_offset=21)], None, None, []), [Expr(Str('Make it a little larger', lineno=98, col_offset=12), lineno=98, col_offset=12), Return(BinOp(Name('arg', Load(), lineno=99, col_offset=19), Add(), Num(1, lineno=99, col_offset=25), lineno=99, col_offset=19), lineno=99, col_offset=12)], [], lineno=97, col_offset=8), FunctionDef('m2_pre', arguments([Name('self', Param(), lineno=101, col_offset=19), Name('arg', Param(), lineno=101, col_offset=25)], None, None, []), [Assert(Compare(Name('arg', Load(), lineno=102, col_offset=19), [Gt()], [Num(0, lineno=102, col_offset=25)], lineno=102, col_offset=19), None, lineno=102, col_offset=12)], [], lineno=101, col_offset=8), FunctionDef('m2_post', arguments([Name('self', Param(), lineno=104, col_offset=20), Name('result', Param(), lineno=104, col_offset=26), Name('arg', Param(), lineno=104, col_offset=34)], None, None, []), [Assert(Compare(Name('result', Load(), lineno=105, col_offset=19), [Gt()], [Name('arg', Load(), lineno=105, col_offset=28)], lineno=105, col_offset=19), None, lineno=105, col_offset=12)], [], lineno=104, col_offset=8)], [], lineno=91, col_offset=4), ClassDef('Sub', [Name('Test', Load(), lineno=107, col_offset=14)], [FunctionDef('m2', arguments([Name('self', Param(), lineno=108, col_offset=15), Name('arg', Param(), lineno=108, col_offset=21)], None, None, []), [Return(BinOp(Name('arg', Load(), lineno=109, col_offset=19), Pow(), Num(2, lineno=109, col_offset=24), lineno=109, col_offset=19), lineno=109, col_offset=12)], [], lineno=108, col_offset=8), FunctionDef('m2_post', arguments([Name('self', Param(), lineno=110, col_offset=20), Name('Result', Param(), lineno=110, col_offset=26), Name('arg', Param(), lineno=110, col_offset=34)], None, None, []), [Expr(Call(Attribute(Call(Name('super', Load(), lineno=111, col_offset=12), [Name('Sub', Load(), lineno=111, col_offset=18), Name('self', Load(), lineno=111, col_offset=23)], [], None, None, lineno=111, col_offset=12), 'm2_post', Load(), lineno=111, col_offset=12), [Name('Result', Load(), lineno=111, col_offset=37), Name('arg', Load(), lineno=111, col_offset=45)], [], None, None, lineno=111, col_offset=12), lineno=111, col_offset=12), Assert(Compare(Name('Result', Load(), lineno=112, col_offset=19), [Lt()], [Num(100, lineno=112, col_offset=28)], lineno=112, col_offset=19), None, lineno=112, col_offset=12)], [], lineno=110, col_offset=8)], [], lineno=107, col_offset=4), Assign([Name('t', Store(), lineno=114, col_offset=4)], Call(Name('Test', Load(), lineno=114, col_offset=8), [], [], None, None, lineno=114, col_offset=8), lineno=114, col_offset=4), Expr(Call(Attribute(Name('t', Load(), lineno=115, col_offset=4), 'm', Load(), lineno=115, col_offset=4), [Num(1, lineno=115, col_offset=8)], [], None, None, lineno=115, col_offset=4), lineno=115, col_offset=4), Expr(Call(Attribute(Name('t', Load(), lineno=116, col_offset=4), 'm2', Load(), lineno=116, col_offset=4), [Num(1, lineno=116, col_offset=9)], [], None, None, lineno=116, col_offset=4), lineno=116, col_offset=4), TryExcept([Expr(Call(Attribute(Name('t', Load(), lineno=118, col_offset=8), 'm2', Load(), lineno=118, col_offset=8), [Num(0, lineno=118, col_offset=13)], [], None, None, lineno=118, col_offset=8), lineno=118, col_offset=8)], [ExceptHandler(Name('AssertionError', Load(), lineno=119, col_offset=11), None, [Pass( lineno=120, col_offset=8)], lineno=119, col_offset=4)], [Assert(Name('False', Load(), lineno=122, col_offset=15), None, lineno=122, col_offset=8)], lineno=117, col_offset=4), Assign([Name('s', Store(), lineno=124, col_offset=4)], Call(Name('Sub', Load(), lineno=124, col_offset=8), [], [], None, None, lineno=124, col_offset=8), lineno=124, col_offset=4), TryExcept([Expr(Call(Attribute(Name('s', Load(), lineno=126, col_offset=8), 'm2', Load(), lineno=126, col_offset=8), [Num(1, lineno=126, col_offset=13)], [], None, None, lineno=126, col_offset=8), lineno=126, col_offset=8)], [ExceptHandler(Name('AssertionError', Load(), lineno=127, col_offset=11), None, [Pass( lineno=128, col_offset=8)], lineno=127, col_offset=4)], [Assert(Name('False', Load(), lineno=130, col_offset=15), None, lineno=130, col_offset=8)], lineno=125, col_offset=4), TryExcept([Expr(Call(Attribute(Name('s', Load(), lineno=132, col_offset=8), 'm2', Load(), lineno=132, col_offset=8), [Num(10, lineno=132, col_offset=13)], [], None, None, lineno=132, col_offset=8), lineno=132, col_offset=8)], [ExceptHandler(Name('AssertionError', Load(), lineno=133, col_offset=11), None, [Pass( lineno=134, col_offset=8)], lineno=133, col_offset=4)], [Assert(Name('False', Load(), lineno=136, col_offset=15), None, lineno=136, col_offset=8)], lineno=131, col_offset=4), Expr(Call(Attribute(Name('s', Load(), lineno=137, col_offset=4), 'm2', Load(), lineno=137, col_offset=4), [Num(5, lineno=137, col_offset=9)], [], None, None, lineno=137, col_offset=4), lineno=137, col_offset=4)], [], lineno=87, col_offset=0), If(Compare(Name('__name__', Load(), lineno=139, col_offset=3), [Eq()], [Str('__main__', lineno=139, col_offset=15)], lineno=139, col_offset=3), [Expr(Call(Name('_test', Load(), lineno=140, col_offset=4), [Name('EiffelMetaClass1', Load(), lineno=140, col_offset=10)], [], None, None, lineno=140, col_offset=4), lineno=140, col_offset=4), Expr(Call(Name('_test', Load(), lineno=141, col_offset=4), [Name('EiffelMetaClass2', Load(), lineno=141, col_offset=10)], [], None, None, lineno=141, col_offset=4), lineno=141, col_offset=4)], [], lineno=139, col_offset=0)])
