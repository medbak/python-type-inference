Module([Expr(Str('SS1 -- a spreadsheet.', lineno=1, col_offset=0), lineno=1, col_offset=0), Import([alias('os', None)], lineno=3, col_offset=0), Import([alias('re', None)], lineno=4, col_offset=0), Import([alias('sys', None)], lineno=5, col_offset=0), Import([alias('cgi', None)], lineno=6, col_offset=0), Import([alias('rexec', None)], lineno=7, col_offset=0), ImportFrom('xml.parsers', [alias('expat', None)], 0, lineno=8, col_offset=0), Assign([Tuple([Name('LEFT', Store(), lineno=10, col_offset=0), Name('CENTER', Store(), lineno=10, col_offset=6), Name('RIGHT', Store(), lineno=10, col_offset=14)], Store(), lineno=10, col_offset=0)], Tuple([Str('LEFT', lineno=10, col_offset=22), Str('CENTER', lineno=10, col_offset=30), Str('RIGHT', lineno=10, col_offset=40)], Load(), lineno=10, col_offset=22), lineno=10, col_offset=0), FunctionDef('ljust', arguments([Name('x', Param(), lineno=12, col_offset=10), Name('n', Param(), lineno=12, col_offset=13)], None, None, []), [Return(Call(Attribute(Name('x', Load(), lineno=13, col_offset=11), 'ljust', Load(), lineno=13, col_offset=11), [Name('n', Load(), lineno=13, col_offset=19)], [], None, None, lineno=13, col_offset=11), lineno=13, col_offset=4)], [], lineno=12, col_offset=0), FunctionDef('center', arguments([Name('x', Param(), lineno=14, col_offset=11), Name('n', Param(), lineno=14, col_offset=14)], None, None, []), [Return(Call(Attribute(Name('x', Load(), lineno=15, col_offset=11), 'center', Load(), lineno=15, col_offset=11), [Name('n', Load(), lineno=15, col_offset=20)], [], None, None, lineno=15, col_offset=11), lineno=15, col_offset=4)], [], lineno=14, col_offset=0), FunctionDef('rjust', arguments([Name('x', Param(), lineno=16, col_offset=10), Name('n', Param(), lineno=16, col_offset=13)], None, None, []), [Return(Call(Attribute(Name('x', Load(), lineno=17, col_offset=11), 'rjust', Load(), lineno=17, col_offset=11), [Name('n', Load(), lineno=17, col_offset=19)], [], None, None, lineno=17, col_offset=11), lineno=17, col_offset=4)], [], lineno=16, col_offset=0), Assign([Name('align2action', Store(), lineno=18, col_offset=0)], Dict([Name('LEFT', Load(), lineno=18, col_offset=16), Name('CENTER', Load(), lineno=18, col_offset=29), Name('RIGHT', Load(), lineno=18, col_offset=45)], [Name('ljust', Load(), lineno=18, col_offset=22), Name('center', Load(), lineno=18, col_offset=37), Name('rjust', Load(), lineno=18, col_offset=52)], lineno=18, col_offset=15), lineno=18, col_offset=0), Assign([Name('align2xml', Store(), lineno=20, col_offset=0)], Dict([Name('LEFT', Load(), lineno=20, col_offset=13), Name('CENTER', Load(), lineno=20, col_offset=27), Name('RIGHT', Load(), lineno=20, col_offset=45)], [Str('left', lineno=20, col_offset=19), Str('center', lineno=20, col_offset=35), Str('right', lineno=20, col_offset=52)], lineno=20, col_offset=12), lineno=20, col_offset=0), Assign([Name('xml2align', Store(), lineno=21, col_offset=0)], Dict([Str('left', lineno=21, col_offset=13), Str('center', lineno=21, col_offset=27), Str('right', lineno=21, col_offset=45)], [Name('LEFT', Load(), lineno=21, col_offset=21), Name('CENTER', Load(), lineno=21, col_offset=37), Name('RIGHT', Load(), lineno=21, col_offset=54)], lineno=21, col_offset=12), lineno=21, col_offset=0), Assign([Name('align2anchor', Store(), lineno=23, col_offset=0)], Dict([Name('LEFT', Load(), lineno=23, col_offset=16), Name('CENTER', Load(), lineno=23, col_offset=27), Name('RIGHT', Load(), lineno=23, col_offset=45)], [Str('w', lineno=23, col_offset=22), Str('center', lineno=23, col_offset=35), Str('e', lineno=23, col_offset=52)], lineno=23, col_offset=15), lineno=23, col_offset=0), FunctionDef('sum', arguments([Name('seq', Param(), lineno=25, col_offset=8)], None, None, []), [Assign([Name('total', Store(), lineno=26, col_offset=4)], Num(0, lineno=26, col_offset=12), lineno=26, col_offset=4), For(Name('x', Store(), lineno=27, col_offset=8), Name('seq', Load(), lineno=27, col_offset=13), [If(Compare(Name('x', Load(), lineno=28, col_offset=11), [IsNot()], [Name('None', Load(), lineno=28, col_offset=20)], lineno=28, col_offset=11), [AugAssign(Name('total', Store(), lineno=29, col_offset=12), Add(), Name('x', Load(), lineno=29, col_offset=21), lineno=29, col_offset=12)], [], lineno=28, col_offset=8)], [], lineno=27, col_offset=4), Return(Name('total', Load(), lineno=30, col_offset=11), lineno=30, col_offset=4)], [], lineno=25, col_offset=0), ClassDef('Sheet', [], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=34, col_offset=17)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=35, col_offset=8), 'cells', Store(), lineno=35, col_offset=8)], Dict([], [], lineno=35, col_offset=21), lineno=35, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=36, col_offset=8), 'rexec', Store(), lineno=36, col_offset=8)], Call(Attribute(Name('rexec', Load(), lineno=36, col_offset=21), 'RExec', Load(), lineno=36, col_offset=21), [], [], None, None, lineno=36, col_offset=21), lineno=36, col_offset=8), Assign([Name('m', Store(), lineno=37, col_offset=8)], Call(Attribute(Attribute(Name('self', Load(), lineno=37, col_offset=12), 'rexec', Load(), lineno=37, col_offset=12), 'add_module', Load(), lineno=37, col_offset=12), [Str('__main__', lineno=37, col_offset=34)], [], None, None, lineno=37, col_offset=12), lineno=37, col_offset=8), Assign([Attribute(Name('m', Load(), lineno=38, col_offset=8), 'cell', Store(), lineno=38, col_offset=8)], Attribute(Name('self', Load(), lineno=38, col_offset=17), 'cellvalue', Load(), lineno=38, col_offset=17), lineno=38, col_offset=8), Assign([Attribute(Name('m', Load(), lineno=39, col_offset=8), 'cells', Store(), lineno=39, col_offset=8)], Attribute(Name('self', Load(), lineno=39, col_offset=18), 'multicellvalue', Load(), lineno=39, col_offset=18), lineno=39, col_offset=8), Assign([Attribute(Name('m', Load(), lineno=40, col_offset=8), 'sum', Store(), lineno=40, col_offset=8)], Name('sum', Load(), lineno=40, col_offset=16), lineno=40, col_offset=8)], [], lineno=34, col_offset=4), FunctionDef('cellvalue', arguments([Name('self', Param(), lineno=42, col_offset=18), Name('x', Param(), lineno=42, col_offset=24), Name('y', Param(), lineno=42, col_offset=27)], None, None, []), [Assign([Name('cell', Store(), lineno=43, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=43, col_offset=15), 'getcell', Load(), lineno=43, col_offset=15), [Name('x', Load(), lineno=43, col_offset=28), Name('y', Load(), lineno=43, col_offset=31)], [], None, None, lineno=43, col_offset=15), lineno=43, col_offset=8), If(Call(Name('hasattr', Load(), lineno=44, col_offset=11), [Name('cell', Load(), lineno=44, col_offset=19), Str('recalc', lineno=44, col_offset=25)], [], None, None, lineno=44, col_offset=11), [Return(Call(Attribute(Name('cell', Load(), lineno=45, col_offset=19), 'recalc', Load(), lineno=45, col_offset=19), [Attribute(Name('self', Load(), lineno=45, col_offset=31), 'rexec', Load(), lineno=45, col_offset=31)], [], None, None, lineno=45, col_offset=19), lineno=45, col_offset=12)], [Return(Name('cell', Load(), lineno=47, col_offset=19), lineno=47, col_offset=12)], lineno=44, col_offset=8)], [], lineno=42, col_offset=4), FunctionDef('multicellvalue', arguments([Name('self', Param(), lineno=49, col_offset=23), Name('x1', Param(), lineno=49, col_offset=29), Name('y1', Param(), lineno=49, col_offset=33), Name('x2', Param(), lineno=49, col_offset=37), Name('y2', Param(), lineno=49, col_offset=41)], None, None, []), [If(Compare(Name('x1', Load(), lineno=50, col_offset=11), [Gt()], [Name('x2', Load(), lineno=50, col_offset=16)], lineno=50, col_offset=11), [Assign([Tuple([Name('x1', Store(), lineno=51, col_offset=12), Name('x2', Store(), lineno=51, col_offset=16)], Store(), lineno=51, col_offset=12)], Tuple([Name('x2', Load(), lineno=51, col_offset=21), Name('x1', Load(), lineno=51, col_offset=25)], Load(), lineno=51, col_offset=21), lineno=51, col_offset=12)], [], lineno=50, col_offset=8), If(Compare(Name('y1', Load(), lineno=52, col_offset=11), [Gt()], [Name('y2', Load(), lineno=52, col_offset=16)], lineno=52, col_offset=11), [Assign([Tuple([Name('y1', Store(), lineno=53, col_offset=12), Name('y2', Store(), lineno=53, col_offset=16)], Store(), lineno=53, col_offset=12)], Tuple([Name('y2', Load(), lineno=53, col_offset=21), Name('y1', Load(), lineno=53, col_offset=25)], Load(), lineno=53, col_offset=21), lineno=53, col_offset=12)], [], lineno=52, col_offset=8), Assign([Name('seq', Store(), lineno=54, col_offset=8)], List([], Load(), lineno=54, col_offset=14), lineno=54, col_offset=8), For(Name('y', Store(), lineno=55, col_offset=12), Call(Name('range', Load(), lineno=55, col_offset=17), [Name('y1', Load(), lineno=55, col_offset=23), BinOp(Name('y2', Load(), lineno=55, col_offset=27), Add(), Num(1, lineno=55, col_offset=30), lineno=55, col_offset=27)], [], None, None, lineno=55, col_offset=17), [For(Name('x', Store(), lineno=56, col_offset=16), Call(Name('range', Load(), lineno=56, col_offset=21), [Name('x1', Load(), lineno=56, col_offset=27), BinOp(Name('x2', Load(), lineno=56, col_offset=31), Add(), Num(1, lineno=56, col_offset=34), lineno=56, col_offset=31)], [], None, None, lineno=56, col_offset=21), [Expr(Call(Attribute(Name('seq', Load(), lineno=57, col_offset=16), 'append', Load(), lineno=57, col_offset=16), [Call(Attribute(Name('self', Load(), lineno=57, col_offset=27), 'cellvalue', Load(), lineno=57, col_offset=27), [Name('x', Load(), lineno=57, col_offset=42), Name('y', Load(), lineno=57, col_offset=45)], [], None, None, lineno=57, col_offset=27)], [], None, None, lineno=57, col_offset=16), lineno=57, col_offset=16)], [], lineno=56, col_offset=12)], [], lineno=55, col_offset=8), Return(Name('seq', Load(), lineno=58, col_offset=15), lineno=58, col_offset=8)], [], lineno=49, col_offset=4), FunctionDef('getcell', arguments([Name('self', Param(), lineno=60, col_offset=16), Name('x', Param(), lineno=60, col_offset=22), Name('y', Param(), lineno=60, col_offset=25)], None, None, []), [Return(Call(Attribute(Attribute(Name('self', Load(), lineno=61, col_offset=15), 'cells', Load(), lineno=61, col_offset=15), 'get', Load(), lineno=61, col_offset=15), [Tuple([Name('x', Load(), lineno=61, col_offset=31), Name('y', Load(), lineno=61, col_offset=34)], Load(), lineno=61, col_offset=31)], [], None, None, lineno=61, col_offset=15), lineno=61, col_offset=8)], [], lineno=60, col_offset=4), FunctionDef('setcell', arguments([Name('self', Param(), lineno=63, col_offset=16), Name('x', Param(), lineno=63, col_offset=22), Name('y', Param(), lineno=63, col_offset=25), Name('cell', Param(), lineno=63, col_offset=28)], None, None, []), [Assert(BoolOp(And(), [Compare(Name('x', Load(), lineno=64, col_offset=15), [Gt()], [Num(0, lineno=64, col_offset=19)], lineno=64, col_offset=15), Compare(Name('y', Load(), lineno=64, col_offset=25), [Gt()], [Num(0, lineno=64, col_offset=29)], lineno=64, col_offset=25)], lineno=64, col_offset=15), None, lineno=64, col_offset=8), Assert(Call(Name('isinstance', Load(), lineno=65, col_offset=15), [Name('cell', Load(), lineno=65, col_offset=26), Name('BaseCell', Load(), lineno=65, col_offset=32)], [], None, None, lineno=65, col_offset=15), None, lineno=65, col_offset=8), Assign([Subscript(Attribute(Name('self', Load(), lineno=66, col_offset=8), 'cells', Load(), lineno=66, col_offset=8), Index(Tuple([Name('x', Load(), lineno=66, col_offset=19), Name('y', Load(), lineno=66, col_offset=22)], Load(), lineno=66, col_offset=19)), Store(), lineno=66, col_offset=8)], Name('cell', Load(), lineno=66, col_offset=27), lineno=66, col_offset=8)], [], lineno=63, col_offset=4), FunctionDef('clearcell', arguments([Name('self', Param(), lineno=68, col_offset=18), Name('x', Param(), lineno=68, col_offset=24), Name('y', Param(), lineno=68, col_offset=27)], None, None, []), [TryExcept([Delete([Subscript(Attribute(Name('self', Load(), lineno=70, col_offset=16), 'cells', Load(), lineno=70, col_offset=16), Index(Tuple([Name('x', Load(), lineno=70, col_offset=27), Name('y', Load(), lineno=70, col_offset=30)], Load(), lineno=70, col_offset=27)), Del(), lineno=70, col_offset=16)], lineno=70, col_offset=12)], [ExceptHandler(Name('KeyError', Load(), lineno=71, col_offset=15), None, [Pass( lineno=72, col_offset=12)], lineno=71, col_offset=8)], [], lineno=69, col_offset=8)], [], lineno=68, col_offset=4), FunctionDef('clearcells', arguments([Name('self', Param(), lineno=74, col_offset=19), Name('x1', Param(), lineno=74, col_offset=25), Name('y1', Param(), lineno=74, col_offset=29), Name('x2', Param(), lineno=74, col_offset=33), Name('y2', Param(), lineno=74, col_offset=37)], None, None, []), [For(Name('xy', Store(), lineno=75, col_offset=12), Call(Attribute(Name('self', Load(), lineno=75, col_offset=18), 'selectcells', Load(), lineno=75, col_offset=18), [Name('x1', Load(), lineno=75, col_offset=35), Name('y1', Load(), lineno=75, col_offset=39), Name('x2', Load(), lineno=75, col_offset=43), Name('y2', Load(), lineno=75, col_offset=47)], [], None, None, lineno=75, col_offset=18), [Delete([Subscript(Attribute(Name('self', Load(), lineno=76, col_offset=16), 'cells', Load(), lineno=76, col_offset=16), Index(Name('xy', Load(), lineno=76, col_offset=27)), Del(), lineno=76, col_offset=16)], lineno=76, col_offset=12)], [], lineno=75, col_offset=8)], [], lineno=74, col_offset=4), FunctionDef('clearrows', arguments([Name('self', Param(), lineno=78, col_offset=18), Name('y1', Param(), lineno=78, col_offset=24), Name('y2', Param(), lineno=78, col_offset=28)], None, None, []), [Expr(Call(Attribute(Name('self', Load(), lineno=79, col_offset=8), 'clearcells', Load(), lineno=79, col_offset=8), [Num(0, lineno=79, col_offset=24), Name('y1', Load(), lineno=79, col_offset=27), Attribute(Name('sys', Load(), lineno=79, col_offset=31), 'maxint', Load(), lineno=79, col_offset=31), Name('y2', Load(), lineno=79, col_offset=43)], [], None, None, lineno=79, col_offset=8), lineno=79, col_offset=8)], [], lineno=78, col_offset=4), FunctionDef('clearcolumns', arguments([Name('self', Param(), lineno=81, col_offset=21), Name('x1', Param(), lineno=81, col_offset=27), Name('x2', Param(), lineno=81, col_offset=31)], None, None, []), [Expr(Call(Attribute(Name('self', Load(), lineno=82, col_offset=8), 'clearcells', Load(), lineno=82, col_offset=8), [Name('x1', Load(), lineno=82, col_offset=24), Num(0, lineno=82, col_offset=28), Name('x2', Load(), lineno=82, col_offset=31), Attribute(Name('sys', Load(), lineno=82, col_offset=35), 'maxint', Load(), lineno=82, col_offset=35)], [], None, None, lineno=82, col_offset=8), lineno=82, col_offset=8)], [], lineno=81, col_offset=4), FunctionDef('selectcells', arguments([Name('self', Param(), lineno=84, col_offset=20), Name('x1', Param(), lineno=84, col_offset=26), Name('y1', Param(), lineno=84, col_offset=30), Name('x2', Param(), lineno=84, col_offset=34), Name('y2', Param(), lineno=84, col_offset=38)], None, None, []), [If(Compare(Name('x1', Load(), lineno=85, col_offset=11), [Gt()], [Name('x2', Load(), lineno=85, col_offset=16)], lineno=85, col_offset=11), [Assign([Tuple([Name('x1', Store(), lineno=86, col_offset=12), Name('x2', Store(), lineno=86, col_offset=16)], Store(), lineno=86, col_offset=12)], Tuple([Name('x2', Load(), lineno=86, col_offset=21), Name('x1', Load(), lineno=86, col_offset=25)], Load(), lineno=86, col_offset=21), lineno=86, col_offset=12)], [], lineno=85, col_offset=8), If(Compare(Name('y1', Load(), lineno=87, col_offset=11), [Gt()], [Name('y2', Load(), lineno=87, col_offset=16)], lineno=87, col_offset=11), [Assign([Tuple([Name('y1', Store(), lineno=88, col_offset=12), Name('y2', Store(), lineno=88, col_offset=16)], Store(), lineno=88, col_offset=12)], Tuple([Name('y2', Load(), lineno=88, col_offset=21), Name('y1', Load(), lineno=88, col_offset=25)], Load(), lineno=88, col_offset=21), lineno=88, col_offset=12)], [], lineno=87, col_offset=8), Return(ListComp(Tuple([Name('x', Load(), lineno=89, col_offset=17), Name('y', Load(), lineno=89, col_offset=20)], Load(), lineno=89, col_offset=17), [comprehension(Tuple([Name('x', Store(), lineno=89, col_offset=27), Name('y', Store(), lineno=89, col_offset=30)], Store(), lineno=89, col_offset=27), Attribute(Name('self', Load(), lineno=89, col_offset=35), 'cells', Load(), lineno=89, col_offset=35), [BoolOp(And(), [Compare(Name('x1', Load(), lineno=90, col_offset=19), [LtE(), LtE()], [Name('x', Load(), lineno=90, col_offset=25), Name('x2', Load(), lineno=90, col_offset=30)], lineno=90, col_offset=19), Compare(Name('y1', Load(), lineno=90, col_offset=37), [LtE(), LtE()], [Name('y', Load(), lineno=90, col_offset=43), Name('y2', Load(), lineno=90, col_offset=48)], lineno=90, col_offset=37)], lineno=90, col_offset=19)])], lineno=89, col_offset=16), lineno=89, col_offset=8)], [], lineno=84, col_offset=4), FunctionDef('movecells', arguments([Name('self', Param(), lineno=92, col_offset=18), Name('x1', Param(), lineno=92, col_offset=24), Name('y1', Param(), lineno=92, col_offset=28), Name('x2', Param(), lineno=92, col_offset=32), Name('y2', Param(), lineno=92, col_offset=36), Name('dx', Param(), lineno=92, col_offset=40), Name('dy', Param(), lineno=92, col_offset=44)], None, None, []), [If(BoolOp(And(), [Compare(Name('dx', Load(), lineno=93, col_offset=11), [Eq()], [Num(0, lineno=93, col_offset=17)], lineno=93, col_offset=11), Compare(Name('dy', Load(), lineno=93, col_offset=23), [Eq()], [Num(0, lineno=93, col_offset=29)], lineno=93, col_offset=23)], lineno=93, col_offset=11), [Return(None, lineno=94, col_offset=12)], [], lineno=93, col_offset=8), If(Compare(Name('x1', Load(), lineno=95, col_offset=11), [Gt()], [Name('x2', Load(), lineno=95, col_offset=16)], lineno=95, col_offset=11), [Assign([Tuple([Name('x1', Store(), lineno=96, col_offset=12), Name('x2', Store(), lineno=96, col_offset=16)], Store(), lineno=96, col_offset=12)], Tuple([Name('x2', Load(), lineno=96, col_offset=21), Name('x1', Load(), lineno=96, col_offset=25)], Load(), lineno=96, col_offset=21), lineno=96, col_offset=12)], [], lineno=95, col_offset=8), If(Compare(Name('y1', Load(), lineno=97, col_offset=11), [Gt()], [Name('y2', Load(), lineno=97, col_offset=16)], lineno=97, col_offset=11), [Assign([Tuple([Name('y1', Store(), lineno=98, col_offset=12), Name('y2', Store(), lineno=98, col_offset=16)], Store(), lineno=98, col_offset=12)], Tuple([Name('y2', Load(), lineno=98, col_offset=21), Name('y1', Load(), lineno=98, col_offset=25)], Load(), lineno=98, col_offset=21), lineno=98, col_offset=12)], [], lineno=97, col_offset=8), Assert(BoolOp(And(), [Compare(BinOp(Name('x1', Load(), lineno=99, col_offset=15), Add(), Name('dx', Load(), lineno=99, col_offset=18), lineno=99, col_offset=15), [Gt()], [Num(0, lineno=99, col_offset=23)], lineno=99, col_offset=15), Compare(BinOp(Name('y1', Load(), lineno=99, col_offset=29), Add(), Name('dy', Load(), lineno=99, col_offset=32), lineno=99, col_offset=29), [Gt()], [Num(0, lineno=99, col_offset=37)], lineno=99, col_offset=29)], lineno=99, col_offset=15), None, lineno=99, col_offset=8), Assign([Name('new', Store(), lineno=100, col_offset=8)], Dict([], [], lineno=100, col_offset=14), lineno=100, col_offset=8), For(Tuple([Name('x', Store(), lineno=101, col_offset=12), Name('y', Store(), lineno=101, col_offset=15)], Store(), lineno=101, col_offset=12), Attribute(Name('self', Load(), lineno=101, col_offset=20), 'cells', Load(), lineno=101, col_offset=20), [Assign([Name('cell', Store(), lineno=102, col_offset=12)], Subscript(Attribute(Name('self', Load(), lineno=102, col_offset=19), 'cells', Load(), lineno=102, col_offset=19), Index(Tuple([Name('x', Load(), lineno=102, col_offset=30), Name('y', Load(), lineno=102, col_offset=33)], Load(), lineno=102, col_offset=30)), Load(), lineno=102, col_offset=19), lineno=102, col_offset=12), If(Call(Name('hasattr', Load(), lineno=103, col_offset=15), [Name('cell', Load(), lineno=103, col_offset=23), Str('renumber', lineno=103, col_offset=29)], [], None, None, lineno=103, col_offset=15), [Assign([Name('cell', Store(), lineno=104, col_offset=16)], Call(Attribute(Name('cell', Load(), lineno=104, col_offset=23), 'renumber', Load(), lineno=104, col_offset=23), [Name('x1', Load(), lineno=104, col_offset=37), Name('y1', Load(), lineno=104, col_offset=41), Name('x2', Load(), lineno=104, col_offset=45), Name('y2', Load(), lineno=104, col_offset=49), Name('dx', Load(), lineno=104, col_offset=53), Name('dy', Load(), lineno=104, col_offset=57)], [], None, None, lineno=104, col_offset=23), lineno=104, col_offset=16)], [], lineno=103, col_offset=12), If(BoolOp(And(), [Compare(Name('x1', Load(), lineno=105, col_offset=15), [LtE(), LtE()], [Name('x', Load(), lineno=105, col_offset=21), Name('x2', Load(), lineno=105, col_offset=26)], lineno=105, col_offset=15), Compare(Name('y1', Load(), lineno=105, col_offset=33), [LtE(), LtE()], [Name('y', Load(), lineno=105, col_offset=39), Name('y2', Load(), lineno=105, col_offset=44)], lineno=105, col_offset=33)], lineno=105, col_offset=15), [AugAssign(Name('x', Store(), lineno=106, col_offset=16), Add(), Name('dx', Load(), lineno=106, col_offset=21), lineno=106, col_offset=16), AugAssign(Name('y', Store(), lineno=107, col_offset=16), Add(), Name('dy', Load(), lineno=107, col_offset=21), lineno=107, col_offset=16)], [], lineno=105, col_offset=12), Assign([Subscript(Name('new', Load(), lineno=108, col_offset=12), Index(Tuple([Name('x', Load(), lineno=108, col_offset=16), Name('y', Load(), lineno=108, col_offset=19)], Load(), lineno=108, col_offset=16)), Store(), lineno=108, col_offset=12)], Name('cell', Load(), lineno=108, col_offset=24), lineno=108, col_offset=12)], [], lineno=101, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=109, col_offset=8), 'cells', Store(), lineno=109, col_offset=8)], Name('new', Load(), lineno=109, col_offset=21), lineno=109, col_offset=8)], [], lineno=92, col_offset=4), FunctionDef('insertrows', arguments([Name('self', Param(), lineno=111, col_offset=19), Name('y', Param(), lineno=111, col_offset=25), Name('n', Param(), lineno=111, col_offset=28)], None, None, []), [Assert(Compare(Name('n', Load(), lineno=112, col_offset=15), [Gt()], [Num(0, lineno=112, col_offset=19)], lineno=112, col_offset=15), None, lineno=112, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=113, col_offset=8), 'movecells', Load(), lineno=113, col_offset=8), [Num(0, lineno=113, col_offset=23), Name('y', Load(), lineno=113, col_offset=26), Attribute(Name('sys', Load(), lineno=113, col_offset=29), 'maxint', Load(), lineno=113, col_offset=29), Attribute(Name('sys', Load(), lineno=113, col_offset=41), 'maxint', Load(), lineno=113, col_offset=41), Num(0, lineno=113, col_offset=53), Name('n', Load(), lineno=113, col_offset=56)], [], None, None, lineno=113, col_offset=8), lineno=113, col_offset=8)], [], lineno=111, col_offset=4), FunctionDef('deleterows', arguments([Name('self', Param(), lineno=115, col_offset=19), Name('y1', Param(), lineno=115, col_offset=25), Name('y2', Param(), lineno=115, col_offset=29)], None, None, []), [If(Compare(Name('y1', Load(), lineno=116, col_offset=11), [Gt()], [Name('y2', Load(), lineno=116, col_offset=16)], lineno=116, col_offset=11), [Assign([Tuple([Name('y1', Store(), lineno=117, col_offset=12), Name('y2', Store(), lineno=117, col_offset=16)], Store(), lineno=117, col_offset=12)], Tuple([Name('y2', Load(), lineno=117, col_offset=21), Name('y1', Load(), lineno=117, col_offset=25)], Load(), lineno=117, col_offset=21), lineno=117, col_offset=12)], [], lineno=116, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=118, col_offset=8), 'clearrows', Load(), lineno=118, col_offset=8), [Name('y1', Load(), lineno=118, col_offset=23), Name('y2', Load(), lineno=118, col_offset=27)], [], None, None, lineno=118, col_offset=8), lineno=118, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=119, col_offset=8), 'movecells', Load(), lineno=119, col_offset=8), [Num(0, lineno=119, col_offset=23), BinOp(Name('y2', Load(), lineno=119, col_offset=26), Add(), Num(1, lineno=119, col_offset=29), lineno=119, col_offset=26), Attribute(Name('sys', Load(), lineno=119, col_offset=32), 'maxint', Load(), lineno=119, col_offset=32), Attribute(Name('sys', Load(), lineno=119, col_offset=44), 'maxint', Load(), lineno=119, col_offset=44), Num(0, lineno=119, col_offset=56), BinOp(BinOp(Name('y1', Load(), lineno=119, col_offset=59), Sub(), Name('y2', Load(), lineno=119, col_offset=62), lineno=119, col_offset=59), Sub(), Num(1, lineno=119, col_offset=65), lineno=119, col_offset=64)], [], None, None, lineno=119, col_offset=8), lineno=119, col_offset=8)], [], lineno=115, col_offset=4), FunctionDef('insertcolumns', arguments([Name('self', Param(), lineno=121, col_offset=22), Name('x', Param(), lineno=121, col_offset=28), Name('n', Param(), lineno=121, col_offset=31)], None, None, []), [Assert(Compare(Name('n', Load(), lineno=122, col_offset=15), [Gt()], [Num(0, lineno=122, col_offset=19)], lineno=122, col_offset=15), None, lineno=122, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=123, col_offset=8), 'movecells', Load(), lineno=123, col_offset=8), [Name('x', Load(), lineno=123, col_offset=23), Num(0, lineno=123, col_offset=26), Attribute(Name('sys', Load(), lineno=123, col_offset=29), 'maxint', Load(), lineno=123, col_offset=29), Attribute(Name('sys', Load(), lineno=123, col_offset=41), 'maxint', Load(), lineno=123, col_offset=41), Name('n', Load(), lineno=123, col_offset=53), Num(0, lineno=123, col_offset=56)], [], None, None, lineno=123, col_offset=8), lineno=123, col_offset=8)], [], lineno=121, col_offset=4), FunctionDef('deletecolumns', arguments([Name('self', Param(), lineno=125, col_offset=22), Name('x1', Param(), lineno=125, col_offset=28), Name('x2', Param(), lineno=125, col_offset=32)], None, None, []), [If(Compare(Name('x1', Load(), lineno=126, col_offset=11), [Gt()], [Name('x2', Load(), lineno=126, col_offset=16)], lineno=126, col_offset=11), [Assign([Tuple([Name('x1', Store(), lineno=127, col_offset=12), Name('x2', Store(), lineno=127, col_offset=16)], Store(), lineno=127, col_offset=12)], Tuple([Name('x2', Load(), lineno=127, col_offset=21), Name('x1', Load(), lineno=127, col_offset=25)], Load(), lineno=127, col_offset=21), lineno=127, col_offset=12)], [], lineno=126, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=128, col_offset=8), 'clearcells', Load(), lineno=128, col_offset=8), [Name('x1', Load(), lineno=128, col_offset=24), Name('x2', Load(), lineno=128, col_offset=28)], [], None, None, lineno=128, col_offset=8), lineno=128, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=129, col_offset=8), 'movecells', Load(), lineno=129, col_offset=8), [BinOp(Name('x2', Load(), lineno=129, col_offset=23), Add(), Num(1, lineno=129, col_offset=26), lineno=129, col_offset=23), Num(0, lineno=129, col_offset=29), Attribute(Name('sys', Load(), lineno=129, col_offset=32), 'maxint', Load(), lineno=129, col_offset=32), Attribute(Name('sys', Load(), lineno=129, col_offset=44), 'maxint', Load(), lineno=129, col_offset=44), BinOp(BinOp(Name('x1', Load(), lineno=129, col_offset=56), Sub(), Name('x2', Load(), lineno=129, col_offset=59), lineno=129, col_offset=56), Sub(), Num(1, lineno=129, col_offset=62), lineno=129, col_offset=61), Num(0, lineno=129, col_offset=65)], [], None, None, lineno=129, col_offset=8), lineno=129, col_offset=8)], [], lineno=125, col_offset=4), FunctionDef('getsize', arguments([Name('self', Param(), lineno=131, col_offset=16)], None, None, []), [Assign([Name('maxx', Store(), lineno=132, col_offset=8), Name('maxy', Store(), lineno=132, col_offset=15)], Num(0, lineno=132, col_offset=22), lineno=132, col_offset=8), For(Tuple([Name('x', Store(), lineno=133, col_offset=12), Name('y', Store(), lineno=133, col_offset=15)], Store(), lineno=133, col_offset=12), Attribute(Name('self', Load(), lineno=133, col_offset=20), 'cells', Load(), lineno=133, col_offset=20), [Assign([Name('maxx', Store(), lineno=134, col_offset=12)], Call(Name('max', Load(), lineno=134, col_offset=19), [Name('maxx', Load(), lineno=134, col_offset=23), Name('x', Load(), lineno=134, col_offset=29)], [], None, None, lineno=134, col_offset=19), lineno=134, col_offset=12), Assign([Name('maxy', Store(), lineno=135, col_offset=12)], Call(Name('max', Load(), lineno=135, col_offset=19), [Name('maxy', Load(), lineno=135, col_offset=23), Name('y', Load(), lineno=135, col_offset=29)], [], None, None, lineno=135, col_offset=19), lineno=135, col_offset=12)], [], lineno=133, col_offset=8), Return(Tuple([Name('maxx', Load(), lineno=136, col_offset=15), Name('maxy', Load(), lineno=136, col_offset=21)], Load(), lineno=136, col_offset=15), lineno=136, col_offset=8)], [], lineno=131, col_offset=4), FunctionDef('reset', arguments([Name('self', Param(), lineno=138, col_offset=14)], None, None, []), [For(Name('cell', Store(), lineno=139, col_offset=12), Call(Attribute(Attribute(Name('self', Load(), lineno=139, col_offset=20), 'cells', Load(), lineno=139, col_offset=20), 'itervalues', Load(), lineno=139, col_offset=20), [], [], None, None, lineno=139, col_offset=20), [If(Call(Name('hasattr', Load(), lineno=140, col_offset=15), [Name('cell', Load(), lineno=140, col_offset=23), Str('reset', lineno=140, col_offset=29)], [], None, None, lineno=140, col_offset=15), [Expr(Call(Attribute(Name('cell', Load(), lineno=141, col_offset=16), 'reset', Load(), lineno=141, col_offset=16), [], [], None, None, lineno=141, col_offset=16), lineno=141, col_offset=16)], [], lineno=140, col_offset=12)], [], lineno=139, col_offset=8)], [], lineno=138, col_offset=4), FunctionDef('recalc', arguments([Name('self', Param(), lineno=143, col_offset=15)], None, None, []), [Expr(Call(Attribute(Name('self', Load(), lineno=144, col_offset=8), 'reset', Load(), lineno=144, col_offset=8), [], [], None, None, lineno=144, col_offset=8), lineno=144, col_offset=8), For(Name('cell', Store(), lineno=145, col_offset=12), Call(Attribute(Attribute(Name('self', Load(), lineno=145, col_offset=20), 'cells', Load(), lineno=145, col_offset=20), 'itervalues', Load(), lineno=145, col_offset=20), [], [], None, None, lineno=145, col_offset=20), [If(Call(Name('hasattr', Load(), lineno=146, col_offset=15), [Name('cell', Load(), lineno=146, col_offset=23), Str('recalc', lineno=146, col_offset=29)], [], None, None, lineno=146, col_offset=15), [Expr(Call(Attribute(Name('cell', Load(), lineno=147, col_offset=16), 'recalc', Load(), lineno=147, col_offset=16), [Attribute(Name('self', Load(), lineno=147, col_offset=28), 'rexec', Load(), lineno=147, col_offset=28)], [], None, None, lineno=147, col_offset=16), lineno=147, col_offset=16)], [], lineno=146, col_offset=12)], [], lineno=145, col_offset=8)], [], lineno=143, col_offset=4), FunctionDef('display', arguments([Name('self', Param(), lineno=149, col_offset=16)], None, None, []), [Assign([Tuple([Name('maxx', Store(), lineno=150, col_offset=8), Name('maxy', Store(), lineno=150, col_offset=14)], Store(), lineno=150, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=150, col_offset=21), 'getsize', Load(), lineno=150, col_offset=21), [], [], None, None, lineno=150, col_offset=21), lineno=150, col_offset=8), Assign([Tuple([Name('width', Store(), lineno=151, col_offset=8), Name('height', Store(), lineno=151, col_offset=15)], Store(), lineno=151, col_offset=8)], Tuple([BinOp(Name('maxx', Load(), lineno=151, col_offset=24), Add(), Num(1, lineno=151, col_offset=29), lineno=151, col_offset=24), BinOp(Name('maxy', Load(), lineno=151, col_offset=32), Add(), Num(1, lineno=151, col_offset=37), lineno=151, col_offset=32)], Load(), lineno=151, col_offset=24), lineno=151, col_offset=8), Assign([Name('colwidth', Store(), lineno=152, col_offset=8)], BinOp(List([Num(1, lineno=152, col_offset=20)], Load(), lineno=152, col_offset=19), Mult(), Name('width', Load(), lineno=152, col_offset=25), lineno=152, col_offset=19), lineno=152, col_offset=8), Assign([Name('full', Store(), lineno=153, col_offset=8)], Dict([], [], lineno=153, col_offset=15), lineno=153, col_offset=8), For(Name('x', Store(), lineno=155, col_offset=12), Call(Name('range', Load(), lineno=155, col_offset=17), [Num(1, lineno=155, col_offset=23), Name('width', Load(), lineno=155, col_offset=26)], [], None, None, lineno=155, col_offset=17), [Assign([Subscript(Name('full', Load(), lineno=156, col_offset=12), Index(Tuple([Name('x', Load(), lineno=156, col_offset=17), Num(0, lineno=156, col_offset=20)], Load(), lineno=156, col_offset=17)), Store(), lineno=156, col_offset=12), Tuple([Name('text', Store(), lineno=156, col_offset=25), Name('alignment', Store(), lineno=156, col_offset=31)], Store(), lineno=156, col_offset=25)], Tuple([Call(Name('colnum2name', Load(), lineno=156, col_offset=43), [Name('x', Load(), lineno=156, col_offset=55)], [], None, None, lineno=156, col_offset=43), Name('RIGHT', Load(), lineno=156, col_offset=59)], Load(), lineno=156, col_offset=43), lineno=156, col_offset=12), Assign([Subscript(Name('colwidth', Load(), lineno=157, col_offset=12), Index(Name('x', Load(), lineno=157, col_offset=21)), Store(), lineno=157, col_offset=12)], Call(Name('max', Load(), lineno=157, col_offset=26), [Subscript(Name('colwidth', Load(), lineno=157, col_offset=30), Index(Name('x', Load(), lineno=157, col_offset=39)), Load(), lineno=157, col_offset=30), Call(Name('len', Load(), lineno=157, col_offset=43), [Name('text', Load(), lineno=157, col_offset=47)], [], None, None, lineno=157, col_offset=43)], [], None, None, lineno=157, col_offset=26), lineno=157, col_offset=12)], [], lineno=155, col_offset=8), For(Name('y', Store(), lineno=159, col_offset=12), Call(Name('range', Load(), lineno=159, col_offset=17), [Num(1, lineno=159, col_offset=23), Name('height', Load(), lineno=159, col_offset=26)], [], None, None, lineno=159, col_offset=17), [Assign([Subscript(Name('full', Load(), lineno=160, col_offset=12), Index(Tuple([Num(0, lineno=160, col_offset=17), Name('y', Load(), lineno=160, col_offset=20)], Load(), lineno=160, col_offset=17)), Store(), lineno=160, col_offset=12), Tuple([Name('text', Store(), lineno=160, col_offset=25), Name('alignment', Store(), lineno=160, col_offset=31)], Store(), lineno=160, col_offset=25)], Tuple([Call(Name('str', Load(), lineno=160, col_offset=43), [Name('y', Load(), lineno=160, col_offset=47)], [], None, None, lineno=160, col_offset=43), Name('RIGHT', Load(), lineno=160, col_offset=51)], Load(), lineno=160, col_offset=43), lineno=160, col_offset=12), Assign([Subscript(Name('colwidth', Load(), lineno=161, col_offset=12), Index(Num(0, lineno=161, col_offset=21)), Store(), lineno=161, col_offset=12)], Call(Name('max', Load(), lineno=161, col_offset=26), [Subscript(Name('colwidth', Load(), lineno=161, col_offset=30), Index(Num(0, lineno=161, col_offset=39)), Load(), lineno=161, col_offset=30), Call(Name('len', Load(), lineno=161, col_offset=43), [Name('text', Load(), lineno=161, col_offset=47)], [], None, None, lineno=161, col_offset=43)], [], None, None, lineno=161, col_offset=26), lineno=161, col_offset=12)], [], lineno=159, col_offset=8), For(Tuple([Tuple([Name('x', Store(), lineno=163, col_offset=13), Name('y', Store(), lineno=163, col_offset=16)], Store(), lineno=163, col_offset=13), Name('cell', Store(), lineno=163, col_offset=20)], Store(), lineno=163, col_offset=13), Call(Attribute(Attribute(Name('self', Load(), lineno=163, col_offset=28), 'cells', Load(), lineno=163, col_offset=28), 'iteritems', Load(), lineno=163, col_offset=28), [], [], None, None, lineno=163, col_offset=28), [If(BoolOp(Or(), [Compare(Name('x', Load(), lineno=164, col_offset=15), [LtE()], [Num(0, lineno=164, col_offset=20)], lineno=164, col_offset=15), Compare(Name('y', Load(), lineno=164, col_offset=25), [LtE()], [Num(0, lineno=164, col_offset=30)], lineno=164, col_offset=25)], lineno=164, col_offset=15), [Continue( lineno=165, col_offset=16)], [], lineno=164, col_offset=12), If(Call(Name('hasattr', Load(), lineno=166, col_offset=15), [Name('cell', Load(), lineno=166, col_offset=23), Str('recalc', lineno=166, col_offset=29)], [], None, None, lineno=166, col_offset=15), [Expr(Call(Attribute(Name('cell', Load(), lineno=167, col_offset=16), 'recalc', Load(), lineno=167, col_offset=16), [Attribute(Name('self', Load(), lineno=167, col_offset=28), 'rexec', Load(), lineno=167, col_offset=28)], [], None, None, lineno=167, col_offset=16), lineno=167, col_offset=16)], [], lineno=166, col_offset=12), If(Call(Name('hasattr', Load(), lineno=168, col_offset=15), [Name('cell', Load(), lineno=168, col_offset=23), Str('format', lineno=168, col_offset=29)], [], None, None, lineno=168, col_offset=15), [Assign([Tuple([Name('text', Store(), lineno=169, col_offset=16), Name('alignment', Store(), lineno=169, col_offset=22)], Store(), lineno=169, col_offset=16)], Call(Attribute(Name('cell', Load(), lineno=169, col_offset=34), 'format', Load(), lineno=169, col_offset=34), [], [], None, None, lineno=169, col_offset=34), lineno=169, col_offset=16), Assert(Call(Name('isinstance', Load(), lineno=170, col_offset=23), [Name('text', Load(), lineno=170, col_offset=34), Name('str', Load(), lineno=170, col_offset=40)], [], None, None, lineno=170, col_offset=23), None, lineno=170, col_offset=16), Assert(Compare(Name('alignment', Load(), lineno=171, col_offset=23), [In()], [Tuple([Name('LEFT', Load(), lineno=171, col_offset=37), Name('CENTER', Load(), lineno=171, col_offset=43), Name('RIGHT', Load(), lineno=171, col_offset=51)], Load(), lineno=171, col_offset=37)], lineno=171, col_offset=23), None, lineno=171, col_offset=16)], [Assign([Name('text', Store(), lineno=173, col_offset=16)], Call(Name('str', Load(), lineno=173, col_offset=23), [Name('cell', Load(), lineno=173, col_offset=27)], [], None, None, lineno=173, col_offset=23), lineno=173, col_offset=16), If(Call(Name('isinstance', Load(), lineno=174, col_offset=19), [Name('cell', Load(), lineno=174, col_offset=30), Name('str', Load(), lineno=174, col_offset=36)], [], None, None, lineno=174, col_offset=19), [Assign([Name('alignment', Store(), lineno=175, col_offset=20)], Name('LEFT', Load(), lineno=175, col_offset=32), lineno=175, col_offset=20)], [Assign([Name('alignment', Store(), lineno=177, col_offset=20)], Name('RIGHT', Load(), lineno=177, col_offset=32), lineno=177, col_offset=20)], lineno=174, col_offset=16)], lineno=168, col_offset=12), Assign([Subscript(Name('full', Load(), lineno=178, col_offset=12), Index(Tuple([Name('x', Load(), lineno=178, col_offset=17), Name('y', Load(), lineno=178, col_offset=20)], Load(), lineno=178, col_offset=17)), Store(), lineno=178, col_offset=12)], Tuple([Name('text', Load(), lineno=178, col_offset=26), Name('alignment', Load(), lineno=178, col_offset=32)], Load(), lineno=178, col_offset=26), lineno=178, col_offset=12), Assign([Subscript(Name('colwidth', Load(), lineno=179, col_offset=12), Index(Name('x', Load(), lineno=179, col_offset=21)), Store(), lineno=179, col_offset=12)], Call(Name('max', Load(), lineno=179, col_offset=26), [Subscript(Name('colwidth', Load(), lineno=179, col_offset=30), Index(Name('x', Load(), lineno=179, col_offset=39)), Load(), lineno=179, col_offset=30), Call(Name('len', Load(), lineno=179, col_offset=43), [Name('text', Load(), lineno=179, col_offset=47)], [], None, None, lineno=179, col_offset=43)], [], None, None, lineno=179, col_offset=26), lineno=179, col_offset=12)], [], lineno=163, col_offset=8), Assign([Name('sep', Store(), lineno=181, col_offset=8)], Str('', lineno=181, col_offset=14), lineno=181, col_offset=8), For(Name('x', Store(), lineno=182, col_offset=12), Call(Name('range', Load(), lineno=182, col_offset=17), [Name('width', Load(), lineno=182, col_offset=23)], [], None, None, lineno=182, col_offset=17), [If(Name('sep', Load(), lineno=183, col_offset=15), [AugAssign(Name('sep', Store(), lineno=184, col_offset=16), Add(), Str('+', lineno=184, col_offset=23), lineno=184, col_offset=16)], [], lineno=183, col_offset=12), AugAssign(Name('sep', Store(), lineno=185, col_offset=12), Add(), BinOp(Str('-', lineno=185, col_offset=19), Mult(), Subscript(Name('colwidth', Load(), lineno=185, col_offset=23), Index(Name('x', Load(), lineno=185, col_offset=32)), Load(), lineno=185, col_offset=23), lineno=185, col_offset=19), lineno=185, col_offset=12)], [], lineno=182, col_offset=8), For(Name('y', Store(), lineno=187, col_offset=12), Call(Name('range', Load(), lineno=187, col_offset=17), [Name('height', Load(), lineno=187, col_offset=23)], [], None, None, lineno=187, col_offset=17), [Assign([Name('line', Store(), lineno=188, col_offset=12)], Str('', lineno=188, col_offset=19), lineno=188, col_offset=12), For(Name('x', Store(), lineno=189, col_offset=16), Call(Name('range', Load(), lineno=189, col_offset=21), [Name('width', Load(), lineno=189, col_offset=27)], [], None, None, lineno=189, col_offset=21), [Assign([Tuple([Name('text', Store(), lineno=190, col_offset=16), Name('alignment', Store(), lineno=190, col_offset=22)], Store(), lineno=190, col_offset=16)], BoolOp(Or(), [Call(Attribute(Name('full', Load(), lineno=190, col_offset=34), 'get', Load(), lineno=190, col_offset=34), [Tuple([Name('x', Load(), lineno=190, col_offset=44), Name('y', Load(), lineno=190, col_offset=47)], Load(), lineno=190, col_offset=44)], [], None, None, lineno=190, col_offset=34), Tuple([Str('', lineno=190, col_offset=55), Name('LEFT', Load(), lineno=190, col_offset=59)], Load(), lineno=190, col_offset=55)], lineno=190, col_offset=34), lineno=190, col_offset=16), Assign([Name('text', Store(), lineno=191, col_offset=16)], Call(Subscript(Name('align2action', Load(), lineno=191, col_offset=23), Index(Name('alignment', Load(), lineno=191, col_offset=36)), Load(), lineno=191, col_offset=23), [Name('text', Load(), lineno=191, col_offset=47), Subscript(Name('colwidth', Load(), lineno=191, col_offset=53), Index(Name('x', Load(), lineno=191, col_offset=62)), Load(), lineno=191, col_offset=53)], [], None, None, lineno=191, col_offset=23), lineno=191, col_offset=16), If(Name('line', Load(), lineno=192, col_offset=19), [AugAssign(Name('line', Store(), lineno=193, col_offset=20), Add(), Str('|', lineno=193, col_offset=28), lineno=193, col_offset=20)], [], lineno=192, col_offset=16), AugAssign(Name('line', Store(), lineno=194, col_offset=16), Add(), Name('text', Load(), lineno=194, col_offset=24), lineno=194, col_offset=16)], [], lineno=189, col_offset=12), Print(None, [Name('line', Load(), lineno=195, col_offset=18)], True, lineno=195, col_offset=12), If(Compare(Name('y', Load(), lineno=196, col_offset=15), [Eq()], [Num(0, lineno=196, col_offset=20)], lineno=196, col_offset=15), [Print(None, [Name('sep', Load(), lineno=197, col_offset=22)], True, lineno=197, col_offset=16)], [], lineno=196, col_offset=12)], [], lineno=187, col_offset=8)], [], lineno=149, col_offset=4), FunctionDef('xml', arguments([Name('self', Param(), lineno=199, col_offset=12)], None, None, []), [Assign([Name('out', Store(), lineno=200, col_offset=8)], List([Str('<spreadsheet>', lineno=200, col_offset=15)], Load(), lineno=200, col_offset=14), lineno=200, col_offset=8), For(Tuple([Tuple([Name('x', Store(), lineno=201, col_offset=13), Name('y', Store(), lineno=201, col_offset=16)], Store(), lineno=201, col_offset=13), Name('cell', Store(), lineno=201, col_offset=20)], Store(), lineno=201, col_offset=13), Call(Attribute(Attribute(Name('self', Load(), lineno=201, col_offset=28), 'cells', Load(), lineno=201, col_offset=28), 'iteritems', Load(), lineno=201, col_offset=28), [], [], None, None, lineno=201, col_offset=28), [If(Call(Name('hasattr', Load(), lineno=202, col_offset=15), [Name('cell', Load(), lineno=202, col_offset=23), Str('xml', lineno=202, col_offset=29)], [], None, None, lineno=202, col_offset=15), [Assign([Name('cellxml', Store(), lineno=203, col_offset=16)], Call(Attribute(Name('cell', Load(), lineno=203, col_offset=26), 'xml', Load(), lineno=203, col_offset=26), [], [], None, None, lineno=203, col_offset=26), lineno=203, col_offset=16)], [Assign([Name('cellxml', Store(), lineno=205, col_offset=16)], BinOp(Str('<value>%s</value>', lineno=205, col_offset=26), Mod(), Call(Attribute(Name('cgi', Load(), lineno=205, col_offset=48), 'escape', Load(), lineno=205, col_offset=48), [Name('cell', Load(), lineno=205, col_offset=59)], [], None, None, lineno=205, col_offset=48), lineno=205, col_offset=26), lineno=205, col_offset=16)], lineno=202, col_offset=12), Expr(Call(Attribute(Name('out', Load(), lineno=206, col_offset=12), 'append', Load(), lineno=206, col_offset=12), [BinOp(Str('<cell row="%s" col="%s">\n  %s\n</cell>', lineno=206, col_offset=23), Mod(), Tuple([Name('y', Load(), lineno=207, col_offset=24), Name('x', Load(), lineno=207, col_offset=27), Name('cellxml', Load(), lineno=207, col_offset=30)], Load(), lineno=207, col_offset=24), lineno=206, col_offset=23)], [], None, None, lineno=206, col_offset=12), lineno=206, col_offset=12)], [], lineno=201, col_offset=8), Expr(Call(Attribute(Name('out', Load(), lineno=208, col_offset=8), 'append', Load(), lineno=208, col_offset=8), [Str('</spreadsheet>', lineno=208, col_offset=19)], [], None, None, lineno=208, col_offset=8), lineno=208, col_offset=8), Return(Call(Attribute(Str('\n', lineno=209, col_offset=15), 'join', Load(), lineno=209, col_offset=15), [Name('out', Load(), lineno=209, col_offset=25)], [], None, None, lineno=209, col_offset=15), lineno=209, col_offset=8)], [], lineno=199, col_offset=4), FunctionDef('save', arguments([Name('self', Param(), lineno=211, col_offset=13), Name('filename', Param(), lineno=211, col_offset=19)], None, None, []), [Assign([Name('text', Store(), lineno=212, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=212, col_offset=15), 'xml', Load(), lineno=212, col_offset=15), [], [], None, None, lineno=212, col_offset=15), lineno=212, col_offset=8), Assign([Name('f', Store(), lineno=213, col_offset=8)], Call(Name('open', Load(), lineno=213, col_offset=12), [Name('filename', Load(), lineno=213, col_offset=17), Str('w', lineno=213, col_offset=27)], [], None, None, lineno=213, col_offset=12), lineno=213, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=214, col_offset=8), 'write', Load(), lineno=214, col_offset=8), [Name('text', Load(), lineno=214, col_offset=16)], [], None, None, lineno=214, col_offset=8), lineno=214, col_offset=8), If(BoolOp(And(), [Name('text', Load(), lineno=215, col_offset=11), UnaryOp(Not(), Call(Attribute(Name('text', Load(), lineno=215, col_offset=24), 'endswith', Load(), lineno=215, col_offset=24), [Str('\n', lineno=215, col_offset=38)], [], None, None, lineno=215, col_offset=24), lineno=215, col_offset=20)], lineno=215, col_offset=11), [Expr(Call(Attribute(Name('f', Load(), lineno=216, col_offset=12), 'write', Load(), lineno=216, col_offset=12), [Str('\n', lineno=216, col_offset=20)], [], None, None, lineno=216, col_offset=12), lineno=216, col_offset=12)], [], lineno=215, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=217, col_offset=8), 'close', Load(), lineno=217, col_offset=8), [], [], None, None, lineno=217, col_offset=8), lineno=217, col_offset=8)], [], lineno=211, col_offset=4), FunctionDef('load', arguments([Name('self', Param(), lineno=219, col_offset=13), Name('filename', Param(), lineno=219, col_offset=19)], None, None, []), [Assign([Name('f', Store(), lineno=220, col_offset=8)], Call(Name('open', Load(), lineno=220, col_offset=12), [Name('filename', Load(), lineno=220, col_offset=17), Str('r', lineno=220, col_offset=27)], [], None, None, lineno=220, col_offset=12), lineno=220, col_offset=8), Expr(Call(Attribute(Call(Name('SheetParser', Load(), lineno=221, col_offset=8), [Name('self', Load(), lineno=221, col_offset=20)], [], None, None, lineno=221, col_offset=8), 'parsefile', Load(), lineno=221, col_offset=8), [Name('f', Load(), lineno=221, col_offset=36)], [], None, None, lineno=221, col_offset=8), lineno=221, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=222, col_offset=8), 'close', Load(), lineno=222, col_offset=8), [], [], None, None, lineno=222, col_offset=8), lineno=222, col_offset=8)], [], lineno=219, col_offset=4)], [], lineno=32, col_offset=0), ClassDef('SheetParser', [], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=226, col_offset=17), Name('sheet', Param(), lineno=226, col_offset=23)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=227, col_offset=8), 'sheet', Store(), lineno=227, col_offset=8)], Name('sheet', Load(), lineno=227, col_offset=21), lineno=227, col_offset=8)], [], lineno=226, col_offset=4), FunctionDef('parsefile', arguments([Name('self', Param(), lineno=229, col_offset=18), Name('f', Param(), lineno=229, col_offset=24)], None, None, []), [Assign([Name('parser', Store(), lineno=230, col_offset=8)], Call(Attribute(Name('expat', Load(), lineno=230, col_offset=17), 'ParserCreate', Load(), lineno=230, col_offset=17), [], [], None, None, lineno=230, col_offset=17), lineno=230, col_offset=8), Assign([Attribute(Name('parser', Load(), lineno=231, col_offset=8), 'StartElementHandler', Store(), lineno=231, col_offset=8)], Attribute(Name('self', Load(), lineno=231, col_offset=37), 'startelement', Load(), lineno=231, col_offset=37), lineno=231, col_offset=8), Assign([Attribute(Name('parser', Load(), lineno=232, col_offset=8), 'EndElementHandler', Store(), lineno=232, col_offset=8)], Attribute(Name('self', Load(), lineno=232, col_offset=35), 'endelement', Load(), lineno=232, col_offset=35), lineno=232, col_offset=8), Assign([Attribute(Name('parser', Load(), lineno=233, col_offset=8), 'CharacterDataHandler', Store(), lineno=233, col_offset=8)], Attribute(Name('self', Load(), lineno=233, col_offset=38), 'data', Load(), lineno=233, col_offset=38), lineno=233, col_offset=8), Expr(Call(Attribute(Name('parser', Load(), lineno=234, col_offset=8), 'ParseFile', Load(), lineno=234, col_offset=8), [Name('f', Load(), lineno=234, col_offset=25)], [], None, None, lineno=234, col_offset=8), lineno=234, col_offset=8)], [], lineno=229, col_offset=4), FunctionDef('startelement', arguments([Name('self', Param(), lineno=236, col_offset=21), Name('tag', Param(), lineno=236, col_offset=27), Name('attrs', Param(), lineno=236, col_offset=32)], None, None, []), [Assign([Name('method', Store(), lineno=237, col_offset=8)], Call(Name('getattr', Load(), lineno=237, col_offset=17), [Name('self', Load(), lineno=237, col_offset=25), BinOp(Str('start_', lineno=237, col_offset=31), Add(), Name('tag', Load(), lineno=237, col_offset=40), lineno=237, col_offset=31), Name('None', Load(), lineno=237, col_offset=45)], [], None, None, lineno=237, col_offset=17), lineno=237, col_offset=8), If(Name('method', Load(), lineno=238, col_offset=11), [For(Tuple([Name('key', Store(), lineno=239, col_offset=16), Name('value', Store(), lineno=239, col_offset=21)], Store(), lineno=239, col_offset=16), Call(Attribute(Name('attrs', Load(), lineno=239, col_offset=30), 'iteritems', Load(), lineno=239, col_offset=30), [], [], None, None, lineno=239, col_offset=30), [Assign([Subscript(Name('attrs', Load(), lineno=240, col_offset=16), Index(Name('key', Load(), lineno=240, col_offset=22)), Store(), lineno=240, col_offset=16)], Call(Name('str', Load(), lineno=240, col_offset=29), [Name('value', Load(), lineno=240, col_offset=33)], [], None, None, lineno=240, col_offset=29), lineno=240, col_offset=16)], [], lineno=239, col_offset=12), Expr(Call(Name('method', Load(), lineno=241, col_offset=12), [Name('attrs', Load(), lineno=241, col_offset=19)], [], None, None, lineno=241, col_offset=12), lineno=241, col_offset=12)], [], lineno=238, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=242, col_offset=8), 'texts', Store(), lineno=242, col_offset=8)], List([], Load(), lineno=242, col_offset=21), lineno=242, col_offset=8)], [], lineno=236, col_offset=4), FunctionDef('data', arguments([Name('self', Param(), lineno=244, col_offset=13), Name('text', Param(), lineno=244, col_offset=19)], None, None, []), [Assign([Name('text', Store(), lineno=245, col_offset=8)], Call(Name('str', Load(), lineno=245, col_offset=15), [Name('text', Load(), lineno=245, col_offset=19)], [], None, None, lineno=245, col_offset=15), lineno=245, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=246, col_offset=8), 'texts', Load(), lineno=246, col_offset=8), 'append', Load(), lineno=246, col_offset=8), [Name('text', Load(), lineno=246, col_offset=26)], [], None, None, lineno=246, col_offset=8), lineno=246, col_offset=8)], [], lineno=244, col_offset=4), FunctionDef('endelement', arguments([Name('self', Param(), lineno=248, col_offset=19), Name('tag', Param(), lineno=248, col_offset=25)], None, None, []), [Assign([Name('method', Store(), lineno=249, col_offset=8)], Call(Name('getattr', Load(), lineno=249, col_offset=17), [Name('self', Load(), lineno=249, col_offset=25), BinOp(Str('end_', lineno=249, col_offset=31), Add(), Name('tag', Load(), lineno=249, col_offset=38), lineno=249, col_offset=31), Name('None', Load(), lineno=249, col_offset=43)], [], None, None, lineno=249, col_offset=17), lineno=249, col_offset=8), If(Name('method', Load(), lineno=250, col_offset=11), [Expr(Call(Name('method', Load(), lineno=251, col_offset=12), [Call(Attribute(Str('', lineno=251, col_offset=19), 'join', Load(), lineno=251, col_offset=19), [Attribute(Name('self', Load(), lineno=251, col_offset=27), 'texts', Load(), lineno=251, col_offset=27)], [], None, None, lineno=251, col_offset=19)], [], None, None, lineno=251, col_offset=12), lineno=251, col_offset=12)], [], lineno=250, col_offset=8)], [], lineno=248, col_offset=4), FunctionDef('start_cell', arguments([Name('self', Param(), lineno=253, col_offset=19), Name('attrs', Param(), lineno=253, col_offset=25)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=254, col_offset=8), 'y', Store(), lineno=254, col_offset=8)], Call(Name('int', Load(), lineno=254, col_offset=17), [Call(Attribute(Name('attrs', Load(), lineno=254, col_offset=21), 'get', Load(), lineno=254, col_offset=21), [Str('row', lineno=254, col_offset=31)], [], None, None, lineno=254, col_offset=21)], [], None, None, lineno=254, col_offset=17), lineno=254, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=255, col_offset=8), 'x', Store(), lineno=255, col_offset=8)], Call(Name('int', Load(), lineno=255, col_offset=17), [Call(Attribute(Name('attrs', Load(), lineno=255, col_offset=21), 'get', Load(), lineno=255, col_offset=21), [Str('col', lineno=255, col_offset=31)], [], None, None, lineno=255, col_offset=21)], [], None, None, lineno=255, col_offset=17), lineno=255, col_offset=8)], [], lineno=253, col_offset=4), FunctionDef('start_value', arguments([Name('self', Param(), lineno=257, col_offset=20), Name('attrs', Param(), lineno=257, col_offset=26)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=258, col_offset=8), 'fmt', Store(), lineno=258, col_offset=8)], Call(Attribute(Name('attrs', Load(), lineno=258, col_offset=19), 'get', Load(), lineno=258, col_offset=19), [Str('format', lineno=258, col_offset=29)], [], None, None, lineno=258, col_offset=19), lineno=258, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=259, col_offset=8), 'alignment', Store(), lineno=259, col_offset=8)], Call(Attribute(Name('xml2align', Load(), lineno=259, col_offset=25), 'get', Load(), lineno=259, col_offset=25), [Call(Attribute(Name('attrs', Load(), lineno=259, col_offset=39), 'get', Load(), lineno=259, col_offset=39), [Str('align', lineno=259, col_offset=49)], [], None, None, lineno=259, col_offset=39)], [], None, None, lineno=259, col_offset=25), lineno=259, col_offset=8)], [], lineno=257, col_offset=4), Assign([Name('start_formula', Store(), lineno=261, col_offset=4)], Name('start_value', Load(), lineno=261, col_offset=20), lineno=261, col_offset=4), FunctionDef('end_int', arguments([Name('self', Param(), lineno=263, col_offset=16), Name('text', Param(), lineno=263, col_offset=22)], None, None, []), [TryExcept([Assign([Attribute(Name('self', Load(), lineno=265, col_offset=12), 'value', Store(), lineno=265, col_offset=12)], Call(Name('int', Load(), lineno=265, col_offset=25), [Name('text', Load(), lineno=265, col_offset=29)], [], None, None, lineno=265, col_offset=25), lineno=265, col_offset=12)], [ExceptHandler(None, None, [Assign([Attribute(Name('self', Load(), lineno=267, col_offset=12), 'value', Store(), lineno=267, col_offset=12)], Name('None', Load(), lineno=267, col_offset=25), lineno=267, col_offset=12)], lineno=266, col_offset=8)], [], lineno=264, col_offset=8)], [], lineno=263, col_offset=4), FunctionDef('end_long', arguments([Name('self', Param(), lineno=269, col_offset=17), Name('text', Param(), lineno=269, col_offset=23)], None, None, []), [TryExcept([Assign([Attribute(Name('self', Load(), lineno=271, col_offset=12), 'value', Store(), lineno=271, col_offset=12)], Call(Name('long', Load(), lineno=271, col_offset=25), [Name('text', Load(), lineno=271, col_offset=30)], [], None, None, lineno=271, col_offset=25), lineno=271, col_offset=12)], [ExceptHandler(None, None, [Assign([Attribute(Name('self', Load(), lineno=273, col_offset=12), 'value', Store(), lineno=273, col_offset=12)], Name('None', Load(), lineno=273, col_offset=25), lineno=273, col_offset=12)], lineno=272, col_offset=8)], [], lineno=270, col_offset=8)], [], lineno=269, col_offset=4), FunctionDef('end_double', arguments([Name('self', Param(), lineno=275, col_offset=19), Name('text', Param(), lineno=275, col_offset=25)], None, None, []), [TryExcept([Assign([Attribute(Name('self', Load(), lineno=277, col_offset=12), 'value', Store(), lineno=277, col_offset=12)], Call(Name('float', Load(), lineno=277, col_offset=25), [Name('text', Load(), lineno=277, col_offset=31)], [], None, None, lineno=277, col_offset=25), lineno=277, col_offset=12)], [ExceptHandler(None, None, [Assign([Attribute(Name('self', Load(), lineno=279, col_offset=12), 'value', Store(), lineno=279, col_offset=12)], Name('None', Load(), lineno=279, col_offset=25), lineno=279, col_offset=12)], lineno=278, col_offset=8)], [], lineno=276, col_offset=8)], [], lineno=275, col_offset=4), FunctionDef('end_complex', arguments([Name('self', Param(), lineno=281, col_offset=20), Name('text', Param(), lineno=281, col_offset=26)], None, None, []), [TryExcept([Assign([Attribute(Name('self', Load(), lineno=283, col_offset=12), 'value', Store(), lineno=283, col_offset=12)], Call(Name('complex', Load(), lineno=283, col_offset=25), [Name('text', Load(), lineno=283, col_offset=33)], [], None, None, lineno=283, col_offset=25), lineno=283, col_offset=12)], [ExceptHandler(None, None, [Assign([Attribute(Name('self', Load(), lineno=285, col_offset=12), 'value', Store(), lineno=285, col_offset=12)], Name('None', Load(), lineno=285, col_offset=25), lineno=285, col_offset=12)], lineno=284, col_offset=8)], [], lineno=282, col_offset=8)], [], lineno=281, col_offset=4), FunctionDef('end_string', arguments([Name('self', Param(), lineno=287, col_offset=19), Name('text', Param(), lineno=287, col_offset=25)], None, None, []), [TryExcept([Assign([Attribute(Name('self', Load(), lineno=289, col_offset=12), 'value', Store(), lineno=289, col_offset=12)], Name('text', Load(), lineno=289, col_offset=25), lineno=289, col_offset=12)], [ExceptHandler(None, None, [Assign([Attribute(Name('self', Load(), lineno=291, col_offset=12), 'value', Store(), lineno=291, col_offset=12)], Name('None', Load(), lineno=291, col_offset=25), lineno=291, col_offset=12)], lineno=290, col_offset=8)], [], lineno=288, col_offset=8)], [], lineno=287, col_offset=4), FunctionDef('end_value', arguments([Name('self', Param(), lineno=293, col_offset=18), Name('text', Param(), lineno=293, col_offset=24)], None, None, []), [If(Call(Name('isinstance', Load(), lineno=294, col_offset=11), [Attribute(Name('self', Load(), lineno=294, col_offset=22), 'value', Load(), lineno=294, col_offset=22), Name('BaseCell', Load(), lineno=294, col_offset=34)], [], None, None, lineno=294, col_offset=11), [Assign([Attribute(Name('self', Load(), lineno=295, col_offset=12), 'cell', Store(), lineno=295, col_offset=12)], Attribute(Name('self', Load(), lineno=295, col_offset=24), 'value', Load(), lineno=295, col_offset=24), lineno=295, col_offset=12)], [If(Call(Name('isinstance', Load(), lineno=296, col_offset=13), [Attribute(Name('self', Load(), lineno=296, col_offset=24), 'value', Load(), lineno=296, col_offset=24), Name('str', Load(), lineno=296, col_offset=36)], [], None, None, lineno=296, col_offset=13), [Assign([Attribute(Name('self', Load(), lineno=297, col_offset=12), 'cell', Store(), lineno=297, col_offset=12)], Call(Name('StringCell', Load(), lineno=297, col_offset=24), [Attribute(Name('self', Load(), lineno=297, col_offset=35), 'value', Load(), lineno=297, col_offset=35), BoolOp(Or(), [Attribute(Name('self', Load(), lineno=298, col_offset=35), 'fmt', Load(), lineno=298, col_offset=35), Str('%s', lineno=298, col_offset=47)], lineno=298, col_offset=35), BoolOp(Or(), [Attribute(Name('self', Load(), lineno=299, col_offset=35), 'alignment', Load(), lineno=299, col_offset=35), Name('LEFT', Load(), lineno=299, col_offset=53)], lineno=299, col_offset=35)], [], None, None, lineno=297, col_offset=24), lineno=297, col_offset=12)], [Assign([Attribute(Name('self', Load(), lineno=301, col_offset=12), 'cell', Store(), lineno=301, col_offset=12)], Call(Name('NumericCell', Load(), lineno=301, col_offset=24), [Attribute(Name('self', Load(), lineno=301, col_offset=36), 'value', Load(), lineno=301, col_offset=36), BoolOp(Or(), [Attribute(Name('self', Load(), lineno=302, col_offset=36), 'fmt', Load(), lineno=302, col_offset=36), Str('%s', lineno=302, col_offset=48)], lineno=302, col_offset=36), BoolOp(Or(), [Attribute(Name('self', Load(), lineno=303, col_offset=36), 'alignment', Load(), lineno=303, col_offset=36), Name('RIGHT', Load(), lineno=303, col_offset=54)], lineno=303, col_offset=36)], [], None, None, lineno=301, col_offset=24), lineno=301, col_offset=12)], lineno=296, col_offset=13)], lineno=294, col_offset=8)], [], lineno=293, col_offset=4), FunctionDef('end_formula', arguments([Name('self', Param(), lineno=305, col_offset=20), Name('text', Param(), lineno=305, col_offset=26)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=306, col_offset=8), 'cell', Store(), lineno=306, col_offset=8)], Call(Name('FormulaCell', Load(), lineno=306, col_offset=20), [Name('text', Load(), lineno=306, col_offset=32), BoolOp(Or(), [Attribute(Name('self', Load(), lineno=307, col_offset=32), 'fmt', Load(), lineno=307, col_offset=32), Str('%s', lineno=307, col_offset=44)], lineno=307, col_offset=32), BoolOp(Or(), [Attribute(Name('self', Load(), lineno=308, col_offset=32), 'alignment', Load(), lineno=308, col_offset=32), Name('RIGHT', Load(), lineno=308, col_offset=50)], lineno=308, col_offset=32)], [], None, None, lineno=306, col_offset=20), lineno=306, col_offset=8)], [], lineno=305, col_offset=4), FunctionDef('end_cell', arguments([Name('self', Param(), lineno=310, col_offset=17), Name('text', Param(), lineno=310, col_offset=23)], None, None, []), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=311, col_offset=8), 'sheet', Load(), lineno=311, col_offset=8), 'setcell', Load(), lineno=311, col_offset=8), [Attribute(Name('self', Load(), lineno=311, col_offset=27), 'x', Load(), lineno=311, col_offset=27), Attribute(Name('self', Load(), lineno=311, col_offset=35), 'y', Load(), lineno=311, col_offset=35), Attribute(Name('self', Load(), lineno=311, col_offset=43), 'cell', Load(), lineno=311, col_offset=43)], [], None, None, lineno=311, col_offset=8), lineno=311, col_offset=8)], [], lineno=310, col_offset=4)], [], lineno=224, col_offset=0), ClassDef('BaseCell', [], [Assign([Name('__init__', Store(), lineno=314, col_offset=4)], Name('None', Load(), lineno=314, col_offset=15), lineno=314, col_offset=4), Expr(Str("Abstract base class for sheet cells.\n\n    Subclasses may but needn't provide the following APIs:\n\n    cell.reset() -- prepare for recalculation\n    cell.recalc(rexec) -> value -- recalculate formula\n    cell.format() -> (value, alignment) -- return formatted value\n    cell.xml() -> string -- return XML\n    ", lineno=323, col_offset=-1), lineno=323, col_offset=-1)], [], lineno=313, col_offset=0), ClassDef('NumericCell', [Name('BaseCell', Load(), lineno=325, col_offset=18)], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=327, col_offset=17), Name('value', Param(), lineno=327, col_offset=23), Name('fmt', Param(), lineno=327, col_offset=30), Name('alignment', Param(), lineno=327, col_offset=40)], None, None, [Str('%s', lineno=327, col_offset=34), Name('RIGHT', Load(), lineno=327, col_offset=50)]), [Assert(Call(Name('isinstance', Load(), lineno=328, col_offset=15), [Name('value', Load(), lineno=328, col_offset=26), Tuple([Name('int', Load(), lineno=328, col_offset=34), Name('long', Load(), lineno=328, col_offset=39), Name('float', Load(), lineno=328, col_offset=45), Name('complex', Load(), lineno=328, col_offset=52)], Load(), lineno=328, col_offset=34)], [], None, None, lineno=328, col_offset=15), None, lineno=328, col_offset=8), Assert(Compare(Name('alignment', Load(), lineno=329, col_offset=15), [In()], [Tuple([Name('LEFT', Load(), lineno=329, col_offset=29), Name('CENTER', Load(), lineno=329, col_offset=35), Name('RIGHT', Load(), lineno=329, col_offset=43)], Load(), lineno=329, col_offset=29)], lineno=329, col_offset=15), None, lineno=329, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=330, col_offset=8), 'value', Store(), lineno=330, col_offset=8)], Name('value', Load(), lineno=330, col_offset=21), lineno=330, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=331, col_offset=8), 'fmt', Store(), lineno=331, col_offset=8)], Name('fmt', Load(), lineno=331, col_offset=19), lineno=331, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=332, col_offset=8), 'alignment', Store(), lineno=332, col_offset=8)], Name('alignment', Load(), lineno=332, col_offset=25), lineno=332, col_offset=8)], [], lineno=327, col_offset=4), FunctionDef('recalc', arguments([Name('self', Param(), lineno=334, col_offset=15), Name('rexec', Param(), lineno=334, col_offset=21)], None, None, []), [Return(Attribute(Name('self', Load(), lineno=335, col_offset=15), 'value', Load(), lineno=335, col_offset=15), lineno=335, col_offset=8)], [], lineno=334, col_offset=4), FunctionDef('format', arguments([Name('self', Param(), lineno=337, col_offset=15)], None, None, []), [TryExcept([Assign([Name('text', Store(), lineno=339, col_offset=12)], BinOp(Attribute(Name('self', Load(), lineno=339, col_offset=19), 'fmt', Load(), lineno=339, col_offset=19), Mod(), Attribute(Name('self', Load(), lineno=339, col_offset=30), 'value', Load(), lineno=339, col_offset=30), lineno=339, col_offset=19), lineno=339, col_offset=12)], [ExceptHandler(None, None, [Assign([Name('text', Store(), lineno=341, col_offset=12)], Call(Name('str', Load(), lineno=341, col_offset=19), [Attribute(Name('self', Load(), lineno=341, col_offset=23), 'value', Load(), lineno=341, col_offset=23)], [], None, None, lineno=341, col_offset=19), lineno=341, col_offset=12)], lineno=340, col_offset=8)], [], lineno=338, col_offset=8), Return(Tuple([Name('text', Load(), lineno=342, col_offset=15), Attribute(Name('self', Load(), lineno=342, col_offset=21), 'alignment', Load(), lineno=342, col_offset=21)], Load(), lineno=342, col_offset=15), lineno=342, col_offset=8)], [], lineno=337, col_offset=4), FunctionDef('xml', arguments([Name('self', Param(), lineno=344, col_offset=12)], None, None, []), [Assign([Name('method', Store(), lineno=345, col_offset=8)], Call(Name('getattr', Load(), lineno=345, col_offset=17), [Name('self', Load(), lineno=345, col_offset=25), BinOp(Str('_xml_', lineno=345, col_offset=31), Add(), Attribute(Call(Name('type', Load(), lineno=345, col_offset=41), [Attribute(Name('self', Load(), lineno=345, col_offset=46), 'value', Load(), lineno=345, col_offset=46)], [], None, None, lineno=345, col_offset=41), '__name__', Load(), lineno=345, col_offset=41), lineno=345, col_offset=31)], [], None, None, lineno=345, col_offset=17), lineno=345, col_offset=8), Return(BinOp(Str('<value align="%s" format="%s">%s</value>', lineno=346, col_offset=15), Mod(), Tuple([Subscript(Name('align2xml', Load(), lineno=347, col_offset=16), Index(Attribute(Name('self', Load(), lineno=347, col_offset=26), 'alignment', Load(), lineno=347, col_offset=26)), Load(), lineno=347, col_offset=16), Attribute(Name('self', Load(), lineno=348, col_offset=16), 'fmt', Load(), lineno=348, col_offset=16), Call(Name('method', Load(), lineno=349, col_offset=16), [], [], None, None, lineno=349, col_offset=16)], Load(), lineno=347, col_offset=16), lineno=346, col_offset=15), lineno=346, col_offset=8)], [], lineno=344, col_offset=4), FunctionDef('_xml_int', arguments([Name('self', Param(), lineno=351, col_offset=17)], None, None, []), [If(Compare(UnaryOp(USub(), BinOp(Num(2, lineno=352, col_offset=12), Pow(), Num(31, lineno=352, col_offset=15), lineno=352, col_offset=12), lineno=352, col_offset=11), [LtE(), Lt()], [Attribute(Name('self', Load(), lineno=352, col_offset=21), 'value', Load(), lineno=352, col_offset=21), BinOp(Num(2, lineno=352, col_offset=34), Pow(), Num(31, lineno=352, col_offset=37), lineno=352, col_offset=34)], lineno=352, col_offset=11), [Return(BinOp(Str('<int>%s</int>', lineno=353, col_offset=19), Mod(), Attribute(Name('self', Load(), lineno=353, col_offset=37), 'value', Load(), lineno=353, col_offset=37), lineno=353, col_offset=19), lineno=353, col_offset=12)], [Return(Call(Attribute(Name('self', Load(), lineno=355, col_offset=19), '_xml_long', Load(), lineno=355, col_offset=19), [], [], None, None, lineno=355, col_offset=19), lineno=355, col_offset=12)], lineno=352, col_offset=8)], [], lineno=351, col_offset=4), FunctionDef('_xml_long', arguments([Name('self', Param(), lineno=357, col_offset=18)], None, None, []), [Return(BinOp(Str('<long>%s</long>', lineno=358, col_offset=15), Mod(), Attribute(Name('self', Load(), lineno=358, col_offset=35), 'value', Load(), lineno=358, col_offset=35), lineno=358, col_offset=15), lineno=358, col_offset=8)], [], lineno=357, col_offset=4), FunctionDef('_xml_float', arguments([Name('self', Param(), lineno=360, col_offset=19)], None, None, []), [Return(BinOp(Str('<double>%s</double>', lineno=361, col_offset=15), Mod(), Call(Name('repr', Load(), lineno=361, col_offset=39), [Attribute(Name('self', Load(), lineno=361, col_offset=44), 'value', Load(), lineno=361, col_offset=44)], [], None, None, lineno=361, col_offset=39), lineno=361, col_offset=15), lineno=361, col_offset=8)], [], lineno=360, col_offset=4), FunctionDef('_xml_complex', arguments([Name('self', Param(), lineno=363, col_offset=21)], None, None, []), [Return(BinOp(Str('<complex>%s</double>', lineno=364, col_offset=15), Mod(), Call(Name('repr', Load(), lineno=364, col_offset=40), [Attribute(Name('self', Load(), lineno=364, col_offset=45), 'value', Load(), lineno=364, col_offset=45)], [], None, None, lineno=364, col_offset=40), lineno=364, col_offset=15), lineno=364, col_offset=8)], [], lineno=363, col_offset=4)], [], lineno=325, col_offset=0), ClassDef('StringCell', [Name('BaseCell', Load(), lineno=366, col_offset=17)], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=368, col_offset=17), Name('text', Param(), lineno=368, col_offset=23), Name('fmt', Param(), lineno=368, col_offset=29), Name('alignment', Param(), lineno=368, col_offset=39)], None, None, [Str('%s', lineno=368, col_offset=33), Name('LEFT', Load(), lineno=368, col_offset=49)]), [Assert(Call(Name('isinstance', Load(), lineno=369, col_offset=15), [Name('text', Load(), lineno=369, col_offset=26), Tuple([Name('str', Load(), lineno=369, col_offset=33), Name('unicode', Load(), lineno=369, col_offset=38)], Load(), lineno=369, col_offset=33)], [], None, None, lineno=369, col_offset=15), None, lineno=369, col_offset=8), Assert(Compare(Name('alignment', Load(), lineno=370, col_offset=15), [In()], [Tuple([Name('LEFT', Load(), lineno=370, col_offset=29), Name('CENTER', Load(), lineno=370, col_offset=35), Name('RIGHT', Load(), lineno=370, col_offset=43)], Load(), lineno=370, col_offset=29)], lineno=370, col_offset=15), None, lineno=370, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=371, col_offset=8), 'text', Store(), lineno=371, col_offset=8)], Name('text', Load(), lineno=371, col_offset=20), lineno=371, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=372, col_offset=8), 'fmt', Store(), lineno=372, col_offset=8)], Name('fmt', Load(), lineno=372, col_offset=19), lineno=372, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=373, col_offset=8), 'alignment', Store(), lineno=373, col_offset=8)], Name('alignment', Load(), lineno=373, col_offset=25), lineno=373, col_offset=8)], [], lineno=368, col_offset=4), FunctionDef('recalc', arguments([Name('self', Param(), lineno=375, col_offset=15), Name('rexec', Param(), lineno=375, col_offset=21)], None, None, []), [Return(Attribute(Name('self', Load(), lineno=376, col_offset=15), 'text', Load(), lineno=376, col_offset=15), lineno=376, col_offset=8)], [], lineno=375, col_offset=4), FunctionDef('format', arguments([Name('self', Param(), lineno=378, col_offset=15)], None, None, []), [Return(Tuple([Attribute(Name('self', Load(), lineno=379, col_offset=15), 'text', Load(), lineno=379, col_offset=15), Attribute(Name('self', Load(), lineno=379, col_offset=26), 'alignment', Load(), lineno=379, col_offset=26)], Load(), lineno=379, col_offset=15), lineno=379, col_offset=8)], [], lineno=378, col_offset=4), FunctionDef('xml', arguments([Name('self', Param(), lineno=381, col_offset=12)], None, None, []), [Assign([Name('s', Store(), lineno=382, col_offset=8)], Str('<value align="%s" format="%s"><string>%s</string></value>', lineno=382, col_offset=12), lineno=382, col_offset=8), Return(BinOp(Name('s', Load(), lineno=383, col_offset=15), Mod(), Tuple([Subscript(Name('align2xml', Load(), lineno=384, col_offset=12), Index(Attribute(Name('self', Load(), lineno=384, col_offset=22), 'alignment', Load(), lineno=384, col_offset=22)), Load(), lineno=384, col_offset=12), Attribute(Name('self', Load(), lineno=385, col_offset=12), 'fmt', Load(), lineno=385, col_offset=12), Call(Attribute(Name('cgi', Load(), lineno=386, col_offset=12), 'escape', Load(), lineno=386, col_offset=12), [Attribute(Name('self', Load(), lineno=386, col_offset=23), 'text', Load(), lineno=386, col_offset=23)], [], None, None, lineno=386, col_offset=12)], Load(), lineno=384, col_offset=12), lineno=383, col_offset=15), lineno=383, col_offset=8)], [], lineno=381, col_offset=4)], [], lineno=366, col_offset=0), ClassDef('FormulaCell', [Name('BaseCell', Load(), lineno=388, col_offset=18)], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=390, col_offset=17), Name('formula', Param(), lineno=390, col_offset=23), Name('fmt', Param(), lineno=390, col_offset=32), Name('alignment', Param(), lineno=390, col_offset=42)], None, None, [Str('%s', lineno=390, col_offset=36), Name('RIGHT', Load(), lineno=390, col_offset=52)]), [Assert(Compare(Name('alignment', Load(), lineno=391, col_offset=15), [In()], [Tuple([Name('LEFT', Load(), lineno=391, col_offset=29), Name('CENTER', Load(), lineno=391, col_offset=35), Name('RIGHT', Load(), lineno=391, col_offset=43)], Load(), lineno=391, col_offset=29)], lineno=391, col_offset=15), None, lineno=391, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=392, col_offset=8), 'formula', Store(), lineno=392, col_offset=8)], Name('formula', Load(), lineno=392, col_offset=23), lineno=392, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=393, col_offset=8), 'translated', Store(), lineno=393, col_offset=8)], Call(Name('translate', Load(), lineno=393, col_offset=26), [Attribute(Name('self', Load(), lineno=393, col_offset=36), 'formula', Load(), lineno=393, col_offset=36)], [], None, None, lineno=393, col_offset=26), lineno=393, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=394, col_offset=8), 'fmt', Store(), lineno=394, col_offset=8)], Name('fmt', Load(), lineno=394, col_offset=19), lineno=394, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=395, col_offset=8), 'alignment', Store(), lineno=395, col_offset=8)], Name('alignment', Load(), lineno=395, col_offset=25), lineno=395, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=396, col_offset=8), 'reset', Load(), lineno=396, col_offset=8), [], [], None, None, lineno=396, col_offset=8), lineno=396, col_offset=8)], [], lineno=390, col_offset=4), FunctionDef('reset', arguments([Name('self', Param(), lineno=398, col_offset=14)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=399, col_offset=8), 'value', Store(), lineno=399, col_offset=8)], Name('None', Load(), lineno=399, col_offset=21), lineno=399, col_offset=8)], [], lineno=398, col_offset=4), FunctionDef('recalc', arguments([Name('self', Param(), lineno=401, col_offset=15), Name('rexec', Param(), lineno=401, col_offset=21)], None, None, []), [If(Compare(Attribute(Name('self', Load(), lineno=402, col_offset=11), 'value', Load(), lineno=402, col_offset=11), [Is()], [Name('None', Load(), lineno=402, col_offset=25)], lineno=402, col_offset=11), [TryExcept([Expr(Call(Attribute(Name('rexec', Load(), lineno=405, col_offset=16), 'r_exec', Load(), lineno=405, col_offset=16), [BinOp(Str('from __future__ import division\n', lineno=405, col_offset=29), Add(), BinOp(Str('__value__ = eval(%s)', lineno=406, col_offset=29), Mod(), Call(Name('repr', Load(), lineno=406, col_offset=54), [Attribute(Name('self', Load(), lineno=406, col_offset=59), 'translated', Load(), lineno=406, col_offset=59)], [], None, None, lineno=406, col_offset=54), lineno=406, col_offset=29), lineno=405, col_offset=29)], [], None, None, lineno=405, col_offset=16), lineno=405, col_offset=16), Assign([Attribute(Name('self', Load(), lineno=407, col_offset=16), 'value', Store(), lineno=407, col_offset=16)], Call(Attribute(Name('rexec', Load(), lineno=407, col_offset=29), 'r_eval', Load(), lineno=407, col_offset=29), [Str('__value__', lineno=407, col_offset=42)], [], None, None, lineno=407, col_offset=29), lineno=407, col_offset=16)], [ExceptHandler(None, None, [Assign([Name('exc', Store(), lineno=409, col_offset=16)], Subscript(Call(Attribute(Name('sys', Load(), lineno=409, col_offset=22), 'exc_info', Load(), lineno=409, col_offset=22), [], [], None, None, lineno=409, col_offset=22), Index(Num(0, lineno=409, col_offset=37)), Load(), lineno=409, col_offset=22), lineno=409, col_offset=16), If(Call(Name('hasattr', Load(), lineno=410, col_offset=19), [Name('exc', Load(), lineno=410, col_offset=27), Str('__name__', lineno=410, col_offset=32)], [], None, None, lineno=410, col_offset=19), [Assign([Attribute(Name('self', Load(), lineno=411, col_offset=20), 'value', Store(), lineno=411, col_offset=20)], Attribute(Name('exc', Load(), lineno=411, col_offset=33), '__name__', Load(), lineno=411, col_offset=33), lineno=411, col_offset=20)], [Assign([Attribute(Name('self', Load(), lineno=413, col_offset=20), 'value', Store(), lineno=413, col_offset=20)], Call(Name('str', Load(), lineno=413, col_offset=33), [Name('exc', Load(), lineno=413, col_offset=37)], [], None, None, lineno=413, col_offset=33), lineno=413, col_offset=20)], lineno=410, col_offset=16)], lineno=408, col_offset=12)], [], lineno=403, col_offset=12)], [], lineno=402, col_offset=8), Return(Attribute(Name('self', Load(), lineno=414, col_offset=15), 'value', Load(), lineno=414, col_offset=15), lineno=414, col_offset=8)], [], lineno=401, col_offset=4), FunctionDef('format', arguments([Name('self', Param(), lineno=416, col_offset=15)], None, None, []), [TryExcept([Assign([Name('text', Store(), lineno=418, col_offset=12)], BinOp(Attribute(Name('self', Load(), lineno=418, col_offset=19), 'fmt', Load(), lineno=418, col_offset=19), Mod(), Attribute(Name('self', Load(), lineno=418, col_offset=30), 'value', Load(), lineno=418, col_offset=30), lineno=418, col_offset=19), lineno=418, col_offset=12)], [ExceptHandler(None, None, [Assign([Name('text', Store(), lineno=420, col_offset=12)], Call(Name('str', Load(), lineno=420, col_offset=19), [Attribute(Name('self', Load(), lineno=420, col_offset=23), 'value', Load(), lineno=420, col_offset=23)], [], None, None, lineno=420, col_offset=19), lineno=420, col_offset=12)], lineno=419, col_offset=8)], [], lineno=417, col_offset=8), Return(Tuple([Name('text', Load(), lineno=421, col_offset=15), Attribute(Name('self', Load(), lineno=421, col_offset=21), 'alignment', Load(), lineno=421, col_offset=21)], Load(), lineno=421, col_offset=15), lineno=421, col_offset=8)], [], lineno=416, col_offset=4), FunctionDef('xml', arguments([Name('self', Param(), lineno=423, col_offset=12)], None, None, []), [Return(BinOp(Str('<formula align="%s" format="%s">%s</formula>', lineno=424, col_offset=15), Mod(), Tuple([Subscript(Name('align2xml', Load(), lineno=425, col_offset=12), Index(Attribute(Name('self', Load(), lineno=425, col_offset=22), 'alignment', Load(), lineno=425, col_offset=22)), Load(), lineno=425, col_offset=12), Attribute(Name('self', Load(), lineno=426, col_offset=12), 'fmt', Load(), lineno=426, col_offset=12), Attribute(Name('self', Load(), lineno=427, col_offset=12), 'formula', Load(), lineno=427, col_offset=12)], Load(), lineno=425, col_offset=12), lineno=424, col_offset=15), lineno=424, col_offset=8)], [], lineno=423, col_offset=4), FunctionDef('renumber', arguments([Name('self', Param(), lineno=429, col_offset=17), Name('x1', Param(), lineno=429, col_offset=23), Name('y1', Param(), lineno=429, col_offset=27), Name('x2', Param(), lineno=429, col_offset=31), Name('y2', Param(), lineno=429, col_offset=35), Name('dx', Param(), lineno=429, col_offset=39), Name('dy', Param(), lineno=429, col_offset=43)], None, None, []), [Assign([Name('out', Store(), lineno=430, col_offset=8)], List([], Load(), lineno=430, col_offset=14), lineno=430, col_offset=8), For(Name('part', Store(), lineno=431, col_offset=12), Call(Attribute(Name('re', Load(), lineno=431, col_offset=20), 'split', Load(), lineno=431, col_offset=20), [Str('(\\w+)', lineno=431, col_offset=29), Attribute(Name('self', Load(), lineno=431, col_offset=38), 'formula', Load(), lineno=431, col_offset=38)], [], None, None, lineno=431, col_offset=20), [Assign([Name('m', Store(), lineno=432, col_offset=12)], Call(Attribute(Name('re', Load(), lineno=432, col_offset=16), 'match', Load(), lineno=432, col_offset=16), [Str('^([A-Z]+)([1-9][0-9]*)$', lineno=432, col_offset=25), Name('part', Load(), lineno=432, col_offset=52)], [], None, None, lineno=432, col_offset=16), lineno=432, col_offset=12), If(Compare(Name('m', Load(), lineno=433, col_offset=15), [IsNot()], [Name('None', Load(), lineno=433, col_offset=24)], lineno=433, col_offset=15), [Assign([Tuple([Name('sx', Store(), lineno=434, col_offset=16), Name('sy', Store(), lineno=434, col_offset=20)], Store(), lineno=434, col_offset=16)], Call(Attribute(Name('m', Load(), lineno=434, col_offset=25), 'groups', Load(), lineno=434, col_offset=25), [], [], None, None, lineno=434, col_offset=25), lineno=434, col_offset=16), Assign([Name('x', Store(), lineno=435, col_offset=16)], Call(Name('colname2num', Load(), lineno=435, col_offset=20), [Name('sx', Load(), lineno=435, col_offset=32)], [], None, None, lineno=435, col_offset=20), lineno=435, col_offset=16), Assign([Name('y', Store(), lineno=436, col_offset=16)], Call(Name('int', Load(), lineno=436, col_offset=20), [Name('sy', Load(), lineno=436, col_offset=24)], [], None, None, lineno=436, col_offset=20), lineno=436, col_offset=16), If(BoolOp(And(), [Compare(Name('x1', Load(), lineno=437, col_offset=19), [LtE(), LtE()], [Name('x', Load(), lineno=437, col_offset=25), Name('x2', Load(), lineno=437, col_offset=30)], lineno=437, col_offset=19), Compare(Name('y1', Load(), lineno=437, col_offset=37), [LtE(), LtE()], [Name('y', Load(), lineno=437, col_offset=43), Name('y2', Load(), lineno=437, col_offset=48)], lineno=437, col_offset=37)], lineno=437, col_offset=19), [Assign([Name('part', Store(), lineno=438, col_offset=20)], Call(Name('cellname', Load(), lineno=438, col_offset=27), [BinOp(Name('x', Load(), lineno=438, col_offset=36), Add(), Name('dx', Load(), lineno=438, col_offset=38), lineno=438, col_offset=36), BinOp(Name('y', Load(), lineno=438, col_offset=42), Add(), Name('dy', Load(), lineno=438, col_offset=44), lineno=438, col_offset=42)], [], None, None, lineno=438, col_offset=27), lineno=438, col_offset=20)], [], lineno=437, col_offset=16)], [], lineno=433, col_offset=12), Expr(Call(Attribute(Name('out', Load(), lineno=439, col_offset=12), 'append', Load(), lineno=439, col_offset=12), [Name('part', Load(), lineno=439, col_offset=23)], [], None, None, lineno=439, col_offset=12), lineno=439, col_offset=12)], [], lineno=431, col_offset=8), Return(Call(Name('FormulaCell', Load(), lineno=440, col_offset=15), [Call(Attribute(Str('', lineno=440, col_offset=27), 'join', Load(), lineno=440, col_offset=27), [Name('out', Load(), lineno=440, col_offset=35)], [], None, None, lineno=440, col_offset=27), Attribute(Name('self', Load(), lineno=440, col_offset=41), 'fmt', Load(), lineno=440, col_offset=41), Attribute(Name('self', Load(), lineno=440, col_offset=51), 'alignment', Load(), lineno=440, col_offset=51)], [], None, None, lineno=440, col_offset=15), lineno=440, col_offset=8)], [], lineno=429, col_offset=4)], [], lineno=388, col_offset=0), FunctionDef('translate', arguments([Name('formula', Param(), lineno=442, col_offset=14)], None, None, []), [Expr(Str('Translate a formula containing fancy cell names to valid Python code.\n\n    Examples:\n        B4 -> cell(2, 4)\n        B4:Z100 -> cells(2, 4, 26, 100)\n    ', lineno=448, col_offset=-1), lineno=448, col_offset=-1), Assign([Name('out', Store(), lineno=449, col_offset=4)], List([], Load(), lineno=449, col_offset=10), lineno=449, col_offset=4), For(Name('part', Store(), lineno=450, col_offset=8), Call(Attribute(Name('re', Load(), lineno=450, col_offset=16), 'split', Load(), lineno=450, col_offset=16), [Str('(\\w+(?::\\w+)?)', lineno=450, col_offset=25), Name('formula', Load(), lineno=450, col_offset=44)], [], None, None, lineno=450, col_offset=16), [Assign([Name('m', Store(), lineno=451, col_offset=8)], Call(Attribute(Name('re', Load(), lineno=451, col_offset=12), 'match', Load(), lineno=451, col_offset=12), [Str('^([A-Z]+)([1-9][0-9]*)(?::([A-Z]+)([1-9][0-9]*))?$', lineno=451, col_offset=21), Name('part', Load(), lineno=451, col_offset=76)], [], None, None, lineno=451, col_offset=12), lineno=451, col_offset=8), If(Compare(Name('m', Load(), lineno=452, col_offset=11), [Is()], [Name('None', Load(), lineno=452, col_offset=16)], lineno=452, col_offset=11), [Expr(Call(Attribute(Name('out', Load(), lineno=453, col_offset=12), 'append', Load(), lineno=453, col_offset=12), [Name('part', Load(), lineno=453, col_offset=23)], [], None, None, lineno=453, col_offset=12), lineno=453, col_offset=12)], [Assign([Tuple([Name('x1', Store(), lineno=455, col_offset=12), Name('y1', Store(), lineno=455, col_offset=16), Name('x2', Store(), lineno=455, col_offset=20), Name('y2', Store(), lineno=455, col_offset=24)], Store(), lineno=455, col_offset=12)], Call(Attribute(Name('m', Load(), lineno=455, col_offset=29), 'groups', Load(), lineno=455, col_offset=29), [], [], None, None, lineno=455, col_offset=29), lineno=455, col_offset=12), Assign([Name('x1', Store(), lineno=456, col_offset=12)], Call(Name('colname2num', Load(), lineno=456, col_offset=17), [Name('x1', Load(), lineno=456, col_offset=29)], [], None, None, lineno=456, col_offset=17), lineno=456, col_offset=12), If(Compare(Name('x2', Load(), lineno=457, col_offset=15), [Is()], [Name('None', Load(), lineno=457, col_offset=21)], lineno=457, col_offset=15), [Assign([Name('s', Store(), lineno=458, col_offset=16)], BinOp(Str('cell(%s, %s)', lineno=458, col_offset=20), Mod(), Tuple([Name('x1', Load(), lineno=458, col_offset=38), Name('y1', Load(), lineno=458, col_offset=42)], Load(), lineno=458, col_offset=38), lineno=458, col_offset=20), lineno=458, col_offset=16)], [Assign([Name('x2', Store(), lineno=460, col_offset=16)], Call(Name('colname2num', Load(), lineno=460, col_offset=21), [Name('x2', Load(), lineno=460, col_offset=33)], [], None, None, lineno=460, col_offset=21), lineno=460, col_offset=16), Assign([Name('s', Store(), lineno=461, col_offset=16)], BinOp(Str('cells(%s, %s, %s, %s)', lineno=461, col_offset=20), Mod(), Tuple([Name('x1', Load(), lineno=461, col_offset=47), Name('y1', Load(), lineno=461, col_offset=51), Name('x2', Load(), lineno=461, col_offset=55), Name('y2', Load(), lineno=461, col_offset=59)], Load(), lineno=461, col_offset=47), lineno=461, col_offset=20), lineno=461, col_offset=16)], lineno=457, col_offset=12), Expr(Call(Attribute(Name('out', Load(), lineno=462, col_offset=12), 'append', Load(), lineno=462, col_offset=12), [Name('s', Load(), lineno=462, col_offset=23)], [], None, None, lineno=462, col_offset=12), lineno=462, col_offset=12)], lineno=452, col_offset=8)], [], lineno=450, col_offset=4), Return(Call(Attribute(Str('', lineno=463, col_offset=11), 'join', Load(), lineno=463, col_offset=11), [Name('out', Load(), lineno=463, col_offset=19)], [], None, None, lineno=463, col_offset=11), lineno=463, col_offset=4)], [], lineno=442, col_offset=0), FunctionDef('cellname', arguments([Name('x', Param(), lineno=465, col_offset=13), Name('y', Param(), lineno=465, col_offset=16)], None, None, []), [Expr(Str("Translate a cell coordinate to a fancy cell name (e.g. (1, 1)->'A1').", lineno=466, col_offset=4), lineno=466, col_offset=4), Assert(Compare(Name('x', Load(), lineno=467, col_offset=11), [Gt()], [Num(0, lineno=467, col_offset=15)], lineno=467, col_offset=11), None, lineno=467, col_offset=4), Return(BinOp(Call(Name('colnum2name', Load(), lineno=468, col_offset=11), [Name('x', Load(), lineno=468, col_offset=23)], [], None, None, lineno=468, col_offset=11), Add(), Call(Name('str', Load(), lineno=468, col_offset=28), [Name('y', Load(), lineno=468, col_offset=32)], [], None, None, lineno=468, col_offset=28), lineno=468, col_offset=11), lineno=468, col_offset=4)], [], lineno=465, col_offset=0), FunctionDef('colname2num', arguments([Name('s', Param(), lineno=470, col_offset=16)], None, None, []), [Expr(Str("Translate a column name to number (e.g. 'A'->1, 'Z'->26, 'AA'->27).", lineno=471, col_offset=4), lineno=471, col_offset=4), Assign([Name('s', Store(), lineno=472, col_offset=4)], Call(Attribute(Name('s', Load(), lineno=472, col_offset=8), 'upper', Load(), lineno=472, col_offset=8), [], [], None, None, lineno=472, col_offset=8), lineno=472, col_offset=4), Assign([Name('n', Store(), lineno=473, col_offset=4)], Num(0, lineno=473, col_offset=8), lineno=473, col_offset=4), For(Name('c', Store(), lineno=474, col_offset=8), Name('s', Load(), lineno=474, col_offset=13), [Assert(Compare(Str('A', lineno=475, col_offset=15), [LtE(), LtE()], [Name('c', Load(), lineno=475, col_offset=22), Str('Z', lineno=475, col_offset=27)], lineno=475, col_offset=15), None, lineno=475, col_offset=8), Assign([Name('n', Store(), lineno=476, col_offset=8)], BinOp(BinOp(BinOp(BinOp(Name('n', Load(), lineno=476, col_offset=12), Mult(), Num(26, lineno=476, col_offset=14), lineno=476, col_offset=12), Add(), Call(Name('ord', Load(), lineno=476, col_offset=19), [Name('c', Load(), lineno=476, col_offset=23)], [], None, None, lineno=476, col_offset=19), lineno=476, col_offset=12), Sub(), Call(Name('ord', Load(), lineno=476, col_offset=28), [Str('A', lineno=476, col_offset=32)], [], None, None, lineno=476, col_offset=28), lineno=476, col_offset=26), Add(), Num(1, lineno=476, col_offset=39), lineno=476, col_offset=37), lineno=476, col_offset=8)], [], lineno=474, col_offset=4), Return(Name('n', Load(), lineno=477, col_offset=11), lineno=477, col_offset=4)], [], lineno=470, col_offset=0), FunctionDef('colnum2name', arguments([Name('n', Param(), lineno=479, col_offset=16)], None, None, []), [Expr(Str("Translate a column number to name (e.g. 1->'A', etc.).", lineno=480, col_offset=4), lineno=480, col_offset=4), Assert(Compare(Name('n', Load(), lineno=481, col_offset=11), [Gt()], [Num(0, lineno=481, col_offset=15)], lineno=481, col_offset=11), None, lineno=481, col_offset=4), Assign([Name('s', Store(), lineno=482, col_offset=4)], Str('', lineno=482, col_offset=8), lineno=482, col_offset=4), While(Name('n', Load(), lineno=483, col_offset=10), [Assign([Tuple([Name('n', Store(), lineno=484, col_offset=8), Name('m', Store(), lineno=484, col_offset=11)], Store(), lineno=484, col_offset=8)], Call(Name('divmod', Load(), lineno=484, col_offset=15), [BinOp(Name('n', Load(), lineno=484, col_offset=22), Sub(), Num(1, lineno=484, col_offset=24), lineno=484, col_offset=22), Num(26, lineno=484, col_offset=27)], [], None, None, lineno=484, col_offset=15), lineno=484, col_offset=8), Assign([Name('s', Store(), lineno=485, col_offset=8)], BinOp(Call(Name('chr', Load(), lineno=485, col_offset=12), [BinOp(Name('m', Load(), lineno=485, col_offset=16), Add(), Call(Name('ord', Load(), lineno=485, col_offset=18), [Str('A', lineno=485, col_offset=22)], [], None, None, lineno=485, col_offset=18), lineno=485, col_offset=16)], [], None, None, lineno=485, col_offset=12), Add(), Name('s', Load(), lineno=485, col_offset=30), lineno=485, col_offset=12), lineno=485, col_offset=8)], [], lineno=483, col_offset=4), Return(Name('s', Load(), lineno=486, col_offset=11), lineno=486, col_offset=4)], [], lineno=479, col_offset=0), Import([alias('Tkinter', 'Tk')], lineno=488, col_offset=0), ClassDef('SheetGUI', [], [Expr(Str('Beginnings of a GUI for a spreadsheet.\n\n    TO DO:\n    - clear multiple cells\n    - Insert, clear, remove rows or columns\n    - Show new contents while typing\n    - Scroll bars\n    - Grow grid when window is grown\n    - Proper menus\n    - Undo, redo\n    - Cut, copy and paste\n    - Formatting and alignment\n    ', lineno=504, col_offset=-1), lineno=504, col_offset=-1), FunctionDef('__init__', arguments([Name('self', Param(), lineno=506, col_offset=17), Name('filename', Param(), lineno=506, col_offset=23), Name('rows', Param(), lineno=506, col_offset=46), Name('columns', Param(), lineno=506, col_offset=55)], None, None, [Str('sheet1.xml', lineno=506, col_offset=32), Num(10, lineno=506, col_offset=51), Num(5, lineno=506, col_offset=63)]), [Expr(Str('Constructor.\n\n        Load the sheet from the filename argument.\n        Set up the Tk widget tree.\n        ', lineno=511, col_offset=-1), lineno=511, col_offset=-1), Assign([Attribute(Name('self', Load(), lineno=513, col_offset=8), 'filename', Store(), lineno=513, col_offset=8)], Name('filename', Load(), lineno=513, col_offset=24), lineno=513, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=514, col_offset=8), 'sheet', Store(), lineno=514, col_offset=8)], Call(Name('Sheet', Load(), lineno=514, col_offset=21), [], [], None, None, lineno=514, col_offset=21), lineno=514, col_offset=8), If(Call(Attribute(Attribute(Name('os', Load(), lineno=515, col_offset=11), 'path', Load(), lineno=515, col_offset=11), 'isfile', Load(), lineno=515, col_offset=11), [Name('filename', Load(), lineno=515, col_offset=26)], [], None, None, lineno=515, col_offset=11), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=516, col_offset=12), 'sheet', Load(), lineno=516, col_offset=12), 'load', Load(), lineno=516, col_offset=12), [Name('filename', Load(), lineno=516, col_offset=28)], [], None, None, lineno=516, col_offset=12), lineno=516, col_offset=12)], [], lineno=515, col_offset=8), Assign([Tuple([Name('maxx', Store(), lineno=518, col_offset=8), Name('maxy', Store(), lineno=518, col_offset=14)], Store(), lineno=518, col_offset=8)], Call(Attribute(Attribute(Name('self', Load(), lineno=518, col_offset=21), 'sheet', Load(), lineno=518, col_offset=21), 'getsize', Load(), lineno=518, col_offset=21), [], [], None, None, lineno=518, col_offset=21), lineno=518, col_offset=8), Assign([Name('rows', Store(), lineno=519, col_offset=8)], Call(Name('max', Load(), lineno=519, col_offset=15), [Name('rows', Load(), lineno=519, col_offset=19), Name('maxy', Load(), lineno=519, col_offset=25)], [], None, None, lineno=519, col_offset=15), lineno=519, col_offset=8), Assign([Name('columns', Store(), lineno=520, col_offset=8)], Call(Name('max', Load(), lineno=520, col_offset=18), [Name('columns', Load(), lineno=520, col_offset=22), Name('maxx', Load(), lineno=520, col_offset=31)], [], None, None, lineno=520, col_offset=18), lineno=520, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=522, col_offset=8), 'root', Store(), lineno=522, col_offset=8)], Call(Attribute(Name('Tk', Load(), lineno=522, col_offset=20), 'Tk', Load(), lineno=522, col_offset=20), [], [], None, None, lineno=522, col_offset=20), lineno=522, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=523, col_offset=8), 'root', Load(), lineno=523, col_offset=8), 'wm_title', Load(), lineno=523, col_offset=8), [BinOp(Str('Spreadsheet: %s', lineno=523, col_offset=27), Mod(), Attribute(Name('self', Load(), lineno=523, col_offset=47), 'filename', Load(), lineno=523, col_offset=47), lineno=523, col_offset=27)], [], None, None, lineno=523, col_offset=8), lineno=523, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=524, col_offset=8), 'beacon', Store(), lineno=524, col_offset=8)], Call(Attribute(Name('Tk', Load(), lineno=524, col_offset=22), 'Label', Load(), lineno=524, col_offset=22), [Attribute(Name('self', Load(), lineno=524, col_offset=31), 'root', Load(), lineno=524, col_offset=31)], [keyword('text', Str('A1', lineno=524, col_offset=47)), keyword('font', Tuple([Str('helvetica', lineno=525, col_offset=37), Num(16, lineno=525, col_offset=50), Str('bold', lineno=525, col_offset=54)], Load(), lineno=525, col_offset=37))], None, None, lineno=524, col_offset=22), lineno=524, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=526, col_offset=8), 'entry', Store(), lineno=526, col_offset=8)], Call(Attribute(Name('Tk', Load(), lineno=526, col_offset=21), 'Entry', Load(), lineno=526, col_offset=21), [Attribute(Name('self', Load(), lineno=526, col_offset=30), 'root', Load(), lineno=526, col_offset=30)], [], None, None, lineno=526, col_offset=21), lineno=526, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=527, col_offset=8), 'savebutton', Store(), lineno=527, col_offset=8)], Call(Attribute(Name('Tk', Load(), lineno=527, col_offset=26), 'Button', Load(), lineno=527, col_offset=26), [Attribute(Name('self', Load(), lineno=527, col_offset=36), 'root', Load(), lineno=527, col_offset=36)], [keyword('text', Str('Save', lineno=527, col_offset=52)), keyword('command', Attribute(Name('self', Load(), lineno=528, col_offset=44), 'save', Load(), lineno=528, col_offset=44))], None, None, lineno=527, col_offset=26), lineno=527, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=529, col_offset=8), 'cellgrid', Store(), lineno=529, col_offset=8)], Call(Attribute(Name('Tk', Load(), lineno=529, col_offset=24), 'Frame', Load(), lineno=529, col_offset=24), [Attribute(Name('self', Load(), lineno=529, col_offset=33), 'root', Load(), lineno=529, col_offset=33)], [], None, None, lineno=529, col_offset=24), lineno=529, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=531, col_offset=8), 'cellgrid', Load(), lineno=531, col_offset=8), 'pack', Load(), lineno=531, col_offset=8), [], [keyword('side', Str('bottom', lineno=531, col_offset=32)), keyword('expand', Num(1, lineno=531, col_offset=49)), keyword('fill', Str('both', lineno=531, col_offset=57))], None, None, lineno=531, col_offset=8), lineno=531, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=532, col_offset=8), 'beacon', Load(), lineno=532, col_offset=8), 'pack', Load(), lineno=532, col_offset=8), [], [keyword('side', Str('left', lineno=532, col_offset=30))], None, None, lineno=532, col_offset=8), lineno=532, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=533, col_offset=8), 'savebutton', Load(), lineno=533, col_offset=8), 'pack', Load(), lineno=533, col_offset=8), [], [keyword('side', Str('right', lineno=533, col_offset=34))], None, None, lineno=533, col_offset=8), lineno=533, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=534, col_offset=8), 'entry', Load(), lineno=534, col_offset=8), 'pack', Load(), lineno=534, col_offset=8), [], [keyword('side', Str('left', lineno=534, col_offset=29)), keyword('expand', Num(1, lineno=534, col_offset=44)), keyword('fill', Str('x', lineno=534, col_offset=52))], None, None, lineno=534, col_offset=8), lineno=534, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=536, col_offset=8), 'entry', Load(), lineno=536, col_offset=8), 'bind', Load(), lineno=536, col_offset=8), [Str('<Return>', lineno=536, col_offset=24), Attribute(Name('self', Load(), lineno=536, col_offset=36), 'return_event', Load(), lineno=536, col_offset=36)], [], None, None, lineno=536, col_offset=8), lineno=536, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=537, col_offset=8), 'entry', Load(), lineno=537, col_offset=8), 'bind', Load(), lineno=537, col_offset=8), [Str('<Shift-Return>', lineno=537, col_offset=24), Attribute(Name('self', Load(), lineno=537, col_offset=42), 'shift_return_event', Load(), lineno=537, col_offset=42)], [], None, None, lineno=537, col_offset=8), lineno=537, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=538, col_offset=8), 'entry', Load(), lineno=538, col_offset=8), 'bind', Load(), lineno=538, col_offset=8), [Str('<Tab>', lineno=538, col_offset=24), Attribute(Name('self', Load(), lineno=538, col_offset=33), 'tab_event', Load(), lineno=538, col_offset=33)], [], None, None, lineno=538, col_offset=8), lineno=538, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=539, col_offset=8), 'entry', Load(), lineno=539, col_offset=8), 'bind', Load(), lineno=539, col_offset=8), [Str('<Shift-Tab>', lineno=539, col_offset=24), Attribute(Name('self', Load(), lineno=539, col_offset=39), 'shift_tab_event', Load(), lineno=539, col_offset=39)], [], None, None, lineno=539, col_offset=8), lineno=539, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=540, col_offset=8), 'entry', Load(), lineno=540, col_offset=8), 'bind', Load(), lineno=540, col_offset=8), [Str('<Delete>', lineno=540, col_offset=24), Attribute(Name('self', Load(), lineno=540, col_offset=36), 'delete_event', Load(), lineno=540, col_offset=36)], [], None, None, lineno=540, col_offset=8), lineno=540, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=541, col_offset=8), 'entry', Load(), lineno=541, col_offset=8), 'bind', Load(), lineno=541, col_offset=8), [Str('<Escape>', lineno=541, col_offset=24), Attribute(Name('self', Load(), lineno=541, col_offset=36), 'escape_event', Load(), lineno=541, col_offset=36)], [], None, None, lineno=541, col_offset=8), lineno=541, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=543, col_offset=8), 'makegrid', Load(), lineno=543, col_offset=8), [Name('rows', Load(), lineno=543, col_offset=22), Name('columns', Load(), lineno=543, col_offset=28)], [], None, None, lineno=543, col_offset=8), lineno=543, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=545, col_offset=8), 'currentxy', Store(), lineno=545, col_offset=8)], Name('None', Load(), lineno=545, col_offset=25), lineno=545, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=546, col_offset=8), 'cornerxy', Store(), lineno=546, col_offset=8)], Name('None', Load(), lineno=546, col_offset=24), lineno=546, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=547, col_offset=8), 'setcurrent', Load(), lineno=547, col_offset=8), [Num(1, lineno=547, col_offset=24), Num(1, lineno=547, col_offset=27)], [], None, None, lineno=547, col_offset=8), lineno=547, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=549, col_offset=8), 'sync', Load(), lineno=549, col_offset=8), [], [], None, None, lineno=549, col_offset=8), lineno=549, col_offset=8)], [], lineno=506, col_offset=4), FunctionDef('delete_event', arguments([Name('self', Param(), lineno=551, col_offset=21), Name('event', Param(), lineno=551, col_offset=27)], None, None, []), [If(BoolOp(And(), [Compare(Attribute(Name('self', Load(), lineno=552, col_offset=11), 'cornerxy', Load(), lineno=552, col_offset=11), [NotEq()], [Attribute(Name('self', Load(), lineno=552, col_offset=28), 'currentxy', Load(), lineno=552, col_offset=28)], lineno=552, col_offset=11), Compare(Attribute(Name('self', Load(), lineno=552, col_offset=47), 'cornerxy', Load(), lineno=552, col_offset=47), [IsNot()], [Name('None', Load(), lineno=552, col_offset=68)], lineno=552, col_offset=47)], lineno=552, col_offset=11), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=553, col_offset=12), 'sheet', Load(), lineno=553, col_offset=12), 'clearcells', Load(), lineno=553, col_offset=12), [], [], BinOp(Attribute(Name('self', Load(), lineno=553, col_offset=36), 'currentxy', Load(), lineno=553, col_offset=36), Add(), Attribute(Name('self', Load(), lineno=553, col_offset=53), 'cornerxy', Load(), lineno=553, col_offset=53), lineno=553, col_offset=36), None, lineno=553, col_offset=12), lineno=553, col_offset=12)], [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=555, col_offset=12), 'sheet', Load(), lineno=555, col_offset=12), 'clearcell', Load(), lineno=555, col_offset=12), [], [], Attribute(Name('self', Load(), lineno=555, col_offset=34), 'currentxy', Load(), lineno=555, col_offset=34), None, lineno=555, col_offset=12), lineno=555, col_offset=12)], lineno=552, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=556, col_offset=8), 'sync', Load(), lineno=556, col_offset=8), [], [], None, None, lineno=556, col_offset=8), lineno=556, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=557, col_offset=8), 'entry', Load(), lineno=557, col_offset=8), 'delete', Load(), lineno=557, col_offset=8), [Num(0, lineno=557, col_offset=26), Str('end', lineno=557, col_offset=29)], [], None, None, lineno=557, col_offset=8), lineno=557, col_offset=8), Return(Str('break', lineno=558, col_offset=15), lineno=558, col_offset=8)], [], lineno=551, col_offset=4), FunctionDef('escape_event', arguments([Name('self', Param(), lineno=560, col_offset=21), Name('event', Param(), lineno=560, col_offset=27)], None, None, []), [Assign([Tuple([Name('x', Store(), lineno=561, col_offset=8), Name('y', Store(), lineno=561, col_offset=11)], Store(), lineno=561, col_offset=8)], Attribute(Name('self', Load(), lineno=561, col_offset=15), 'currentxy', Load(), lineno=561, col_offset=15), lineno=561, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=562, col_offset=8), 'load_entry', Load(), lineno=562, col_offset=8), [Name('x', Load(), lineno=562, col_offset=24), Name('y', Load(), lineno=562, col_offset=27)], [], None, None, lineno=562, col_offset=8), lineno=562, col_offset=8)], [], lineno=560, col_offset=4), FunctionDef('load_entry', arguments([Name('self', Param(), lineno=564, col_offset=19), Name('x', Param(), lineno=564, col_offset=25), Name('y', Param(), lineno=564, col_offset=28)], None, None, []), [Assign([Name('cell', Store(), lineno=565, col_offset=8)], Call(Attribute(Attribute(Name('self', Load(), lineno=565, col_offset=15), 'sheet', Load(), lineno=565, col_offset=15), 'getcell', Load(), lineno=565, col_offset=15), [Name('x', Load(), lineno=565, col_offset=34), Name('y', Load(), lineno=565, col_offset=37)], [], None, None, lineno=565, col_offset=15), lineno=565, col_offset=8), If(Compare(Name('cell', Load(), lineno=566, col_offset=11), [Is()], [Name('None', Load(), lineno=566, col_offset=19)], lineno=566, col_offset=11), [Assign([Name('text', Store(), lineno=567, col_offset=12)], Str('', lineno=567, col_offset=19), lineno=567, col_offset=12)], [If(Call(Name('isinstance', Load(), lineno=568, col_offset=13), [Name('cell', Load(), lineno=568, col_offset=24), Name('FormulaCell', Load(), lineno=568, col_offset=30)], [], None, None, lineno=568, col_offset=13), [Assign([Name('text', Store(), lineno=569, col_offset=12)], BinOp(Str('=', lineno=569, col_offset=19), Add(), Attribute(Name('cell', Load(), lineno=569, col_offset=25), 'formula', Load(), lineno=569, col_offset=25), lineno=569, col_offset=19), lineno=569, col_offset=12)], [Assign([Tuple([Name('text', Store(), lineno=571, col_offset=12), Name('alignment', Store(), lineno=571, col_offset=18)], Store(), lineno=571, col_offset=12)], Call(Attribute(Name('cell', Load(), lineno=571, col_offset=30), 'format', Load(), lineno=571, col_offset=30), [], [], None, None, lineno=571, col_offset=30), lineno=571, col_offset=12)], lineno=568, col_offset=13)], lineno=566, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=572, col_offset=8), 'entry', Load(), lineno=572, col_offset=8), 'delete', Load(), lineno=572, col_offset=8), [Num(0, lineno=572, col_offset=26), Str('end', lineno=572, col_offset=29)], [], None, None, lineno=572, col_offset=8), lineno=572, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=573, col_offset=8), 'entry', Load(), lineno=573, col_offset=8), 'insert', Load(), lineno=573, col_offset=8), [Num(0, lineno=573, col_offset=26), Name('text', Load(), lineno=573, col_offset=29)], [], None, None, lineno=573, col_offset=8), lineno=573, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=574, col_offset=8), 'entry', Load(), lineno=574, col_offset=8), 'selection_range', Load(), lineno=574, col_offset=8), [Num(0, lineno=574, col_offset=35), Str('end', lineno=574, col_offset=38)], [], None, None, lineno=574, col_offset=8), lineno=574, col_offset=8)], [], lineno=564, col_offset=4), FunctionDef('makegrid', arguments([Name('self', Param(), lineno=576, col_offset=17), Name('rows', Param(), lineno=576, col_offset=23), Name('columns', Param(), lineno=576, col_offset=29)], None, None, []), [Expr(Str('Helper to create the grid of GUI cells.\n\n        The edge (x==0 or y==0) is filled with labels; the rest is real cells.\n        ', lineno=580, col_offset=-1), lineno=580, col_offset=-1), Assign([Attribute(Name('self', Load(), lineno=581, col_offset=8), 'rows', Store(), lineno=581, col_offset=8)], Name('rows', Load(), lineno=581, col_offset=20), lineno=581, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=582, col_offset=8), 'columns', Store(), lineno=582, col_offset=8)], Name('columns', Load(), lineno=582, col_offset=23), lineno=582, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=583, col_offset=8), 'gridcells', Store(), lineno=583, col_offset=8)], Dict([], [], lineno=583, col_offset=25), lineno=583, col_offset=8), Assign([Name('cell', Store(), lineno=585, col_offset=8)], Call(Attribute(Name('Tk', Load(), lineno=585, col_offset=15), 'Label', Load(), lineno=585, col_offset=15), [Attribute(Name('self', Load(), lineno=585, col_offset=24), 'cellgrid', Load(), lineno=585, col_offset=24)], [keyword('relief', Str('raised', lineno=585, col_offset=46))], None, None, lineno=585, col_offset=15), lineno=585, col_offset=8), Expr(Call(Attribute(Name('cell', Load(), lineno=586, col_offset=8), 'grid_configure', Load(), lineno=586, col_offset=8), [], [keyword('column', Num(0, lineno=586, col_offset=35)), keyword('row', Num(0, lineno=586, col_offset=42)), keyword('sticky', Str('NSWE', lineno=586, col_offset=52))], None, None, lineno=586, col_offset=8), lineno=586, col_offset=8), Expr(Call(Attribute(Name('cell', Load(), lineno=587, col_offset=8), 'bind', Load(), lineno=587, col_offset=8), [Str('<ButtonPress-1>', lineno=587, col_offset=18), Attribute(Name('self', Load(), lineno=587, col_offset=37), 'selectall', Load(), lineno=587, col_offset=37)], [], None, None, lineno=587, col_offset=8), lineno=587, col_offset=8), For(Name('x', Store(), lineno=589, col_offset=12), Call(Name('range', Load(), lineno=589, col_offset=17), [Num(1, lineno=589, col_offset=23), BinOp(Name('columns', Load(), lineno=589, col_offset=26), Add(), Num(1, lineno=589, col_offset=34), lineno=589, col_offset=26)], [], None, None, lineno=589, col_offset=17), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=590, col_offset=12), 'cellgrid', Load(), lineno=590, col_offset=12), 'grid_columnconfigure', Load(), lineno=590, col_offset=12), [Name('x', Load(), lineno=590, col_offset=47)], [keyword('minsize', Num(64, lineno=590, col_offset=58))], None, None, lineno=590, col_offset=12), lineno=590, col_offset=12), Assign([Name('cell', Store(), lineno=591, col_offset=12)], Call(Attribute(Name('Tk', Load(), lineno=591, col_offset=19), 'Label', Load(), lineno=591, col_offset=19), [Attribute(Name('self', Load(), lineno=591, col_offset=28), 'cellgrid', Load(), lineno=591, col_offset=28)], [keyword('text', Call(Name('colnum2name', Load(), lineno=591, col_offset=48), [Name('x', Load(), lineno=591, col_offset=60)], [], None, None, lineno=591, col_offset=48)), keyword('relief', Str('raised', lineno=591, col_offset=71))], None, None, lineno=591, col_offset=19), lineno=591, col_offset=12), Expr(Call(Attribute(Name('cell', Load(), lineno=592, col_offset=12), 'grid_configure', Load(), lineno=592, col_offset=12), [], [keyword('column', Name('x', Load(), lineno=592, col_offset=39)), keyword('row', Num(0, lineno=592, col_offset=46)), keyword('sticky', Str('WE', lineno=592, col_offset=56))], None, None, lineno=592, col_offset=12), lineno=592, col_offset=12), Assign([Subscript(Attribute(Name('self', Load(), lineno=593, col_offset=12), 'gridcells', Load(), lineno=593, col_offset=12), Index(Tuple([Name('x', Load(), lineno=593, col_offset=27), Num(0, lineno=593, col_offset=30)], Load(), lineno=593, col_offset=27)), Store(), lineno=593, col_offset=12)], Name('cell', Load(), lineno=593, col_offset=35), lineno=593, col_offset=12), Assign([Attribute(Name('cell', Load(), lineno=594, col_offset=12), '__x', Store(), lineno=594, col_offset=12)], Name('x', Load(), lineno=594, col_offset=23), lineno=594, col_offset=12), Assign([Attribute(Name('cell', Load(), lineno=595, col_offset=12), '__y', Store(), lineno=595, col_offset=12)], Num(0, lineno=595, col_offset=23), lineno=595, col_offset=12), Expr(Call(Attribute(Name('cell', Load(), lineno=596, col_offset=12), 'bind', Load(), lineno=596, col_offset=12), [Str('<ButtonPress-1>', lineno=596, col_offset=22), Attribute(Name('self', Load(), lineno=596, col_offset=41), 'selectcolumn', Load(), lineno=596, col_offset=41)], [], None, None, lineno=596, col_offset=12), lineno=596, col_offset=12), Expr(Call(Attribute(Name('cell', Load(), lineno=597, col_offset=12), 'bind', Load(), lineno=597, col_offset=12), [Str('<B1-Motion>', lineno=597, col_offset=22), Attribute(Name('self', Load(), lineno=597, col_offset=37), 'extendcolumn', Load(), lineno=597, col_offset=37)], [], None, None, lineno=597, col_offset=12), lineno=597, col_offset=12), Expr(Call(Attribute(Name('cell', Load(), lineno=598, col_offset=12), 'bind', Load(), lineno=598, col_offset=12), [Str('<ButtonRelease-1>', lineno=598, col_offset=22), Attribute(Name('self', Load(), lineno=598, col_offset=43), 'extendcolumn', Load(), lineno=598, col_offset=43)], [], None, None, lineno=598, col_offset=12), lineno=598, col_offset=12), Expr(Call(Attribute(Name('cell', Load(), lineno=599, col_offset=12), 'bind', Load(), lineno=599, col_offset=12), [Str('<Shift-Button-1>', lineno=599, col_offset=22), Attribute(Name('self', Load(), lineno=599, col_offset=42), 'extendcolumn', Load(), lineno=599, col_offset=42)], [], None, None, lineno=599, col_offset=12), lineno=599, col_offset=12)], [], lineno=589, col_offset=8), For(Name('y', Store(), lineno=601, col_offset=12), Call(Name('range', Load(), lineno=601, col_offset=17), [Num(1, lineno=601, col_offset=23), BinOp(Name('rows', Load(), lineno=601, col_offset=26), Add(), Num(1, lineno=601, col_offset=31), lineno=601, col_offset=26)], [], None, None, lineno=601, col_offset=17), [Assign([Name('cell', Store(), lineno=602, col_offset=12)], Call(Attribute(Name('Tk', Load(), lineno=602, col_offset=19), 'Label', Load(), lineno=602, col_offset=19), [Attribute(Name('self', Load(), lineno=602, col_offset=28), 'cellgrid', Load(), lineno=602, col_offset=28)], [keyword('text', Call(Name('str', Load(), lineno=602, col_offset=48), [Name('y', Load(), lineno=602, col_offset=52)], [], None, None, lineno=602, col_offset=48)), keyword('relief', Str('raised', lineno=602, col_offset=63))], None, None, lineno=602, col_offset=19), lineno=602, col_offset=12), Expr(Call(Attribute(Name('cell', Load(), lineno=603, col_offset=12), 'grid_configure', Load(), lineno=603, col_offset=12), [], [keyword('column', Num(0, lineno=603, col_offset=39)), keyword('row', Name('y', Load(), lineno=603, col_offset=46)), keyword('sticky', Str('WE', lineno=603, col_offset=56))], None, None, lineno=603, col_offset=12), lineno=603, col_offset=12), Assign([Subscript(Attribute(Name('self', Load(), lineno=604, col_offset=12), 'gridcells', Load(), lineno=604, col_offset=12), Index(Tuple([Num(0, lineno=604, col_offset=27), Name('y', Load(), lineno=604, col_offset=30)], Load(), lineno=604, col_offset=27)), Store(), lineno=604, col_offset=12)], Name('cell', Load(), lineno=604, col_offset=35), lineno=604, col_offset=12), Assign([Attribute(Name('cell', Load(), lineno=605, col_offset=12), '__x', Store(), lineno=605, col_offset=12)], Num(0, lineno=605, col_offset=23), lineno=605, col_offset=12), Assign([Attribute(Name('cell', Load(), lineno=606, col_offset=12), '__y', Store(), lineno=606, col_offset=12)], Name('y', Load(), lineno=606, col_offset=23), lineno=606, col_offset=12), Expr(Call(Attribute(Name('cell', Load(), lineno=607, col_offset=12), 'bind', Load(), lineno=607, col_offset=12), [Str('<ButtonPress-1>', lineno=607, col_offset=22), Attribute(Name('self', Load(), lineno=607, col_offset=41), 'selectrow', Load(), lineno=607, col_offset=41)], [], None, None, lineno=607, col_offset=12), lineno=607, col_offset=12), Expr(Call(Attribute(Name('cell', Load(), lineno=608, col_offset=12), 'bind', Load(), lineno=608, col_offset=12), [Str('<B1-Motion>', lineno=608, col_offset=22), Attribute(Name('self', Load(), lineno=608, col_offset=37), 'extendrow', Load(), lineno=608, col_offset=37)], [], None, None, lineno=608, col_offset=12), lineno=608, col_offset=12), Expr(Call(Attribute(Name('cell', Load(), lineno=609, col_offset=12), 'bind', Load(), lineno=609, col_offset=12), [Str('<ButtonRelease-1>', lineno=609, col_offset=22), Attribute(Name('self', Load(), lineno=609, col_offset=43), 'extendrow', Load(), lineno=609, col_offset=43)], [], None, None, lineno=609, col_offset=12), lineno=609, col_offset=12), Expr(Call(Attribute(Name('cell', Load(), lineno=610, col_offset=12), 'bind', Load(), lineno=610, col_offset=12), [Str('<Shift-Button-1>', lineno=610, col_offset=22), Attribute(Name('self', Load(), lineno=610, col_offset=42), 'extendrow', Load(), lineno=610, col_offset=42)], [], None, None, lineno=610, col_offset=12), lineno=610, col_offset=12)], [], lineno=601, col_offset=8), For(Name('x', Store(), lineno=612, col_offset=12), Call(Name('range', Load(), lineno=612, col_offset=17), [Num(1, lineno=612, col_offset=23), BinOp(Name('columns', Load(), lineno=612, col_offset=26), Add(), Num(1, lineno=612, col_offset=34), lineno=612, col_offset=26)], [], None, None, lineno=612, col_offset=17), [For(Name('y', Store(), lineno=613, col_offset=16), Call(Name('range', Load(), lineno=613, col_offset=21), [Num(1, lineno=613, col_offset=27), BinOp(Name('rows', Load(), lineno=613, col_offset=30), Add(), Num(1, lineno=613, col_offset=35), lineno=613, col_offset=30)], [], None, None, lineno=613, col_offset=21), [Assign([Name('cell', Store(), lineno=614, col_offset=16)], Call(Attribute(Name('Tk', Load(), lineno=614, col_offset=23), 'Label', Load(), lineno=614, col_offset=23), [Attribute(Name('self', Load(), lineno=614, col_offset=32), 'cellgrid', Load(), lineno=614, col_offset=32)], [keyword('relief', Str('sunken', lineno=614, col_offset=54)), keyword('bg', Str('white', lineno=615, col_offset=35)), keyword('fg', Str('black', lineno=615, col_offset=47))], None, None, lineno=614, col_offset=23), lineno=614, col_offset=16), Expr(Call(Attribute(Name('cell', Load(), lineno=616, col_offset=16), 'grid_configure', Load(), lineno=616, col_offset=16), [], [keyword('column', Name('x', Load(), lineno=616, col_offset=43)), keyword('row', Name('y', Load(), lineno=616, col_offset=50)), keyword('sticky', Str('NSWE', lineno=616, col_offset=60))], None, None, lineno=616, col_offset=16), lineno=616, col_offset=16), Assign([Subscript(Attribute(Name('self', Load(), lineno=617, col_offset=16), 'gridcells', Load(), lineno=617, col_offset=16), Index(Tuple([Name('x', Load(), lineno=617, col_offset=31), Name('y', Load(), lineno=617, col_offset=34)], Load(), lineno=617, col_offset=31)), Store(), lineno=617, col_offset=16)], Name('cell', Load(), lineno=617, col_offset=39), lineno=617, col_offset=16), Assign([Attribute(Name('cell', Load(), lineno=618, col_offset=16), '__x', Store(), lineno=618, col_offset=16)], Name('x', Load(), lineno=618, col_offset=27), lineno=618, col_offset=16), Assign([Attribute(Name('cell', Load(), lineno=619, col_offset=16), '__y', Store(), lineno=619, col_offset=16)], Name('y', Load(), lineno=619, col_offset=27), lineno=619, col_offset=16), Expr(Call(Attribute(Name('cell', Load(), lineno=621, col_offset=16), 'bind', Load(), lineno=621, col_offset=16), [Str('<ButtonPress-1>', lineno=621, col_offset=26), Attribute(Name('self', Load(), lineno=621, col_offset=45), 'press', Load(), lineno=621, col_offset=45)], [], None, None, lineno=621, col_offset=16), lineno=621, col_offset=16), Expr(Call(Attribute(Name('cell', Load(), lineno=622, col_offset=16), 'bind', Load(), lineno=622, col_offset=16), [Str('<B1-Motion>', lineno=622, col_offset=26), Attribute(Name('self', Load(), lineno=622, col_offset=41), 'motion', Load(), lineno=622, col_offset=41)], [], None, None, lineno=622, col_offset=16), lineno=622, col_offset=16), Expr(Call(Attribute(Name('cell', Load(), lineno=623, col_offset=16), 'bind', Load(), lineno=623, col_offset=16), [Str('<ButtonRelease-1>', lineno=623, col_offset=26), Attribute(Name('self', Load(), lineno=623, col_offset=47), 'release', Load(), lineno=623, col_offset=47)], [], None, None, lineno=623, col_offset=16), lineno=623, col_offset=16), Expr(Call(Attribute(Name('cell', Load(), lineno=624, col_offset=16), 'bind', Load(), lineno=624, col_offset=16), [Str('<Shift-Button-1>', lineno=624, col_offset=26), Attribute(Name('self', Load(), lineno=624, col_offset=46), 'release', Load(), lineno=624, col_offset=46)], [], None, None, lineno=624, col_offset=16), lineno=624, col_offset=16)], [], lineno=613, col_offset=12)], [], lineno=612, col_offset=8)], [], lineno=576, col_offset=4), FunctionDef('selectall', arguments([Name('self', Param(), lineno=626, col_offset=18), Name('event', Param(), lineno=626, col_offset=24)], None, None, []), [Expr(Call(Attribute(Name('self', Load(), lineno=627, col_offset=8), 'setcurrent', Load(), lineno=627, col_offset=8), [Num(1, lineno=627, col_offset=24), Num(1, lineno=627, col_offset=27)], [], None, None, lineno=627, col_offset=8), lineno=627, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=628, col_offset=8), 'setcorner', Load(), lineno=628, col_offset=8), [Attribute(Name('sys', Load(), lineno=628, col_offset=23), 'maxint', Load(), lineno=628, col_offset=23), Attribute(Name('sys', Load(), lineno=628, col_offset=35), 'maxint', Load(), lineno=628, col_offset=35)], [], None, None, lineno=628, col_offset=8), lineno=628, col_offset=8)], [], lineno=626, col_offset=4), FunctionDef('selectcolumn', arguments([Name('self', Param(), lineno=630, col_offset=21), Name('event', Param(), lineno=630, col_offset=27)], None, None, []), [Assign([Tuple([Name('x', Store(), lineno=631, col_offset=8), Name('y', Store(), lineno=631, col_offset=11)], Store(), lineno=631, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=631, col_offset=15), 'whichxy', Load(), lineno=631, col_offset=15), [Name('event', Load(), lineno=631, col_offset=28)], [], None, None, lineno=631, col_offset=15), lineno=631, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=632, col_offset=8), 'setcurrent', Load(), lineno=632, col_offset=8), [Name('x', Load(), lineno=632, col_offset=24), Num(1, lineno=632, col_offset=27)], [], None, None, lineno=632, col_offset=8), lineno=632, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=633, col_offset=8), 'setcorner', Load(), lineno=633, col_offset=8), [Name('x', Load(), lineno=633, col_offset=23), Attribute(Name('sys', Load(), lineno=633, col_offset=26), 'maxint', Load(), lineno=633, col_offset=26)], [], None, None, lineno=633, col_offset=8), lineno=633, col_offset=8)], [], lineno=630, col_offset=4), FunctionDef('extendcolumn', arguments([Name('self', Param(), lineno=635, col_offset=21), Name('event', Param(), lineno=635, col_offset=27)], None, None, []), [Assign([Tuple([Name('x', Store(), lineno=636, col_offset=8), Name('y', Store(), lineno=636, col_offset=11)], Store(), lineno=636, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=636, col_offset=15), 'whichxy', Load(), lineno=636, col_offset=15), [Name('event', Load(), lineno=636, col_offset=28)], [], None, None, lineno=636, col_offset=15), lineno=636, col_offset=8), If(Compare(Name('x', Load(), lineno=637, col_offset=11), [Gt()], [Num(0, lineno=637, col_offset=15)], lineno=637, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=638, col_offset=12), 'setcurrent', Load(), lineno=638, col_offset=12), [Subscript(Attribute(Name('self', Load(), lineno=638, col_offset=28), 'currentxy', Load(), lineno=638, col_offset=28), Index(Num(0, lineno=638, col_offset=43)), Load(), lineno=638, col_offset=28), Num(1, lineno=638, col_offset=47)], [], None, None, lineno=638, col_offset=12), lineno=638, col_offset=12), Expr(Call(Attribute(Name('self', Load(), lineno=639, col_offset=12), 'setcorner', Load(), lineno=639, col_offset=12), [Name('x', Load(), lineno=639, col_offset=27), Attribute(Name('sys', Load(), lineno=639, col_offset=30), 'maxint', Load(), lineno=639, col_offset=30)], [], None, None, lineno=639, col_offset=12), lineno=639, col_offset=12)], [], lineno=637, col_offset=8)], [], lineno=635, col_offset=4), FunctionDef('selectrow', arguments([Name('self', Param(), lineno=641, col_offset=18), Name('event', Param(), lineno=641, col_offset=24)], None, None, []), [Assign([Tuple([Name('x', Store(), lineno=642, col_offset=8), Name('y', Store(), lineno=642, col_offset=11)], Store(), lineno=642, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=642, col_offset=15), 'whichxy', Load(), lineno=642, col_offset=15), [Name('event', Load(), lineno=642, col_offset=28)], [], None, None, lineno=642, col_offset=15), lineno=642, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=643, col_offset=8), 'setcurrent', Load(), lineno=643, col_offset=8), [Num(1, lineno=643, col_offset=24), Name('y', Load(), lineno=643, col_offset=27)], [], None, None, lineno=643, col_offset=8), lineno=643, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=644, col_offset=8), 'setcorner', Load(), lineno=644, col_offset=8), [Attribute(Name('sys', Load(), lineno=644, col_offset=23), 'maxint', Load(), lineno=644, col_offset=23), Name('y', Load(), lineno=644, col_offset=35)], [], None, None, lineno=644, col_offset=8), lineno=644, col_offset=8)], [], lineno=641, col_offset=4), FunctionDef('extendrow', arguments([Name('self', Param(), lineno=646, col_offset=18), Name('event', Param(), lineno=646, col_offset=24)], None, None, []), [Assign([Tuple([Name('x', Store(), lineno=647, col_offset=8), Name('y', Store(), lineno=647, col_offset=11)], Store(), lineno=647, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=647, col_offset=15), 'whichxy', Load(), lineno=647, col_offset=15), [Name('event', Load(), lineno=647, col_offset=28)], [], None, None, lineno=647, col_offset=15), lineno=647, col_offset=8), If(Compare(Name('y', Load(), lineno=648, col_offset=11), [Gt()], [Num(0, lineno=648, col_offset=15)], lineno=648, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=649, col_offset=12), 'setcurrent', Load(), lineno=649, col_offset=12), [Num(1, lineno=649, col_offset=28), Subscript(Attribute(Name('self', Load(), lineno=649, col_offset=31), 'currentxy', Load(), lineno=649, col_offset=31), Index(Num(1, lineno=649, col_offset=46)), Load(), lineno=649, col_offset=31)], [], None, None, lineno=649, col_offset=12), lineno=649, col_offset=12), Expr(Call(Attribute(Name('self', Load(), lineno=650, col_offset=12), 'setcorner', Load(), lineno=650, col_offset=12), [Attribute(Name('sys', Load(), lineno=650, col_offset=27), 'maxint', Load(), lineno=650, col_offset=27), Name('y', Load(), lineno=650, col_offset=39)], [], None, None, lineno=650, col_offset=12), lineno=650, col_offset=12)], [], lineno=648, col_offset=8)], [], lineno=646, col_offset=4), FunctionDef('press', arguments([Name('self', Param(), lineno=652, col_offset=14), Name('event', Param(), lineno=652, col_offset=20)], None, None, []), [Assign([Tuple([Name('x', Store(), lineno=653, col_offset=8), Name('y', Store(), lineno=653, col_offset=11)], Store(), lineno=653, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=653, col_offset=15), 'whichxy', Load(), lineno=653, col_offset=15), [Name('event', Load(), lineno=653, col_offset=28)], [], None, None, lineno=653, col_offset=15), lineno=653, col_offset=8), If(BoolOp(And(), [Compare(Name('x', Load(), lineno=654, col_offset=11), [Gt()], [Num(0, lineno=654, col_offset=15)], lineno=654, col_offset=11), Compare(Name('y', Load(), lineno=654, col_offset=21), [Gt()], [Num(0, lineno=654, col_offset=25)], lineno=654, col_offset=21)], lineno=654, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=655, col_offset=12), 'setcurrent', Load(), lineno=655, col_offset=12), [Name('x', Load(), lineno=655, col_offset=28), Name('y', Load(), lineno=655, col_offset=31)], [], None, None, lineno=655, col_offset=12), lineno=655, col_offset=12)], [], lineno=654, col_offset=8)], [], lineno=652, col_offset=4), FunctionDef('motion', arguments([Name('self', Param(), lineno=657, col_offset=15), Name('event', Param(), lineno=657, col_offset=21)], None, None, []), [Assign([Tuple([Name('x', Store(), lineno=658, col_offset=8), Name('y', Store(), lineno=658, col_offset=11)], Store(), lineno=658, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=658, col_offset=15), 'whichxy', Load(), lineno=658, col_offset=15), [Name('event', Load(), lineno=658, col_offset=28)], [], None, None, lineno=658, col_offset=15), lineno=658, col_offset=8), If(BoolOp(And(), [Compare(Name('x', Load(), lineno=659, col_offset=11), [Gt()], [Num(0, lineno=659, col_offset=15)], lineno=659, col_offset=11), Compare(Name('y', Load(), lineno=659, col_offset=21), [Gt()], [Num(0, lineno=659, col_offset=25)], lineno=659, col_offset=21)], lineno=659, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=660, col_offset=12), 'setcorner', Load(), lineno=660, col_offset=12), [Name('x', Load(), lineno=660, col_offset=27), Name('y', Load(), lineno=660, col_offset=30)], [], None, None, lineno=660, col_offset=12), lineno=660, col_offset=12)], [], lineno=659, col_offset=8)], [], lineno=657, col_offset=4), Assign([Name('release', Store(), lineno=662, col_offset=4)], Name('motion', Load(), lineno=662, col_offset=14), lineno=662, col_offset=4), FunctionDef('whichxy', arguments([Name('self', Param(), lineno=664, col_offset=16), Name('event', Param(), lineno=664, col_offset=22)], None, None, []), [Assign([Name('w', Store(), lineno=665, col_offset=8)], Call(Attribute(Attribute(Name('self', Load(), lineno=665, col_offset=12), 'cellgrid', Load(), lineno=665, col_offset=12), 'winfo_containing', Load(), lineno=665, col_offset=12), [Attribute(Name('event', Load(), lineno=665, col_offset=43), 'x_root', Load(), lineno=665, col_offset=43), Attribute(Name('event', Load(), lineno=665, col_offset=57), 'y_root', Load(), lineno=665, col_offset=57)], [], None, None, lineno=665, col_offset=12), lineno=665, col_offset=8), If(BoolOp(And(), [Compare(Name('w', Load(), lineno=666, col_offset=11), [IsNot()], [Name('None', Load(), lineno=666, col_offset=20)], lineno=666, col_offset=11), Call(Name('isinstance', Load(), lineno=666, col_offset=29), [Name('w', Load(), lineno=666, col_offset=40), Attribute(Name('Tk', Load(), lineno=666, col_offset=43), 'Label', Load(), lineno=666, col_offset=43)], [], None, None, lineno=666, col_offset=29)], lineno=666, col_offset=11), [TryExcept([Return(Tuple([Attribute(Name('w', Load(), lineno=668, col_offset=23), '__x', Load(), lineno=668, col_offset=23), Attribute(Name('w', Load(), lineno=668, col_offset=30), '__y', Load(), lineno=668, col_offset=30)], Load(), lineno=668, col_offset=23), lineno=668, col_offset=16)], [ExceptHandler(Name('AttributeError', Load(), lineno=669, col_offset=19), None, [Pass( lineno=670, col_offset=16)], lineno=669, col_offset=12)], [], lineno=667, col_offset=12)], [], lineno=666, col_offset=8), Return(Tuple([Num(0, lineno=671, col_offset=15), Num(0, lineno=671, col_offset=18)], Load(), lineno=671, col_offset=15), lineno=671, col_offset=8)], [], lineno=664, col_offset=4), FunctionDef('save', arguments([Name('self', Param(), lineno=673, col_offset=13)], None, None, []), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=674, col_offset=8), 'sheet', Load(), lineno=674, col_offset=8), 'save', Load(), lineno=674, col_offset=8), [Attribute(Name('self', Load(), lineno=674, col_offset=24), 'filename', Load(), lineno=674, col_offset=24)], [], None, None, lineno=674, col_offset=8), lineno=674, col_offset=8)], [], lineno=673, col_offset=4), FunctionDef('setcurrent', arguments([Name('self', Param(), lineno=676, col_offset=19), Name('x', Param(), lineno=676, col_offset=25), Name('y', Param(), lineno=676, col_offset=28)], None, None, []), [Expr(Str('Make (x, y) the current cell.', lineno=677, col_offset=8), lineno=677, col_offset=8), If(Compare(Attribute(Name('self', Load(), lineno=678, col_offset=11), 'currentxy', Load(), lineno=678, col_offset=11), [IsNot()], [Name('None', Load(), lineno=678, col_offset=33)], lineno=678, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=679, col_offset=12), 'change_cell', Load(), lineno=679, col_offset=12), [], [], None, None, lineno=679, col_offset=12), lineno=679, col_offset=12)], [], lineno=678, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=680, col_offset=8), 'clearfocus', Load(), lineno=680, col_offset=8), [], [], None, None, lineno=680, col_offset=8), lineno=680, col_offset=8), Assign([Subscript(Attribute(Name('self', Load(), lineno=681, col_offset=8), 'beacon', Load(), lineno=681, col_offset=8), Index(Str('text', lineno=681, col_offset=20)), Store(), lineno=681, col_offset=8)], Call(Name('cellname', Load(), lineno=681, col_offset=30), [Name('x', Load(), lineno=681, col_offset=39), Name('y', Load(), lineno=681, col_offset=42)], [], None, None, lineno=681, col_offset=30), lineno=681, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=682, col_offset=8), 'load_entry', Load(), lineno=682, col_offset=8), [Name('x', Load(), lineno=682, col_offset=24), Name('y', Load(), lineno=682, col_offset=27)], [], None, None, lineno=682, col_offset=8), lineno=682, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=683, col_offset=8), 'entry', Load(), lineno=683, col_offset=8), 'focus_set', Load(), lineno=683, col_offset=8), [], [], None, None, lineno=683, col_offset=8), lineno=683, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=684, col_offset=8), 'currentxy', Store(), lineno=684, col_offset=8)], Tuple([Name('x', Load(), lineno=684, col_offset=25), Name('y', Load(), lineno=684, col_offset=28)], Load(), lineno=684, col_offset=25), lineno=684, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=685, col_offset=8), 'cornerxy', Store(), lineno=685, col_offset=8)], Name('None', Load(), lineno=685, col_offset=24), lineno=685, col_offset=8), Assign([Name('gridcell', Store(), lineno=686, col_offset=8)], Call(Attribute(Attribute(Name('self', Load(), lineno=686, col_offset=19), 'gridcells', Load(), lineno=686, col_offset=19), 'get', Load(), lineno=686, col_offset=19), [Attribute(Name('self', Load(), lineno=686, col_offset=38), 'currentxy', Load(), lineno=686, col_offset=38)], [], None, None, lineno=686, col_offset=19), lineno=686, col_offset=8), If(Compare(Name('gridcell', Load(), lineno=687, col_offset=11), [IsNot()], [Name('None', Load(), lineno=687, col_offset=27)], lineno=687, col_offset=11), [Assign([Subscript(Name('gridcell', Load(), lineno=688, col_offset=12), Index(Str('bg', lineno=688, col_offset=21)), Store(), lineno=688, col_offset=12)], Str('yellow', lineno=688, col_offset=29), lineno=688, col_offset=12)], [], lineno=687, col_offset=8)], [], lineno=676, col_offset=4), FunctionDef('setcorner', arguments([Name('self', Param(), lineno=690, col_offset=18), Name('x', Param(), lineno=690, col_offset=24), Name('y', Param(), lineno=690, col_offset=27)], None, None, []), [If(BoolOp(Or(), [Compare(Attribute(Name('self', Load(), lineno=691, col_offset=11), 'currentxy', Load(), lineno=691, col_offset=11), [Is()], [Name('None', Load(), lineno=691, col_offset=29)], lineno=691, col_offset=11), Compare(Attribute(Name('self', Load(), lineno=691, col_offset=37), 'currentxy', Load(), lineno=691, col_offset=37), [Eq()], [Tuple([Name('x', Load(), lineno=691, col_offset=56), Name('y', Load(), lineno=691, col_offset=59)], Load(), lineno=691, col_offset=56)], lineno=691, col_offset=37)], lineno=691, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=692, col_offset=12), 'setcurrent', Load(), lineno=692, col_offset=12), [Name('x', Load(), lineno=692, col_offset=28), Name('y', Load(), lineno=692, col_offset=31)], [], None, None, lineno=692, col_offset=12), lineno=692, col_offset=12), Return(None, lineno=693, col_offset=12)], [], lineno=691, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=694, col_offset=8), 'clearfocus', Load(), lineno=694, col_offset=8), [], [], None, None, lineno=694, col_offset=8), lineno=694, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=695, col_offset=8), 'cornerxy', Store(), lineno=695, col_offset=8)], Tuple([Name('x', Load(), lineno=695, col_offset=24), Name('y', Load(), lineno=695, col_offset=27)], Load(), lineno=695, col_offset=24), lineno=695, col_offset=8), Assign([Tuple([Name('x1', Store(), lineno=696, col_offset=8), Name('y1', Store(), lineno=696, col_offset=12)], Store(), lineno=696, col_offset=8)], Attribute(Name('self', Load(), lineno=696, col_offset=17), 'currentxy', Load(), lineno=696, col_offset=17), lineno=696, col_offset=8), Assign([Tuple([Name('x2', Store(), lineno=697, col_offset=8), Name('y2', Store(), lineno=697, col_offset=12)], Store(), lineno=697, col_offset=8)], BoolOp(Or(), [Attribute(Name('self', Load(), lineno=697, col_offset=17), 'cornerxy', Load(), lineno=697, col_offset=17), Attribute(Name('self', Load(), lineno=697, col_offset=34), 'currentxy', Load(), lineno=697, col_offset=34)], lineno=697, col_offset=17), lineno=697, col_offset=8), If(Compare(Name('x1', Load(), lineno=698, col_offset=11), [Gt()], [Name('x2', Load(), lineno=698, col_offset=16)], lineno=698, col_offset=11), [Assign([Tuple([Name('x1', Store(), lineno=699, col_offset=12), Name('x2', Store(), lineno=699, col_offset=16)], Store(), lineno=699, col_offset=12)], Tuple([Name('x2', Load(), lineno=699, col_offset=21), Name('x1', Load(), lineno=699, col_offset=25)], Load(), lineno=699, col_offset=21), lineno=699, col_offset=12)], [], lineno=698, col_offset=8), If(Compare(Name('y1', Load(), lineno=700, col_offset=11), [Gt()], [Name('y2', Load(), lineno=700, col_offset=16)], lineno=700, col_offset=11), [Assign([Tuple([Name('y1', Store(), lineno=701, col_offset=12), Name('y2', Store(), lineno=701, col_offset=16)], Store(), lineno=701, col_offset=12)], Tuple([Name('y2', Load(), lineno=701, col_offset=21), Name('y1', Load(), lineno=701, col_offset=25)], Load(), lineno=701, col_offset=21), lineno=701, col_offset=12)], [], lineno=700, col_offset=8), For(Tuple([Tuple([Name('x', Store(), lineno=702, col_offset=13), Name('y', Store(), lineno=702, col_offset=16)], Store(), lineno=702, col_offset=13), Name('cell', Store(), lineno=702, col_offset=20)], Store(), lineno=702, col_offset=13), Call(Attribute(Attribute(Name('self', Load(), lineno=702, col_offset=28), 'gridcells', Load(), lineno=702, col_offset=28), 'iteritems', Load(), lineno=702, col_offset=28), [], [], None, None, lineno=702, col_offset=28), [If(BoolOp(And(), [Compare(Name('x1', Load(), lineno=703, col_offset=15), [LtE(), LtE()], [Name('x', Load(), lineno=703, col_offset=21), Name('x2', Load(), lineno=703, col_offset=26)], lineno=703, col_offset=15), Compare(Name('y1', Load(), lineno=703, col_offset=33), [LtE(), LtE()], [Name('y', Load(), lineno=703, col_offset=39), Name('y2', Load(), lineno=703, col_offset=44)], lineno=703, col_offset=33)], lineno=703, col_offset=15), [Assign([Subscript(Name('cell', Load(), lineno=704, col_offset=16), Index(Str('bg', lineno=704, col_offset=21)), Store(), lineno=704, col_offset=16)], Str('lightBlue', lineno=704, col_offset=29), lineno=704, col_offset=16)], [], lineno=703, col_offset=12)], [], lineno=702, col_offset=8), Assign([Name('gridcell', Store(), lineno=705, col_offset=8)], Call(Attribute(Attribute(Name('self', Load(), lineno=705, col_offset=19), 'gridcells', Load(), lineno=705, col_offset=19), 'get', Load(), lineno=705, col_offset=19), [Attribute(Name('self', Load(), lineno=705, col_offset=38), 'currentxy', Load(), lineno=705, col_offset=38)], [], None, None, lineno=705, col_offset=19), lineno=705, col_offset=8), If(Compare(Name('gridcell', Load(), lineno=706, col_offset=11), [IsNot()], [Name('None', Load(), lineno=706, col_offset=27)], lineno=706, col_offset=11), [Assign([Subscript(Name('gridcell', Load(), lineno=707, col_offset=12), Index(Str('bg', lineno=707, col_offset=21)), Store(), lineno=707, col_offset=12)], Str('yellow', lineno=707, col_offset=29), lineno=707, col_offset=12)], [], lineno=706, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=708, col_offset=8), 'setbeacon', Load(), lineno=708, col_offset=8), [Name('x1', Load(), lineno=708, col_offset=23), Name('y1', Load(), lineno=708, col_offset=27), Name('x2', Load(), lineno=708, col_offset=31), Name('y2', Load(), lineno=708, col_offset=35)], [], None, None, lineno=708, col_offset=8), lineno=708, col_offset=8)], [], lineno=690, col_offset=4), FunctionDef('setbeacon', arguments([Name('self', Param(), lineno=710, col_offset=18), Name('x1', Param(), lineno=710, col_offset=24), Name('y1', Param(), lineno=710, col_offset=28), Name('x2', Param(), lineno=710, col_offset=32), Name('y2', Param(), lineno=710, col_offset=36)], None, None, []), [If(BoolOp(And(), [Compare(Name('x1', Load(), lineno=711, col_offset=11), [Eq(), Eq()], [Name('y1', Load(), lineno=711, col_offset=17), Num(1, lineno=711, col_offset=23)], lineno=711, col_offset=11), Compare(Name('x2', Load(), lineno=711, col_offset=29), [Eq(), Eq()], [Name('y2', Load(), lineno=711, col_offset=35), Attribute(Name('sys', Load(), lineno=711, col_offset=41), 'maxint', Load(), lineno=711, col_offset=41)], lineno=711, col_offset=29)], lineno=711, col_offset=11), [Assign([Name('name', Store(), lineno=712, col_offset=12)], Str(':', lineno=712, col_offset=19), lineno=712, col_offset=12)], [If(Compare(Tuple([Name('x1', Load(), lineno=713, col_offset=14), Name('x2', Load(), lineno=713, col_offset=18)], Load(), lineno=713, col_offset=14), [Eq()], [Tuple([Num(1, lineno=713, col_offset=26), Attribute(Name('sys', Load(), lineno=713, col_offset=29), 'maxint', Load(), lineno=713, col_offset=29)], Load(), lineno=713, col_offset=26)], lineno=713, col_offset=13), [If(Compare(Name('y1', Load(), lineno=714, col_offset=15), [Eq()], [Name('y2', Load(), lineno=714, col_offset=21)], lineno=714, col_offset=15), [Assign([Name('name', Store(), lineno=715, col_offset=16)], BinOp(Str('%d', lineno=715, col_offset=23), Mod(), Name('y1', Load(), lineno=715, col_offset=30), lineno=715, col_offset=23), lineno=715, col_offset=16)], [Assign([Name('name', Store(), lineno=717, col_offset=16)], BinOp(Str('%d:%d', lineno=717, col_offset=23), Mod(), Tuple([Name('y1', Load(), lineno=717, col_offset=34), Name('y2', Load(), lineno=717, col_offset=38)], Load(), lineno=717, col_offset=34), lineno=717, col_offset=23), lineno=717, col_offset=16)], lineno=714, col_offset=12)], [If(Compare(Tuple([Name('y1', Load(), lineno=718, col_offset=14), Name('y2', Load(), lineno=718, col_offset=18)], Load(), lineno=718, col_offset=14), [Eq()], [Tuple([Num(1, lineno=718, col_offset=26), Attribute(Name('sys', Load(), lineno=718, col_offset=29), 'maxint', Load(), lineno=718, col_offset=29)], Load(), lineno=718, col_offset=26)], lineno=718, col_offset=13), [If(Compare(Name('x1', Load(), lineno=719, col_offset=15), [Eq()], [Name('x2', Load(), lineno=719, col_offset=21)], lineno=719, col_offset=15), [Assign([Name('name', Store(), lineno=720, col_offset=16)], BinOp(Str('%s', lineno=720, col_offset=23), Mod(), Call(Name('colnum2name', Load(), lineno=720, col_offset=30), [Name('x1', Load(), lineno=720, col_offset=42)], [], None, None, lineno=720, col_offset=30), lineno=720, col_offset=23), lineno=720, col_offset=16)], [Assign([Name('name', Store(), lineno=722, col_offset=16)], BinOp(Str('%s:%s', lineno=722, col_offset=23), Mod(), Tuple([Call(Name('colnum2name', Load(), lineno=722, col_offset=34), [Name('x1', Load(), lineno=722, col_offset=46)], [], None, None, lineno=722, col_offset=34), Call(Name('colnum2name', Load(), lineno=722, col_offset=51), [Name('x2', Load(), lineno=722, col_offset=63)], [], None, None, lineno=722, col_offset=51)], Load(), lineno=722, col_offset=34), lineno=722, col_offset=23), lineno=722, col_offset=16)], lineno=719, col_offset=12)], [Assign([Name('name1', Store(), lineno=724, col_offset=12)], Call(Name('cellname', Load(), lineno=724, col_offset=20), [], [], Attribute(Name('self', Load(), lineno=724, col_offset=30), 'currentxy', Load(), lineno=724, col_offset=30), None, lineno=724, col_offset=20), lineno=724, col_offset=12), Assign([Name('name2', Store(), lineno=725, col_offset=12)], Call(Name('cellname', Load(), lineno=725, col_offset=20), [], [], Attribute(Name('self', Load(), lineno=725, col_offset=30), 'cornerxy', Load(), lineno=725, col_offset=30), None, lineno=725, col_offset=20), lineno=725, col_offset=12), Assign([Name('name', Store(), lineno=726, col_offset=12)], BinOp(Str('%s:%s', lineno=726, col_offset=19), Mod(), Tuple([Name('name1', Load(), lineno=726, col_offset=30), Name('name2', Load(), lineno=726, col_offset=37)], Load(), lineno=726, col_offset=30), lineno=726, col_offset=19), lineno=726, col_offset=12)], lineno=718, col_offset=13)], lineno=713, col_offset=13)], lineno=711, col_offset=8), Assign([Subscript(Attribute(Name('self', Load(), lineno=727, col_offset=8), 'beacon', Load(), lineno=727, col_offset=8), Index(Str('text', lineno=727, col_offset=20)), Store(), lineno=727, col_offset=8)], Name('name', Load(), lineno=727, col_offset=30), lineno=727, col_offset=8)], [], lineno=710, col_offset=4), FunctionDef('clearfocus', arguments([Name('self', Param(), lineno=730, col_offset=19)], None, None, []), [If(Compare(Attribute(Name('self', Load(), lineno=731, col_offset=11), 'currentxy', Load(), lineno=731, col_offset=11), [IsNot()], [Name('None', Load(), lineno=731, col_offset=33)], lineno=731, col_offset=11), [Assign([Tuple([Name('x1', Store(), lineno=732, col_offset=12), Name('y1', Store(), lineno=732, col_offset=16)], Store(), lineno=732, col_offset=12)], Attribute(Name('self', Load(), lineno=732, col_offset=21), 'currentxy', Load(), lineno=732, col_offset=21), lineno=732, col_offset=12), Assign([Tuple([Name('x2', Store(), lineno=733, col_offset=12), Name('y2', Store(), lineno=733, col_offset=16)], Store(), lineno=733, col_offset=12)], BoolOp(Or(), [Attribute(Name('self', Load(), lineno=733, col_offset=21), 'cornerxy', Load(), lineno=733, col_offset=21), Attribute(Name('self', Load(), lineno=733, col_offset=38), 'currentxy', Load(), lineno=733, col_offset=38)], lineno=733, col_offset=21), lineno=733, col_offset=12), If(Compare(Name('x1', Load(), lineno=734, col_offset=15), [Gt()], [Name('x2', Load(), lineno=734, col_offset=20)], lineno=734, col_offset=15), [Assign([Tuple([Name('x1', Store(), lineno=735, col_offset=16), Name('x2', Store(), lineno=735, col_offset=20)], Store(), lineno=735, col_offset=16)], Tuple([Name('x2', Load(), lineno=735, col_offset=25), Name('x1', Load(), lineno=735, col_offset=29)], Load(), lineno=735, col_offset=25), lineno=735, col_offset=16)], [], lineno=734, col_offset=12), If(Compare(Name('y1', Load(), lineno=736, col_offset=15), [Gt()], [Name('y2', Load(), lineno=736, col_offset=20)], lineno=736, col_offset=15), [Assign([Tuple([Name('y1', Store(), lineno=737, col_offset=16), Name('y2', Store(), lineno=737, col_offset=20)], Store(), lineno=737, col_offset=16)], Tuple([Name('y2', Load(), lineno=737, col_offset=25), Name('y1', Load(), lineno=737, col_offset=29)], Load(), lineno=737, col_offset=25), lineno=737, col_offset=16)], [], lineno=736, col_offset=12), For(Tuple([Tuple([Name('x', Store(), lineno=738, col_offset=17), Name('y', Store(), lineno=738, col_offset=20)], Store(), lineno=738, col_offset=17), Name('cell', Store(), lineno=738, col_offset=24)], Store(), lineno=738, col_offset=17), Call(Attribute(Attribute(Name('self', Load(), lineno=738, col_offset=32), 'gridcells', Load(), lineno=738, col_offset=32), 'iteritems', Load(), lineno=738, col_offset=32), [], [], None, None, lineno=738, col_offset=32), [If(BoolOp(And(), [Compare(Name('x1', Load(), lineno=739, col_offset=19), [LtE(), LtE()], [Name('x', Load(), lineno=739, col_offset=25), Name('x2', Load(), lineno=739, col_offset=30)], lineno=739, col_offset=19), Compare(Name('y1', Load(), lineno=739, col_offset=37), [LtE(), LtE()], [Name('y', Load(), lineno=739, col_offset=43), Name('y2', Load(), lineno=739, col_offset=48)], lineno=739, col_offset=37)], lineno=739, col_offset=19), [Assign([Subscript(Name('cell', Load(), lineno=740, col_offset=20), Index(Str('bg', lineno=740, col_offset=25)), Store(), lineno=740, col_offset=20)], Str('white', lineno=740, col_offset=33), lineno=740, col_offset=20)], [], lineno=739, col_offset=16)], [], lineno=738, col_offset=12)], [], lineno=731, col_offset=8)], [], lineno=730, col_offset=4), FunctionDef('return_event', arguments([Name('self', Param(), lineno=742, col_offset=21), Name('event', Param(), lineno=742, col_offset=27)], None, None, []), [Expr(Str('Callback for the Return key.', lineno=743, col_offset=8), lineno=743, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=744, col_offset=8), 'change_cell', Load(), lineno=744, col_offset=8), [], [], None, None, lineno=744, col_offset=8), lineno=744, col_offset=8), Assign([Tuple([Name('x', Store(), lineno=745, col_offset=8), Name('y', Store(), lineno=745, col_offset=11)], Store(), lineno=745, col_offset=8)], Attribute(Name('self', Load(), lineno=745, col_offset=15), 'currentxy', Load(), lineno=745, col_offset=15), lineno=745, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=746, col_offset=8), 'setcurrent', Load(), lineno=746, col_offset=8), [Name('x', Load(), lineno=746, col_offset=24), BinOp(Name('y', Load(), lineno=746, col_offset=27), Add(), Num(1, lineno=746, col_offset=29), lineno=746, col_offset=27)], [], None, None, lineno=746, col_offset=8), lineno=746, col_offset=8), Return(Str('break', lineno=747, col_offset=15), lineno=747, col_offset=8)], [], lineno=742, col_offset=4), FunctionDef('shift_return_event', arguments([Name('self', Param(), lineno=749, col_offset=27), Name('event', Param(), lineno=749, col_offset=33)], None, None, []), [Expr(Str('Callback for the Return key with Shift modifier.', lineno=750, col_offset=8), lineno=750, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=751, col_offset=8), 'change_cell', Load(), lineno=751, col_offset=8), [], [], None, None, lineno=751, col_offset=8), lineno=751, col_offset=8), Assign([Tuple([Name('x', Store(), lineno=752, col_offset=8), Name('y', Store(), lineno=752, col_offset=11)], Store(), lineno=752, col_offset=8)], Attribute(Name('self', Load(), lineno=752, col_offset=15), 'currentxy', Load(), lineno=752, col_offset=15), lineno=752, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=753, col_offset=8), 'setcurrent', Load(), lineno=753, col_offset=8), [Name('x', Load(), lineno=753, col_offset=24), Call(Name('max', Load(), lineno=753, col_offset=27), [Num(1, lineno=753, col_offset=31), BinOp(Name('y', Load(), lineno=753, col_offset=34), Sub(), Num(1, lineno=753, col_offset=36), lineno=753, col_offset=34)], [], None, None, lineno=753, col_offset=27)], [], None, None, lineno=753, col_offset=8), lineno=753, col_offset=8), Return(Str('break', lineno=754, col_offset=15), lineno=754, col_offset=8)], [], lineno=749, col_offset=4), FunctionDef('tab_event', arguments([Name('self', Param(), lineno=756, col_offset=18), Name('event', Param(), lineno=756, col_offset=24)], None, None, []), [Expr(Str('Callback for the Tab key.', lineno=757, col_offset=8), lineno=757, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=758, col_offset=8), 'change_cell', Load(), lineno=758, col_offset=8), [], [], None, None, lineno=758, col_offset=8), lineno=758, col_offset=8), Assign([Tuple([Name('x', Store(), lineno=759, col_offset=8), Name('y', Store(), lineno=759, col_offset=11)], Store(), lineno=759, col_offset=8)], Attribute(Name('self', Load(), lineno=759, col_offset=15), 'currentxy', Load(), lineno=759, col_offset=15), lineno=759, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=760, col_offset=8), 'setcurrent', Load(), lineno=760, col_offset=8), [BinOp(Name('x', Load(), lineno=760, col_offset=24), Add(), Num(1, lineno=760, col_offset=26), lineno=760, col_offset=24), Name('y', Load(), lineno=760, col_offset=29)], [], None, None, lineno=760, col_offset=8), lineno=760, col_offset=8), Return(Str('break', lineno=761, col_offset=15), lineno=761, col_offset=8)], [], lineno=756, col_offset=4), FunctionDef('shift_tab_event', arguments([Name('self', Param(), lineno=763, col_offset=24), Name('event', Param(), lineno=763, col_offset=30)], None, None, []), [Expr(Str('Callback for the Tab key with Shift modifier.', lineno=764, col_offset=8), lineno=764, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=765, col_offset=8), 'change_cell', Load(), lineno=765, col_offset=8), [], [], None, None, lineno=765, col_offset=8), lineno=765, col_offset=8), Assign([Tuple([Name('x', Store(), lineno=766, col_offset=8), Name('y', Store(), lineno=766, col_offset=11)], Store(), lineno=766, col_offset=8)], Attribute(Name('self', Load(), lineno=766, col_offset=15), 'currentxy', Load(), lineno=766, col_offset=15), lineno=766, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=767, col_offset=8), 'setcurrent', Load(), lineno=767, col_offset=8), [Call(Name('max', Load(), lineno=767, col_offset=24), [Num(1, lineno=767, col_offset=28), BinOp(Name('x', Load(), lineno=767, col_offset=31), Sub(), Num(1, lineno=767, col_offset=33), lineno=767, col_offset=31)], [], None, None, lineno=767, col_offset=24), Name('y', Load(), lineno=767, col_offset=37)], [], None, None, lineno=767, col_offset=8), lineno=767, col_offset=8), Return(Str('break', lineno=768, col_offset=15), lineno=768, col_offset=8)], [], lineno=763, col_offset=4), FunctionDef('change_cell', arguments([Name('self', Param(), lineno=770, col_offset=20)], None, None, []), [Expr(Str('Set the current cell from the entry widget.', lineno=771, col_offset=8), lineno=771, col_offset=8), Assign([Tuple([Name('x', Store(), lineno=772, col_offset=8), Name('y', Store(), lineno=772, col_offset=11)], Store(), lineno=772, col_offset=8)], Attribute(Name('self', Load(), lineno=772, col_offset=15), 'currentxy', Load(), lineno=772, col_offset=15), lineno=772, col_offset=8), Assign([Name('text', Store(), lineno=773, col_offset=8)], Call(Attribute(Attribute(Name('self', Load(), lineno=773, col_offset=15), 'entry', Load(), lineno=773, col_offset=15), 'get', Load(), lineno=773, col_offset=15), [], [], None, None, lineno=773, col_offset=15), lineno=773, col_offset=8), Assign([Name('cell', Store(), lineno=774, col_offset=8)], Name('None', Load(), lineno=774, col_offset=15), lineno=774, col_offset=8), If(Call(Attribute(Name('text', Load(), lineno=775, col_offset=11), 'startswith', Load(), lineno=775, col_offset=11), [Str('=', lineno=775, col_offset=27)], [], None, None, lineno=775, col_offset=11), [Assign([Name('cell', Store(), lineno=776, col_offset=12)], Call(Name('FormulaCell', Load(), lineno=776, col_offset=19), [Subscript(Name('text', Load(), lineno=776, col_offset=31), Slice(Num(1, lineno=776, col_offset=36), None, None), Load(), lineno=776, col_offset=31)], [], None, None, lineno=776, col_offset=19), lineno=776, col_offset=12)], [For(Name('cls', Store(), lineno=778, col_offset=16), Tuple([Name('int', Load(), lineno=778, col_offset=23), Name('long', Load(), lineno=778, col_offset=28), Name('float', Load(), lineno=778, col_offset=34), Name('complex', Load(), lineno=778, col_offset=41)], Load(), lineno=778, col_offset=23), [TryExcept([Assign([Name('value', Store(), lineno=780, col_offset=20)], Call(Name('cls', Load(), lineno=780, col_offset=28), [Name('text', Load(), lineno=780, col_offset=32)], [], None, None, lineno=780, col_offset=28), lineno=780, col_offset=20)], [ExceptHandler(None, None, [Continue( lineno=782, col_offset=20)], lineno=781, col_offset=16)], [Assign([Name('cell', Store(), lineno=784, col_offset=20)], Call(Name('NumericCell', Load(), lineno=784, col_offset=27), [Name('value', Load(), lineno=784, col_offset=39)], [], None, None, lineno=784, col_offset=27), lineno=784, col_offset=20), Break( lineno=785, col_offset=20)], lineno=779, col_offset=16)], [], lineno=778, col_offset=12)], lineno=775, col_offset=8), If(BoolOp(And(), [Compare(Name('cell', Load(), lineno=786, col_offset=11), [Is()], [Name('None', Load(), lineno=786, col_offset=19)], lineno=786, col_offset=11), Name('text', Load(), lineno=786, col_offset=28)], lineno=786, col_offset=11), [Assign([Name('cell', Store(), lineno=787, col_offset=12)], Call(Name('StringCell', Load(), lineno=787, col_offset=19), [Name('text', Load(), lineno=787, col_offset=30)], [], None, None, lineno=787, col_offset=19), lineno=787, col_offset=12)], [], lineno=786, col_offset=8), If(Compare(Name('cell', Load(), lineno=788, col_offset=11), [Is()], [Name('None', Load(), lineno=788, col_offset=19)], lineno=788, col_offset=11), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=789, col_offset=12), 'sheet', Load(), lineno=789, col_offset=12), 'clearcell', Load(), lineno=789, col_offset=12), [Name('x', Load(), lineno=789, col_offset=33), Name('y', Load(), lineno=789, col_offset=36)], [], None, None, lineno=789, col_offset=12), lineno=789, col_offset=12)], [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=791, col_offset=12), 'sheet', Load(), lineno=791, col_offset=12), 'setcell', Load(), lineno=791, col_offset=12), [Name('x', Load(), lineno=791, col_offset=31), Name('y', Load(), lineno=791, col_offset=34), Name('cell', Load(), lineno=791, col_offset=37)], [], None, None, lineno=791, col_offset=12), lineno=791, col_offset=12)], lineno=788, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=792, col_offset=8), 'sync', Load(), lineno=792, col_offset=8), [], [], None, None, lineno=792, col_offset=8), lineno=792, col_offset=8)], [], lineno=770, col_offset=4), FunctionDef('sync', arguments([Name('self', Param(), lineno=794, col_offset=13)], None, None, []), [Expr(Str('Fill the GUI cells from the sheet cells.', lineno=795, col_offset=8), lineno=795, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=796, col_offset=8), 'sheet', Load(), lineno=796, col_offset=8), 'recalc', Load(), lineno=796, col_offset=8), [], [], None, None, lineno=796, col_offset=8), lineno=796, col_offset=8), For(Tuple([Tuple([Name('x', Store(), lineno=797, col_offset=13), Name('y', Store(), lineno=797, col_offset=16)], Store(), lineno=797, col_offset=13), Name('gridcell', Store(), lineno=797, col_offset=20)], Store(), lineno=797, col_offset=13), Call(Attribute(Attribute(Name('self', Load(), lineno=797, col_offset=32), 'gridcells', Load(), lineno=797, col_offset=32), 'iteritems', Load(), lineno=797, col_offset=32), [], [], None, None, lineno=797, col_offset=32), [If(BoolOp(Or(), [Compare(Name('x', Load(), lineno=798, col_offset=15), [Eq()], [Num(0, lineno=798, col_offset=20)], lineno=798, col_offset=15), Compare(Name('y', Load(), lineno=798, col_offset=25), [Eq()], [Num(0, lineno=798, col_offset=30)], lineno=798, col_offset=25)], lineno=798, col_offset=15), [Continue( lineno=799, col_offset=16)], [], lineno=798, col_offset=12), Assign([Name('cell', Store(), lineno=800, col_offset=12)], Call(Attribute(Attribute(Name('self', Load(), lineno=800, col_offset=19), 'sheet', Load(), lineno=800, col_offset=19), 'getcell', Load(), lineno=800, col_offset=19), [Name('x', Load(), lineno=800, col_offset=38), Name('y', Load(), lineno=800, col_offset=41)], [], None, None, lineno=800, col_offset=19), lineno=800, col_offset=12), If(Compare(Name('cell', Load(), lineno=801, col_offset=15), [Is()], [Name('None', Load(), lineno=801, col_offset=23)], lineno=801, col_offset=15), [Assign([Subscript(Name('gridcell', Load(), lineno=802, col_offset=16), Index(Str('text', lineno=802, col_offset=25)), Store(), lineno=802, col_offset=16)], Str('', lineno=802, col_offset=35), lineno=802, col_offset=16)], [If(Call(Name('hasattr', Load(), lineno=804, col_offset=19), [Name('cell', Load(), lineno=804, col_offset=27), Str('format', lineno=804, col_offset=33)], [], None, None, lineno=804, col_offset=19), [Assign([Tuple([Name('text', Store(), lineno=805, col_offset=20), Name('alignment', Store(), lineno=805, col_offset=26)], Store(), lineno=805, col_offset=20)], Call(Attribute(Name('cell', Load(), lineno=805, col_offset=38), 'format', Load(), lineno=805, col_offset=38), [], [], None, None, lineno=805, col_offset=38), lineno=805, col_offset=20)], [Assign([Tuple([Name('text', Store(), lineno=807, col_offset=20), Name('alignment', Store(), lineno=807, col_offset=26)], Store(), lineno=807, col_offset=20)], Tuple([Call(Name('str', Load(), lineno=807, col_offset=38), [Name('cell', Load(), lineno=807, col_offset=42)], [], None, None, lineno=807, col_offset=38), Name('LEFT', Load(), lineno=807, col_offset=49)], Load(), lineno=807, col_offset=38), lineno=807, col_offset=20)], lineno=804, col_offset=16), Assign([Subscript(Name('gridcell', Load(), lineno=808, col_offset=16), Index(Str('text', lineno=808, col_offset=25)), Store(), lineno=808, col_offset=16)], Name('text', Load(), lineno=808, col_offset=35), lineno=808, col_offset=16), Assign([Subscript(Name('gridcell', Load(), lineno=809, col_offset=16), Index(Str('anchor', lineno=809, col_offset=25)), Store(), lineno=809, col_offset=16)], Subscript(Name('align2anchor', Load(), lineno=809, col_offset=37), Index(Name('alignment', Load(), lineno=809, col_offset=50)), Load(), lineno=809, col_offset=37), lineno=809, col_offset=16)], lineno=801, col_offset=12)], [], lineno=797, col_offset=8)], [], lineno=794, col_offset=4)], [], lineno=490, col_offset=0), FunctionDef('test_basic', arguments([], None, None, []), [Expr(Str('Basic non-gui self-test.', lineno=813, col_offset=4), lineno=813, col_offset=4), Import([alias('os', None)], lineno=814, col_offset=4), Assign([Name('a', Store(), lineno=815, col_offset=4)], Call(Name('Sheet', Load(), lineno=815, col_offset=8), [], [], None, None, lineno=815, col_offset=8), lineno=815, col_offset=4), For(Name('x', Store(), lineno=816, col_offset=8), Call(Name('range', Load(), lineno=816, col_offset=13), [Num(1, lineno=816, col_offset=19), Num(11, lineno=816, col_offset=22)], [], None, None, lineno=816, col_offset=13), [For(Name('y', Store(), lineno=817, col_offset=12), Call(Name('range', Load(), lineno=817, col_offset=17), [Num(1, lineno=817, col_offset=23), Num(11, lineno=817, col_offset=26)], [], None, None, lineno=817, col_offset=17), [If(Compare(Name('x', Load(), lineno=818, col_offset=15), [Eq()], [Num(1, lineno=818, col_offset=20)], lineno=818, col_offset=15), [Assign([Name('cell', Store(), lineno=819, col_offset=16)], Call(Name('NumericCell', Load(), lineno=819, col_offset=23), [Name('y', Load(), lineno=819, col_offset=35)], [], None, None, lineno=819, col_offset=23), lineno=819, col_offset=16)], [If(Compare(Name('y', Load(), lineno=820, col_offset=17), [Eq()], [Num(1, lineno=820, col_offset=22)], lineno=820, col_offset=17), [Assign([Name('cell', Store(), lineno=821, col_offset=16)], Call(Name('NumericCell', Load(), lineno=821, col_offset=23), [Name('x', Load(), lineno=821, col_offset=35)], [], None, None, lineno=821, col_offset=23), lineno=821, col_offset=16)], [Assign([Name('c1', Store(), lineno=823, col_offset=16)], Call(Name('cellname', Load(), lineno=823, col_offset=21), [Name('x', Load(), lineno=823, col_offset=30), Num(1, lineno=823, col_offset=33)], [], None, None, lineno=823, col_offset=21), lineno=823, col_offset=16), Assign([Name('c2', Store(), lineno=824, col_offset=16)], Call(Name('cellname', Load(), lineno=824, col_offset=21), [Num(1, lineno=824, col_offset=30), Name('y', Load(), lineno=824, col_offset=33)], [], None, None, lineno=824, col_offset=21), lineno=824, col_offset=16), Assign([Name('formula', Store(), lineno=825, col_offset=16)], BinOp(Str('%s*%s', lineno=825, col_offset=26), Mod(), Tuple([Name('c1', Load(), lineno=825, col_offset=37), Name('c2', Load(), lineno=825, col_offset=41)], Load(), lineno=825, col_offset=37), lineno=825, col_offset=26), lineno=825, col_offset=16), Assign([Name('cell', Store(), lineno=826, col_offset=16)], Call(Name('FormulaCell', Load(), lineno=826, col_offset=23), [Name('formula', Load(), lineno=826, col_offset=35)], [], None, None, lineno=826, col_offset=23), lineno=826, col_offset=16)], lineno=820, col_offset=17)], lineno=818, col_offset=12), Expr(Call(Attribute(Name('a', Load(), lineno=827, col_offset=12), 'setcell', Load(), lineno=827, col_offset=12), [Name('x', Load(), lineno=827, col_offset=22), Name('y', Load(), lineno=827, col_offset=25), Name('cell', Load(), lineno=827, col_offset=28)], [], None, None, lineno=827, col_offset=12), lineno=827, col_offset=12)], [], lineno=817, col_offset=8)], [], lineno=816, col_offset=4), Expr(Call(Attribute(Name('a', Load(), lineno=831, col_offset=4), 'display', Load(), lineno=831, col_offset=4), [], [], None, None, lineno=831, col_offset=4), lineno=831, col_offset=4), Expr(Call(Attribute(Name('a', Load(), lineno=832, col_offset=4), 'save', Load(), lineno=832, col_offset=4), [Str('sheet1.xml', lineno=832, col_offset=11)], [], None, None, lineno=832, col_offset=4), lineno=832, col_offset=4)], [], lineno=812, col_offset=0), FunctionDef('test_gui', arguments([], None, None, []), [Expr(Str('GUI test.', lineno=835, col_offset=4), lineno=835, col_offset=4), If(Subscript(Attribute(Name('sys', Load(), lineno=836, col_offset=7), 'argv', Load(), lineno=836, col_offset=7), Slice(Num(1, lineno=836, col_offset=16), None, None), Load(), lineno=836, col_offset=7), [Assign([Name('filename', Store(), lineno=837, col_offset=8)], Subscript(Attribute(Name('sys', Load(), lineno=837, col_offset=19), 'argv', Load(), lineno=837, col_offset=19), Index(Num(1, lineno=837, col_offset=28)), Load(), lineno=837, col_offset=19), lineno=837, col_offset=8)], [Assign([Name('filename', Store(), lineno=839, col_offset=8)], Str('sheet1.xml', lineno=839, col_offset=19), lineno=839, col_offset=8)], lineno=836, col_offset=4), Assign([Name('g', Store(), lineno=840, col_offset=4)], Call(Name('SheetGUI', Load(), lineno=840, col_offset=8), [Name('filename', Load(), lineno=840, col_offset=17)], [], None, None, lineno=840, col_offset=8), lineno=840, col_offset=4), Expr(Call(Attribute(Attribute(Name('g', Load(), lineno=841, col_offset=4), 'root', Load(), lineno=841, col_offset=4), 'mainloop', Load(), lineno=841, col_offset=4), [], [], None, None, lineno=841, col_offset=4), lineno=841, col_offset=4)], [], lineno=834, col_offset=0), If(Compare(Name('__name__', Load(), lineno=843, col_offset=3), [Eq()], [Str('__main__', lineno=843, col_offset=15)], lineno=843, col_offset=3), [Expr(Call(Name('test_gui', Load(), lineno=845, col_offset=4), [], [], None, None, lineno=845, col_offset=4), lineno=845, col_offset=4)], [], lineno=843, col_offset=0)])
