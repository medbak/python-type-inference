Module([Expr(Str('Script used to test os.kill on Windows, for issue #1220212\n\nThis script is started as a subprocess in test_os and is used to test the\nCTRL_C_EVENT and CTRL_BREAK_EVENT signals, which requires a custom handler\nto be written into the kill target.\n\nSee http://msdn.microsoft.com/en-us/library/ms685049%28v=VS.85%29.aspx for a\nsimilar example in C.\n', lineno=9, col_offset=-1), lineno=9, col_offset=-1), ImportFrom('ctypes', [alias('wintypes', None), alias('WINFUNCTYPE', None)], 0, lineno=11, col_offset=0), Import([alias('signal', None)], lineno=12, col_offset=0), Import([alias('ctypes', None)], lineno=13, col_offset=0), Import([alias('mmap', None)], lineno=14, col_offset=0), Import([alias('sys', None)], lineno=15, col_offset=0), Assign([Name('HandlerRoutine', Store(), lineno=18, col_offset=0)], Call(Name('WINFUNCTYPE', Load(), lineno=18, col_offset=17), [Attribute(Name('wintypes', Load(), lineno=18, col_offset=29), 'BOOL', Load(), lineno=18, col_offset=29), Attribute(Name('wintypes', Load(), lineno=18, col_offset=44), 'DWORD', Load(), lineno=18, col_offset=44)], [], None, None, lineno=18, col_offset=17), lineno=18, col_offset=0), FunctionDef('_ctrl_handler', arguments([Name('sig', Param(), lineno=20, col_offset=18)], None, None, []), [Expr(Str('Handle a sig event and return 0 to terminate the process', lineno=21, col_offset=4), lineno=21, col_offset=4), If(Compare(Name('sig', Load(), lineno=22, col_offset=7), [Eq()], [Attribute(Name('signal', Load(), lineno=22, col_offset=14), 'CTRL_C_EVENT', Load(), lineno=22, col_offset=14)], lineno=22, col_offset=7), [Pass( lineno=23, col_offset=8)], [If(Compare(Name('sig', Load(), lineno=24, col_offset=9), [Eq()], [Attribute(Name('signal', Load(), lineno=24, col_offset=16), 'CTRL_BREAK_EVENT', Load(), lineno=24, col_offset=16)], lineno=24, col_offset=9), [Pass( lineno=25, col_offset=8)], [Print(None, [Str('UNKNOWN EVENT', lineno=27, col_offset=14)], True, lineno=27, col_offset=8)], lineno=24, col_offset=9)], lineno=22, col_offset=4), Return(Num(0, lineno=28, col_offset=11), lineno=28, col_offset=4)], [], lineno=20, col_offset=0), Assign([Name('ctrl_handler', Store(), lineno=30, col_offset=0)], Call(Name('HandlerRoutine', Load(), lineno=30, col_offset=15), [Name('_ctrl_handler', Load(), lineno=30, col_offset=30)], [], None, None, lineno=30, col_offset=15), lineno=30, col_offset=0), Assign([Name('SetConsoleCtrlHandler', Store(), lineno=33, col_offset=0)], Attribute(Attribute(Attribute(Name('ctypes', Load(), lineno=33, col_offset=24), 'windll', Load(), lineno=33, col_offset=24), 'kernel32', Load(), lineno=33, col_offset=24), 'SetConsoleCtrlHandler', Load(), lineno=33, col_offset=24), lineno=33, col_offset=0), Assign([Attribute(Name('SetConsoleCtrlHandler', Load(), lineno=34, col_offset=0), 'argtypes', Store(), lineno=34, col_offset=0)], Tuple([Name('HandlerRoutine', Load(), lineno=34, col_offset=34), Attribute(Name('wintypes', Load(), lineno=34, col_offset=50), 'BOOL', Load(), lineno=34, col_offset=50)], Load(), lineno=34, col_offset=34), lineno=34, col_offset=0), Assign([Attribute(Name('SetConsoleCtrlHandler', Load(), lineno=35, col_offset=0), 'restype', Store(), lineno=35, col_offset=0)], Attribute(Name('wintypes', Load(), lineno=35, col_offset=32), 'BOOL', Load(), lineno=35, col_offset=32), lineno=35, col_offset=0), If(Compare(Name('__name__', Load(), lineno=37, col_offset=3), [Eq()], [Str('__main__', lineno=37, col_offset=15)], lineno=37, col_offset=3), [If(UnaryOp(Not(), Call(Name('SetConsoleCtrlHandler', Load(), lineno=39, col_offset=11), [Name('ctrl_handler', Load(), lineno=39, col_offset=33), Num(1, lineno=39, col_offset=47)], [], None, None, lineno=39, col_offset=11), lineno=39, col_offset=7), [Print(None, [Str('Unable to add SetConsoleCtrlHandler', lineno=40, col_offset=14)], True, lineno=40, col_offset=8), Expr(Call(Name('exit', Load(), lineno=41, col_offset=8), [Num(-1, lineno=41, col_offset=14)], [], None, None, lineno=41, col_offset=8), lineno=41, col_offset=8)], [], lineno=39, col_offset=4), Assign([Name('m', Store(), lineno=44, col_offset=4)], Call(Attribute(Name('mmap', Load(), lineno=44, col_offset=8), 'mmap', Load(), lineno=44, col_offset=8), [Num(-1, lineno=44, col_offset=19), Num(1, lineno=44, col_offset=22), Subscript(Attribute(Name('sys', Load(), lineno=44, col_offset=25), 'argv', Load(), lineno=44, col_offset=25), Index(Num(1, lineno=44, col_offset=34)), Load(), lineno=44, col_offset=25)], [], None, None, lineno=44, col_offset=8), lineno=44, col_offset=4), Assign([Subscript(Name('m', Load(), lineno=45, col_offset=4), Index(Num(0, lineno=45, col_offset=6)), Store(), lineno=45, col_offset=4)], Str('1', lineno=45, col_offset=11), lineno=45, col_offset=4), While(Name('True', Load(), lineno=48, col_offset=10), [Pass( lineno=49, col_offset=8)], [], lineno=48, col_offset=4)], [], lineno=37, col_offset=0)])
