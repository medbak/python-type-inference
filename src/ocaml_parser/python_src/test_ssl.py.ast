Module([Import([alias('sys', None)], lineno=3, col_offset=0), Import([alias('unittest', None)], lineno=4, col_offset=0), ImportFrom('test', [alias('test_support', None)], 0, lineno=5, col_offset=0), Import([alias('asyncore', None)], lineno=6, col_offset=0), Import([alias('socket', None)], lineno=7, col_offset=0), Import([alias('select', None)], lineno=8, col_offset=0), Import([alias('time', None)], lineno=9, col_offset=0), Import([alias('gc', None)], lineno=10, col_offset=0), Import([alias('os', None)], lineno=11, col_offset=0), Import([alias('errno', None)], lineno=12, col_offset=0), Import([alias('pprint', None)], lineno=13, col_offset=0), Import([alias('urllib', None), alias('urlparse', None)], lineno=14, col_offset=0), Import([alias('traceback', None)], lineno=15, col_offset=0), Import([alias('weakref', None)], lineno=16, col_offset=0), Import([alias('functools', None)], lineno=17, col_offset=0), Import([alias('platform', None)], lineno=18, col_offset=0), ImportFrom('BaseHTTPServer', [alias('HTTPServer', None)], 0, lineno=20, col_offset=0), ImportFrom('SimpleHTTPServer', [alias('SimpleHTTPRequestHandler', None)], 0, lineno=21, col_offset=0), Assign([Name('skip_expected', Store(), lineno=24, col_offset=0)], Name('False', Load(), lineno=24, col_offset=16), lineno=24, col_offset=0), TryExcept([Import([alias('ssl', None)], lineno=26, col_offset=4)], [ExceptHandler(Name('ImportError', Load(), lineno=27, col_offset=7), None, [Assign([Name('skip_expected', Store(), lineno=28, col_offset=4)], Name('True', Load(), lineno=28, col_offset=20), lineno=28, col_offset=4)], lineno=27, col_offset=0)], [], lineno=25, col_offset=0), Assign([Name('HOST', Store(), lineno=30, col_offset=0)], Attribute(Name('test_support', Load(), lineno=30, col_offset=7), 'HOST', Load(), lineno=30, col_offset=7), lineno=30, col_offset=0), Assign([Name('CERTFILE', Store(), lineno=31, col_offset=0)], Name('None', Load(), lineno=31, col_offset=11), lineno=31, col_offset=0), Assign([Name('SVN_PYTHON_ORG_ROOT_CERT', Store(), lineno=32, col_offset=0)], Name('None', Load(), lineno=32, col_offset=27), lineno=32, col_offset=0), FunctionDef('handle_error', arguments([Name('prefix', Param(), lineno=34, col_offset=17)], None, None, []), [Assign([Name('exc_format', Store(), lineno=35, col_offset=4)], Call(Attribute(Str(' ', lineno=35, col_offset=17), 'join', Load(), lineno=35, col_offset=17), [Call(Attribute(Name('traceback', Load(), lineno=35, col_offset=26), 'format_exception', Load(), lineno=35, col_offset=26), [], [], Call(Attribute(Name('sys', Load(), lineno=35, col_offset=54), 'exc_info', Load(), lineno=35, col_offset=54), [], [], None, None, lineno=35, col_offset=54), None, lineno=35, col_offset=26)], [], None, None, lineno=35, col_offset=17), lineno=35, col_offset=4), If(Attribute(Name('test_support', Load(), lineno=36, col_offset=7), 'verbose', Load(), lineno=36, col_offset=7), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=37, col_offset=8), 'stdout', Load(), lineno=37, col_offset=8), 'write', Load(), lineno=37, col_offset=8), [BinOp(Name('prefix', Load(), lineno=37, col_offset=25), Add(), Name('exc_format', Load(), lineno=37, col_offset=34), lineno=37, col_offset=25)], [], None, None, lineno=37, col_offset=8), lineno=37, col_offset=8)], [], lineno=36, col_offset=4)], [], lineno=34, col_offset=0), ClassDef('BasicTests', [Attribute(Name('unittest', Load(), lineno=40, col_offset=17), 'TestCase', Load(), lineno=40, col_offset=17)], [FunctionDef('test_sslwrap_simple', arguments([Name('self', Param(), lineno=42, col_offset=28)], None, None, []), [TryExcept([Expr(Call(Attribute(Name('ssl', Load(), lineno=45, col_offset=12), 'sslwrap_simple', Load(), lineno=45, col_offset=12), [Call(Attribute(Name('socket', Load(), lineno=45, col_offset=31), 'socket', Load(), lineno=45, col_offset=31), [Attribute(Name('socket', Load(), lineno=45, col_offset=45), 'AF_INET', Load(), lineno=45, col_offset=45)], [], None, None, lineno=45, col_offset=31)], [], None, None, lineno=45, col_offset=12), lineno=45, col_offset=12)], [ExceptHandler(Name('IOError', Load(), lineno=46, col_offset=15), Name('e', Store(), lineno=46, col_offset=24), [If(Compare(Attribute(Name('e', Load(), lineno=47, col_offset=15), 'errno', Load(), lineno=47, col_offset=15), [Eq()], [Num(32, lineno=47, col_offset=26)], lineno=47, col_offset=15), [Pass( lineno=48, col_offset=16)], [Raise(None, None, None, lineno=50, col_offset=16)], lineno=47, col_offset=12)], lineno=46, col_offset=8)], [], lineno=44, col_offset=8), TryExcept([Expr(Call(Attribute(Name('ssl', Load(), lineno=52, col_offset=12), 'sslwrap_simple', Load(), lineno=52, col_offset=12), [Attribute(Call(Attribute(Name('socket', Load(), lineno=52, col_offset=31), 'socket', Load(), lineno=52, col_offset=31), [Attribute(Name('socket', Load(), lineno=52, col_offset=45), 'AF_INET', Load(), lineno=52, col_offset=45)], [], None, None, lineno=52, col_offset=31), '_sock', Load(), lineno=52, col_offset=31)], [], None, None, lineno=52, col_offset=12), lineno=52, col_offset=12)], [ExceptHandler(Name('IOError', Load(), lineno=53, col_offset=15), Name('e', Store(), lineno=53, col_offset=24), [If(Compare(Attribute(Name('e', Load(), lineno=54, col_offset=15), 'errno', Load(), lineno=54, col_offset=15), [Eq()], [Num(32, lineno=54, col_offset=26)], lineno=54, col_offset=15), [Pass( lineno=55, col_offset=16)], [Raise(None, None, None, lineno=57, col_offset=16)], lineno=54, col_offset=12)], lineno=53, col_offset=8)], [], lineno=51, col_offset=8)], [], lineno=42, col_offset=4)], [], lineno=40, col_offset=0), FunctionDef('skip_if_broken_ubuntu_ssl', arguments([Name('func', Param(), lineno=60, col_offset=30)], None, None, []), [TryExcept([Import([alias('_ssl', None)], lineno=64, col_offset=8)], [ExceptHandler(Name('ImportError', Load(), lineno=65, col_offset=11), None, [Pass( lineno=67, col_offset=8)], lineno=65, col_offset=4)], [], lineno=63, col_offset=4), FunctionDef('f', arguments([], 'args', 'kwargs', []), [TryExcept([Assign([Name('s', Store(), lineno=71, col_offset=12)], Call(Attribute(Name('socket', Load(), lineno=71, col_offset=16), 'socket', Load(), lineno=71, col_offset=16), [Attribute(Name('socket', Load(), lineno=71, col_offset=30), 'AF_INET', Load(), lineno=71, col_offset=30)], [], None, None, lineno=71, col_offset=16), lineno=71, col_offset=12), Expr(Call(Attribute(Name('_ssl', Load(), lineno=72, col_offset=12), 'sslwrap', Load(), lineno=72, col_offset=12), [Attribute(Name('s', Load(), lineno=72, col_offset=25), '_sock', Load(), lineno=72, col_offset=25), Num(0, lineno=72, col_offset=34), Name('None', Load(), lineno=72, col_offset=37), Name('None', Load(), lineno=72, col_offset=43), Attribute(Name('ssl', Load(), lineno=73, col_offset=25), 'CERT_NONE', Load(), lineno=73, col_offset=25), Attribute(Name('ssl', Load(), lineno=73, col_offset=40), 'PROTOCOL_SSLv2', Load(), lineno=73, col_offset=40), Name('None', Load(), lineno=73, col_offset=60), Name('None', Load(), lineno=73, col_offset=66)], [], None, None, lineno=72, col_offset=12), lineno=72, col_offset=12)], [ExceptHandler(Attribute(Name('ssl', Load(), lineno=74, col_offset=15), 'SSLError', Load(), lineno=74, col_offset=15), Name('e', Store(), lineno=74, col_offset=31), [If(BoolOp(And(), [Compare(Attribute(Name('ssl', Load(), lineno=75, col_offset=16), 'OPENSSL_VERSION_INFO', Load(), lineno=75, col_offset=16), [Eq()], [Tuple([Num(0, lineno=75, col_offset=45), Num(9, lineno=75, col_offset=48), Num(8, lineno=75, col_offset=51), Num(15, lineno=75, col_offset=54), Num(15, lineno=75, col_offset=58)], Load(), lineno=75, col_offset=45)], lineno=75, col_offset=16), Compare(Call(Attribute(Name('platform', Load(), lineno=76, col_offset=16), 'linux_distribution', Load(), lineno=76, col_offset=16), [], [], None, None, lineno=76, col_offset=16), [Eq()], [Tuple([Str('debian', lineno=76, col_offset=50), Str('squeeze/sid', lineno=76, col_offset=60), Str('', lineno=76, col_offset=75)], Load(), lineno=76, col_offset=50)], lineno=76, col_offset=16), Compare(Str('Invalid SSL protocol variant specified', lineno=77, col_offset=20), [In()], [Call(Name('str', Load(), lineno=77, col_offset=64), [Name('e', Load(), lineno=77, col_offset=68)], [], None, None, lineno=77, col_offset=64)], lineno=77, col_offset=20)], lineno=75, col_offset=16), [Raise(Call(Attribute(Name('unittest', Load(), lineno=78, col_offset=22), 'SkipTest', Load(), lineno=78, col_offset=22), [Str('Patched Ubuntu OpenSSL breaks behaviour', lineno=78, col_offset=40)], [], None, None, lineno=78, col_offset=22), None, None, lineno=78, col_offset=16)], [], lineno=75, col_offset=12)], lineno=74, col_offset=8)], [], lineno=70, col_offset=8), Return(Call(Name('func', Load(), lineno=79, col_offset=15), [], [], Name('args', Load(), lineno=79, col_offset=21), Name('kwargs', Load(), lineno=79, col_offset=29), lineno=79, col_offset=15), lineno=79, col_offset=8)], [Call(Attribute(Name('functools', Load(), lineno=68, col_offset=5), 'wraps', Load(), lineno=68, col_offset=5), [Name('func', Load(), lineno=68, col_offset=21)], [], None, None, lineno=68, col_offset=5)], lineno=68, col_offset=4), Return(Name('f', Load(), lineno=80, col_offset=11), lineno=80, col_offset=4)], [], lineno=60, col_offset=0), ClassDef('BasicSocketTests', [Attribute(Name('unittest', Load(), lineno=83, col_offset=23), 'TestCase', Load(), lineno=83, col_offset=23)], [FunctionDef('test_constants', arguments([Name('self', Param(), lineno=85, col_offset=23)], None, None, []), [Expr(Attribute(Name('ssl', Load(), lineno=86, col_offset=8), 'PROTOCOL_SSLv2', Load(), lineno=86, col_offset=8), lineno=86, col_offset=8), Expr(Attribute(Name('ssl', Load(), lineno=87, col_offset=8), 'PROTOCOL_SSLv23', Load(), lineno=87, col_offset=8), lineno=87, col_offset=8), Expr(Attribute(Name('ssl', Load(), lineno=88, col_offset=8), 'PROTOCOL_SSLv3', Load(), lineno=88, col_offset=8), lineno=88, col_offset=8), Expr(Attribute(Name('ssl', Load(), lineno=89, col_offset=8), 'PROTOCOL_TLSv1', Load(), lineno=89, col_offset=8), lineno=89, col_offset=8), Expr(Attribute(Name('ssl', Load(), lineno=90, col_offset=8), 'CERT_NONE', Load(), lineno=90, col_offset=8), lineno=90, col_offset=8), Expr(Attribute(Name('ssl', Load(), lineno=91, col_offset=8), 'CERT_OPTIONAL', Load(), lineno=91, col_offset=8), lineno=91, col_offset=8), Expr(Attribute(Name('ssl', Load(), lineno=92, col_offset=8), 'CERT_REQUIRED', Load(), lineno=92, col_offset=8), lineno=92, col_offset=8)], [], lineno=85, col_offset=4), FunctionDef('test_random', arguments([Name('self', Param(), lineno=94, col_offset=20)], None, None, []), [Assign([Name('v', Store(), lineno=95, col_offset=8)], Call(Attribute(Name('ssl', Load(), lineno=95, col_offset=12), 'RAND_status', Load(), lineno=95, col_offset=12), [], [], None, None, lineno=95, col_offset=12), lineno=95, col_offset=8), If(Attribute(Name('test_support', Load(), lineno=96, col_offset=11), 'verbose', Load(), lineno=96, col_offset=11), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=97, col_offset=12), 'stdout', Load(), lineno=97, col_offset=12), 'write', Load(), lineno=97, col_offset=12), [BinOp(Str('\n RAND_status is %d (%s)\n', lineno=97, col_offset=29), Mod(), Tuple([Name('v', Load(), lineno=98, col_offset=32), BoolOp(Or(), [BoolOp(And(), [Name('v', Load(), lineno=98, col_offset=36), Str('sufficient randomness', lineno=98, col_offset=42)], lineno=98, col_offset=36), Str('insufficient randomness', lineno=99, col_offset=32)], lineno=98, col_offset=35)], Load(), lineno=98, col_offset=32), lineno=97, col_offset=29)], [], None, None, lineno=97, col_offset=12), lineno=97, col_offset=12)], [], lineno=96, col_offset=8), TryExcept([Expr(Call(Attribute(Name('ssl', Load(), lineno=101, col_offset=12), 'RAND_egd', Load(), lineno=101, col_offset=12), [Num(1, lineno=101, col_offset=25)], [], None, None, lineno=101, col_offset=12), lineno=101, col_offset=12)], [ExceptHandler(Name('TypeError', Load(), lineno=102, col_offset=15), None, [Pass( lineno=103, col_offset=12)], lineno=102, col_offset=8)], [Print(None, [Str("didn't raise TypeError", lineno=105, col_offset=18)], True, lineno=105, col_offset=12)], lineno=100, col_offset=8), Expr(Call(Attribute(Name('ssl', Load(), lineno=106, col_offset=8), 'RAND_add', Load(), lineno=106, col_offset=8), [Str('this is a random string', lineno=106, col_offset=21), Num(75.0, lineno=106, col_offset=48)], [], None, None, lineno=106, col_offset=8), lineno=106, col_offset=8)], [], lineno=94, col_offset=4), FunctionDef('test_parse_cert', arguments([Name('self', Param(), lineno=108, col_offset=24)], None, None, []), [Assign([Name('p', Store(), lineno=112, col_offset=8)], Call(Attribute(Attribute(Name('ssl', Load(), lineno=112, col_offset=12), '_ssl', Load(), lineno=112, col_offset=12), '_test_decode_cert', Load(), lineno=112, col_offset=12), [Name('CERTFILE', Load(), lineno=112, col_offset=39), Name('False', Load(), lineno=112, col_offset=49)], [], None, None, lineno=112, col_offset=12), lineno=112, col_offset=8), If(Attribute(Name('test_support', Load(), lineno=113, col_offset=11), 'verbose', Load(), lineno=113, col_offset=11), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=114, col_offset=12), 'stdout', Load(), lineno=114, col_offset=12), 'write', Load(), lineno=114, col_offset=12), [BinOp(BinOp(Str('\n', lineno=114, col_offset=29), Add(), Call(Attribute(Name('pprint', Load(), lineno=114, col_offset=36), 'pformat', Load(), lineno=114, col_offset=36), [Name('p', Load(), lineno=114, col_offset=51)], [], None, None, lineno=114, col_offset=36), lineno=114, col_offset=29), Add(), Str('\n', lineno=114, col_offset=56), lineno=114, col_offset=54)], [], None, None, lineno=114, col_offset=12), lineno=114, col_offset=12)], [], lineno=113, col_offset=8)], [], lineno=108, col_offset=4), FunctionDef('test_DER_to_PEM', arguments([Name('self', Param(), lineno=116, col_offset=24)], None, None, []), [With(Call(Name('open', Load(), lineno=117, col_offset=13), [Name('SVN_PYTHON_ORG_ROOT_CERT', Load(), lineno=117, col_offset=18), Str('r', lineno=117, col_offset=44)], [], None, None, lineno=117, col_offset=13), Name('f', Store(), lineno=117, col_offset=52), [Assign([Name('pem', Store(), lineno=118, col_offset=12)], Call(Attribute(Name('f', Load(), lineno=118, col_offset=18), 'read', Load(), lineno=118, col_offset=18), [], [], None, None, lineno=118, col_offset=18), lineno=118, col_offset=12)], lineno=117, col_offset=13), Assign([Name('d1', Store(), lineno=119, col_offset=8)], Call(Attribute(Name('ssl', Load(), lineno=119, col_offset=13), 'PEM_cert_to_DER_cert', Load(), lineno=119, col_offset=13), [Name('pem', Load(), lineno=119, col_offset=38)], [], None, None, lineno=119, col_offset=13), lineno=119, col_offset=8), Assign([Name('p2', Store(), lineno=120, col_offset=8)], Call(Attribute(Name('ssl', Load(), lineno=120, col_offset=13), 'DER_cert_to_PEM_cert', Load(), lineno=120, col_offset=13), [Name('d1', Load(), lineno=120, col_offset=38)], [], None, None, lineno=120, col_offset=13), lineno=120, col_offset=8), Assign([Name('d2', Store(), lineno=121, col_offset=8)], Call(Attribute(Name('ssl', Load(), lineno=121, col_offset=13), 'PEM_cert_to_DER_cert', Load(), lineno=121, col_offset=13), [Name('p2', Load(), lineno=121, col_offset=38)], [], None, None, lineno=121, col_offset=13), lineno=121, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=122, col_offset=8), 'assertEqual', Load(), lineno=122, col_offset=8), [Name('d1', Load(), lineno=122, col_offset=25), Name('d2', Load(), lineno=122, col_offset=29)], [], None, None, lineno=122, col_offset=8), lineno=122, col_offset=8), If(UnaryOp(Not(), Call(Attribute(Name('p2', Load(), lineno=123, col_offset=15), 'startswith', Load(), lineno=123, col_offset=15), [BinOp(Attribute(Name('ssl', Load(), lineno=123, col_offset=29), 'PEM_HEADER', Load(), lineno=123, col_offset=29), Add(), Str('\n', lineno=123, col_offset=46), lineno=123, col_offset=29)], [], None, None, lineno=123, col_offset=15), lineno=123, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=124, col_offset=12), 'fail', Load(), lineno=124, col_offset=12), [BinOp(Str("DER-to-PEM didn't include correct header:\n%r\n", lineno=124, col_offset=22), Mod(), Name('p2', Load(), lineno=124, col_offset=74), lineno=124, col_offset=22)], [], None, None, lineno=124, col_offset=12), lineno=124, col_offset=12)], [], lineno=123, col_offset=8), If(UnaryOp(Not(), Call(Attribute(Name('p2', Load(), lineno=125, col_offset=15), 'endswith', Load(), lineno=125, col_offset=15), [BinOp(BinOp(Str('\n', lineno=125, col_offset=27), Add(), Attribute(Name('ssl', Load(), lineno=125, col_offset=34), 'PEM_FOOTER', Load(), lineno=125, col_offset=34), lineno=125, col_offset=27), Add(), Str('\n', lineno=125, col_offset=51), lineno=125, col_offset=49)], [], None, None, lineno=125, col_offset=15), lineno=125, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=126, col_offset=12), 'fail', Load(), lineno=126, col_offset=12), [BinOp(Str("DER-to-PEM didn't include correct footer:\n%r\n", lineno=126, col_offset=22), Mod(), Name('p2', Load(), lineno=126, col_offset=74), lineno=126, col_offset=22)], [], None, None, lineno=126, col_offset=12), lineno=126, col_offset=12)], [], lineno=125, col_offset=8)], [], lineno=116, col_offset=4), FunctionDef('test_openssl_version', arguments([Name('self', Param(), lineno=128, col_offset=29)], None, None, []), [Assign([Name('n', Store(), lineno=129, col_offset=8)], Attribute(Name('ssl', Load(), lineno=129, col_offset=12), 'OPENSSL_VERSION_NUMBER', Load(), lineno=129, col_offset=12), lineno=129, col_offset=8), Assign([Name('t', Store(), lineno=130, col_offset=8)], Attribute(Name('ssl', Load(), lineno=130, col_offset=12), 'OPENSSL_VERSION_INFO', Load(), lineno=130, col_offset=12), lineno=130, col_offset=8), Assign([Name('s', Store(), lineno=131, col_offset=8)], Attribute(Name('ssl', Load(), lineno=131, col_offset=12), 'OPENSSL_VERSION', Load(), lineno=131, col_offset=12), lineno=131, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=132, col_offset=8), 'assertIsInstance', Load(), lineno=132, col_offset=8), [Name('n', Load(), lineno=132, col_offset=30), Tuple([Name('int', Load(), lineno=132, col_offset=34), Name('long', Load(), lineno=132, col_offset=39)], Load(), lineno=132, col_offset=34)], [], None, None, lineno=132, col_offset=8), lineno=132, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=133, col_offset=8), 'assertIsInstance', Load(), lineno=133, col_offset=8), [Name('t', Load(), lineno=133, col_offset=30), Name('tuple', Load(), lineno=133, col_offset=33)], [], None, None, lineno=133, col_offset=8), lineno=133, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=134, col_offset=8), 'assertIsInstance', Load(), lineno=134, col_offset=8), [Name('s', Load(), lineno=134, col_offset=30), Name('str', Load(), lineno=134, col_offset=33)], [], None, None, lineno=134, col_offset=8), lineno=134, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=137, col_offset=8), 'assertGreaterEqual', Load(), lineno=137, col_offset=8), [Name('n', Load(), lineno=137, col_offset=32), Num(9437184, lineno=137, col_offset=35)], [], None, None, lineno=137, col_offset=8), lineno=137, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=139, col_offset=8), 'assertLess', Load(), lineno=139, col_offset=8), [Name('n', Load(), lineno=139, col_offset=24), Num(536870912, lineno=139, col_offset=27)], [], None, None, lineno=139, col_offset=8), lineno=139, col_offset=8), Assign([Tuple([Name('major', Store(), lineno=140, col_offset=8), Name('minor', Store(), lineno=140, col_offset=15), Name('fix', Store(), lineno=140, col_offset=22), Name('patch', Store(), lineno=140, col_offset=27), Name('status', Store(), lineno=140, col_offset=34)], Store(), lineno=140, col_offset=8)], Name('t', Load(), lineno=140, col_offset=43), lineno=140, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=141, col_offset=8), 'assertGreaterEqual', Load(), lineno=141, col_offset=8), [Name('major', Load(), lineno=141, col_offset=32), Num(0, lineno=141, col_offset=39)], [], None, None, lineno=141, col_offset=8), lineno=141, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=142, col_offset=8), 'assertLess', Load(), lineno=142, col_offset=8), [Name('major', Load(), lineno=142, col_offset=24), Num(2, lineno=142, col_offset=31)], [], None, None, lineno=142, col_offset=8), lineno=142, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=143, col_offset=8), 'assertGreaterEqual', Load(), lineno=143, col_offset=8), [Name('minor', Load(), lineno=143, col_offset=32), Num(0, lineno=143, col_offset=39)], [], None, None, lineno=143, col_offset=8), lineno=143, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=144, col_offset=8), 'assertLess', Load(), lineno=144, col_offset=8), [Name('minor', Load(), lineno=144, col_offset=24), Num(256, lineno=144, col_offset=31)], [], None, None, lineno=144, col_offset=8), lineno=144, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=145, col_offset=8), 'assertGreaterEqual', Load(), lineno=145, col_offset=8), [Name('fix', Load(), lineno=145, col_offset=32), Num(0, lineno=145, col_offset=37)], [], None, None, lineno=145, col_offset=8), lineno=145, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=146, col_offset=8), 'assertLess', Load(), lineno=146, col_offset=8), [Name('fix', Load(), lineno=146, col_offset=24), Num(256, lineno=146, col_offset=29)], [], None, None, lineno=146, col_offset=8), lineno=146, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=147, col_offset=8), 'assertGreaterEqual', Load(), lineno=147, col_offset=8), [Name('patch', Load(), lineno=147, col_offset=32), Num(0, lineno=147, col_offset=39)], [], None, None, lineno=147, col_offset=8), lineno=147, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=148, col_offset=8), 'assertLessEqual', Load(), lineno=148, col_offset=8), [Name('patch', Load(), lineno=148, col_offset=29), Num(26, lineno=148, col_offset=36)], [], None, None, lineno=148, col_offset=8), lineno=148, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=149, col_offset=8), 'assertGreaterEqual', Load(), lineno=149, col_offset=8), [Name('status', Load(), lineno=149, col_offset=32), Num(0, lineno=149, col_offset=40)], [], None, None, lineno=149, col_offset=8), lineno=149, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=150, col_offset=8), 'assertLessEqual', Load(), lineno=150, col_offset=8), [Name('status', Load(), lineno=150, col_offset=29), Num(15, lineno=150, col_offset=37)], [], None, None, lineno=150, col_offset=8), lineno=150, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=152, col_offset=8), 'assertTrue', Load(), lineno=152, col_offset=8), [Call(Attribute(Name('s', Load(), lineno=152, col_offset=24), 'startswith', Load(), lineno=152, col_offset=24), [Call(Attribute(Str('OpenSSL {:d}.{:d}.{:d}', lineno=152, col_offset=37), 'format', Load(), lineno=152, col_offset=37), [Name('major', Load(), lineno=152, col_offset=69), Name('minor', Load(), lineno=152, col_offset=76), Name('fix', Load(), lineno=152, col_offset=83)], [], None, None, lineno=152, col_offset=37)], [], None, None, lineno=152, col_offset=24), Tuple([Name('s', Load(), lineno=153, col_offset=25), Name('t', Load(), lineno=153, col_offset=28)], Load(), lineno=153, col_offset=25)], [], None, None, lineno=152, col_offset=8), lineno=152, col_offset=8)], [], lineno=128, col_offset=4), FunctionDef('test_ciphers', arguments([Name('self', Param(), lineno=155, col_offset=21)], None, None, []), [If(UnaryOp(Not(), Call(Attribute(Name('test_support', Load(), lineno=156, col_offset=15), 'is_resource_enabled', Load(), lineno=156, col_offset=15), [Str('network', lineno=156, col_offset=48)], [], None, None, lineno=156, col_offset=15), lineno=156, col_offset=11), [Return(None, lineno=157, col_offset=12)], [], lineno=156, col_offset=8), Assign([Name('remote', Store(), lineno=158, col_offset=8)], Tuple([Str('svn.python.org', lineno=158, col_offset=18), Num(443, lineno=158, col_offset=36)], Load(), lineno=158, col_offset=18), lineno=158, col_offset=8), With(Call(Attribute(Name('test_support', Load(), lineno=159, col_offset=13), 'transient_internet', Load(), lineno=159, col_offset=13), [Subscript(Name('remote', Load(), lineno=159, col_offset=45), Index(Num(0, lineno=159, col_offset=52)), Load(), lineno=159, col_offset=45)], [], None, None, lineno=159, col_offset=13), None, [Assign([Name('s', Store(), lineno=160, col_offset=12)], Call(Attribute(Name('ssl', Load(), lineno=160, col_offset=16), 'wrap_socket', Load(), lineno=160, col_offset=16), [Call(Attribute(Name('socket', Load(), lineno=160, col_offset=32), 'socket', Load(), lineno=160, col_offset=32), [Attribute(Name('socket', Load(), lineno=160, col_offset=46), 'AF_INET', Load(), lineno=160, col_offset=46)], [], None, None, lineno=160, col_offset=32)], [keyword('cert_reqs', Attribute(Name('ssl', Load(), lineno=161, col_offset=42), 'CERT_NONE', Load(), lineno=161, col_offset=42)), keyword('ciphers', Str('ALL', lineno=161, col_offset=65))], None, None, lineno=160, col_offset=16), lineno=160, col_offset=12), Expr(Call(Attribute(Name('s', Load(), lineno=162, col_offset=12), 'connect', Load(), lineno=162, col_offset=12), [Name('remote', Load(), lineno=162, col_offset=22)], [], None, None, lineno=162, col_offset=12), lineno=162, col_offset=12), Assign([Name('s', Store(), lineno=163, col_offset=12)], Call(Attribute(Name('ssl', Load(), lineno=163, col_offset=16), 'wrap_socket', Load(), lineno=163, col_offset=16), [Call(Attribute(Name('socket', Load(), lineno=163, col_offset=32), 'socket', Load(), lineno=163, col_offset=32), [Attribute(Name('socket', Load(), lineno=163, col_offset=46), 'AF_INET', Load(), lineno=163, col_offset=46)], [], None, None, lineno=163, col_offset=32)], [keyword('cert_reqs', Attribute(Name('ssl', Load(), lineno=164, col_offset=42), 'CERT_NONE', Load(), lineno=164, col_offset=42)), keyword('ciphers', Str('DEFAULT', lineno=164, col_offset=65))], None, None, lineno=163, col_offset=16), lineno=163, col_offset=12), Expr(Call(Attribute(Name('s', Load(), lineno=165, col_offset=12), 'connect', Load(), lineno=165, col_offset=12), [Name('remote', Load(), lineno=165, col_offset=22)], [], None, None, lineno=165, col_offset=12), lineno=165, col_offset=12), Assign([Name('s', Store(), lineno=168, col_offset=12)], Call(Attribute(Name('ssl', Load(), lineno=168, col_offset=16), 'wrap_socket', Load(), lineno=168, col_offset=16), [Call(Attribute(Name('socket', Load(), lineno=168, col_offset=32), 'socket', Load(), lineno=168, col_offset=32), [Attribute(Name('socket', Load(), lineno=168, col_offset=46), 'AF_INET', Load(), lineno=168, col_offset=46)], [], None, None, lineno=168, col_offset=32)], [keyword('cert_reqs', Attribute(Name('ssl', Load(), lineno=169, col_offset=42), 'CERT_NONE', Load(), lineno=169, col_offset=42)), keyword('ciphers', Str("^$:,;?*'dorothyx", lineno=169, col_offset=65))], None, None, lineno=168, col_offset=16), lineno=168, col_offset=12), With(Call(Attribute(Name('self', Load(), lineno=170, col_offset=17), 'assertRaisesRegexp', Load(), lineno=170, col_offset=17), [Attribute(Name('ssl', Load(), lineno=170, col_offset=41), 'SSLError', Load(), lineno=170, col_offset=41), Str('No cipher can be selected', lineno=170, col_offset=55)], [], None, None, lineno=170, col_offset=17), None, [Expr(Call(Attribute(Name('s', Load(), lineno=171, col_offset=16), 'connect', Load(), lineno=171, col_offset=16), [Name('remote', Load(), lineno=171, col_offset=26)], [], None, None, lineno=171, col_offset=16), lineno=171, col_offset=16)], lineno=170, col_offset=17)], lineno=159, col_offset=13)], [], lineno=155, col_offset=4), FunctionDef('test_refcycle', arguments([Name('self', Param(), lineno=174, col_offset=22)], None, None, []), [Assign([Name('s', Store(), lineno=177, col_offset=8)], Call(Attribute(Name('socket', Load(), lineno=177, col_offset=12), 'socket', Load(), lineno=177, col_offset=12), [Attribute(Name('socket', Load(), lineno=177, col_offset=26), 'AF_INET', Load(), lineno=177, col_offset=26)], [], None, None, lineno=177, col_offset=12), lineno=177, col_offset=8), Assign([Name('ss', Store(), lineno=178, col_offset=8)], Call(Attribute(Name('ssl', Load(), lineno=178, col_offset=13), 'wrap_socket', Load(), lineno=178, col_offset=13), [Name('s', Load(), lineno=178, col_offset=29)], [], None, None, lineno=178, col_offset=13), lineno=178, col_offset=8), Assign([Name('wr', Store(), lineno=179, col_offset=8)], Call(Attribute(Name('weakref', Load(), lineno=179, col_offset=13), 'ref', Load(), lineno=179, col_offset=13), [Name('ss', Load(), lineno=179, col_offset=25)], [], None, None, lineno=179, col_offset=13), lineno=179, col_offset=8), Delete([Name('ss', Del(), lineno=180, col_offset=12)], lineno=180, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=181, col_offset=8), 'assertEqual', Load(), lineno=181, col_offset=8), [Call(Name('wr', Load(), lineno=181, col_offset=25), [], [], None, None, lineno=181, col_offset=25), Name('None', Load(), lineno=181, col_offset=31)], [], None, None, lineno=181, col_offset=8), lineno=181, col_offset=8)], [Attribute(Name('test_support', Load(), lineno=173, col_offset=5), 'cpython_only', Load(), lineno=173, col_offset=5)], lineno=173, col_offset=4), FunctionDef('test_wrapped_unconnected', arguments([Name('self', Param(), lineno=183, col_offset=33)], None, None, []), [Assign([Name('s', Store(), lineno=187, col_offset=8)], Call(Attribute(Name('socket', Load(), lineno=187, col_offset=12), 'socket', Load(), lineno=187, col_offset=12), [Attribute(Name('socket', Load(), lineno=187, col_offset=26), 'AF_INET', Load(), lineno=187, col_offset=26)], [], None, None, lineno=187, col_offset=12), lineno=187, col_offset=8), Assign([Name('ss', Store(), lineno=188, col_offset=8)], Call(Attribute(Name('ssl', Load(), lineno=188, col_offset=13), 'wrap_socket', Load(), lineno=188, col_offset=13), [Name('s', Load(), lineno=188, col_offset=29)], [], None, None, lineno=188, col_offset=13), lineno=188, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=189, col_offset=8), 'assertRaises', Load(), lineno=189, col_offset=8), [Attribute(Name('socket', Load(), lineno=189, col_offset=26), 'error', Load(), lineno=189, col_offset=26), Attribute(Name('ss', Load(), lineno=189, col_offset=40), 'recv', Load(), lineno=189, col_offset=40), Num(1, lineno=189, col_offset=49)], [], None, None, lineno=189, col_offset=8), lineno=189, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=190, col_offset=8), 'assertRaises', Load(), lineno=190, col_offset=8), [Attribute(Name('socket', Load(), lineno=190, col_offset=26), 'error', Load(), lineno=190, col_offset=26), Attribute(Name('ss', Load(), lineno=190, col_offset=40), 'recv_into', Load(), lineno=190, col_offset=40), Call(Name('bytearray', Load(), lineno=190, col_offset=54), [Str('x', lineno=190, col_offset=64)], [], None, None, lineno=190, col_offset=54)], [], None, None, lineno=190, col_offset=8), lineno=190, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=191, col_offset=8), 'assertRaises', Load(), lineno=191, col_offset=8), [Attribute(Name('socket', Load(), lineno=191, col_offset=26), 'error', Load(), lineno=191, col_offset=26), Attribute(Name('ss', Load(), lineno=191, col_offset=40), 'recvfrom', Load(), lineno=191, col_offset=40), Num(1, lineno=191, col_offset=53)], [], None, None, lineno=191, col_offset=8), lineno=191, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=192, col_offset=8), 'assertRaises', Load(), lineno=192, col_offset=8), [Attribute(Name('socket', Load(), lineno=192, col_offset=26), 'error', Load(), lineno=192, col_offset=26), Attribute(Name('ss', Load(), lineno=192, col_offset=40), 'recvfrom_into', Load(), lineno=192, col_offset=40), Call(Name('bytearray', Load(), lineno=192, col_offset=58), [Str('x', lineno=192, col_offset=68)], [], None, None, lineno=192, col_offset=58), Num(1, lineno=192, col_offset=75)], [], None, None, lineno=192, col_offset=8), lineno=192, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=193, col_offset=8), 'assertRaises', Load(), lineno=193, col_offset=8), [Attribute(Name('socket', Load(), lineno=193, col_offset=26), 'error', Load(), lineno=193, col_offset=26), Attribute(Name('ss', Load(), lineno=193, col_offset=40), 'send', Load(), lineno=193, col_offset=40), Str('x', lineno=193, col_offset=49)], [], None, None, lineno=193, col_offset=8), lineno=193, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=194, col_offset=8), 'assertRaises', Load(), lineno=194, col_offset=8), [Attribute(Name('socket', Load(), lineno=194, col_offset=26), 'error', Load(), lineno=194, col_offset=26), Attribute(Name('ss', Load(), lineno=194, col_offset=40), 'sendto', Load(), lineno=194, col_offset=40), Str('x', lineno=194, col_offset=51), Tuple([Str('0.0.0.0', lineno=194, col_offset=58), Num(0, lineno=194, col_offset=69)], Load(), lineno=194, col_offset=58)], [], None, None, lineno=194, col_offset=8), lineno=194, col_offset=8)], [], lineno=183, col_offset=4)], [], lineno=83, col_offset=0), ClassDef('NetworkedTests', [Attribute(Name('unittest', Load(), lineno=197, col_offset=21), 'TestCase', Load(), lineno=197, col_offset=21)], [FunctionDef('test_connect', arguments([Name('self', Param(), lineno=199, col_offset=21)], None, None, []), [With(Call(Attribute(Name('test_support', Load(), lineno=200, col_offset=13), 'transient_internet', Load(), lineno=200, col_offset=13), [Str('svn.python.org', lineno=200, col_offset=45)], [], None, None, lineno=200, col_offset=13), None, [Assign([Name('s', Store(), lineno=201, col_offset=12)], Call(Attribute(Name('ssl', Load(), lineno=201, col_offset=16), 'wrap_socket', Load(), lineno=201, col_offset=16), [Call(Attribute(Name('socket', Load(), lineno=201, col_offset=32), 'socket', Load(), lineno=201, col_offset=32), [Attribute(Name('socket', Load(), lineno=201, col_offset=46), 'AF_INET', Load(), lineno=201, col_offset=46)], [], None, None, lineno=201, col_offset=32)], [keyword('cert_reqs', Attribute(Name('ssl', Load(), lineno=202, col_offset=42), 'CERT_NONE', Load(), lineno=202, col_offset=42))], None, None, lineno=201, col_offset=16), lineno=201, col_offset=12), Expr(Call(Attribute(Name('s', Load(), lineno=203, col_offset=12), 'connect', Load(), lineno=203, col_offset=12), [Tuple([Str('svn.python.org', lineno=203, col_offset=23), Num(443, lineno=203, col_offset=41)], Load(), lineno=203, col_offset=23)], [], None, None, lineno=203, col_offset=12), lineno=203, col_offset=12), Assign([Name('c', Store(), lineno=204, col_offset=12)], Call(Attribute(Name('s', Load(), lineno=204, col_offset=16), 'getpeercert', Load(), lineno=204, col_offset=16), [], [], None, None, lineno=204, col_offset=16), lineno=204, col_offset=12), If(Name('c', Load(), lineno=205, col_offset=15), [Expr(Call(Attribute(Name('self', Load(), lineno=206, col_offset=16), 'fail', Load(), lineno=206, col_offset=16), [Str("Peer cert %s shouldn't be here!", lineno=206, col_offset=26)], [], None, None, lineno=206, col_offset=16), lineno=206, col_offset=16)], [], lineno=205, col_offset=12), Expr(Call(Attribute(Name('s', Load(), lineno=207, col_offset=12), 'close', Load(), lineno=207, col_offset=12), [], [], None, None, lineno=207, col_offset=12), lineno=207, col_offset=12), Assign([Name('s', Store(), lineno=210, col_offset=12)], Call(Attribute(Name('ssl', Load(), lineno=210, col_offset=16), 'wrap_socket', Load(), lineno=210, col_offset=16), [Call(Attribute(Name('socket', Load(), lineno=210, col_offset=32), 'socket', Load(), lineno=210, col_offset=32), [Attribute(Name('socket', Load(), lineno=210, col_offset=46), 'AF_INET', Load(), lineno=210, col_offset=46)], [], None, None, lineno=210, col_offset=32)], [keyword('cert_reqs', Attribute(Name('ssl', Load(), lineno=211, col_offset=42), 'CERT_REQUIRED', Load(), lineno=211, col_offset=42))], None, None, lineno=210, col_offset=16), lineno=210, col_offset=12), TryFinally([TryExcept([Expr(Call(Attribute(Name('s', Load(), lineno=213, col_offset=16), 'connect', Load(), lineno=213, col_offset=16), [Tuple([Str('svn.python.org', lineno=213, col_offset=27), Num(443, lineno=213, col_offset=45)], Load(), lineno=213, col_offset=27)], [], None, None, lineno=213, col_offset=16), lineno=213, col_offset=16)], [ExceptHandler(Attribute(Name('ssl', Load(), lineno=214, col_offset=19), 'SSLError', Load(), lineno=214, col_offset=19), None, [Pass( lineno=215, col_offset=16)], lineno=214, col_offset=12)], [], lineno=212, col_offset=12)], [Expr(Call(Attribute(Name('s', Load(), lineno=217, col_offset=16), 'close', Load(), lineno=217, col_offset=16), [], [], None, None, lineno=217, col_offset=16), lineno=217, col_offset=16)], lineno=212, col_offset=12), Assign([Name('s', Store(), lineno=220, col_offset=12)], Call(Attribute(Name('ssl', Load(), lineno=220, col_offset=16), 'wrap_socket', Load(), lineno=220, col_offset=16), [Call(Attribute(Name('socket', Load(), lineno=220, col_offset=32), 'socket', Load(), lineno=220, col_offset=32), [Attribute(Name('socket', Load(), lineno=220, col_offset=46), 'AF_INET', Load(), lineno=220, col_offset=46)], [], None, None, lineno=220, col_offset=32)], [keyword('cert_reqs', Attribute(Name('ssl', Load(), lineno=221, col_offset=42), 'CERT_REQUIRED', Load(), lineno=221, col_offset=42)), keyword('ca_certs', Name('SVN_PYTHON_ORG_ROOT_CERT', Load(), lineno=222, col_offset=41))], None, None, lineno=220, col_offset=16), lineno=220, col_offset=12), TryFinally([Expr(Call(Attribute(Name('s', Load(), lineno=224, col_offset=16), 'connect', Load(), lineno=224, col_offset=16), [Tuple([Str('svn.python.org', lineno=224, col_offset=27), Num(443, lineno=224, col_offset=45)], Load(), lineno=224, col_offset=27)], [], None, None, lineno=224, col_offset=16), lineno=224, col_offset=16)], [Expr(Call(Attribute(Name('s', Load(), lineno=226, col_offset=16), 'close', Load(), lineno=226, col_offset=16), [], [], None, None, lineno=226, col_offset=16), lineno=226, col_offset=16)], lineno=223, col_offset=12)], lineno=200, col_offset=13)], [], lineno=199, col_offset=4), FunctionDef('test_makefile_close', arguments([Name('self', Param(), lineno=229, col_offset=28)], None, None, []), [With(Call(Attribute(Name('test_support', Load(), lineno=233, col_offset=13), 'transient_internet', Load(), lineno=233, col_offset=13), [Str('svn.python.org', lineno=233, col_offset=45)], [], None, None, lineno=233, col_offset=13), None, [Assign([Name('ss', Store(), lineno=234, col_offset=12)], Call(Attribute(Name('ssl', Load(), lineno=234, col_offset=17), 'wrap_socket', Load(), lineno=234, col_offset=17), [Call(Attribute(Name('socket', Load(), lineno=234, col_offset=33), 'socket', Load(), lineno=234, col_offset=33), [Attribute(Name('socket', Load(), lineno=234, col_offset=47), 'AF_INET', Load(), lineno=234, col_offset=47)], [], None, None, lineno=234, col_offset=33)], [], None, None, lineno=234, col_offset=17), lineno=234, col_offset=12), Expr(Call(Attribute(Name('ss', Load(), lineno=235, col_offset=12), 'connect', Load(), lineno=235, col_offset=12), [Tuple([Str('svn.python.org', lineno=235, col_offset=24), Num(443, lineno=235, col_offset=42)], Load(), lineno=235, col_offset=24)], [], None, None, lineno=235, col_offset=12), lineno=235, col_offset=12), Assign([Name('fd', Store(), lineno=236, col_offset=12)], Call(Attribute(Name('ss', Load(), lineno=236, col_offset=17), 'fileno', Load(), lineno=236, col_offset=17), [], [], None, None, lineno=236, col_offset=17), lineno=236, col_offset=12), Assign([Name('f', Store(), lineno=237, col_offset=12)], Call(Attribute(Name('ss', Load(), lineno=237, col_offset=16), 'makefile', Load(), lineno=237, col_offset=16), [], [], None, None, lineno=237, col_offset=16), lineno=237, col_offset=12), Expr(Call(Attribute(Name('f', Load(), lineno=238, col_offset=12), 'close', Load(), lineno=238, col_offset=12), [], [], None, None, lineno=238, col_offset=12), lineno=238, col_offset=12), Expr(Call(Attribute(Name('os', Load(), lineno=240, col_offset=12), 'read', Load(), lineno=240, col_offset=12), [Name('fd', Load(), lineno=240, col_offset=20), Num(0, lineno=240, col_offset=24)], [], None, None, lineno=240, col_offset=12), lineno=240, col_offset=12), Expr(Call(Attribute(Name('ss', Load(), lineno=242, col_offset=12), 'close', Load(), lineno=242, col_offset=12), [], [], None, None, lineno=242, col_offset=12), lineno=242, col_offset=12), Expr(Call(Attribute(Name('gc', Load(), lineno=243, col_offset=12), 'collect', Load(), lineno=243, col_offset=12), [], [], None, None, lineno=243, col_offset=12), lineno=243, col_offset=12), With(Call(Attribute(Name('self', Load(), lineno=244, col_offset=17), 'assertRaises', Load(), lineno=244, col_offset=17), [Name('OSError', Load(), lineno=244, col_offset=35)], [], None, None, lineno=244, col_offset=17), Name('e', Store(), lineno=244, col_offset=47), [Expr(Call(Attribute(Name('os', Load(), lineno=245, col_offset=16), 'read', Load(), lineno=245, col_offset=16), [Name('fd', Load(), lineno=245, col_offset=24), Num(0, lineno=245, col_offset=28)], [], None, None, lineno=245, col_offset=16), lineno=245, col_offset=16)], lineno=244, col_offset=17), Expr(Call(Attribute(Name('self', Load(), lineno=246, col_offset=12), 'assertEqual', Load(), lineno=246, col_offset=12), [Attribute(Attribute(Name('e', Load(), lineno=246, col_offset=29), 'exception', Load(), lineno=246, col_offset=29), 'errno', Load(), lineno=246, col_offset=29), Attribute(Name('errno', Load(), lineno=246, col_offset=48), 'EBADF', Load(), lineno=246, col_offset=48)], [], None, None, lineno=246, col_offset=12), lineno=246, col_offset=12)], lineno=233, col_offset=13)], [Call(Attribute(Name('unittest', Load(), lineno=228, col_offset=5), 'skipIf', Load(), lineno=228, col_offset=5), [Compare(Attribute(Name('os', Load(), lineno=228, col_offset=21), 'name', Load(), lineno=228, col_offset=21), [Eq()], [Str('nt', lineno=228, col_offset=32)], lineno=228, col_offset=21), Str("Can't use a socket as a file under Windows", lineno=228, col_offset=38)], [], None, None, lineno=228, col_offset=5)], lineno=228, col_offset=4), FunctionDef('test_non_blocking_handshake', arguments([Name('self', Param(), lineno=248, col_offset=36)], None, None, []), [With(Call(Attribute(Name('test_support', Load(), lineno=249, col_offset=13), 'transient_internet', Load(), lineno=249, col_offset=13), [Str('svn.python.org', lineno=249, col_offset=45)], [], None, None, lineno=249, col_offset=13), None, [Assign([Name('s', Store(), lineno=250, col_offset=12)], Call(Attribute(Name('socket', Load(), lineno=250, col_offset=16), 'socket', Load(), lineno=250, col_offset=16), [Attribute(Name('socket', Load(), lineno=250, col_offset=30), 'AF_INET', Load(), lineno=250, col_offset=30)], [], None, None, lineno=250, col_offset=16), lineno=250, col_offset=12), Expr(Call(Attribute(Name('s', Load(), lineno=251, col_offset=12), 'connect', Load(), lineno=251, col_offset=12), [Tuple([Str('svn.python.org', lineno=251, col_offset=23), Num(443, lineno=251, col_offset=41)], Load(), lineno=251, col_offset=23)], [], None, None, lineno=251, col_offset=12), lineno=251, col_offset=12), Expr(Call(Attribute(Name('s', Load(), lineno=252, col_offset=12), 'setblocking', Load(), lineno=252, col_offset=12), [Name('False', Load(), lineno=252, col_offset=26)], [], None, None, lineno=252, col_offset=12), lineno=252, col_offset=12), Assign([Name('s', Store(), lineno=253, col_offset=12)], Call(Attribute(Name('ssl', Load(), lineno=253, col_offset=16), 'wrap_socket', Load(), lineno=253, col_offset=16), [Name('s', Load(), lineno=253, col_offset=32)], [keyword('cert_reqs', Attribute(Name('ssl', Load(), lineno=254, col_offset=42), 'CERT_NONE', Load(), lineno=254, col_offset=42)), keyword('do_handshake_on_connect', Name('False', Load(), lineno=255, col_offset=56))], None, None, lineno=253, col_offset=16), lineno=253, col_offset=12), Assign([Name('count', Store(), lineno=256, col_offset=12)], Num(0, lineno=256, col_offset=20), lineno=256, col_offset=12), While(Name('True', Load(), lineno=257, col_offset=18), [TryExcept([AugAssign(Name('count', Store(), lineno=259, col_offset=20), Add(), Num(1, lineno=259, col_offset=29), lineno=259, col_offset=20), Expr(Call(Attribute(Name('s', Load(), lineno=260, col_offset=20), 'do_handshake', Load(), lineno=260, col_offset=20), [], [], None, None, lineno=260, col_offset=20), lineno=260, col_offset=20), Break( lineno=261, col_offset=20)], [ExceptHandler(Attribute(Name('ssl', Load(), lineno=262, col_offset=23), 'SSLError', Load(), lineno=262, col_offset=23), Name('err', Store(), lineno=262, col_offset=37), [If(Compare(Subscript(Attribute(Name('err', Load(), lineno=263, col_offset=23), 'args', Load(), lineno=263, col_offset=23), Index(Num(0, lineno=263, col_offset=32)), Load(), lineno=263, col_offset=23), [Eq()], [Attribute(Name('ssl', Load(), lineno=263, col_offset=38), 'SSL_ERROR_WANT_READ', Load(), lineno=263, col_offset=38)], lineno=263, col_offset=23), [Expr(Call(Attribute(Name('select', Load(), lineno=264, col_offset=24), 'select', Load(), lineno=264, col_offset=24), [List([Name('s', Load(), lineno=264, col_offset=39)], Load(), lineno=264, col_offset=38), List([], Load(), lineno=264, col_offset=43), List([], Load(), lineno=264, col_offset=47)], [], None, None, lineno=264, col_offset=24), lineno=264, col_offset=24)], [If(Compare(Subscript(Attribute(Name('err', Load(), lineno=265, col_offset=25), 'args', Load(), lineno=265, col_offset=25), Index(Num(0, lineno=265, col_offset=34)), Load(), lineno=265, col_offset=25), [Eq()], [Attribute(Name('ssl', Load(), lineno=265, col_offset=40), 'SSL_ERROR_WANT_WRITE', Load(), lineno=265, col_offset=40)], lineno=265, col_offset=25), [Expr(Call(Attribute(Name('select', Load(), lineno=266, col_offset=24), 'select', Load(), lineno=266, col_offset=24), [List([], Load(), lineno=266, col_offset=38), List([Name('s', Load(), lineno=266, col_offset=43)], Load(), lineno=266, col_offset=42), List([], Load(), lineno=266, col_offset=47)], [], None, None, lineno=266, col_offset=24), lineno=266, col_offset=24)], [Raise(None, None, None, lineno=268, col_offset=24)], lineno=265, col_offset=25)], lineno=263, col_offset=20)], lineno=262, col_offset=16)], [], lineno=258, col_offset=16)], [], lineno=257, col_offset=12), Expr(Call(Attribute(Name('s', Load(), lineno=269, col_offset=12), 'close', Load(), lineno=269, col_offset=12), [], [], None, None, lineno=269, col_offset=12), lineno=269, col_offset=12), If(Attribute(Name('test_support', Load(), lineno=270, col_offset=15), 'verbose', Load(), lineno=270, col_offset=15), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=271, col_offset=16), 'stdout', Load(), lineno=271, col_offset=16), 'write', Load(), lineno=271, col_offset=16), [BinOp(Str('\nNeeded %d calls to do_handshake() to establish session.\n', lineno=271, col_offset=33), Mod(), Name('count', Load(), lineno=271, col_offset=97), lineno=271, col_offset=33)], [], None, None, lineno=271, col_offset=16), lineno=271, col_offset=16)], [], lineno=270, col_offset=12)], lineno=249, col_offset=13)], [], lineno=248, col_offset=4), FunctionDef('test_get_server_certificate', arguments([Name('self', Param(), lineno=273, col_offset=36)], None, None, []), [With(Call(Attribute(Name('test_support', Load(), lineno=274, col_offset=13), 'transient_internet', Load(), lineno=274, col_offset=13), [Str('svn.python.org', lineno=274, col_offset=45)], [], None, None, lineno=274, col_offset=13), None, [Assign([Name('pem', Store(), lineno=275, col_offset=12)], Call(Attribute(Name('ssl', Load(), lineno=275, col_offset=18), 'get_server_certificate', Load(), lineno=275, col_offset=18), [Tuple([Str('svn.python.org', lineno=275, col_offset=46), Num(443, lineno=275, col_offset=64)], Load(), lineno=275, col_offset=46)], [], None, None, lineno=275, col_offset=18), lineno=275, col_offset=12), If(UnaryOp(Not(), Name('pem', Load(), lineno=276, col_offset=19), lineno=276, col_offset=15), [Expr(Call(Attribute(Name('self', Load(), lineno=277, col_offset=16), 'fail', Load(), lineno=277, col_offset=16), [Str('No server certificate on svn.python.org:443!', lineno=277, col_offset=26)], [], None, None, lineno=277, col_offset=16), lineno=277, col_offset=16)], [], lineno=276, col_offset=12), TryExcept([Assign([Name('pem', Store(), lineno=280, col_offset=16)], Call(Attribute(Name('ssl', Load(), lineno=280, col_offset=22), 'get_server_certificate', Load(), lineno=280, col_offset=22), [Tuple([Str('svn.python.org', lineno=280, col_offset=50), Num(443, lineno=280, col_offset=68)], Load(), lineno=280, col_offset=50)], [keyword('ca_certs', Name('CERTFILE', Load(), lineno=280, col_offset=83))], None, None, lineno=280, col_offset=22), lineno=280, col_offset=16)], [ExceptHandler(Attribute(Name('ssl', Load(), lineno=281, col_offset=19), 'SSLError', Load(), lineno=281, col_offset=19), None, [Pass( lineno=283, col_offset=16)], lineno=281, col_offset=12)], [Expr(Call(Attribute(Name('self', Load(), lineno=285, col_offset=16), 'fail', Load(), lineno=285, col_offset=16), [BinOp(Str('Got server certificate %s for svn.python.org!', lineno=285, col_offset=26), Mod(), Name('pem', Load(), lineno=285, col_offset=76), lineno=285, col_offset=26)], [], None, None, lineno=285, col_offset=16), lineno=285, col_offset=16)], lineno=279, col_offset=12), Assign([Name('pem', Store(), lineno=287, col_offset=12)], Call(Attribute(Name('ssl', Load(), lineno=287, col_offset=18), 'get_server_certificate', Load(), lineno=287, col_offset=18), [Tuple([Str('svn.python.org', lineno=287, col_offset=46), Num(443, lineno=287, col_offset=64)], Load(), lineno=287, col_offset=46)], [keyword('ca_certs', Name('SVN_PYTHON_ORG_ROOT_CERT', Load(), lineno=287, col_offset=79))], None, None, lineno=287, col_offset=18), lineno=287, col_offset=12), If(UnaryOp(Not(), Name('pem', Load(), lineno=288, col_offset=19), lineno=288, col_offset=15), [Expr(Call(Attribute(Name('self', Load(), lineno=289, col_offset=16), 'fail', Load(), lineno=289, col_offset=16), [Str('No server certificate on svn.python.org:443!', lineno=289, col_offset=26)], [], None, None, lineno=289, col_offset=16), lineno=289, col_offset=16)], [], lineno=288, col_offset=12), If(Attribute(Name('test_support', Load(), lineno=290, col_offset=15), 'verbose', Load(), lineno=290, col_offset=15), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=291, col_offset=16), 'stdout', Load(), lineno=291, col_offset=16), 'write', Load(), lineno=291, col_offset=16), [BinOp(Str('\nVerified certificate for svn.python.org:443 is\n%s\n', lineno=291, col_offset=33), Mod(), Name('pem', Load(), lineno=291, col_offset=92), lineno=291, col_offset=33)], [], None, None, lineno=291, col_offset=16), lineno=291, col_offset=16)], [], lineno=290, col_offset=12)], lineno=274, col_offset=13)], [], lineno=273, col_offset=4), FunctionDef('test_algorithms', arguments([Name('self', Param(), lineno=293, col_offset=24)], None, None, []), [If(Compare(Attribute(Name('ssl', Load(), lineno=297, col_offset=11), 'OPENSSL_VERSION_INFO', Load(), lineno=297, col_offset=11), [Lt()], [Tuple([Num(0, lineno=297, col_offset=39), Num(9, lineno=297, col_offset=42), Num(8, lineno=297, col_offset=45), Num(0, lineno=297, col_offset=48), Num(15, lineno=297, col_offset=51)], Load(), lineno=297, col_offset=39)], lineno=297, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=298, col_offset=12), 'skipTest', Load(), lineno=298, col_offset=12), [BinOp(Str('SHA256 not available on %r', lineno=298, col_offset=26), Mod(), Attribute(Name('ssl', Load(), lineno=298, col_offset=57), 'OPENSSL_VERSION', Load(), lineno=298, col_offset=57), lineno=298, col_offset=26)], [], None, None, lineno=298, col_offset=12), lineno=298, col_offset=12)], [], lineno=297, col_offset=8), Assign([Name('remote', Store(), lineno=300, col_offset=8)], Tuple([Str('sha2.hboeck.de', lineno=300, col_offset=18), Num(443, lineno=300, col_offset=36)], Load(), lineno=300, col_offset=18), lineno=300, col_offset=8), Assign([Name('sha256_cert', Store(), lineno=301, col_offset=8)], Call(Attribute(Attribute(Name('os', Load(), lineno=301, col_offset=22), 'path', Load(), lineno=301, col_offset=22), 'join', Load(), lineno=301, col_offset=22), [Call(Attribute(Attribute(Name('os', Load(), lineno=301, col_offset=35), 'path', Load(), lineno=301, col_offset=35), 'dirname', Load(), lineno=301, col_offset=35), [Name('__file__', Load(), lineno=301, col_offset=51)], [], None, None, lineno=301, col_offset=35), Str('sha256.pem', lineno=301, col_offset=62)], [], None, None, lineno=301, col_offset=22), lineno=301, col_offset=8), With(Call(Attribute(Name('test_support', Load(), lineno=302, col_offset=13), 'transient_internet', Load(), lineno=302, col_offset=13), [Str('sha2.hboeck.de', lineno=302, col_offset=45)], [], None, None, lineno=302, col_offset=13), None, [Assign([Name('s', Store(), lineno=303, col_offset=12)], Call(Attribute(Name('ssl', Load(), lineno=303, col_offset=16), 'wrap_socket', Load(), lineno=303, col_offset=16), [Call(Attribute(Name('socket', Load(), lineno=303, col_offset=32), 'socket', Load(), lineno=303, col_offset=32), [Attribute(Name('socket', Load(), lineno=303, col_offset=46), 'AF_INET', Load(), lineno=303, col_offset=46)], [], None, None, lineno=303, col_offset=32)], [keyword('cert_reqs', Attribute(Name('ssl', Load(), lineno=304, col_offset=42), 'CERT_REQUIRED', Load(), lineno=304, col_offset=42)), keyword('ca_certs', Name('sha256_cert', Load(), lineno=305, col_offset=41))], None, None, lineno=303, col_offset=16), lineno=303, col_offset=12), TryFinally([Expr(Call(Attribute(Name('s', Load(), lineno=307, col_offset=16), 'connect', Load(), lineno=307, col_offset=16), [Name('remote', Load(), lineno=307, col_offset=26)], [], None, None, lineno=307, col_offset=16), lineno=307, col_offset=16), If(Attribute(Name('test_support', Load(), lineno=308, col_offset=19), 'verbose', Load(), lineno=308, col_offset=19), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=309, col_offset=20), 'stdout', Load(), lineno=309, col_offset=20), 'write', Load(), lineno=309, col_offset=20), [BinOp(Str('\nCipher with %r is %r\n', lineno=309, col_offset=37), Mod(), Tuple([Name('remote', Load(), lineno=310, col_offset=38), Call(Attribute(Name('s', Load(), lineno=310, col_offset=46), 'cipher', Load(), lineno=310, col_offset=46), [], [], None, None, lineno=310, col_offset=46)], Load(), lineno=310, col_offset=38), lineno=309, col_offset=37)], [], None, None, lineno=309, col_offset=20), lineno=309, col_offset=20), Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=311, col_offset=20), 'stdout', Load(), lineno=311, col_offset=20), 'write', Load(), lineno=311, col_offset=20), [BinOp(Str('Certificate is:\n%s\n', lineno=311, col_offset=37), Mod(), Call(Attribute(Name('pprint', Load(), lineno=312, col_offset=37), 'pformat', Load(), lineno=312, col_offset=37), [Call(Attribute(Name('s', Load(), lineno=312, col_offset=52), 'getpeercert', Load(), lineno=312, col_offset=52), [], [], None, None, lineno=312, col_offset=52)], [], None, None, lineno=312, col_offset=37), lineno=311, col_offset=37)], [], None, None, lineno=311, col_offset=20), lineno=311, col_offset=20)], [], lineno=308, col_offset=16)], [Expr(Call(Attribute(Name('s', Load(), lineno=314, col_offset=16), 'close', Load(), lineno=314, col_offset=16), [], [], None, None, lineno=314, col_offset=16), lineno=314, col_offset=16)], lineno=306, col_offset=12)], lineno=302, col_offset=13)], [], lineno=293, col_offset=4)], [], lineno=197, col_offset=0), TryExcept([Import([alias('threading', None)], lineno=318, col_offset=4)], [ExceptHandler(Name('ImportError', Load(), lineno=319, col_offset=7), None, [Assign([Name('_have_threads', Store(), lineno=320, col_offset=4)], Name('False', Load(), lineno=320, col_offset=20), lineno=320, col_offset=4)], lineno=319, col_offset=0)], [Assign([Name('_have_threads', Store(), lineno=322, col_offset=4)], Name('True', Load(), lineno=322, col_offset=20), lineno=322, col_offset=4), ClassDef('ThreadedEchoServer', [Attribute(Name('threading', Load(), lineno=324, col_offset=29), 'Thread', Load(), lineno=324, col_offset=29)], [ClassDef('ConnectionHandler', [Attribute(Name('threading', Load(), lineno=326, col_offset=32), 'Thread', Load(), lineno=326, col_offset=32)], [Expr(Str('A mildly complicated class, because we want it to work both\n            with and without the SSL wrapper around the socket connection, so\n            that we can test the STARTTLS functionality.', lineno=330, col_offset=-1), lineno=330, col_offset=-1), FunctionDef('__init__', arguments([Name('self', Param(), lineno=332, col_offset=25), Name('server', Param(), lineno=332, col_offset=31), Name('connsock', Param(), lineno=332, col_offset=39)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=333, col_offset=16), 'server', Store(), lineno=333, col_offset=16)], Name('server', Load(), lineno=333, col_offset=30), lineno=333, col_offset=16), Assign([Attribute(Name('self', Load(), lineno=334, col_offset=16), 'running', Store(), lineno=334, col_offset=16)], Name('False', Load(), lineno=334, col_offset=31), lineno=334, col_offset=16), Assign([Attribute(Name('self', Load(), lineno=335, col_offset=16), 'sock', Store(), lineno=335, col_offset=16)], Name('connsock', Load(), lineno=335, col_offset=28), lineno=335, col_offset=16), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=336, col_offset=16), 'sock', Load(), lineno=336, col_offset=16), 'setblocking', Load(), lineno=336, col_offset=16), [Num(1, lineno=336, col_offset=38)], [], None, None, lineno=336, col_offset=16), lineno=336, col_offset=16), Assign([Attribute(Name('self', Load(), lineno=337, col_offset=16), 'sslconn', Store(), lineno=337, col_offset=16)], Name('None', Load(), lineno=337, col_offset=31), lineno=337, col_offset=16), Expr(Call(Attribute(Attribute(Name('threading', Load(), lineno=338, col_offset=16), 'Thread', Load(), lineno=338, col_offset=16), '__init__', Load(), lineno=338, col_offset=16), [Name('self', Load(), lineno=338, col_offset=42)], [], None, None, lineno=338, col_offset=16), lineno=338, col_offset=16), Assign([Attribute(Name('self', Load(), lineno=339, col_offset=16), 'daemon', Store(), lineno=339, col_offset=16)], Name('True', Load(), lineno=339, col_offset=30), lineno=339, col_offset=16)], [], lineno=332, col_offset=12), FunctionDef('show_conn_details', arguments([Name('self', Param(), lineno=341, col_offset=34)], None, None, []), [If(Compare(Attribute(Attribute(Name('self', Load(), lineno=342, col_offset=19), 'server', Load(), lineno=342, col_offset=19), 'certreqs', Load(), lineno=342, col_offset=19), [Eq()], [Attribute(Name('ssl', Load(), lineno=342, col_offset=43), 'CERT_REQUIRED', Load(), lineno=342, col_offset=43)], lineno=342, col_offset=19), [Assign([Name('cert', Store(), lineno=343, col_offset=20)], Call(Attribute(Attribute(Name('self', Load(), lineno=343, col_offset=27), 'sslconn', Load(), lineno=343, col_offset=27), 'getpeercert', Load(), lineno=343, col_offset=27), [], [], None, None, lineno=343, col_offset=27), lineno=343, col_offset=20), If(BoolOp(And(), [Attribute(Name('test_support', Load(), lineno=344, col_offset=23), 'verbose', Load(), lineno=344, col_offset=23), Attribute(Attribute(Name('self', Load(), lineno=344, col_offset=48), 'server', Load(), lineno=344, col_offset=48), 'chatty', Load(), lineno=344, col_offset=48)], lineno=344, col_offset=23), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=345, col_offset=24), 'stdout', Load(), lineno=345, col_offset=24), 'write', Load(), lineno=345, col_offset=24), [BinOp(BinOp(Str(' client cert is ', lineno=345, col_offset=41), Add(), Call(Attribute(Name('pprint', Load(), lineno=345, col_offset=62), 'pformat', Load(), lineno=345, col_offset=62), [Name('cert', Load(), lineno=345, col_offset=77)], [], None, None, lineno=345, col_offset=62), lineno=345, col_offset=41), Add(), Str('\n', lineno=345, col_offset=85), lineno=345, col_offset=83)], [], None, None, lineno=345, col_offset=24), lineno=345, col_offset=24)], [], lineno=344, col_offset=20), Assign([Name('cert_binary', Store(), lineno=346, col_offset=20)], Call(Attribute(Attribute(Name('self', Load(), lineno=346, col_offset=34), 'sslconn', Load(), lineno=346, col_offset=34), 'getpeercert', Load(), lineno=346, col_offset=34), [Name('True', Load(), lineno=346, col_offset=59)], [], None, None, lineno=346, col_offset=34), lineno=346, col_offset=20), If(BoolOp(And(), [Attribute(Name('test_support', Load(), lineno=347, col_offset=23), 'verbose', Load(), lineno=347, col_offset=23), Attribute(Attribute(Name('self', Load(), lineno=347, col_offset=48), 'server', Load(), lineno=347, col_offset=48), 'chatty', Load(), lineno=347, col_offset=48)], lineno=347, col_offset=23), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=348, col_offset=24), 'stdout', Load(), lineno=348, col_offset=24), 'write', Load(), lineno=348, col_offset=24), [BinOp(BinOp(Str(' cert binary is ', lineno=348, col_offset=41), Add(), Call(Name('str', Load(), lineno=348, col_offset=62), [Call(Name('len', Load(), lineno=348, col_offset=66), [Name('cert_binary', Load(), lineno=348, col_offset=70)], [], None, None, lineno=348, col_offset=66)], [], None, None, lineno=348, col_offset=62), lineno=348, col_offset=41), Add(), Str(' bytes\n', lineno=348, col_offset=86), lineno=348, col_offset=84)], [], None, None, lineno=348, col_offset=24), lineno=348, col_offset=24)], [], lineno=347, col_offset=20)], [], lineno=342, col_offset=16), Assign([Name('cipher', Store(), lineno=349, col_offset=16)], Call(Attribute(Attribute(Name('self', Load(), lineno=349, col_offset=25), 'sslconn', Load(), lineno=349, col_offset=25), 'cipher', Load(), lineno=349, col_offset=25), [], [], None, None, lineno=349, col_offset=25), lineno=349, col_offset=16), If(BoolOp(And(), [Attribute(Name('test_support', Load(), lineno=350, col_offset=19), 'verbose', Load(), lineno=350, col_offset=19), Attribute(Attribute(Name('self', Load(), lineno=350, col_offset=44), 'server', Load(), lineno=350, col_offset=44), 'chatty', Load(), lineno=350, col_offset=44)], lineno=350, col_offset=19), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=351, col_offset=20), 'stdout', Load(), lineno=351, col_offset=20), 'write', Load(), lineno=351, col_offset=20), [BinOp(BinOp(Str(' server: connection cipher is now ', lineno=351, col_offset=37), Add(), Call(Name('str', Load(), lineno=351, col_offset=76), [Name('cipher', Load(), lineno=351, col_offset=80)], [], None, None, lineno=351, col_offset=76), lineno=351, col_offset=37), Add(), Str('\n', lineno=351, col_offset=90), lineno=351, col_offset=88)], [], None, None, lineno=351, col_offset=20), lineno=351, col_offset=20)], [], lineno=350, col_offset=16)], [], lineno=341, col_offset=12), FunctionDef('wrap_conn', arguments([Name('self', Param(), lineno=353, col_offset=26)], None, None, []), [TryExcept([Assign([Attribute(Name('self', Load(), lineno=355, col_offset=20), 'sslconn', Store(), lineno=355, col_offset=20)], Call(Attribute(Name('ssl', Load(), lineno=355, col_offset=35), 'wrap_socket', Load(), lineno=355, col_offset=35), [Attribute(Name('self', Load(), lineno=355, col_offset=51), 'sock', Load(), lineno=355, col_offset=51)], [keyword('server_side', Name('True', Load(), lineno=355, col_offset=74)), keyword('certfile', Attribute(Attribute(Name('self', Load(), lineno=356, col_offset=60), 'server', Load(), lineno=356, col_offset=60), 'certificate', Load(), lineno=356, col_offset=60)), keyword('ssl_version', Attribute(Attribute(Name('self', Load(), lineno=357, col_offset=63), 'server', Load(), lineno=357, col_offset=63), 'protocol', Load(), lineno=357, col_offset=63)), keyword('ca_certs', Attribute(Attribute(Name('self', Load(), lineno=358, col_offset=60), 'server', Load(), lineno=358, col_offset=60), 'cacerts', Load(), lineno=358, col_offset=60)), keyword('cert_reqs', Attribute(Attribute(Name('self', Load(), lineno=359, col_offset=61), 'server', Load(), lineno=359, col_offset=61), 'certreqs', Load(), lineno=359, col_offset=61)), keyword('ciphers', Attribute(Attribute(Name('self', Load(), lineno=360, col_offset=59), 'server', Load(), lineno=360, col_offset=59), 'ciphers', Load(), lineno=360, col_offset=59))], None, None, lineno=355, col_offset=35), lineno=355, col_offset=20)], [ExceptHandler(Attribute(Name('ssl', Load(), lineno=361, col_offset=23), 'SSLError', Load(), lineno=361, col_offset=23), None, [If(Attribute(Attribute(Name('self', Load(), lineno=365, col_offset=23), 'server', Load(), lineno=365, col_offset=23), 'chatty', Load(), lineno=365, col_offset=23), [Expr(Call(Name('handle_error', Load(), lineno=366, col_offset=24), [BinOp(BinOp(Str('\n server:  bad connection attempt from ', lineno=366, col_offset=37), Add(), Call(Name('str', Load(), lineno=367, col_offset=37), [Call(Attribute(Attribute(Name('self', Load(), lineno=367, col_offset=41), 'sock', Load(), lineno=367, col_offset=41), 'getpeername', Load(), lineno=367, col_offset=41), [], [], None, None, lineno=367, col_offset=41)], [], None, None, lineno=367, col_offset=37), lineno=366, col_offset=37), Add(), Str(':\n', lineno=367, col_offset=68), lineno=367, col_offset=66)], [], None, None, lineno=366, col_offset=24), lineno=366, col_offset=24)], [], lineno=365, col_offset=20), Expr(Call(Attribute(Name('self', Load(), lineno=368, col_offset=20), 'close', Load(), lineno=368, col_offset=20), [], [], None, None, lineno=368, col_offset=20), lineno=368, col_offset=20), Assign([Attribute(Name('self', Load(), lineno=369, col_offset=20), 'running', Store(), lineno=369, col_offset=20)], Name('False', Load(), lineno=369, col_offset=35), lineno=369, col_offset=20), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=370, col_offset=20), 'server', Load(), lineno=370, col_offset=20), 'stop', Load(), lineno=370, col_offset=20), [], [], None, None, lineno=370, col_offset=20), lineno=370, col_offset=20), Return(Name('False', Load(), lineno=371, col_offset=27), lineno=371, col_offset=20)], lineno=361, col_offset=16)], [Return(Name('True', Load(), lineno=373, col_offset=27), lineno=373, col_offset=20)], lineno=354, col_offset=16)], [], lineno=353, col_offset=12), FunctionDef('read', arguments([Name('self', Param(), lineno=375, col_offset=21)], None, None, []), [If(Attribute(Name('self', Load(), lineno=376, col_offset=19), 'sslconn', Load(), lineno=376, col_offset=19), [Return(Call(Attribute(Attribute(Name('self', Load(), lineno=377, col_offset=27), 'sslconn', Load(), lineno=377, col_offset=27), 'read', Load(), lineno=377, col_offset=27), [], [], None, None, lineno=377, col_offset=27), lineno=377, col_offset=20)], [Return(Call(Attribute(Attribute(Name('self', Load(), lineno=379, col_offset=27), 'sock', Load(), lineno=379, col_offset=27), 'recv', Load(), lineno=379, col_offset=27), [Num(1024, lineno=379, col_offset=42)], [], None, None, lineno=379, col_offset=27), lineno=379, col_offset=20)], lineno=376, col_offset=16)], [], lineno=375, col_offset=12), FunctionDef('write', arguments([Name('self', Param(), lineno=381, col_offset=22), Name('bytes', Param(), lineno=381, col_offset=28)], None, None, []), [If(Attribute(Name('self', Load(), lineno=382, col_offset=19), 'sslconn', Load(), lineno=382, col_offset=19), [Return(Call(Attribute(Attribute(Name('self', Load(), lineno=383, col_offset=27), 'sslconn', Load(), lineno=383, col_offset=27), 'write', Load(), lineno=383, col_offset=27), [Name('bytes', Load(), lineno=383, col_offset=46)], [], None, None, lineno=383, col_offset=27), lineno=383, col_offset=20)], [Return(Call(Attribute(Attribute(Name('self', Load(), lineno=385, col_offset=27), 'sock', Load(), lineno=385, col_offset=27), 'send', Load(), lineno=385, col_offset=27), [Name('bytes', Load(), lineno=385, col_offset=42)], [], None, None, lineno=385, col_offset=27), lineno=385, col_offset=20)], lineno=382, col_offset=16)], [], lineno=381, col_offset=12), FunctionDef('close', arguments([Name('self', Param(), lineno=387, col_offset=22)], None, None, []), [If(Attribute(Name('self', Load(), lineno=388, col_offset=19), 'sslconn', Load(), lineno=388, col_offset=19), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=389, col_offset=20), 'sslconn', Load(), lineno=389, col_offset=20), 'close', Load(), lineno=389, col_offset=20), [], [], None, None, lineno=389, col_offset=20), lineno=389, col_offset=20)], [Expr(Call(Attribute(Attribute(Attribute(Name('self', Load(), lineno=391, col_offset=20), 'sock', Load(), lineno=391, col_offset=20), '_sock', Load(), lineno=391, col_offset=20), 'close', Load(), lineno=391, col_offset=20), [], [], None, None, lineno=391, col_offset=20), lineno=391, col_offset=20)], lineno=388, col_offset=16)], [], lineno=387, col_offset=12), FunctionDef('run', arguments([Name('self', Param(), lineno=393, col_offset=20)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=394, col_offset=16), 'running', Store(), lineno=394, col_offset=16)], Name('True', Load(), lineno=394, col_offset=31), lineno=394, col_offset=16), If(UnaryOp(Not(), Attribute(Attribute(Name('self', Load(), lineno=395, col_offset=23), 'server', Load(), lineno=395, col_offset=23), 'starttls_server', Load(), lineno=395, col_offset=23), lineno=395, col_offset=19), [If(Call(Name('isinstance', Load(), lineno=396, col_offset=23), [Attribute(Name('self', Load(), lineno=396, col_offset=34), 'sock', Load(), lineno=396, col_offset=34), Attribute(Name('ssl', Load(), lineno=396, col_offset=45), 'SSLSocket', Load(), lineno=396, col_offset=45)], [], None, None, lineno=396, col_offset=23), [Assign([Attribute(Name('self', Load(), lineno=397, col_offset=24), 'sslconn', Store(), lineno=397, col_offset=24)], Attribute(Name('self', Load(), lineno=397, col_offset=39), 'sock', Load(), lineno=397, col_offset=39), lineno=397, col_offset=24)], [If(UnaryOp(Not(), Call(Attribute(Name('self', Load(), lineno=398, col_offset=29), 'wrap_conn', Load(), lineno=398, col_offset=29), [], [], None, None, lineno=398, col_offset=29), lineno=398, col_offset=25), [Return(None, lineno=399, col_offset=24)], [], lineno=398, col_offset=25)], lineno=396, col_offset=20), Expr(Call(Attribute(Name('self', Load(), lineno=400, col_offset=20), 'show_conn_details', Load(), lineno=400, col_offset=20), [], [], None, None, lineno=400, col_offset=20), lineno=400, col_offset=20)], [], lineno=395, col_offset=16), While(Attribute(Name('self', Load(), lineno=401, col_offset=22), 'running', Load(), lineno=401, col_offset=22), [TryExcept([Assign([Name('msg', Store(), lineno=403, col_offset=24)], Call(Attribute(Name('self', Load(), lineno=403, col_offset=30), 'read', Load(), lineno=403, col_offset=30), [], [], None, None, lineno=403, col_offset=30), lineno=403, col_offset=24), If(UnaryOp(Not(), Name('msg', Load(), lineno=404, col_offset=31), lineno=404, col_offset=27), [Assign([Attribute(Name('self', Load(), lineno=406, col_offset=28), 'running', Store(), lineno=406, col_offset=28)], Name('False', Load(), lineno=406, col_offset=43), lineno=406, col_offset=28), Expr(Call(Attribute(Name('self', Load(), lineno=407, col_offset=28), 'close', Load(), lineno=407, col_offset=28), [], [], None, None, lineno=407, col_offset=28), lineno=407, col_offset=28)], [If(Compare(Call(Attribute(Name('msg', Load(), lineno=408, col_offset=29), 'strip', Load(), lineno=408, col_offset=29), [], [], None, None, lineno=408, col_offset=29), [Eq()], [Str('over', lineno=408, col_offset=44)], lineno=408, col_offset=29), [If(BoolOp(And(), [Attribute(Name('test_support', Load(), lineno=409, col_offset=31), 'verbose', Load(), lineno=409, col_offset=31), Attribute(Attribute(Name('self', Load(), lineno=409, col_offset=56), 'server', Load(), lineno=409, col_offset=56), 'connectionchatty', Load(), lineno=409, col_offset=56)], lineno=409, col_offset=31), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=410, col_offset=32), 'stdout', Load(), lineno=410, col_offset=32), 'write', Load(), lineno=410, col_offset=32), [Str(' server: client closed connection\n', lineno=410, col_offset=49)], [], None, None, lineno=410, col_offset=32), lineno=410, col_offset=32)], [], lineno=409, col_offset=28), Expr(Call(Attribute(Name('self', Load(), lineno=411, col_offset=28), 'close', Load(), lineno=411, col_offset=28), [], [], None, None, lineno=411, col_offset=28), lineno=411, col_offset=28), Return(None, lineno=412, col_offset=28)], [If(BoolOp(And(), [Attribute(Attribute(Name('self', Load(), lineno=413, col_offset=29), 'server', Load(), lineno=413, col_offset=29), 'starttls_server', Load(), lineno=413, col_offset=29), Compare(Call(Attribute(Name('msg', Load(), lineno=413, col_offset=61), 'strip', Load(), lineno=413, col_offset=61), [], [], None, None, lineno=413, col_offset=61), [Eq()], [Str('STARTTLS', lineno=413, col_offset=76)], lineno=413, col_offset=61)], lineno=413, col_offset=29), [If(BoolOp(And(), [Attribute(Name('test_support', Load(), lineno=414, col_offset=31), 'verbose', Load(), lineno=414, col_offset=31), Attribute(Attribute(Name('self', Load(), lineno=414, col_offset=56), 'server', Load(), lineno=414, col_offset=56), 'connectionchatty', Load(), lineno=414, col_offset=56)], lineno=414, col_offset=31), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=415, col_offset=32), 'stdout', Load(), lineno=415, col_offset=32), 'write', Load(), lineno=415, col_offset=32), [Str(' server: read STARTTLS from client, sending OK...\n', lineno=415, col_offset=49)], [], None, None, lineno=415, col_offset=32), lineno=415, col_offset=32)], [], lineno=414, col_offset=28), Expr(Call(Attribute(Name('self', Load(), lineno=416, col_offset=28), 'write', Load(), lineno=416, col_offset=28), [Str('OK\n', lineno=416, col_offset=39)], [], None, None, lineno=416, col_offset=28), lineno=416, col_offset=28), If(UnaryOp(Not(), Call(Attribute(Name('self', Load(), lineno=417, col_offset=35), 'wrap_conn', Load(), lineno=417, col_offset=35), [], [], None, None, lineno=417, col_offset=35), lineno=417, col_offset=31), [Return(None, lineno=418, col_offset=32)], [], lineno=417, col_offset=28)], [If(BoolOp(And(), [Attribute(Attribute(Name('self', Load(), lineno=419, col_offset=29), 'server', Load(), lineno=419, col_offset=29), 'starttls_server', Load(), lineno=419, col_offset=29), Attribute(Name('self', Load(), lineno=419, col_offset=61), 'sslconn', Load(), lineno=419, col_offset=61), Compare(Call(Attribute(Name('msg', Load(), lineno=419, col_offset=78), 'strip', Load(), lineno=419, col_offset=78), [], [], None, None, lineno=419, col_offset=78), [Eq()], [Str('ENDTLS', lineno=419, col_offset=93)], lineno=419, col_offset=78)], lineno=419, col_offset=29), [If(BoolOp(And(), [Attribute(Name('test_support', Load(), lineno=420, col_offset=31), 'verbose', Load(), lineno=420, col_offset=31), Attribute(Attribute(Name('self', Load(), lineno=420, col_offset=56), 'server', Load(), lineno=420, col_offset=56), 'connectionchatty', Load(), lineno=420, col_offset=56)], lineno=420, col_offset=31), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=421, col_offset=32), 'stdout', Load(), lineno=421, col_offset=32), 'write', Load(), lineno=421, col_offset=32), [Str(' server: read ENDTLS from client, sending OK...\n', lineno=421, col_offset=49)], [], None, None, lineno=421, col_offset=32), lineno=421, col_offset=32)], [], lineno=420, col_offset=28), Expr(Call(Attribute(Name('self', Load(), lineno=422, col_offset=28), 'write', Load(), lineno=422, col_offset=28), [Str('OK\n', lineno=422, col_offset=39)], [], None, None, lineno=422, col_offset=28), lineno=422, col_offset=28), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=423, col_offset=28), 'sslconn', Load(), lineno=423, col_offset=28), 'unwrap', Load(), lineno=423, col_offset=28), [], [], None, None, lineno=423, col_offset=28), lineno=423, col_offset=28), Assign([Attribute(Name('self', Load(), lineno=424, col_offset=28), 'sslconn', Store(), lineno=424, col_offset=28)], Name('None', Load(), lineno=424, col_offset=43), lineno=424, col_offset=28), If(BoolOp(And(), [Attribute(Name('test_support', Load(), lineno=425, col_offset=31), 'verbose', Load(), lineno=425, col_offset=31), Attribute(Attribute(Name('self', Load(), lineno=425, col_offset=56), 'server', Load(), lineno=425, col_offset=56), 'connectionchatty', Load(), lineno=425, col_offset=56)], lineno=425, col_offset=31), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=426, col_offset=32), 'stdout', Load(), lineno=426, col_offset=32), 'write', Load(), lineno=426, col_offset=32), [Str(' server: connection is now unencrypted...\n', lineno=426, col_offset=49)], [], None, None, lineno=426, col_offset=32), lineno=426, col_offset=32)], [], lineno=425, col_offset=28)], [If(BoolOp(And(), [Attribute(Name('test_support', Load(), lineno=428, col_offset=32), 'verbose', Load(), lineno=428, col_offset=32), Attribute(Attribute(Name('self', Load(), lineno=429, col_offset=32), 'server', Load(), lineno=429, col_offset=32), 'connectionchatty', Load(), lineno=429, col_offset=32)], lineno=428, col_offset=32), [Assign([Name('ctype', Store(), lineno=430, col_offset=32)], BoolOp(Or(), [BoolOp(And(), [Attribute(Name('self', Load(), lineno=430, col_offset=41), 'sslconn', Load(), lineno=430, col_offset=41), Str('encrypted', lineno=430, col_offset=58)], lineno=430, col_offset=41), Str('unencrypted', lineno=430, col_offset=74)], lineno=430, col_offset=40), lineno=430, col_offset=32), Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=431, col_offset=32), 'stdout', Load(), lineno=431, col_offset=32), 'write', Load(), lineno=431, col_offset=32), [BinOp(Str(' server: read %s (%s), sending back %s (%s)...\n', lineno=431, col_offset=49), Mod(), Tuple([Call(Name('repr', Load(), lineno=432, col_offset=52), [Name('msg', Load(), lineno=432, col_offset=57)], [], None, None, lineno=432, col_offset=52), Name('ctype', Load(), lineno=432, col_offset=63), Call(Name('repr', Load(), lineno=432, col_offset=70), [Call(Attribute(Name('msg', Load(), lineno=432, col_offset=75), 'lower', Load(), lineno=432, col_offset=75), [], [], None, None, lineno=432, col_offset=75)], [], None, None, lineno=432, col_offset=70), Name('ctype', Load(), lineno=432, col_offset=89)], Load(), lineno=432, col_offset=52), lineno=431, col_offset=49)], [], None, None, lineno=431, col_offset=32), lineno=431, col_offset=32)], [], lineno=428, col_offset=28), Expr(Call(Attribute(Name('self', Load(), lineno=433, col_offset=28), 'write', Load(), lineno=433, col_offset=28), [Call(Attribute(Name('msg', Load(), lineno=433, col_offset=39), 'lower', Load(), lineno=433, col_offset=39), [], [], None, None, lineno=433, col_offset=39)], [], None, None, lineno=433, col_offset=28), lineno=433, col_offset=28)], lineno=419, col_offset=29)], lineno=413, col_offset=29)], lineno=408, col_offset=29)], lineno=404, col_offset=24)], [ExceptHandler(Attribute(Name('ssl', Load(), lineno=434, col_offset=27), 'SSLError', Load(), lineno=434, col_offset=27), None, [If(Attribute(Attribute(Name('self', Load(), lineno=435, col_offset=27), 'server', Load(), lineno=435, col_offset=27), 'chatty', Load(), lineno=435, col_offset=27), [Expr(Call(Name('handle_error', Load(), lineno=436, col_offset=28), [Str('Test server failure:\n', lineno=436, col_offset=41)], [], None, None, lineno=436, col_offset=28), lineno=436, col_offset=28)], [], lineno=435, col_offset=24), Expr(Call(Attribute(Name('self', Load(), lineno=437, col_offset=24), 'close', Load(), lineno=437, col_offset=24), [], [], None, None, lineno=437, col_offset=24), lineno=437, col_offset=24), Assign([Attribute(Name('self', Load(), lineno=438, col_offset=24), 'running', Store(), lineno=438, col_offset=24)], Name('False', Load(), lineno=438, col_offset=39), lineno=438, col_offset=24), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=441, col_offset=24), 'server', Load(), lineno=441, col_offset=24), 'stop', Load(), lineno=441, col_offset=24), [], [], None, None, lineno=441, col_offset=24), lineno=441, col_offset=24)], lineno=434, col_offset=20)], [], lineno=402, col_offset=20)], [], lineno=401, col_offset=16)], [], lineno=393, col_offset=12)], [], lineno=326, col_offset=8), FunctionDef('__init__', arguments([Name('self', Param(), lineno=443, col_offset=21), Name('certificate', Param(), lineno=443, col_offset=27), Name('ssl_version', Param(), lineno=443, col_offset=40), Name('certreqs', Param(), lineno=444, col_offset=21), Name('cacerts', Param(), lineno=444, col_offset=36), Name('chatty', Param(), lineno=445, col_offset=21), Name('connectionchatty', Param(), lineno=445, col_offset=34), Name('starttls_server', Param(), lineno=445, col_offset=58), Name('wrap_accepting_socket', Param(), lineno=446, col_offset=21), Name('ciphers', Param(), lineno=446, col_offset=50)], None, None, [Name('None', Load(), lineno=443, col_offset=52), Name('None', Load(), lineno=444, col_offset=30), Name('None', Load(), lineno=444, col_offset=44), Name('True', Load(), lineno=445, col_offset=28), Name('False', Load(), lineno=445, col_offset=51), Name('False', Load(), lineno=445, col_offset=74), Name('False', Load(), lineno=446, col_offset=43), Name('None', Load(), lineno=446, col_offset=58)]), [If(Compare(Name('ssl_version', Load(), lineno=448, col_offset=15), [Is()], [Name('None', Load(), lineno=448, col_offset=30)], lineno=448, col_offset=15), [Assign([Name('ssl_version', Store(), lineno=449, col_offset=16)], Attribute(Name('ssl', Load(), lineno=449, col_offset=30), 'PROTOCOL_TLSv1', Load(), lineno=449, col_offset=30), lineno=449, col_offset=16)], [], lineno=448, col_offset=12), If(Compare(Name('certreqs', Load(), lineno=450, col_offset=15), [Is()], [Name('None', Load(), lineno=450, col_offset=27)], lineno=450, col_offset=15), [Assign([Name('certreqs', Store(), lineno=451, col_offset=16)], Attribute(Name('ssl', Load(), lineno=451, col_offset=27), 'CERT_NONE', Load(), lineno=451, col_offset=27), lineno=451, col_offset=16)], [], lineno=450, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=452, col_offset=12), 'certificate', Store(), lineno=452, col_offset=12)], Name('certificate', Load(), lineno=452, col_offset=31), lineno=452, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=453, col_offset=12), 'protocol', Store(), lineno=453, col_offset=12)], Name('ssl_version', Load(), lineno=453, col_offset=28), lineno=453, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=454, col_offset=12), 'certreqs', Store(), lineno=454, col_offset=12)], Name('certreqs', Load(), lineno=454, col_offset=28), lineno=454, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=455, col_offset=12), 'cacerts', Store(), lineno=455, col_offset=12)], Name('cacerts', Load(), lineno=455, col_offset=27), lineno=455, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=456, col_offset=12), 'ciphers', Store(), lineno=456, col_offset=12)], Name('ciphers', Load(), lineno=456, col_offset=27), lineno=456, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=457, col_offset=12), 'chatty', Store(), lineno=457, col_offset=12)], Name('chatty', Load(), lineno=457, col_offset=26), lineno=457, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=458, col_offset=12), 'connectionchatty', Store(), lineno=458, col_offset=12)], Name('connectionchatty', Load(), lineno=458, col_offset=36), lineno=458, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=459, col_offset=12), 'starttls_server', Store(), lineno=459, col_offset=12)], Name('starttls_server', Load(), lineno=459, col_offset=35), lineno=459, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=460, col_offset=12), 'sock', Store(), lineno=460, col_offset=12)], Call(Attribute(Name('socket', Load(), lineno=460, col_offset=24), 'socket', Load(), lineno=460, col_offset=24), [], [], None, None, lineno=460, col_offset=24), lineno=460, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=461, col_offset=12), 'flag', Store(), lineno=461, col_offset=12)], Name('None', Load(), lineno=461, col_offset=24), lineno=461, col_offset=12), If(Name('wrap_accepting_socket', Load(), lineno=462, col_offset=15), [Assign([Attribute(Name('self', Load(), lineno=463, col_offset=16), 'sock', Store(), lineno=463, col_offset=16)], Call(Attribute(Name('ssl', Load(), lineno=463, col_offset=28), 'wrap_socket', Load(), lineno=463, col_offset=28), [Attribute(Name('self', Load(), lineno=463, col_offset=44), 'sock', Load(), lineno=463, col_offset=44)], [keyword('server_side', Name('True', Load(), lineno=463, col_offset=67)), keyword('certfile', Attribute(Name('self', Load(), lineno=464, col_offset=53), 'certificate', Load(), lineno=464, col_offset=53)), keyword('cert_reqs', Attribute(Name('self', Load(), lineno=465, col_offset=56), 'certreqs', Load(), lineno=465, col_offset=56)), keyword('ca_certs', Attribute(Name('self', Load(), lineno=466, col_offset=55), 'cacerts', Load(), lineno=466, col_offset=55)), keyword('ssl_version', Attribute(Name('self', Load(), lineno=467, col_offset=58), 'protocol', Load(), lineno=467, col_offset=58)), keyword('ciphers', Attribute(Name('self', Load(), lineno=468, col_offset=54), 'ciphers', Load(), lineno=468, col_offset=54))], None, None, lineno=463, col_offset=28), lineno=463, col_offset=16), If(BoolOp(And(), [Attribute(Name('test_support', Load(), lineno=469, col_offset=19), 'verbose', Load(), lineno=469, col_offset=19), Attribute(Name('self', Load(), lineno=469, col_offset=44), 'chatty', Load(), lineno=469, col_offset=44)], lineno=469, col_offset=19), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=470, col_offset=20), 'stdout', Load(), lineno=470, col_offset=20), 'write', Load(), lineno=470, col_offset=20), [BinOp(Str(' server:  wrapped server socket as %s\n', lineno=470, col_offset=37), Mod(), Call(Name('str', Load(), lineno=470, col_offset=81), [Attribute(Name('self', Load(), lineno=470, col_offset=85), 'sock', Load(), lineno=470, col_offset=85)], [], None, None, lineno=470, col_offset=81), lineno=470, col_offset=37)], [], None, None, lineno=470, col_offset=20), lineno=470, col_offset=20)], [], lineno=469, col_offset=16)], [], lineno=462, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=471, col_offset=12), 'port', Store(), lineno=471, col_offset=12)], Call(Attribute(Name('test_support', Load(), lineno=471, col_offset=24), 'bind_port', Load(), lineno=471, col_offset=24), [Attribute(Name('self', Load(), lineno=471, col_offset=47), 'sock', Load(), lineno=471, col_offset=47)], [], None, None, lineno=471, col_offset=24), lineno=471, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=472, col_offset=12), 'active', Store(), lineno=472, col_offset=12)], Name('False', Load(), lineno=472, col_offset=26), lineno=472, col_offset=12), Expr(Call(Attribute(Attribute(Name('threading', Load(), lineno=473, col_offset=12), 'Thread', Load(), lineno=473, col_offset=12), '__init__', Load(), lineno=473, col_offset=12), [Name('self', Load(), lineno=473, col_offset=38)], [], None, None, lineno=473, col_offset=12), lineno=473, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=474, col_offset=12), 'daemon', Store(), lineno=474, col_offset=12)], Name('True', Load(), lineno=474, col_offset=26), lineno=474, col_offset=12)], [], lineno=443, col_offset=8), FunctionDef('start', arguments([Name('self', Param(), lineno=476, col_offset=18), Name('flag', Param(), lineno=476, col_offset=24)], None, None, [Name('None', Load(), lineno=476, col_offset=29)]), [Assign([Attribute(Name('self', Load(), lineno=477, col_offset=12), 'flag', Store(), lineno=477, col_offset=12)], Name('flag', Load(), lineno=477, col_offset=24), lineno=477, col_offset=12), Expr(Call(Attribute(Attribute(Name('threading', Load(), lineno=478, col_offset=12), 'Thread', Load(), lineno=478, col_offset=12), 'start', Load(), lineno=478, col_offset=12), [Name('self', Load(), lineno=478, col_offset=35)], [], None, None, lineno=478, col_offset=12), lineno=478, col_offset=12)], [], lineno=476, col_offset=8), FunctionDef('run', arguments([Name('self', Param(), lineno=480, col_offset=16)], None, None, []), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=481, col_offset=12), 'sock', Load(), lineno=481, col_offset=12), 'settimeout', Load(), lineno=481, col_offset=12), [Num(0.05, lineno=481, col_offset=33)], [], None, None, lineno=481, col_offset=12), lineno=481, col_offset=12), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=482, col_offset=12), 'sock', Load(), lineno=482, col_offset=12), 'listen', Load(), lineno=482, col_offset=12), [Num(5, lineno=482, col_offset=29)], [], None, None, lineno=482, col_offset=12), lineno=482, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=483, col_offset=12), 'active', Store(), lineno=483, col_offset=12)], Name('True', Load(), lineno=483, col_offset=26), lineno=483, col_offset=12), If(Attribute(Name('self', Load(), lineno=484, col_offset=15), 'flag', Load(), lineno=484, col_offset=15), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=486, col_offset=16), 'flag', Load(), lineno=486, col_offset=16), 'set', Load(), lineno=486, col_offset=16), [], [], None, None, lineno=486, col_offset=16), lineno=486, col_offset=16)], [], lineno=484, col_offset=12), While(Attribute(Name('self', Load(), lineno=487, col_offset=18), 'active', Load(), lineno=487, col_offset=18), [TryExcept([Assign([Tuple([Name('newconn', Store(), lineno=489, col_offset=20), Name('connaddr', Store(), lineno=489, col_offset=29)], Store(), lineno=489, col_offset=20)], Call(Attribute(Attribute(Name('self', Load(), lineno=489, col_offset=40), 'sock', Load(), lineno=489, col_offset=40), 'accept', Load(), lineno=489, col_offset=40), [], [], None, None, lineno=489, col_offset=40), lineno=489, col_offset=20), If(BoolOp(And(), [Attribute(Name('test_support', Load(), lineno=490, col_offset=23), 'verbose', Load(), lineno=490, col_offset=23), Attribute(Name('self', Load(), lineno=490, col_offset=48), 'chatty', Load(), lineno=490, col_offset=48)], lineno=490, col_offset=23), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=491, col_offset=24), 'stdout', Load(), lineno=491, col_offset=24), 'write', Load(), lineno=491, col_offset=24), [BinOp(BinOp(Str(' server:  new connection from ', lineno=491, col_offset=41), Add(), Call(Name('str', Load(), lineno=492, col_offset=43), [Name('connaddr', Load(), lineno=492, col_offset=47)], [], None, None, lineno=492, col_offset=43), lineno=491, col_offset=41), Add(), Str('\n', lineno=492, col_offset=59), lineno=492, col_offset=57)], [], None, None, lineno=491, col_offset=24), lineno=491, col_offset=24)], [], lineno=490, col_offset=20), Assign([Name('handler', Store(), lineno=493, col_offset=20)], Call(Attribute(Name('self', Load(), lineno=493, col_offset=30), 'ConnectionHandler', Load(), lineno=493, col_offset=30), [Name('self', Load(), lineno=493, col_offset=53), Name('newconn', Load(), lineno=493, col_offset=59)], [], None, None, lineno=493, col_offset=30), lineno=493, col_offset=20), Expr(Call(Attribute(Name('handler', Load(), lineno=494, col_offset=20), 'start', Load(), lineno=494, col_offset=20), [], [], None, None, lineno=494, col_offset=20), lineno=494, col_offset=20)], [ExceptHandler(Attribute(Name('socket', Load(), lineno=495, col_offset=23), 'timeout', Load(), lineno=495, col_offset=23), None, [Pass( lineno=496, col_offset=20)], lineno=495, col_offset=16), ExceptHandler(Name('KeyboardInterrupt', Load(), lineno=497, col_offset=23), None, [Expr(Call(Attribute(Name('self', Load(), lineno=498, col_offset=20), 'stop', Load(), lineno=498, col_offset=20), [], [], None, None, lineno=498, col_offset=20), lineno=498, col_offset=20)], lineno=497, col_offset=16)], [], lineno=488, col_offset=16)], [], lineno=487, col_offset=12), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=499, col_offset=12), 'sock', Load(), lineno=499, col_offset=12), 'close', Load(), lineno=499, col_offset=12), [], [], None, None, lineno=499, col_offset=12), lineno=499, col_offset=12)], [], lineno=480, col_offset=8), FunctionDef('stop', arguments([Name('self', Param(), lineno=501, col_offset=17)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=502, col_offset=12), 'active', Store(), lineno=502, col_offset=12)], Name('False', Load(), lineno=502, col_offset=26), lineno=502, col_offset=12)], [], lineno=501, col_offset=8)], [], lineno=324, col_offset=4), ClassDef('AsyncoreEchoServer', [Attribute(Name('threading', Load(), lineno=504, col_offset=29), 'Thread', Load(), lineno=504, col_offset=29)], [ClassDef('EchoServer', [Attribute(Name('asyncore', Load(), lineno=506, col_offset=25), 'dispatcher', Load(), lineno=506, col_offset=25)], [ClassDef('ConnectionHandler', [Attribute(Name('asyncore', Load(), lineno=508, col_offset=36), 'dispatcher_with_send', Load(), lineno=508, col_offset=36)], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=510, col_offset=29), Name('conn', Param(), lineno=510, col_offset=35), Name('certfile', Param(), lineno=510, col_offset=41)], None, None, []), [Expr(Call(Attribute(Attribute(Name('asyncore', Load(), lineno=511, col_offset=20), 'dispatcher_with_send', Load(), lineno=511, col_offset=20), '__init__', Load(), lineno=511, col_offset=20), [Name('self', Load(), lineno=511, col_offset=59), Name('conn', Load(), lineno=511, col_offset=65)], [], None, None, lineno=511, col_offset=20), lineno=511, col_offset=20), Assign([Attribute(Name('self', Load(), lineno=512, col_offset=20), 'socket', Store(), lineno=512, col_offset=20)], Call(Attribute(Name('ssl', Load(), lineno=512, col_offset=34), 'wrap_socket', Load(), lineno=512, col_offset=34), [Name('conn', Load(), lineno=512, col_offset=50)], [keyword('server_side', Name('True', Load(), lineno=512, col_offset=68)), keyword('certfile', Name('certfile', Load(), lineno=513, col_offset=59)), keyword('do_handshake_on_connect', Name('False', Load(), lineno=514, col_offset=74))], None, None, lineno=512, col_offset=34), lineno=512, col_offset=20), Assign([Attribute(Name('self', Load(), lineno=515, col_offset=20), '_ssl_accepting', Store(), lineno=515, col_offset=20)], Name('True', Load(), lineno=515, col_offset=42), lineno=515, col_offset=20)], [], lineno=510, col_offset=16), FunctionDef('readable', arguments([Name('self', Param(), lineno=517, col_offset=29)], None, None, []), [If(Call(Name('isinstance', Load(), lineno=518, col_offset=23), [Attribute(Name('self', Load(), lineno=518, col_offset=34), 'socket', Load(), lineno=518, col_offset=34), Attribute(Name('ssl', Load(), lineno=518, col_offset=47), 'SSLSocket', Load(), lineno=518, col_offset=47)], [], None, None, lineno=518, col_offset=23), [While(Compare(Call(Attribute(Attribute(Name('self', Load(), lineno=519, col_offset=30), 'socket', Load(), lineno=519, col_offset=30), 'pending', Load(), lineno=519, col_offset=30), [], [], None, None, lineno=519, col_offset=30), [Gt()], [Num(0, lineno=519, col_offset=54)], lineno=519, col_offset=30), [Expr(Call(Attribute(Name('self', Load(), lineno=520, col_offset=28), 'handle_read_event', Load(), lineno=520, col_offset=28), [], [], None, None, lineno=520, col_offset=28), lineno=520, col_offset=28)], [], lineno=519, col_offset=24)], [], lineno=518, col_offset=20), Return(Name('True', Load(), lineno=521, col_offset=27), lineno=521, col_offset=20)], [], lineno=517, col_offset=16), FunctionDef('_do_ssl_handshake', arguments([Name('self', Param(), lineno=523, col_offset=38)], None, None, []), [TryExcept([Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=525, col_offset=24), 'socket', Load(), lineno=525, col_offset=24), 'do_handshake', Load(), lineno=525, col_offset=24), [], [], None, None, lineno=525, col_offset=24), lineno=525, col_offset=24)], [ExceptHandler(Attribute(Name('ssl', Load(), lineno=526, col_offset=27), 'SSLError', Load(), lineno=526, col_offset=27), Name('err', Store(), lineno=526, col_offset=41), [If(Compare(Subscript(Attribute(Name('err', Load(), lineno=527, col_offset=27), 'args', Load(), lineno=527, col_offset=27), Index(Num(0, lineno=527, col_offset=36)), Load(), lineno=527, col_offset=27), [In()], [Tuple([Attribute(Name('ssl', Load(), lineno=527, col_offset=43), 'SSL_ERROR_WANT_READ', Load(), lineno=527, col_offset=43), Attribute(Name('ssl', Load(), lineno=528, col_offset=43), 'SSL_ERROR_WANT_WRITE', Load(), lineno=528, col_offset=43)], Load(), lineno=527, col_offset=43)], lineno=527, col_offset=27), [Return(None, lineno=529, col_offset=28)], [If(Compare(Subscript(Attribute(Name('err', Load(), lineno=530, col_offset=29), 'args', Load(), lineno=530, col_offset=29), Index(Num(0, lineno=530, col_offset=38)), Load(), lineno=530, col_offset=29), [Eq()], [Attribute(Name('ssl', Load(), lineno=530, col_offset=44), 'SSL_ERROR_EOF', Load(), lineno=530, col_offset=44)], lineno=530, col_offset=29), [Return(Call(Attribute(Name('self', Load(), lineno=531, col_offset=35), 'handle_close', Load(), lineno=531, col_offset=35), [], [], None, None, lineno=531, col_offset=35), lineno=531, col_offset=28)], [], lineno=530, col_offset=29)], lineno=527, col_offset=24), Raise(None, None, None, lineno=532, col_offset=24)], lineno=526, col_offset=20), ExceptHandler(Attribute(Name('socket', Load(), lineno=533, col_offset=27), 'error', Load(), lineno=533, col_offset=27), Name('err', Store(), lineno=533, col_offset=41), [If(Compare(Subscript(Attribute(Name('err', Load(), lineno=534, col_offset=27), 'args', Load(), lineno=534, col_offset=27), Index(Num(0, lineno=534, col_offset=36)), Load(), lineno=534, col_offset=27), [Eq()], [Attribute(Name('errno', Load(), lineno=534, col_offset=42), 'ECONNABORTED', Load(), lineno=534, col_offset=42)], lineno=534, col_offset=27), [Return(Call(Attribute(Name('self', Load(), lineno=535, col_offset=35), 'handle_close', Load(), lineno=535, col_offset=35), [], [], None, None, lineno=535, col_offset=35), lineno=535, col_offset=28)], [], lineno=534, col_offset=24)], lineno=533, col_offset=20)], [Assign([Attribute(Name('self', Load(), lineno=537, col_offset=24), '_ssl_accepting', Store(), lineno=537, col_offset=24)], Name('False', Load(), lineno=537, col_offset=46), lineno=537, col_offset=24)], lineno=524, col_offset=20)], [], lineno=523, col_offset=16), FunctionDef('handle_read', arguments([Name('self', Param(), lineno=539, col_offset=32)], None, None, []), [If(Attribute(Name('self', Load(), lineno=540, col_offset=23), '_ssl_accepting', Load(), lineno=540, col_offset=23), [Expr(Call(Attribute(Name('self', Load(), lineno=541, col_offset=24), '_do_ssl_handshake', Load(), lineno=541, col_offset=24), [], [], None, None, lineno=541, col_offset=24), lineno=541, col_offset=24)], [Assign([Name('data', Store(), lineno=543, col_offset=24)], Call(Attribute(Name('self', Load(), lineno=543, col_offset=31), 'recv', Load(), lineno=543, col_offset=31), [Num(1024, lineno=543, col_offset=41)], [], None, None, lineno=543, col_offset=31), lineno=543, col_offset=24), If(BoolOp(And(), [Name('data', Load(), lineno=544, col_offset=27), Compare(Call(Attribute(Name('data', Load(), lineno=544, col_offset=36), 'strip', Load(), lineno=544, col_offset=36), [], [], None, None, lineno=544, col_offset=36), [NotEq()], [Str('over', lineno=544, col_offset=52)], lineno=544, col_offset=36)], lineno=544, col_offset=27), [Expr(Call(Attribute(Name('self', Load(), lineno=545, col_offset=28), 'send', Load(), lineno=545, col_offset=28), [Call(Attribute(Name('data', Load(), lineno=545, col_offset=38), 'lower', Load(), lineno=545, col_offset=38), [], [], None, None, lineno=545, col_offset=38)], [], None, None, lineno=545, col_offset=28), lineno=545, col_offset=28)], [], lineno=544, col_offset=24)], lineno=540, col_offset=20)], [], lineno=539, col_offset=16), FunctionDef('handle_close', arguments([Name('self', Param(), lineno=547, col_offset=33)], None, None, []), [Expr(Call(Attribute(Name('self', Load(), lineno=548, col_offset=20), 'close', Load(), lineno=548, col_offset=20), [], [], None, None, lineno=548, col_offset=20), lineno=548, col_offset=20), If(Attribute(Name('test_support', Load(), lineno=549, col_offset=23), 'verbose', Load(), lineno=549, col_offset=23), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=550, col_offset=24), 'stdout', Load(), lineno=550, col_offset=24), 'write', Load(), lineno=550, col_offset=24), [BinOp(Str(' server:  closed connection %s\n', lineno=550, col_offset=41), Mod(), Attribute(Name('self', Load(), lineno=550, col_offset=78), 'socket', Load(), lineno=550, col_offset=78), lineno=550, col_offset=41)], [], None, None, lineno=550, col_offset=24), lineno=550, col_offset=24)], [], lineno=549, col_offset=20)], [], lineno=547, col_offset=16), FunctionDef('handle_error', arguments([Name('self', Param(), lineno=552, col_offset=33)], None, None, []), [Raise(None, None, None, lineno=553, col_offset=20)], [], lineno=552, col_offset=16)], [], lineno=508, col_offset=12), FunctionDef('__init__', arguments([Name('self', Param(), lineno=555, col_offset=25), Name('certfile', Param(), lineno=555, col_offset=31)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=556, col_offset=16), 'certfile', Store(), lineno=556, col_offset=16)], Name('certfile', Load(), lineno=556, col_offset=32), lineno=556, col_offset=16), Expr(Call(Attribute(Attribute(Name('asyncore', Load(), lineno=557, col_offset=16), 'dispatcher', Load(), lineno=557, col_offset=16), '__init__', Load(), lineno=557, col_offset=16), [Name('self', Load(), lineno=557, col_offset=45)], [], None, None, lineno=557, col_offset=16), lineno=557, col_offset=16), Expr(Call(Attribute(Name('self', Load(), lineno=558, col_offset=16), 'create_socket', Load(), lineno=558, col_offset=16), [Attribute(Name('socket', Load(), lineno=558, col_offset=35), 'AF_INET', Load(), lineno=558, col_offset=35), Attribute(Name('socket', Load(), lineno=558, col_offset=51), 'SOCK_STREAM', Load(), lineno=558, col_offset=51)], [], None, None, lineno=558, col_offset=16), lineno=558, col_offset=16), Assign([Attribute(Name('self', Load(), lineno=559, col_offset=16), 'port', Store(), lineno=559, col_offset=16)], Call(Attribute(Name('test_support', Load(), lineno=559, col_offset=28), 'bind_port', Load(), lineno=559, col_offset=28), [Attribute(Name('self', Load(), lineno=559, col_offset=51), 'socket', Load(), lineno=559, col_offset=51)], [], None, None, lineno=559, col_offset=28), lineno=559, col_offset=16), Expr(Call(Attribute(Name('self', Load(), lineno=560, col_offset=16), 'listen', Load(), lineno=560, col_offset=16), [Num(5, lineno=560, col_offset=28)], [], None, None, lineno=560, col_offset=16), lineno=560, col_offset=16)], [], lineno=555, col_offset=12), FunctionDef('handle_accept', arguments([Name('self', Param(), lineno=562, col_offset=30)], None, None, []), [Assign([Tuple([Name('sock_obj', Store(), lineno=563, col_offset=16), Name('addr', Store(), lineno=563, col_offset=26)], Store(), lineno=563, col_offset=16)], Call(Attribute(Name('self', Load(), lineno=563, col_offset=33), 'accept', Load(), lineno=563, col_offset=33), [], [], None, None, lineno=563, col_offset=33), lineno=563, col_offset=16), If(Attribute(Name('test_support', Load(), lineno=564, col_offset=19), 'verbose', Load(), lineno=564, col_offset=19), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=565, col_offset=20), 'stdout', Load(), lineno=565, col_offset=20), 'write', Load(), lineno=565, col_offset=20), [BinOp(Str(' server:  new connection from %s:%s\n', lineno=565, col_offset=37), Mod(), Name('addr', Load(), lineno=565, col_offset=78), lineno=565, col_offset=37)], [], None, None, lineno=565, col_offset=20), lineno=565, col_offset=20)], [], lineno=564, col_offset=16), Expr(Call(Attribute(Name('self', Load(), lineno=566, col_offset=16), 'ConnectionHandler', Load(), lineno=566, col_offset=16), [Name('sock_obj', Load(), lineno=566, col_offset=39), Attribute(Name('self', Load(), lineno=566, col_offset=49), 'certfile', Load(), lineno=566, col_offset=49)], [], None, None, lineno=566, col_offset=16), lineno=566, col_offset=16)], [], lineno=562, col_offset=12), FunctionDef('handle_error', arguments([Name('self', Param(), lineno=568, col_offset=29)], None, None, []), [Raise(None, None, None, lineno=569, col_offset=16)], [], lineno=568, col_offset=12)], [], lineno=506, col_offset=8), FunctionDef('__init__', arguments([Name('self', Param(), lineno=571, col_offset=21), Name('certfile', Param(), lineno=571, col_offset=27)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=572, col_offset=12), 'flag', Store(), lineno=572, col_offset=12)], Name('None', Load(), lineno=572, col_offset=24), lineno=572, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=573, col_offset=12), 'active', Store(), lineno=573, col_offset=12)], Name('False', Load(), lineno=573, col_offset=26), lineno=573, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=574, col_offset=12), 'server', Store(), lineno=574, col_offset=12)], Call(Attribute(Name('self', Load(), lineno=574, col_offset=26), 'EchoServer', Load(), lineno=574, col_offset=26), [Name('certfile', Load(), lineno=574, col_offset=42)], [], None, None, lineno=574, col_offset=26), lineno=574, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=575, col_offset=12), 'port', Store(), lineno=575, col_offset=12)], Attribute(Attribute(Name('self', Load(), lineno=575, col_offset=24), 'server', Load(), lineno=575, col_offset=24), 'port', Load(), lineno=575, col_offset=24), lineno=575, col_offset=12), Expr(Call(Attribute(Attribute(Name('threading', Load(), lineno=576, col_offset=12), 'Thread', Load(), lineno=576, col_offset=12), '__init__', Load(), lineno=576, col_offset=12), [Name('self', Load(), lineno=576, col_offset=38)], [], None, None, lineno=576, col_offset=12), lineno=576, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=577, col_offset=12), 'daemon', Store(), lineno=577, col_offset=12)], Name('True', Load(), lineno=577, col_offset=26), lineno=577, col_offset=12)], [], lineno=571, col_offset=8), FunctionDef('__str__', arguments([Name('self', Param(), lineno=579, col_offset=20)], None, None, []), [Return(BinOp(Str('<%s %s>', lineno=580, col_offset=19), Mod(), Tuple([Attribute(Attribute(Name('self', Load(), lineno=580, col_offset=32), '__class__', Load(), lineno=580, col_offset=32), '__name__', Load(), lineno=580, col_offset=32), Attribute(Name('self', Load(), lineno=580, col_offset=57), 'server', Load(), lineno=580, col_offset=57)], Load(), lineno=580, col_offset=32), lineno=580, col_offset=19), lineno=580, col_offset=12)], [], lineno=579, col_offset=8), FunctionDef('start', arguments([Name('self', Param(), lineno=582, col_offset=18), Name('flag', Param(), lineno=582, col_offset=24)], None, None, [Name('None', Load(), lineno=582, col_offset=29)]), [Assign([Attribute(Name('self', Load(), lineno=583, col_offset=12), 'flag', Store(), lineno=583, col_offset=12)], Name('flag', Load(), lineno=583, col_offset=24), lineno=583, col_offset=12), Expr(Call(Attribute(Attribute(Name('threading', Load(), lineno=584, col_offset=12), 'Thread', Load(), lineno=584, col_offset=12), 'start', Load(), lineno=584, col_offset=12), [Name('self', Load(), lineno=584, col_offset=35)], [], None, None, lineno=584, col_offset=12), lineno=584, col_offset=12)], [], lineno=582, col_offset=8), FunctionDef('run', arguments([Name('self', Param(), lineno=586, col_offset=16)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=587, col_offset=12), 'active', Store(), lineno=587, col_offset=12)], Name('True', Load(), lineno=587, col_offset=26), lineno=587, col_offset=12), If(Attribute(Name('self', Load(), lineno=588, col_offset=15), 'flag', Load(), lineno=588, col_offset=15), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=589, col_offset=16), 'flag', Load(), lineno=589, col_offset=16), 'set', Load(), lineno=589, col_offset=16), [], [], None, None, lineno=589, col_offset=16), lineno=589, col_offset=16)], [], lineno=588, col_offset=12), While(Attribute(Name('self', Load(), lineno=590, col_offset=18), 'active', Load(), lineno=590, col_offset=18), [Expr(Call(Attribute(Name('asyncore', Load(), lineno=591, col_offset=16), 'loop', Load(), lineno=591, col_offset=16), [Num(0.05, lineno=591, col_offset=30)], [], None, None, lineno=591, col_offset=16), lineno=591, col_offset=16)], [], lineno=590, col_offset=12)], [], lineno=586, col_offset=8), FunctionDef('stop', arguments([Name('self', Param(), lineno=593, col_offset=17)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=594, col_offset=12), 'active', Store(), lineno=594, col_offset=12)], Name('False', Load(), lineno=594, col_offset=26), lineno=594, col_offset=12), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=595, col_offset=12), 'server', Load(), lineno=595, col_offset=12), 'close', Load(), lineno=595, col_offset=12), [], [], None, None, lineno=595, col_offset=12), lineno=595, col_offset=12)], [], lineno=593, col_offset=8)], [], lineno=504, col_offset=4), ClassDef('SocketServerHTTPSServer', [Attribute(Name('threading', Load(), lineno=597, col_offset=34), 'Thread', Load(), lineno=597, col_offset=34)], [ClassDef('HTTPSServer', [Name('HTTPServer', Load(), lineno=599, col_offset=26)], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=601, col_offset=25), Name('server_address', Param(), lineno=601, col_offset=31), Name('RequestHandlerClass', Param(), lineno=601, col_offset=47), Name('certfile', Param(), lineno=601, col_offset=68)], None, None, []), [Expr(Call(Attribute(Name('HTTPServer', Load(), lineno=602, col_offset=16), '__init__', Load(), lineno=602, col_offset=16), [Name('self', Load(), lineno=602, col_offset=36), Name('server_address', Load(), lineno=602, col_offset=42), Name('RequestHandlerClass', Load(), lineno=602, col_offset=58)], [], None, None, lineno=602, col_offset=16), lineno=602, col_offset=16), Assign([Attribute(Name('self', Load(), lineno=604, col_offset=16), 'certfile', Store(), lineno=604, col_offset=16)], Name('certfile', Load(), lineno=604, col_offset=32), lineno=604, col_offset=16), Assign([Attribute(Name('self', Load(), lineno=605, col_offset=16), 'allow_reuse_address', Store(), lineno=605, col_offset=16)], Name('True', Load(), lineno=605, col_offset=43), lineno=605, col_offset=16)], [], lineno=601, col_offset=12), FunctionDef('__str__', arguments([Name('self', Param(), lineno=607, col_offset=24)], None, None, []), [Return(BinOp(Str('<%s %s:%s>', lineno=608, col_offset=24), Mod(), Tuple([Attribute(Attribute(Name('self', Load(), lineno=609, col_offset=25), '__class__', Load(), lineno=609, col_offset=25), '__name__', Load(), lineno=609, col_offset=25), Attribute(Name('self', Load(), lineno=610, col_offset=25), 'server_name', Load(), lineno=610, col_offset=25), Attribute(Name('self', Load(), lineno=611, col_offset=25), 'server_port', Load(), lineno=611, col_offset=25)], Load(), lineno=609, col_offset=25), lineno=608, col_offset=24), lineno=608, col_offset=16)], [], lineno=607, col_offset=12), FunctionDef('get_request', arguments([Name('self', Param(), lineno=613, col_offset=28)], None, None, []), [Assign([Tuple([Name('sock', Store(), lineno=615, col_offset=16), Name('addr', Store(), lineno=615, col_offset=22)], Store(), lineno=615, col_offset=16)], Call(Attribute(Attribute(Name('self', Load(), lineno=615, col_offset=29), 'socket', Load(), lineno=615, col_offset=29), 'accept', Load(), lineno=615, col_offset=29), [], [], None, None, lineno=615, col_offset=29), lineno=615, col_offset=16), Assign([Name('sslconn', Store(), lineno=616, col_offset=16)], Call(Attribute(Name('ssl', Load(), lineno=616, col_offset=26), 'wrap_socket', Load(), lineno=616, col_offset=26), [Name('sock', Load(), lineno=616, col_offset=42)], [keyword('server_side', Name('True', Load(), lineno=616, col_offset=60)), keyword('certfile', Attribute(Name('self', Load(), lineno=617, col_offset=51), 'certfile', Load(), lineno=617, col_offset=51))], None, None, lineno=616, col_offset=26), lineno=616, col_offset=16), Return(Tuple([Name('sslconn', Load(), lineno=618, col_offset=23), Name('addr', Load(), lineno=618, col_offset=32)], Load(), lineno=618, col_offset=23), lineno=618, col_offset=16)], [], lineno=613, col_offset=12)], [], lineno=599, col_offset=8), ClassDef('RootedHTTPRequestHandler', [Name('SimpleHTTPRequestHandler', Load(), lineno=620, col_offset=39)], [Assign([Name('server_version', Store(), lineno=625, col_offset=12)], Str('TestHTTPS/1.0', lineno=625, col_offset=29), lineno=625, col_offset=12), Assign([Name('root', Store(), lineno=627, col_offset=12)], Name('None', Load(), lineno=627, col_offset=19), lineno=627, col_offset=12), FunctionDef('translate_path', arguments([Name('self', Param(), lineno=629, col_offset=31), Name('path', Param(), lineno=629, col_offset=37)], None, None, []), [Expr(Str('Translate a /-separated PATH to the local filename syntax.\n\n                Components that mean special things to the local file system\n                (e.g. drive or directory names) are ignored.  (XXX They should\n                probably be diagnosed.)\n\n                ', lineno=636, col_offset=-1), lineno=636, col_offset=-1), Assign([Name('path', Store(), lineno=638, col_offset=16)], Subscript(Call(Attribute(Name('urlparse', Load(), lineno=638, col_offset=23), 'urlparse', Load(), lineno=638, col_offset=23), [Name('path', Load(), lineno=638, col_offset=41)], [], None, None, lineno=638, col_offset=23), Index(Num(2, lineno=638, col_offset=47)), Load(), lineno=638, col_offset=23), lineno=638, col_offset=16), Assign([Name('path', Store(), lineno=639, col_offset=16)], Call(Attribute(Attribute(Name('os', Load(), lineno=639, col_offset=23), 'path', Load(), lineno=639, col_offset=23), 'normpath', Load(), lineno=639, col_offset=23), [Call(Attribute(Name('urllib', Load(), lineno=639, col_offset=40), 'unquote', Load(), lineno=639, col_offset=40), [Name('path', Load(), lineno=639, col_offset=55)], [], None, None, lineno=639, col_offset=40)], [], None, None, lineno=639, col_offset=23), lineno=639, col_offset=16), Assign([Name('words', Store(), lineno=640, col_offset=16)], Call(Attribute(Name('path', Load(), lineno=640, col_offset=24), 'split', Load(), lineno=640, col_offset=24), [Str('/', lineno=640, col_offset=35)], [], None, None, lineno=640, col_offset=24), lineno=640, col_offset=16), Assign([Name('words', Store(), lineno=641, col_offset=16)], Call(Name('filter', Load(), lineno=641, col_offset=24), [Name('None', Load(), lineno=641, col_offset=31), Name('words', Load(), lineno=641, col_offset=37)], [], None, None, lineno=641, col_offset=24), lineno=641, col_offset=16), Assign([Name('path', Store(), lineno=642, col_offset=16)], Attribute(Name('self', Load(), lineno=642, col_offset=23), 'root', Load(), lineno=642, col_offset=23), lineno=642, col_offset=16), For(Name('word', Store(), lineno=643, col_offset=20), Name('words', Load(), lineno=643, col_offset=28), [Assign([Tuple([Name('drive', Store(), lineno=644, col_offset=20), Name('word', Store(), lineno=644, col_offset=27)], Store(), lineno=644, col_offset=20)], Call(Attribute(Attribute(Name('os', Load(), lineno=644, col_offset=34), 'path', Load(), lineno=644, col_offset=34), 'splitdrive', Load(), lineno=644, col_offset=34), [Name('word', Load(), lineno=644, col_offset=53)], [], None, None, lineno=644, col_offset=34), lineno=644, col_offset=20), Assign([Tuple([Name('head', Store(), lineno=645, col_offset=20), Name('word', Store(), lineno=645, col_offset=26)], Store(), lineno=645, col_offset=20)], Call(Attribute(Attribute(Name('os', Load(), lineno=645, col_offset=33), 'path', Load(), lineno=645, col_offset=33), 'split', Load(), lineno=645, col_offset=33), [Name('word', Load(), lineno=645, col_offset=47)], [], None, None, lineno=645, col_offset=33), lineno=645, col_offset=20), If(Compare(Name('word', Load(), lineno=646, col_offset=23), [In()], [Attribute(Name('self', Load(), lineno=646, col_offset=31), 'root', Load(), lineno=646, col_offset=31)], lineno=646, col_offset=23), [Continue( lineno=646, col_offset=42)], [], lineno=646, col_offset=20), Assign([Name('path', Store(), lineno=647, col_offset=20)], Call(Attribute(Attribute(Name('os', Load(), lineno=647, col_offset=27), 'path', Load(), lineno=647, col_offset=27), 'join', Load(), lineno=647, col_offset=27), [Name('path', Load(), lineno=647, col_offset=40), Name('word', Load(), lineno=647, col_offset=46)], [], None, None, lineno=647, col_offset=27), lineno=647, col_offset=20)], [], lineno=643, col_offset=16), Return(Name('path', Load(), lineno=648, col_offset=23), lineno=648, col_offset=16)], [], lineno=629, col_offset=12), FunctionDef('log_message', arguments([Name('self', Param(), lineno=650, col_offset=28), Name('format', Param(), lineno=650, col_offset=34)], 'args', None, []), [If(Attribute(Name('test_support', Load(), lineno=654, col_offset=19), 'verbose', Load(), lineno=654, col_offset=19), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=655, col_offset=20), 'stdout', Load(), lineno=655, col_offset=20), 'write', Load(), lineno=655, col_offset=20), [BinOp(Str(' server (%s:%d %s):\n   [%s] %s\n', lineno=655, col_offset=37), Mod(), Tuple([Attribute(Attribute(Name('self', Load(), lineno=656, col_offset=38), 'server', Load(), lineno=656, col_offset=38), 'server_address', Load(), lineno=656, col_offset=38), Attribute(Attribute(Name('self', Load(), lineno=657, col_offset=38), 'server', Load(), lineno=657, col_offset=38), 'server_port', Load(), lineno=657, col_offset=38), Call(Attribute(Attribute(Name('self', Load(), lineno=658, col_offset=38), 'request', Load(), lineno=658, col_offset=38), 'cipher', Load(), lineno=658, col_offset=38), [], [], None, None, lineno=658, col_offset=38), Call(Attribute(Name('self', Load(), lineno=659, col_offset=38), 'log_date_time_string', Load(), lineno=659, col_offset=38), [], [], None, None, lineno=659, col_offset=38), BinOp(Name('format', Load(), lineno=660, col_offset=38), Mod(), Name('args', Load(), lineno=660, col_offset=45), lineno=660, col_offset=38)], Load(), lineno=656, col_offset=38), lineno=655, col_offset=37)], [], None, None, lineno=655, col_offset=20), lineno=655, col_offset=20)], [], lineno=654, col_offset=16)], [], lineno=650, col_offset=12)], [], lineno=620, col_offset=8), FunctionDef('__init__', arguments([Name('self', Param(), lineno=663, col_offset=21), Name('certfile', Param(), lineno=663, col_offset=27)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=664, col_offset=12), 'flag', Store(), lineno=664, col_offset=12)], Name('None', Load(), lineno=664, col_offset=24), lineno=664, col_offset=12), Assign([Attribute(Attribute(Name('self', Load(), lineno=665, col_offset=12), 'RootedHTTPRequestHandler', Load(), lineno=665, col_offset=12), 'root', Store(), lineno=665, col_offset=12)], Subscript(Call(Attribute(Attribute(Name('os', Load(), lineno=665, col_offset=49), 'path', Load(), lineno=665, col_offset=49), 'split', Load(), lineno=665, col_offset=49), [Name('CERTFILE', Load(), lineno=665, col_offset=63)], [], None, None, lineno=665, col_offset=49), Index(Num(0, lineno=665, col_offset=73)), Load(), lineno=665, col_offset=49), lineno=665, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=666, col_offset=12), 'server', Store(), lineno=666, col_offset=12)], Call(Attribute(Name('self', Load(), lineno=666, col_offset=26), 'HTTPSServer', Load(), lineno=666, col_offset=26), [Tuple([Name('HOST', Load(), lineno=667, col_offset=17), Num(0, lineno=667, col_offset=23)], Load(), lineno=667, col_offset=17), Attribute(Name('self', Load(), lineno=667, col_offset=27), 'RootedHTTPRequestHandler', Load(), lineno=667, col_offset=27), Name('certfile', Load(), lineno=667, col_offset=58)], [], None, None, lineno=666, col_offset=26), lineno=666, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=668, col_offset=12), 'port', Store(), lineno=668, col_offset=12)], Attribute(Attribute(Name('self', Load(), lineno=668, col_offset=24), 'server', Load(), lineno=668, col_offset=24), 'server_port', Load(), lineno=668, col_offset=24), lineno=668, col_offset=12), Expr(Call(Attribute(Attribute(Name('threading', Load(), lineno=669, col_offset=12), 'Thread', Load(), lineno=669, col_offset=12), '__init__', Load(), lineno=669, col_offset=12), [Name('self', Load(), lineno=669, col_offset=38)], [], None, None, lineno=669, col_offset=12), lineno=669, col_offset=12), Assign([Attribute(Name('self', Load(), lineno=670, col_offset=12), 'daemon', Store(), lineno=670, col_offset=12)], Name('True', Load(), lineno=670, col_offset=26), lineno=670, col_offset=12)], [], lineno=663, col_offset=8), FunctionDef('__str__', arguments([Name('self', Param(), lineno=672, col_offset=20)], None, None, []), [Return(BinOp(Str('<%s %s>', lineno=673, col_offset=19), Mod(), Tuple([Attribute(Attribute(Name('self', Load(), lineno=673, col_offset=32), '__class__', Load(), lineno=673, col_offset=32), '__name__', Load(), lineno=673, col_offset=32), Attribute(Name('self', Load(), lineno=673, col_offset=57), 'server', Load(), lineno=673, col_offset=57)], Load(), lineno=673, col_offset=32), lineno=673, col_offset=19), lineno=673, col_offset=12)], [], lineno=672, col_offset=8), FunctionDef('start', arguments([Name('self', Param(), lineno=675, col_offset=18), Name('flag', Param(), lineno=675, col_offset=24)], None, None, [Name('None', Load(), lineno=675, col_offset=29)]), [Assign([Attribute(Name('self', Load(), lineno=676, col_offset=12), 'flag', Store(), lineno=676, col_offset=12)], Name('flag', Load(), lineno=676, col_offset=24), lineno=676, col_offset=12), Expr(Call(Attribute(Attribute(Name('threading', Load(), lineno=677, col_offset=12), 'Thread', Load(), lineno=677, col_offset=12), 'start', Load(), lineno=677, col_offset=12), [Name('self', Load(), lineno=677, col_offset=35)], [], None, None, lineno=677, col_offset=12), lineno=677, col_offset=12)], [], lineno=675, col_offset=8), FunctionDef('run', arguments([Name('self', Param(), lineno=679, col_offset=16)], None, None, []), [If(Attribute(Name('self', Load(), lineno=680, col_offset=15), 'flag', Load(), lineno=680, col_offset=15), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=681, col_offset=16), 'flag', Load(), lineno=681, col_offset=16), 'set', Load(), lineno=681, col_offset=16), [], [], None, None, lineno=681, col_offset=16), lineno=681, col_offset=16)], [], lineno=680, col_offset=12), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=682, col_offset=12), 'server', Load(), lineno=682, col_offset=12), 'serve_forever', Load(), lineno=682, col_offset=12), [Num(0.05, lineno=682, col_offset=38)], [], None, None, lineno=682, col_offset=12), lineno=682, col_offset=12)], [], lineno=679, col_offset=8), FunctionDef('stop', arguments([Name('self', Param(), lineno=684, col_offset=17)], None, None, []), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=685, col_offset=12), 'server', Load(), lineno=685, col_offset=12), 'shutdown', Load(), lineno=685, col_offset=12), [], [], None, None, lineno=685, col_offset=12), lineno=685, col_offset=12)], [], lineno=684, col_offset=8)], [], lineno=597, col_offset=4), FunctionDef('bad_cert_test', arguments([Name('certfile', Param(), lineno=688, col_offset=22)], None, None, []), [Expr(Str('\n        Launch a server with CERT_REQUIRED, and check that trying to\n        connect to it with the given client certificate fails.\n        ', lineno=692, col_offset=-1), lineno=692, col_offset=-1), Assign([Name('server', Store(), lineno=693, col_offset=8)], Call(Name('ThreadedEchoServer', Load(), lineno=693, col_offset=17), [Name('CERTFILE', Load(), lineno=693, col_offset=36)], [keyword('certreqs', Attribute(Name('ssl', Load(), lineno=694, col_offset=45), 'CERT_REQUIRED', Load(), lineno=694, col_offset=45)), keyword('cacerts', Name('CERTFILE', Load(), lineno=695, col_offset=44)), keyword('chatty', Name('False', Load(), lineno=695, col_offset=61))], None, None, lineno=693, col_offset=17), lineno=693, col_offset=8), Assign([Name('flag', Store(), lineno=696, col_offset=8)], Call(Attribute(Name('threading', Load(), lineno=696, col_offset=15), 'Event', Load(), lineno=696, col_offset=15), [], [], None, None, lineno=696, col_offset=15), lineno=696, col_offset=8), Expr(Call(Attribute(Name('server', Load(), lineno=697, col_offset=8), 'start', Load(), lineno=697, col_offset=8), [Name('flag', Load(), lineno=697, col_offset=21)], [], None, None, lineno=697, col_offset=8), lineno=697, col_offset=8), Expr(Call(Attribute(Name('flag', Load(), lineno=699, col_offset=8), 'wait', Load(), lineno=699, col_offset=8), [], [], None, None, lineno=699, col_offset=8), lineno=699, col_offset=8), TryFinally([TryExcept([Assign([Name('s', Store(), lineno=703, col_offset=16)], Call(Attribute(Name('ssl', Load(), lineno=703, col_offset=20), 'wrap_socket', Load(), lineno=703, col_offset=20), [Call(Attribute(Name('socket', Load(), lineno=703, col_offset=36), 'socket', Load(), lineno=703, col_offset=36), [], [], None, None, lineno=703, col_offset=36)], [keyword('certfile', Name('certfile', Load(), lineno=704, col_offset=45)), keyword('ssl_version', Attribute(Name('ssl', Load(), lineno=705, col_offset=48), 'PROTOCOL_TLSv1', Load(), lineno=705, col_offset=48))], None, None, lineno=703, col_offset=20), lineno=703, col_offset=16), Expr(Call(Attribute(Name('s', Load(), lineno=706, col_offset=16), 'connect', Load(), lineno=706, col_offset=16), [Tuple([Name('HOST', Load(), lineno=706, col_offset=27), Attribute(Name('server', Load(), lineno=706, col_offset=33), 'port', Load(), lineno=706, col_offset=33)], Load(), lineno=706, col_offset=27)], [], None, None, lineno=706, col_offset=16), lineno=706, col_offset=16)], [ExceptHandler(Attribute(Name('ssl', Load(), lineno=707, col_offset=19), 'SSLError', Load(), lineno=707, col_offset=19), Name('x', Store(), lineno=707, col_offset=33), [If(Attribute(Name('test_support', Load(), lineno=708, col_offset=19), 'verbose', Load(), lineno=708, col_offset=19), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=709, col_offset=20), 'stdout', Load(), lineno=709, col_offset=20), 'write', Load(), lineno=709, col_offset=20), [BinOp(Str('\nSSLError is %s\n', lineno=709, col_offset=37), Mod(), Subscript(Name('x', Load(), lineno=709, col_offset=60), Index(Num(1, lineno=709, col_offset=62)), Load(), lineno=709, col_offset=60), lineno=709, col_offset=37)], [], None, None, lineno=709, col_offset=20), lineno=709, col_offset=20)], [], lineno=708, col_offset=16)], lineno=707, col_offset=12), ExceptHandler(Attribute(Name('socket', Load(), lineno=710, col_offset=19), 'error', Load(), lineno=710, col_offset=19), Name('x', Store(), lineno=710, col_offset=33), [If(Attribute(Name('test_support', Load(), lineno=711, col_offset=19), 'verbose', Load(), lineno=711, col_offset=19), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=712, col_offset=20), 'stdout', Load(), lineno=712, col_offset=20), 'write', Load(), lineno=712, col_offset=20), [BinOp(Str('\nsocket.error is %s\n', lineno=712, col_offset=37), Mod(), Subscript(Name('x', Load(), lineno=712, col_offset=64), Index(Num(1, lineno=712, col_offset=66)), Load(), lineno=712, col_offset=64), lineno=712, col_offset=37)], [], None, None, lineno=712, col_offset=20), lineno=712, col_offset=20)], [], lineno=711, col_offset=16)], lineno=710, col_offset=12)], [Raise(Call(Name('AssertionError', Load(), lineno=714, col_offset=22), [Str('Use of invalid cert should have failed!', lineno=714, col_offset=37)], [], None, None, lineno=714, col_offset=22), None, None, lineno=714, col_offset=16)], lineno=702, col_offset=12)], [Expr(Call(Attribute(Name('server', Load(), lineno=716, col_offset=12), 'stop', Load(), lineno=716, col_offset=12), [], [], None, None, lineno=716, col_offset=12), lineno=716, col_offset=12), Expr(Call(Attribute(Name('server', Load(), lineno=717, col_offset=12), 'join', Load(), lineno=717, col_offset=12), [], [], None, None, lineno=717, col_offset=12), lineno=717, col_offset=12)], lineno=701, col_offset=8)], [], lineno=688, col_offset=4), FunctionDef('server_params_test', arguments([Name('certfile', Param(), lineno=719, col_offset=27), Name('protocol', Param(), lineno=719, col_offset=37), Name('certreqs', Param(), lineno=719, col_offset=47), Name('cacertsfile', Param(), lineno=719, col_offset=57), Name('client_certfile', Param(), lineno=720, col_offset=27), Name('client_protocol', Param(), lineno=720, col_offset=44), Name('indata', Param(), lineno=720, col_offset=66), Name('ciphers', Param(), lineno=721, col_offset=27), Name('chatty', Param(), lineno=721, col_offset=41), Name('connectionchatty', Param(), lineno=721, col_offset=54), Name('wrap_accepting_socket', Param(), lineno=722, col_offset=27)], None, None, [Name('None', Load(), lineno=720, col_offset=60), Str('FOO\n', lineno=720, col_offset=73), Name('None', Load(), lineno=721, col_offset=35), Name('True', Load(), lineno=721, col_offset=48), Name('False', Load(), lineno=721, col_offset=71), Name('False', Load(), lineno=722, col_offset=49)]), [Expr(Str('\n        Launch a server, connect a client to it and try various reads\n        and writes.\n        ', lineno=726, col_offset=-1), lineno=726, col_offset=-1), Assign([Name('server', Store(), lineno=727, col_offset=8)], Call(Name('ThreadedEchoServer', Load(), lineno=727, col_offset=17), [Name('certfile', Load(), lineno=727, col_offset=36)], [keyword('certreqs', Name('certreqs', Load(), lineno=728, col_offset=45)), keyword('ssl_version', Name('protocol', Load(), lineno=729, col_offset=48)), keyword('cacerts', Name('cacertsfile', Load(), lineno=730, col_offset=44)), keyword('ciphers', Name('ciphers', Load(), lineno=731, col_offset=44)), keyword('chatty', Name('chatty', Load(), lineno=732, col_offset=43)), keyword('connectionchatty', Name('connectionchatty', Load(), lineno=733, col_offset=53)), keyword('wrap_accepting_socket', Name('wrap_accepting_socket', Load(), lineno=734, col_offset=58))], None, None, lineno=727, col_offset=17), lineno=727, col_offset=8), Assign([Name('flag', Store(), lineno=735, col_offset=8)], Call(Attribute(Name('threading', Load(), lineno=735, col_offset=15), 'Event', Load(), lineno=735, col_offset=15), [], [], None, None, lineno=735, col_offset=15), lineno=735, col_offset=8), Expr(Call(Attribute(Name('server', Load(), lineno=736, col_offset=8), 'start', Load(), lineno=736, col_offset=8), [Name('flag', Load(), lineno=736, col_offset=21)], [], None, None, lineno=736, col_offset=8), lineno=736, col_offset=8), Expr(Call(Attribute(Name('flag', Load(), lineno=738, col_offset=8), 'wait', Load(), lineno=738, col_offset=8), [], [], None, None, lineno=738, col_offset=8), lineno=738, col_offset=8), If(Compare(Name('client_protocol', Load(), lineno=740, col_offset=11), [Is()], [Name('None', Load(), lineno=740, col_offset=30)], lineno=740, col_offset=11), [Assign([Name('client_protocol', Store(), lineno=741, col_offset=12)], Name('protocol', Load(), lineno=741, col_offset=30), lineno=741, col_offset=12)], [], lineno=740, col_offset=8), TryFinally([Assign([Name('s', Store(), lineno=743, col_offset=12)], Call(Attribute(Name('ssl', Load(), lineno=743, col_offset=16), 'wrap_socket', Load(), lineno=743, col_offset=16), [Call(Attribute(Name('socket', Load(), lineno=743, col_offset=32), 'socket', Load(), lineno=743, col_offset=32), [], [], None, None, lineno=743, col_offset=32)], [keyword('certfile', Name('client_certfile', Load(), lineno=744, col_offset=41)), keyword('ca_certs', Name('cacertsfile', Load(), lineno=745, col_offset=41)), keyword('ciphers', Name('ciphers', Load(), lineno=746, col_offset=40)), keyword('cert_reqs', Name('certreqs', Load(), lineno=747, col_offset=42)), keyword('ssl_version', Name('client_protocol', Load(), lineno=748, col_offset=44))], None, None, lineno=743, col_offset=16), lineno=743, col_offset=12), Expr(Call(Attribute(Name('s', Load(), lineno=749, col_offset=12), 'connect', Load(), lineno=749, col_offset=12), [Tuple([Name('HOST', Load(), lineno=749, col_offset=23), Attribute(Name('server', Load(), lineno=749, col_offset=29), 'port', Load(), lineno=749, col_offset=29)], Load(), lineno=749, col_offset=23)], [], None, None, lineno=749, col_offset=12), lineno=749, col_offset=12), For(Name('arg', Store(), lineno=750, col_offset=16), List([Name('indata', Load(), lineno=750, col_offset=24), Call(Name('bytearray', Load(), lineno=750, col_offset=32), [Name('indata', Load(), lineno=750, col_offset=42)], [], None, None, lineno=750, col_offset=32), Call(Name('memoryview', Load(), lineno=750, col_offset=51), [Name('indata', Load(), lineno=750, col_offset=62)], [], None, None, lineno=750, col_offset=51)], Load(), lineno=750, col_offset=23), [If(Name('connectionchatty', Load(), lineno=751, col_offset=19), [If(Attribute(Name('test_support', Load(), lineno=752, col_offset=23), 'verbose', Load(), lineno=752, col_offset=23), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=753, col_offset=24), 'stdout', Load(), lineno=753, col_offset=24), 'write', Load(), lineno=753, col_offset=24), [BinOp(Str(' client:  sending %s...\n', lineno=754, col_offset=28), Mod(), Call(Name('repr', Load(), lineno=754, col_offset=59), [Name('arg', Load(), lineno=754, col_offset=64)], [], None, None, lineno=754, col_offset=59), lineno=754, col_offset=28)], [], None, None, lineno=753, col_offset=24), lineno=753, col_offset=24)], [], lineno=752, col_offset=20)], [], lineno=751, col_offset=16), Expr(Call(Attribute(Name('s', Load(), lineno=755, col_offset=16), 'write', Load(), lineno=755, col_offset=16), [Name('arg', Load(), lineno=755, col_offset=24)], [], None, None, lineno=755, col_offset=16), lineno=755, col_offset=16), Assign([Name('outdata', Store(), lineno=756, col_offset=16)], Call(Attribute(Name('s', Load(), lineno=756, col_offset=26), 'read', Load(), lineno=756, col_offset=26), [], [], None, None, lineno=756, col_offset=26), lineno=756, col_offset=16), If(Name('connectionchatty', Load(), lineno=757, col_offset=19), [If(Attribute(Name('test_support', Load(), lineno=758, col_offset=23), 'verbose', Load(), lineno=758, col_offset=23), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=759, col_offset=24), 'stdout', Load(), lineno=759, col_offset=24), 'write', Load(), lineno=759, col_offset=24), [BinOp(Str(' client:  read %s\n', lineno=759, col_offset=41), Mod(), Call(Name('repr', Load(), lineno=759, col_offset=65), [Name('outdata', Load(), lineno=759, col_offset=70)], [], None, None, lineno=759, col_offset=65), lineno=759, col_offset=41)], [], None, None, lineno=759, col_offset=24), lineno=759, col_offset=24)], [], lineno=758, col_offset=20)], [], lineno=757, col_offset=16), If(Compare(Name('outdata', Load(), lineno=760, col_offset=19), [NotEq()], [Call(Attribute(Name('indata', Load(), lineno=760, col_offset=30), 'lower', Load(), lineno=760, col_offset=30), [], [], None, None, lineno=760, col_offset=30)], lineno=760, col_offset=19), [Raise(Call(Name('AssertionError', Load(), lineno=761, col_offset=26), [BinOp(Str('bad data <<%s>> (%d) received; expected <<%s>> (%d)\n', lineno=762, col_offset=24), Mod(), Tuple([Subscript(Name('outdata', Load(), lineno=763, col_offset=27), Slice(None, Call(Name('min', Load(), lineno=763, col_offset=36), [Call(Name('len', Load(), lineno=763, col_offset=40), [Name('outdata', Load(), lineno=763, col_offset=44)], [], None, None, lineno=763, col_offset=40), Num(20, lineno=763, col_offset=53)], [], None, None, lineno=763, col_offset=36), None), Load(), lineno=763, col_offset=27), Call(Name('len', Load(), lineno=763, col_offset=59), [Name('outdata', Load(), lineno=763, col_offset=63)], [], None, None, lineno=763, col_offset=59), Call(Attribute(Subscript(Name('indata', Load(), lineno=764, col_offset=27), Slice(None, Call(Name('min', Load(), lineno=764, col_offset=35), [Call(Name('len', Load(), lineno=764, col_offset=39), [Name('indata', Load(), lineno=764, col_offset=43)], [], None, None, lineno=764, col_offset=39), Num(20, lineno=764, col_offset=51)], [], None, None, lineno=764, col_offset=35), None), Load(), lineno=764, col_offset=27), 'lower', Load(), lineno=764, col_offset=27), [], [], None, None, lineno=764, col_offset=27), Call(Name('len', Load(), lineno=764, col_offset=65), [Name('indata', Load(), lineno=764, col_offset=69)], [], None, None, lineno=764, col_offset=65)], Load(), lineno=763, col_offset=27), lineno=762, col_offset=24)], [], None, None, lineno=761, col_offset=26), None, None, lineno=761, col_offset=20)], [], lineno=760, col_offset=16)], [], lineno=750, col_offset=12), Expr(Call(Attribute(Name('s', Load(), lineno=765, col_offset=12), 'write', Load(), lineno=765, col_offset=12), [Str('over\n', lineno=765, col_offset=20)], [], None, None, lineno=765, col_offset=12), lineno=765, col_offset=12), If(Name('connectionchatty', Load(), lineno=766, col_offset=15), [If(Attribute(Name('test_support', Load(), lineno=767, col_offset=19), 'verbose', Load(), lineno=767, col_offset=19), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=768, col_offset=20), 'stdout', Load(), lineno=768, col_offset=20), 'write', Load(), lineno=768, col_offset=20), [Str(' client:  closing connection.\n', lineno=768, col_offset=37)], [], None, None, lineno=768, col_offset=20), lineno=768, col_offset=20)], [], lineno=767, col_offset=16)], [], lineno=766, col_offset=12), Expr(Call(Attribute(Name('s', Load(), lineno=769, col_offset=12), 'close', Load(), lineno=769, col_offset=12), [], [], None, None, lineno=769, col_offset=12), lineno=769, col_offset=12)], [Expr(Call(Attribute(Name('server', Load(), lineno=771, col_offset=12), 'stop', Load(), lineno=771, col_offset=12), [], [], None, None, lineno=771, col_offset=12), lineno=771, col_offset=12), Expr(Call(Attribute(Name('server', Load(), lineno=772, col_offset=12), 'join', Load(), lineno=772, col_offset=12), [], [], None, None, lineno=772, col_offset=12), lineno=772, col_offset=12)], lineno=742, col_offset=8)], [], lineno=719, col_offset=4), FunctionDef('try_protocol_combo', arguments([Name('server_protocol', Param(), lineno=774, col_offset=27), Name('client_protocol', Param(), lineno=775, col_offset=27), Name('expect_success', Param(), lineno=776, col_offset=27), Name('certsreqs', Param(), lineno=777, col_offset=27)], None, None, [Name('None', Load(), lineno=777, col_offset=37)]), [If(Compare(Name('certsreqs', Load(), lineno=778, col_offset=11), [Is()], [Name('None', Load(), lineno=778, col_offset=24)], lineno=778, col_offset=11), [Assign([Name('certsreqs', Store(), lineno=779, col_offset=12)], Attribute(Name('ssl', Load(), lineno=779, col_offset=24), 'CERT_NONE', Load(), lineno=779, col_offset=24), lineno=779, col_offset=12)], [], lineno=778, col_offset=8), Assign([Name('certtype', Store(), lineno=780, col_offset=8)], Subscript(Dict([Attribute(Name('ssl', Load(), lineno=781, col_offset=12), 'CERT_NONE', Load(), lineno=781, col_offset=12), Attribute(Name('ssl', Load(), lineno=782, col_offset=12), 'CERT_OPTIONAL', Load(), lineno=782, col_offset=12), Attribute(Name('ssl', Load(), lineno=783, col_offset=12), 'CERT_REQUIRED', Load(), lineno=783, col_offset=12)], [Str('CERT_NONE', lineno=781, col_offset=27), Str('CERT_OPTIONAL', lineno=782, col_offset=31), Str('CERT_REQUIRED', lineno=783, col_offset=31)], lineno=780, col_offset=19), Index(Name('certsreqs', Load(), lineno=784, col_offset=10)), Load(), lineno=780, col_offset=19), lineno=780, col_offset=8), If(Attribute(Name('test_support', Load(), lineno=785, col_offset=11), 'verbose', Load(), lineno=785, col_offset=11), [Assign([Name('formatstr', Store(), lineno=786, col_offset=12)], BoolOp(Or(), [BoolOp(And(), [Name('expect_success', Load(), lineno=786, col_offset=25), Str(' %s->%s %s\n', lineno=786, col_offset=44)], lineno=786, col_offset=25), Str(' {%s->%s} %s\n', lineno=786, col_offset=63)], lineno=786, col_offset=24), lineno=786, col_offset=12), Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=787, col_offset=12), 'stdout', Load(), lineno=787, col_offset=12), 'write', Load(), lineno=787, col_offset=12), [BinOp(Name('formatstr', Load(), lineno=787, col_offset=29), Mod(), Tuple([Call(Attribute(Name('ssl', Load(), lineno=788, col_offset=30), 'get_protocol_name', Load(), lineno=788, col_offset=30), [Name('client_protocol', Load(), lineno=788, col_offset=52)], [], None, None, lineno=788, col_offset=30), Call(Attribute(Name('ssl', Load(), lineno=789, col_offset=30), 'get_protocol_name', Load(), lineno=789, col_offset=30), [Name('server_protocol', Load(), lineno=789, col_offset=52)], [], None, None, lineno=789, col_offset=30), Name('certtype', Load(), lineno=790, col_offset=30)], Load(), lineno=788, col_offset=30), lineno=787, col_offset=29)], [], None, None, lineno=787, col_offset=12), lineno=787, col_offset=12)], [], lineno=785, col_offset=8), TryExcept([Expr(Call(Name('server_params_test', Load(), lineno=795, col_offset=12), [Name('CERTFILE', Load(), lineno=795, col_offset=31), Name('server_protocol', Load(), lineno=795, col_offset=41), Name('certsreqs', Load(), lineno=795, col_offset=58), Name('CERTFILE', Load(), lineno=796, col_offset=31), Name('CERTFILE', Load(), lineno=796, col_offset=41), Name('client_protocol', Load(), lineno=796, col_offset=51)], [keyword('ciphers', Str('ALL', lineno=797, col_offset=39)), keyword('chatty', Name('False', Load(), lineno=797, col_offset=53))], None, None, lineno=795, col_offset=12), lineno=795, col_offset=12)], [ExceptHandler(Attribute(Name('ssl', Load(), lineno=800, col_offset=15), 'SSLError', Load(), lineno=800, col_offset=15), None, [If(Name('expect_success', Load(), lineno=801, col_offset=15), [Raise(None, None, None, lineno=802, col_offset=16)], [], lineno=801, col_offset=12)], lineno=800, col_offset=8), ExceptHandler(Attribute(Name('socket', Load(), lineno=803, col_offset=15), 'error', Load(), lineno=803, col_offset=15), Name('e', Store(), lineno=803, col_offset=31), [If(BoolOp(Or(), [Name('expect_success', Load(), lineno=804, col_offset=15), Compare(Attribute(Name('e', Load(), lineno=804, col_offset=33), 'errno', Load(), lineno=804, col_offset=33), [NotEq()], [Attribute(Name('errno', Load(), lineno=804, col_offset=44), 'ECONNRESET', Load(), lineno=804, col_offset=44)], lineno=804, col_offset=33)], lineno=804, col_offset=15), [Raise(None, None, None, lineno=805, col_offset=16)], [], lineno=804, col_offset=12)], lineno=803, col_offset=8)], [If(UnaryOp(Not(), Name('expect_success', Load(), lineno=807, col_offset=19), lineno=807, col_offset=15), [Raise(Call(Name('AssertionError', Load(), lineno=808, col_offset=22), [BinOp(Str('Client protocol %s succeeded with server protocol %s!', lineno=809, col_offset=20), Mod(), Tuple([Call(Attribute(Name('ssl', Load(), lineno=810, col_offset=23), 'get_protocol_name', Load(), lineno=810, col_offset=23), [Name('client_protocol', Load(), lineno=810, col_offset=45)], [], None, None, lineno=810, col_offset=23), Call(Attribute(Name('ssl', Load(), lineno=811, col_offset=23), 'get_protocol_name', Load(), lineno=811, col_offset=23), [Name('server_protocol', Load(), lineno=811, col_offset=45)], [], None, None, lineno=811, col_offset=23)], Load(), lineno=810, col_offset=23), lineno=809, col_offset=20)], [], None, None, lineno=808, col_offset=22), None, None, lineno=808, col_offset=16)], [], lineno=807, col_offset=12)], lineno=791, col_offset=8)], [], lineno=774, col_offset=4), ClassDef('ThreadedTests', [Attribute(Name('unittest', Load(), lineno=814, col_offset=24), 'TestCase', Load(), lineno=814, col_offset=24)], [FunctionDef('test_rude_shutdown', arguments([Name('self', Param(), lineno=816, col_offset=31)], None, None, []), [Expr(Str('A brutal shutdown of an SSL server should raise an IOError\n            in the client when attempting handshake.\n            ', lineno=819, col_offset=-1), lineno=819, col_offset=-1), Assign([Name('listener_ready', Store(), lineno=820, col_offset=12)], Call(Attribute(Name('threading', Load(), lineno=820, col_offset=29), 'Event', Load(), lineno=820, col_offset=29), [], [], None, None, lineno=820, col_offset=29), lineno=820, col_offset=12), Assign([Name('listener_gone', Store(), lineno=821, col_offset=12)], Call(Attribute(Name('threading', Load(), lineno=821, col_offset=28), 'Event', Load(), lineno=821, col_offset=28), [], [], None, None, lineno=821, col_offset=28), lineno=821, col_offset=12), Assign([Name('s', Store(), lineno=823, col_offset=12)], Call(Attribute(Name('socket', Load(), lineno=823, col_offset=16), 'socket', Load(), lineno=823, col_offset=16), [], [], None, None, lineno=823, col_offset=16), lineno=823, col_offset=12), Assign([Name('port', Store(), lineno=824, col_offset=12)], Call(Attribute(Name('test_support', Load(), lineno=824, col_offset=19), 'bind_port', Load(), lineno=824, col_offset=19), [Name('s', Load(), lineno=824, col_offset=42), Name('HOST', Load(), lineno=824, col_offset=45)], [], None, None, lineno=824, col_offset=19), lineno=824, col_offset=12), FunctionDef('listener', arguments([], None, None, []), [Expr(Call(Attribute(Name('s', Load(), lineno=831, col_offset=16), 'listen', Load(), lineno=831, col_offset=16), [Num(5, lineno=831, col_offset=25)], [], None, None, lineno=831, col_offset=16), lineno=831, col_offset=16), Expr(Call(Attribute(Name('listener_ready', Load(), lineno=832, col_offset=16), 'set', Load(), lineno=832, col_offset=16), [], [], None, None, lineno=832, col_offset=16), lineno=832, col_offset=16), Expr(Call(Attribute(Name('s', Load(), lineno=833, col_offset=16), 'accept', Load(), lineno=833, col_offset=16), [], [], None, None, lineno=833, col_offset=16), lineno=833, col_offset=16), Expr(Call(Attribute(Name('s', Load(), lineno=834, col_offset=16), 'close', Load(), lineno=834, col_offset=16), [], [], None, None, lineno=834, col_offset=16), lineno=834, col_offset=16), Expr(Call(Attribute(Name('listener_gone', Load(), lineno=835, col_offset=16), 'set', Load(), lineno=835, col_offset=16), [], [], None, None, lineno=835, col_offset=16), lineno=835, col_offset=16)], [], lineno=830, col_offset=12), FunctionDef('connector', arguments([], None, None, []), [Expr(Call(Attribute(Name('listener_ready', Load(), lineno=838, col_offset=16), 'wait', Load(), lineno=838, col_offset=16), [], [], None, None, lineno=838, col_offset=16), lineno=838, col_offset=16), Assign([Name('c', Store(), lineno=839, col_offset=16)], Call(Attribute(Name('socket', Load(), lineno=839, col_offset=20), 'socket', Load(), lineno=839, col_offset=20), [], [], None, None, lineno=839, col_offset=20), lineno=839, col_offset=16), Expr(Call(Attribute(Name('c', Load(), lineno=840, col_offset=16), 'connect', Load(), lineno=840, col_offset=16), [Tuple([Name('HOST', Load(), lineno=840, col_offset=27), Name('port', Load(), lineno=840, col_offset=33)], Load(), lineno=840, col_offset=27)], [], None, None, lineno=840, col_offset=16), lineno=840, col_offset=16), Expr(Call(Attribute(Name('listener_gone', Load(), lineno=841, col_offset=16), 'wait', Load(), lineno=841, col_offset=16), [], [], None, None, lineno=841, col_offset=16), lineno=841, col_offset=16), TryExcept([Assign([Name('ssl_sock', Store(), lineno=843, col_offset=20)], Call(Attribute(Name('ssl', Load(), lineno=843, col_offset=31), 'wrap_socket', Load(), lineno=843, col_offset=31), [Name('c', Load(), lineno=843, col_offset=47)], [], None, None, lineno=843, col_offset=31), lineno=843, col_offset=20)], [ExceptHandler(Name('IOError', Load(), lineno=844, col_offset=23), None, [Pass( lineno=845, col_offset=20)], lineno=844, col_offset=16)], [Expr(Call(Attribute(Name('self', Load(), lineno=847, col_offset=20), 'fail', Load(), lineno=847, col_offset=20), [Str('connecting to closed SSL socket should have failed', lineno=847, col_offset=30)], [], None, None, lineno=847, col_offset=20), lineno=847, col_offset=20)], lineno=842, col_offset=16)], [], lineno=837, col_offset=12), Assign([Name('t', Store(), lineno=849, col_offset=12)], Call(Attribute(Name('threading', Load(), lineno=849, col_offset=16), 'Thread', Load(), lineno=849, col_offset=16), [], [keyword('target', Name('listener', Load(), lineno=849, col_offset=40))], None, None, lineno=849, col_offset=16), lineno=849, col_offset=12), Expr(Call(Attribute(Name('t', Load(), lineno=850, col_offset=12), 'start', Load(), lineno=850, col_offset=12), [], [], None, None, lineno=850, col_offset=12), lineno=850, col_offset=12), TryFinally([Expr(Call(Name('connector', Load(), lineno=852, col_offset=16), [], [], None, None, lineno=852, col_offset=16), lineno=852, col_offset=16)], [Expr(Call(Attribute(Name('t', Load(), lineno=854, col_offset=16), 'join', Load(), lineno=854, col_offset=16), [], [], None, None, lineno=854, col_offset=16), lineno=854, col_offset=16)], lineno=851, col_offset=12)], [], lineno=816, col_offset=8), FunctionDef('test_echo', arguments([Name('self', Param(), lineno=857, col_offset=22)], None, None, []), [Expr(Str('Basic test of an SSL client connecting to a server', lineno=858, col_offset=12), lineno=858, col_offset=12), If(Attribute(Name('test_support', Load(), lineno=859, col_offset=15), 'verbose', Load(), lineno=859, col_offset=15), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=860, col_offset=16), 'stdout', Load(), lineno=860, col_offset=16), 'write', Load(), lineno=860, col_offset=16), [Str('\n', lineno=860, col_offset=33)], [], None, None, lineno=860, col_offset=16), lineno=860, col_offset=16)], [], lineno=859, col_offset=12), Expr(Call(Name('server_params_test', Load(), lineno=861, col_offset=12), [Name('CERTFILE', Load(), lineno=861, col_offset=31), Attribute(Name('ssl', Load(), lineno=861, col_offset=41), 'PROTOCOL_TLSv1', Load(), lineno=861, col_offset=41), Attribute(Name('ssl', Load(), lineno=861, col_offset=61), 'CERT_NONE', Load(), lineno=861, col_offset=61), Name('CERTFILE', Load(), lineno=862, col_offset=31), Name('CERTFILE', Load(), lineno=862, col_offset=41), Attribute(Name('ssl', Load(), lineno=862, col_offset=51), 'PROTOCOL_TLSv1', Load(), lineno=862, col_offset=51)], [keyword('chatty', Name('True', Load(), lineno=863, col_offset=38)), keyword('connectionchatty', Name('True', Load(), lineno=863, col_offset=61))], None, None, lineno=861, col_offset=12), lineno=861, col_offset=12)], [Name('skip_if_broken_ubuntu_ssl', Load(), lineno=856, col_offset=9)], lineno=856, col_offset=8), FunctionDef('test_getpeercert', arguments([Name('self', Param(), lineno=865, col_offset=29)], None, None, []), [If(Attribute(Name('test_support', Load(), lineno=866, col_offset=15), 'verbose', Load(), lineno=866, col_offset=15), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=867, col_offset=16), 'stdout', Load(), lineno=867, col_offset=16), 'write', Load(), lineno=867, col_offset=16), [Str('\n', lineno=867, col_offset=33)], [], None, None, lineno=867, col_offset=16), lineno=867, col_offset=16)], [], lineno=866, col_offset=12), Assign([Name('s2', Store(), lineno=868, col_offset=12)], Call(Attribute(Name('socket', Load(), lineno=868, col_offset=17), 'socket', Load(), lineno=868, col_offset=17), [], [], None, None, lineno=868, col_offset=17), lineno=868, col_offset=12), Assign([Name('server', Store(), lineno=869, col_offset=12)], Call(Name('ThreadedEchoServer', Load(), lineno=869, col_offset=21), [Name('CERTFILE', Load(), lineno=869, col_offset=40)], [keyword('certreqs', Attribute(Name('ssl', Load(), lineno=870, col_offset=49), 'CERT_NONE', Load(), lineno=870, col_offset=49)), keyword('ssl_version', Attribute(Name('ssl', Load(), lineno=871, col_offset=52), 'PROTOCOL_SSLv23', Load(), lineno=871, col_offset=52)), keyword('cacerts', Name('CERTFILE', Load(), lineno=872, col_offset=48)), keyword('chatty', Name('False', Load(), lineno=873, col_offset=47))], None, None, lineno=869, col_offset=21), lineno=869, col_offset=12), Assign([Name('flag', Store(), lineno=874, col_offset=12)], Call(Attribute(Name('threading', Load(), lineno=874, col_offset=19), 'Event', Load(), lineno=874, col_offset=19), [], [], None, None, lineno=874, col_offset=19), lineno=874, col_offset=12), Expr(Call(Attribute(Name('server', Load(), lineno=875, col_offset=12), 'start', Load(), lineno=875, col_offset=12), [Name('flag', Load(), lineno=875, col_offset=25)], [], None, None, lineno=875, col_offset=12), lineno=875, col_offset=12), Expr(Call(Attribute(Name('flag', Load(), lineno=877, col_offset=12), 'wait', Load(), lineno=877, col_offset=12), [], [], None, None, lineno=877, col_offset=12), lineno=877, col_offset=12), TryFinally([Assign([Name('s', Store(), lineno=880, col_offset=16)], Call(Attribute(Name('ssl', Load(), lineno=880, col_offset=20), 'wrap_socket', Load(), lineno=880, col_offset=20), [Call(Attribute(Name('socket', Load(), lineno=880, col_offset=36), 'socket', Load(), lineno=880, col_offset=36), [], [], None, None, lineno=880, col_offset=36)], [keyword('certfile', Name('CERTFILE', Load(), lineno=881, col_offset=45)), keyword('ca_certs', Name('CERTFILE', Load(), lineno=882, col_offset=45)), keyword('cert_reqs', Attribute(Name('ssl', Load(), lineno=883, col_offset=46), 'CERT_REQUIRED', Load(), lineno=883, col_offset=46)), keyword('ssl_version', Attribute(Name('ssl', Load(), lineno=884, col_offset=48), 'PROTOCOL_SSLv23', Load(), lineno=884, col_offset=48))], None, None, lineno=880, col_offset=20), lineno=880, col_offset=16), Expr(Call(Attribute(Name('s', Load(), lineno=885, col_offset=16), 'connect', Load(), lineno=885, col_offset=16), [Tuple([Name('HOST', Load(), lineno=885, col_offset=27), Attribute(Name('server', Load(), lineno=885, col_offset=33), 'port', Load(), lineno=885, col_offset=33)], Load(), lineno=885, col_offset=27)], [], None, None, lineno=885, col_offset=16), lineno=885, col_offset=16), Assign([Name('cert', Store(), lineno=886, col_offset=16)], Call(Attribute(Name('s', Load(), lineno=886, col_offset=23), 'getpeercert', Load(), lineno=886, col_offset=23), [], [], None, None, lineno=886, col_offset=23), lineno=886, col_offset=16), Expr(Call(Attribute(Name('self', Load(), lineno=887, col_offset=16), 'assertTrue', Load(), lineno=887, col_offset=16), [Name('cert', Load(), lineno=887, col_offset=32), Str("Can't get peer certificate.", lineno=887, col_offset=38)], [], None, None, lineno=887, col_offset=16), lineno=887, col_offset=16), Assign([Name('cipher', Store(), lineno=888, col_offset=16)], Call(Attribute(Name('s', Load(), lineno=888, col_offset=25), 'cipher', Load(), lineno=888, col_offset=25), [], [], None, None, lineno=888, col_offset=25), lineno=888, col_offset=16), If(Attribute(Name('test_support', Load(), lineno=889, col_offset=19), 'verbose', Load(), lineno=889, col_offset=19), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=890, col_offset=20), 'stdout', Load(), lineno=890, col_offset=20), 'write', Load(), lineno=890, col_offset=20), [BinOp(Call(Attribute(Name('pprint', Load(), lineno=890, col_offset=37), 'pformat', Load(), lineno=890, col_offset=37), [Name('cert', Load(), lineno=890, col_offset=52)], [], None, None, lineno=890, col_offset=37), Add(), Str('\n', lineno=890, col_offset=60), lineno=890, col_offset=37)], [], None, None, lineno=890, col_offset=20), lineno=890, col_offset=20), Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=891, col_offset=20), 'stdout', Load(), lineno=891, col_offset=20), 'write', Load(), lineno=891, col_offset=20), [BinOp(BinOp(Str('Connection cipher is ', lineno=891, col_offset=37), Add(), Call(Name('str', Load(), lineno=891, col_offset=63), [Name('cipher', Load(), lineno=891, col_offset=67)], [], None, None, lineno=891, col_offset=63), lineno=891, col_offset=37), Add(), Str('.\n', lineno=891, col_offset=77), lineno=891, col_offset=75)], [], None, None, lineno=891, col_offset=20), lineno=891, col_offset=20)], [], lineno=889, col_offset=16), If(Compare(Str('subject', lineno=892, col_offset=19), [NotIn()], [Name('cert', Load(), lineno=892, col_offset=36)], lineno=892, col_offset=19), [Expr(Call(Attribute(Name('self', Load(), lineno=893, col_offset=20), 'fail', Load(), lineno=893, col_offset=20), [BinOp(Str('No subject field in certificate: %s.', lineno=893, col_offset=30), Mod(), Call(Attribute(Name('pprint', Load(), lineno=894, col_offset=30), 'pformat', Load(), lineno=894, col_offset=30), [Name('cert', Load(), lineno=894, col_offset=45)], [], None, None, lineno=894, col_offset=30), lineno=893, col_offset=30)], [], None, None, lineno=893, col_offset=20), lineno=893, col_offset=20)], [], lineno=892, col_offset=16), If(Compare(Tuple([Tuple([Str('organizationName', lineno=895, col_offset=22), Str('Python Software Foundation', lineno=895, col_offset=42)], Load(), lineno=895, col_offset=22)], Load(), lineno=895, col_offset=21), [NotIn()], [Subscript(Name('cert', Load(), lineno=896, col_offset=27), Index(Str('subject', lineno=896, col_offset=32)), Load(), lineno=896, col_offset=27)], lineno=895, col_offset=20), [Expr(Call(Attribute(Name('self', Load(), lineno=897, col_offset=20), 'fail', Load(), lineno=897, col_offset=20), [Str("Missing or invalid 'organizationName' field in certificate subject; should be 'Python Software Foundation'.", lineno=898, col_offset=24)], [], None, None, lineno=897, col_offset=20), lineno=897, col_offset=20)], [], lineno=895, col_offset=16), Expr(Call(Attribute(Name('s', Load(), lineno=900, col_offset=16), 'close', Load(), lineno=900, col_offset=16), [], [], None, None, lineno=900, col_offset=16), lineno=900, col_offset=16)], [Expr(Call(Attribute(Name('server', Load(), lineno=902, col_offset=16), 'stop', Load(), lineno=902, col_offset=16), [], [], None, None, lineno=902, col_offset=16), lineno=902, col_offset=16), Expr(Call(Attribute(Name('server', Load(), lineno=903, col_offset=16), 'join', Load(), lineno=903, col_offset=16), [], [], None, None, lineno=903, col_offset=16), lineno=903, col_offset=16)], lineno=879, col_offset=12)], [], lineno=865, col_offset=8), FunctionDef('test_empty_cert', arguments([Name('self', Param(), lineno=905, col_offset=28)], None, None, []), [Expr(Str('Connecting with an empty cert file', lineno=906, col_offset=12), lineno=906, col_offset=12), Expr(Call(Name('bad_cert_test', Load(), lineno=907, col_offset=12), [Call(Attribute(Attribute(Name('os', Load(), lineno=907, col_offset=26), 'path', Load(), lineno=907, col_offset=26), 'join', Load(), lineno=907, col_offset=26), [BoolOp(Or(), [Call(Attribute(Attribute(Name('os', Load(), lineno=907, col_offset=39), 'path', Load(), lineno=907, col_offset=39), 'dirname', Load(), lineno=907, col_offset=39), [Name('__file__', Load(), lineno=907, col_offset=55)], [], None, None, lineno=907, col_offset=39), Attribute(Name('os', Load(), lineno=907, col_offset=68), 'curdir', Load(), lineno=907, col_offset=68)], lineno=907, col_offset=39), Str('nullcert.pem', lineno=908, col_offset=38)], [], None, None, lineno=907, col_offset=26)], [], None, None, lineno=907, col_offset=12), lineno=907, col_offset=12)], [], lineno=905, col_offset=8), FunctionDef('test_malformed_cert', arguments([Name('self', Param(), lineno=909, col_offset=32)], None, None, []), [Expr(Str('Connecting with a badly formatted certificate (syntax error)', lineno=910, col_offset=12), lineno=910, col_offset=12), Expr(Call(Name('bad_cert_test', Load(), lineno=911, col_offset=12), [Call(Attribute(Attribute(Name('os', Load(), lineno=911, col_offset=26), 'path', Load(), lineno=911, col_offset=26), 'join', Load(), lineno=911, col_offset=26), [BoolOp(Or(), [Call(Attribute(Attribute(Name('os', Load(), lineno=911, col_offset=39), 'path', Load(), lineno=911, col_offset=39), 'dirname', Load(), lineno=911, col_offset=39), [Name('__file__', Load(), lineno=911, col_offset=55)], [], None, None, lineno=911, col_offset=39), Attribute(Name('os', Load(), lineno=911, col_offset=68), 'curdir', Load(), lineno=911, col_offset=68)], lineno=911, col_offset=39), Str('badcert.pem', lineno=912, col_offset=39)], [], None, None, lineno=911, col_offset=26)], [], None, None, lineno=911, col_offset=12), lineno=911, col_offset=12)], [], lineno=909, col_offset=8), FunctionDef('test_nonexisting_cert', arguments([Name('self', Param(), lineno=913, col_offset=34)], None, None, []), [Expr(Str('Connecting with a non-existing cert file', lineno=914, col_offset=12), lineno=914, col_offset=12), Expr(Call(Name('bad_cert_test', Load(), lineno=915, col_offset=12), [Call(Attribute(Attribute(Name('os', Load(), lineno=915, col_offset=26), 'path', Load(), lineno=915, col_offset=26), 'join', Load(), lineno=915, col_offset=26), [BoolOp(Or(), [Call(Attribute(Attribute(Name('os', Load(), lineno=915, col_offset=39), 'path', Load(), lineno=915, col_offset=39), 'dirname', Load(), lineno=915, col_offset=39), [Name('__file__', Load(), lineno=915, col_offset=55)], [], None, None, lineno=915, col_offset=39), Attribute(Name('os', Load(), lineno=915, col_offset=68), 'curdir', Load(), lineno=915, col_offset=68)], lineno=915, col_offset=39), Str('wrongcert.pem', lineno=916, col_offset=39)], [], None, None, lineno=915, col_offset=26)], [], None, None, lineno=915, col_offset=12), lineno=915, col_offset=12)], [], lineno=913, col_offset=8), FunctionDef('test_malformed_key', arguments([Name('self', Param(), lineno=917, col_offset=31)], None, None, []), [Expr(Str('Connecting with a badly formatted key (syntax error)', lineno=918, col_offset=12), lineno=918, col_offset=12), Expr(Call(Name('bad_cert_test', Load(), lineno=919, col_offset=12), [Call(Attribute(Attribute(Name('os', Load(), lineno=919, col_offset=26), 'path', Load(), lineno=919, col_offset=26), 'join', Load(), lineno=919, col_offset=26), [BoolOp(Or(), [Call(Attribute(Attribute(Name('os', Load(), lineno=919, col_offset=39), 'path', Load(), lineno=919, col_offset=39), 'dirname', Load(), lineno=919, col_offset=39), [Name('__file__', Load(), lineno=919, col_offset=55)], [], None, None, lineno=919, col_offset=39), Attribute(Name('os', Load(), lineno=919, col_offset=68), 'curdir', Load(), lineno=919, col_offset=68)], lineno=919, col_offset=39), Str('badkey.pem', lineno=920, col_offset=39)], [], None, None, lineno=919, col_offset=26)], [], None, None, lineno=919, col_offset=12), lineno=919, col_offset=12)], [], lineno=917, col_offset=8), FunctionDef('test_protocol_sslv2', arguments([Name('self', Param(), lineno=923, col_offset=32)], None, None, []), [Expr(Str('Connecting to an SSLv2 server with various client options', lineno=924, col_offset=12), lineno=924, col_offset=12), If(Attribute(Name('test_support', Load(), lineno=925, col_offset=15), 'verbose', Load(), lineno=925, col_offset=15), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=926, col_offset=16), 'stdout', Load(), lineno=926, col_offset=16), 'write', Load(), lineno=926, col_offset=16), [Str('\n', lineno=926, col_offset=33)], [], None, None, lineno=926, col_offset=16), lineno=926, col_offset=16)], [], lineno=925, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=927, col_offset=12), [Attribute(Name('ssl', Load(), lineno=927, col_offset=31), 'PROTOCOL_SSLv2', Load(), lineno=927, col_offset=31), Attribute(Name('ssl', Load(), lineno=927, col_offset=51), 'PROTOCOL_SSLv2', Load(), lineno=927, col_offset=51), Name('True', Load(), lineno=927, col_offset=71)], [], None, None, lineno=927, col_offset=12), lineno=927, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=928, col_offset=12), [Attribute(Name('ssl', Load(), lineno=928, col_offset=31), 'PROTOCOL_SSLv2', Load(), lineno=928, col_offset=31), Attribute(Name('ssl', Load(), lineno=928, col_offset=51), 'PROTOCOL_SSLv2', Load(), lineno=928, col_offset=51), Name('True', Load(), lineno=928, col_offset=71), Attribute(Name('ssl', Load(), lineno=928, col_offset=77), 'CERT_OPTIONAL', Load(), lineno=928, col_offset=77)], [], None, None, lineno=928, col_offset=12), lineno=928, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=929, col_offset=12), [Attribute(Name('ssl', Load(), lineno=929, col_offset=31), 'PROTOCOL_SSLv2', Load(), lineno=929, col_offset=31), Attribute(Name('ssl', Load(), lineno=929, col_offset=51), 'PROTOCOL_SSLv2', Load(), lineno=929, col_offset=51), Name('True', Load(), lineno=929, col_offset=71), Attribute(Name('ssl', Load(), lineno=929, col_offset=77), 'CERT_REQUIRED', Load(), lineno=929, col_offset=77)], [], None, None, lineno=929, col_offset=12), lineno=929, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=930, col_offset=12), [Attribute(Name('ssl', Load(), lineno=930, col_offset=31), 'PROTOCOL_SSLv2', Load(), lineno=930, col_offset=31), Attribute(Name('ssl', Load(), lineno=930, col_offset=51), 'PROTOCOL_SSLv23', Load(), lineno=930, col_offset=51), Name('True', Load(), lineno=930, col_offset=72)], [], None, None, lineno=930, col_offset=12), lineno=930, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=931, col_offset=12), [Attribute(Name('ssl', Load(), lineno=931, col_offset=31), 'PROTOCOL_SSLv2', Load(), lineno=931, col_offset=31), Attribute(Name('ssl', Load(), lineno=931, col_offset=51), 'PROTOCOL_SSLv3', Load(), lineno=931, col_offset=51), Name('False', Load(), lineno=931, col_offset=71)], [], None, None, lineno=931, col_offset=12), lineno=931, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=932, col_offset=12), [Attribute(Name('ssl', Load(), lineno=932, col_offset=31), 'PROTOCOL_SSLv2', Load(), lineno=932, col_offset=31), Attribute(Name('ssl', Load(), lineno=932, col_offset=51), 'PROTOCOL_TLSv1', Load(), lineno=932, col_offset=51), Name('False', Load(), lineno=932, col_offset=71)], [], None, None, lineno=932, col_offset=12), lineno=932, col_offset=12)], [Name('skip_if_broken_ubuntu_ssl', Load(), lineno=922, col_offset=9)], lineno=922, col_offset=8), FunctionDef('test_protocol_sslv23', arguments([Name('self', Param(), lineno=935, col_offset=33)], None, None, []), [Expr(Str('Connecting to an SSLv23 server with various client options', lineno=936, col_offset=12), lineno=936, col_offset=12), If(Attribute(Name('test_support', Load(), lineno=937, col_offset=15), 'verbose', Load(), lineno=937, col_offset=15), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=938, col_offset=16), 'stdout', Load(), lineno=938, col_offset=16), 'write', Load(), lineno=938, col_offset=16), [Str('\n', lineno=938, col_offset=33)], [], None, None, lineno=938, col_offset=16), lineno=938, col_offset=16)], [], lineno=937, col_offset=12), TryExcept([Expr(Call(Name('try_protocol_combo', Load(), lineno=940, col_offset=16), [Attribute(Name('ssl', Load(), lineno=940, col_offset=35), 'PROTOCOL_SSLv23', Load(), lineno=940, col_offset=35), Attribute(Name('ssl', Load(), lineno=940, col_offset=56), 'PROTOCOL_SSLv2', Load(), lineno=940, col_offset=56), Name('True', Load(), lineno=940, col_offset=76)], [], None, None, lineno=940, col_offset=16), lineno=940, col_offset=16)], [ExceptHandler(Tuple([Attribute(Name('ssl', Load(), lineno=941, col_offset=20), 'SSLError', Load(), lineno=941, col_offset=20), Attribute(Name('socket', Load(), lineno=941, col_offset=34), 'error', Load(), lineno=941, col_offset=34)], Load(), lineno=941, col_offset=20), Name('x', Store(), lineno=941, col_offset=49), [If(Attribute(Name('test_support', Load(), lineno=943, col_offset=19), 'verbose', Load(), lineno=943, col_offset=19), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=944, col_offset=20), 'stdout', Load(), lineno=944, col_offset=20), 'write', Load(), lineno=944, col_offset=20), [BinOp(Str(' SSL2 client to SSL23 server test unexpectedly failed:\n %s\n', lineno=945, col_offset=24), Mod(), Call(Name('str', Load(), lineno=946, col_offset=26), [Name('x', Load(), lineno=946, col_offset=30)], [], None, None, lineno=946, col_offset=26), lineno=945, col_offset=24)], [], None, None, lineno=944, col_offset=20), lineno=944, col_offset=20)], [], lineno=943, col_offset=16)], lineno=941, col_offset=12)], [], lineno=939, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=947, col_offset=12), [Attribute(Name('ssl', Load(), lineno=947, col_offset=31), 'PROTOCOL_SSLv23', Load(), lineno=947, col_offset=31), Attribute(Name('ssl', Load(), lineno=947, col_offset=52), 'PROTOCOL_SSLv3', Load(), lineno=947, col_offset=52), Name('True', Load(), lineno=947, col_offset=72)], [], None, None, lineno=947, col_offset=12), lineno=947, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=948, col_offset=12), [Attribute(Name('ssl', Load(), lineno=948, col_offset=31), 'PROTOCOL_SSLv23', Load(), lineno=948, col_offset=31), Attribute(Name('ssl', Load(), lineno=948, col_offset=52), 'PROTOCOL_SSLv23', Load(), lineno=948, col_offset=52), Name('True', Load(), lineno=948, col_offset=73)], [], None, None, lineno=948, col_offset=12), lineno=948, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=949, col_offset=12), [Attribute(Name('ssl', Load(), lineno=949, col_offset=31), 'PROTOCOL_SSLv23', Load(), lineno=949, col_offset=31), Attribute(Name('ssl', Load(), lineno=949, col_offset=52), 'PROTOCOL_TLSv1', Load(), lineno=949, col_offset=52), Name('True', Load(), lineno=949, col_offset=72)], [], None, None, lineno=949, col_offset=12), lineno=949, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=951, col_offset=12), [Attribute(Name('ssl', Load(), lineno=951, col_offset=31), 'PROTOCOL_SSLv23', Load(), lineno=951, col_offset=31), Attribute(Name('ssl', Load(), lineno=951, col_offset=52), 'PROTOCOL_SSLv3', Load(), lineno=951, col_offset=52), Name('True', Load(), lineno=951, col_offset=72), Attribute(Name('ssl', Load(), lineno=951, col_offset=78), 'CERT_OPTIONAL', Load(), lineno=951, col_offset=78)], [], None, None, lineno=951, col_offset=12), lineno=951, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=952, col_offset=12), [Attribute(Name('ssl', Load(), lineno=952, col_offset=31), 'PROTOCOL_SSLv23', Load(), lineno=952, col_offset=31), Attribute(Name('ssl', Load(), lineno=952, col_offset=52), 'PROTOCOL_SSLv23', Load(), lineno=952, col_offset=52), Name('True', Load(), lineno=952, col_offset=73), Attribute(Name('ssl', Load(), lineno=952, col_offset=79), 'CERT_OPTIONAL', Load(), lineno=952, col_offset=79)], [], None, None, lineno=952, col_offset=12), lineno=952, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=953, col_offset=12), [Attribute(Name('ssl', Load(), lineno=953, col_offset=31), 'PROTOCOL_SSLv23', Load(), lineno=953, col_offset=31), Attribute(Name('ssl', Load(), lineno=953, col_offset=52), 'PROTOCOL_TLSv1', Load(), lineno=953, col_offset=52), Name('True', Load(), lineno=953, col_offset=72), Attribute(Name('ssl', Load(), lineno=953, col_offset=78), 'CERT_OPTIONAL', Load(), lineno=953, col_offset=78)], [], None, None, lineno=953, col_offset=12), lineno=953, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=955, col_offset=12), [Attribute(Name('ssl', Load(), lineno=955, col_offset=31), 'PROTOCOL_SSLv23', Load(), lineno=955, col_offset=31), Attribute(Name('ssl', Load(), lineno=955, col_offset=52), 'PROTOCOL_SSLv3', Load(), lineno=955, col_offset=52), Name('True', Load(), lineno=955, col_offset=72), Attribute(Name('ssl', Load(), lineno=955, col_offset=78), 'CERT_REQUIRED', Load(), lineno=955, col_offset=78)], [], None, None, lineno=955, col_offset=12), lineno=955, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=956, col_offset=12), [Attribute(Name('ssl', Load(), lineno=956, col_offset=31), 'PROTOCOL_SSLv23', Load(), lineno=956, col_offset=31), Attribute(Name('ssl', Load(), lineno=956, col_offset=52), 'PROTOCOL_SSLv23', Load(), lineno=956, col_offset=52), Name('True', Load(), lineno=956, col_offset=73), Attribute(Name('ssl', Load(), lineno=956, col_offset=79), 'CERT_REQUIRED', Load(), lineno=956, col_offset=79)], [], None, None, lineno=956, col_offset=12), lineno=956, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=957, col_offset=12), [Attribute(Name('ssl', Load(), lineno=957, col_offset=31), 'PROTOCOL_SSLv23', Load(), lineno=957, col_offset=31), Attribute(Name('ssl', Load(), lineno=957, col_offset=52), 'PROTOCOL_TLSv1', Load(), lineno=957, col_offset=52), Name('True', Load(), lineno=957, col_offset=72), Attribute(Name('ssl', Load(), lineno=957, col_offset=78), 'CERT_REQUIRED', Load(), lineno=957, col_offset=78)], [], None, None, lineno=957, col_offset=12), lineno=957, col_offset=12)], [Name('skip_if_broken_ubuntu_ssl', Load(), lineno=934, col_offset=9)], lineno=934, col_offset=8), FunctionDef('test_protocol_sslv3', arguments([Name('self', Param(), lineno=960, col_offset=32)], None, None, []), [Expr(Str('Connecting to an SSLv3 server with various client options', lineno=961, col_offset=12), lineno=961, col_offset=12), If(Attribute(Name('test_support', Load(), lineno=962, col_offset=15), 'verbose', Load(), lineno=962, col_offset=15), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=963, col_offset=16), 'stdout', Load(), lineno=963, col_offset=16), 'write', Load(), lineno=963, col_offset=16), [Str('\n', lineno=963, col_offset=33)], [], None, None, lineno=963, col_offset=16), lineno=963, col_offset=16)], [], lineno=962, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=964, col_offset=12), [Attribute(Name('ssl', Load(), lineno=964, col_offset=31), 'PROTOCOL_SSLv3', Load(), lineno=964, col_offset=31), Attribute(Name('ssl', Load(), lineno=964, col_offset=51), 'PROTOCOL_SSLv3', Load(), lineno=964, col_offset=51), Name('True', Load(), lineno=964, col_offset=71)], [], None, None, lineno=964, col_offset=12), lineno=964, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=965, col_offset=12), [Attribute(Name('ssl', Load(), lineno=965, col_offset=31), 'PROTOCOL_SSLv3', Load(), lineno=965, col_offset=31), Attribute(Name('ssl', Load(), lineno=965, col_offset=51), 'PROTOCOL_SSLv3', Load(), lineno=965, col_offset=51), Name('True', Load(), lineno=965, col_offset=71), Attribute(Name('ssl', Load(), lineno=965, col_offset=77), 'CERT_OPTIONAL', Load(), lineno=965, col_offset=77)], [], None, None, lineno=965, col_offset=12), lineno=965, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=966, col_offset=12), [Attribute(Name('ssl', Load(), lineno=966, col_offset=31), 'PROTOCOL_SSLv3', Load(), lineno=966, col_offset=31), Attribute(Name('ssl', Load(), lineno=966, col_offset=51), 'PROTOCOL_SSLv3', Load(), lineno=966, col_offset=51), Name('True', Load(), lineno=966, col_offset=71), Attribute(Name('ssl', Load(), lineno=966, col_offset=77), 'CERT_REQUIRED', Load(), lineno=966, col_offset=77)], [], None, None, lineno=966, col_offset=12), lineno=966, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=967, col_offset=12), [Attribute(Name('ssl', Load(), lineno=967, col_offset=31), 'PROTOCOL_SSLv3', Load(), lineno=967, col_offset=31), Attribute(Name('ssl', Load(), lineno=967, col_offset=51), 'PROTOCOL_SSLv2', Load(), lineno=967, col_offset=51), Name('False', Load(), lineno=967, col_offset=71)], [], None, None, lineno=967, col_offset=12), lineno=967, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=968, col_offset=12), [Attribute(Name('ssl', Load(), lineno=968, col_offset=31), 'PROTOCOL_SSLv3', Load(), lineno=968, col_offset=31), Attribute(Name('ssl', Load(), lineno=968, col_offset=51), 'PROTOCOL_SSLv23', Load(), lineno=968, col_offset=51), Name('False', Load(), lineno=968, col_offset=72)], [], None, None, lineno=968, col_offset=12), lineno=968, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=969, col_offset=12), [Attribute(Name('ssl', Load(), lineno=969, col_offset=31), 'PROTOCOL_SSLv3', Load(), lineno=969, col_offset=31), Attribute(Name('ssl', Load(), lineno=969, col_offset=51), 'PROTOCOL_TLSv1', Load(), lineno=969, col_offset=51), Name('False', Load(), lineno=969, col_offset=71)], [], None, None, lineno=969, col_offset=12), lineno=969, col_offset=12)], [Name('skip_if_broken_ubuntu_ssl', Load(), lineno=959, col_offset=9)], lineno=959, col_offset=8), FunctionDef('test_protocol_tlsv1', arguments([Name('self', Param(), lineno=972, col_offset=32)], None, None, []), [Expr(Str('Connecting to a TLSv1 server with various client options', lineno=973, col_offset=12), lineno=973, col_offset=12), If(Attribute(Name('test_support', Load(), lineno=974, col_offset=15), 'verbose', Load(), lineno=974, col_offset=15), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=975, col_offset=16), 'stdout', Load(), lineno=975, col_offset=16), 'write', Load(), lineno=975, col_offset=16), [Str('\n', lineno=975, col_offset=33)], [], None, None, lineno=975, col_offset=16), lineno=975, col_offset=16)], [], lineno=974, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=976, col_offset=12), [Attribute(Name('ssl', Load(), lineno=976, col_offset=31), 'PROTOCOL_TLSv1', Load(), lineno=976, col_offset=31), Attribute(Name('ssl', Load(), lineno=976, col_offset=51), 'PROTOCOL_TLSv1', Load(), lineno=976, col_offset=51), Name('True', Load(), lineno=976, col_offset=71)], [], None, None, lineno=976, col_offset=12), lineno=976, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=977, col_offset=12), [Attribute(Name('ssl', Load(), lineno=977, col_offset=31), 'PROTOCOL_TLSv1', Load(), lineno=977, col_offset=31), Attribute(Name('ssl', Load(), lineno=977, col_offset=51), 'PROTOCOL_TLSv1', Load(), lineno=977, col_offset=51), Name('True', Load(), lineno=977, col_offset=71), Attribute(Name('ssl', Load(), lineno=977, col_offset=77), 'CERT_OPTIONAL', Load(), lineno=977, col_offset=77)], [], None, None, lineno=977, col_offset=12), lineno=977, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=978, col_offset=12), [Attribute(Name('ssl', Load(), lineno=978, col_offset=31), 'PROTOCOL_TLSv1', Load(), lineno=978, col_offset=31), Attribute(Name('ssl', Load(), lineno=978, col_offset=51), 'PROTOCOL_TLSv1', Load(), lineno=978, col_offset=51), Name('True', Load(), lineno=978, col_offset=71), Attribute(Name('ssl', Load(), lineno=978, col_offset=77), 'CERT_REQUIRED', Load(), lineno=978, col_offset=77)], [], None, None, lineno=978, col_offset=12), lineno=978, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=979, col_offset=12), [Attribute(Name('ssl', Load(), lineno=979, col_offset=31), 'PROTOCOL_TLSv1', Load(), lineno=979, col_offset=31), Attribute(Name('ssl', Load(), lineno=979, col_offset=51), 'PROTOCOL_SSLv2', Load(), lineno=979, col_offset=51), Name('False', Load(), lineno=979, col_offset=71)], [], None, None, lineno=979, col_offset=12), lineno=979, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=980, col_offset=12), [Attribute(Name('ssl', Load(), lineno=980, col_offset=31), 'PROTOCOL_TLSv1', Load(), lineno=980, col_offset=31), Attribute(Name('ssl', Load(), lineno=980, col_offset=51), 'PROTOCOL_SSLv3', Load(), lineno=980, col_offset=51), Name('False', Load(), lineno=980, col_offset=71)], [], None, None, lineno=980, col_offset=12), lineno=980, col_offset=12), Expr(Call(Name('try_protocol_combo', Load(), lineno=981, col_offset=12), [Attribute(Name('ssl', Load(), lineno=981, col_offset=31), 'PROTOCOL_TLSv1', Load(), lineno=981, col_offset=31), Attribute(Name('ssl', Load(), lineno=981, col_offset=51), 'PROTOCOL_SSLv23', Load(), lineno=981, col_offset=51), Name('False', Load(), lineno=981, col_offset=72)], [], None, None, lineno=981, col_offset=12), lineno=981, col_offset=12)], [Name('skip_if_broken_ubuntu_ssl', Load(), lineno=971, col_offset=9)], lineno=971, col_offset=8), FunctionDef('test_starttls', arguments([Name('self', Param(), lineno=983, col_offset=26)], None, None, []), [Expr(Str('Switching from clear text to encrypted and back again.', lineno=984, col_offset=12), lineno=984, col_offset=12), Assign([Name('msgs', Store(), lineno=985, col_offset=12)], Tuple([Str('msg 1', lineno=985, col_offset=20), Str('MSG 2', lineno=985, col_offset=29), Str('STARTTLS', lineno=985, col_offset=38), Str('MSG 3', lineno=985, col_offset=50), Str('msg 4', lineno=985, col_offset=59), Str('ENDTLS', lineno=985, col_offset=68), Str('msg 5', lineno=985, col_offset=78), Str('msg 6', lineno=985, col_offset=87)], Load(), lineno=985, col_offset=20), lineno=985, col_offset=12), Assign([Name('server', Store(), lineno=987, col_offset=12)], Call(Name('ThreadedEchoServer', Load(), lineno=987, col_offset=21), [Name('CERTFILE', Load(), lineno=987, col_offset=40)], [keyword('ssl_version', Attribute(Name('ssl', Load(), lineno=988, col_offset=52), 'PROTOCOL_TLSv1', Load(), lineno=988, col_offset=52)), keyword('starttls_server', Name('True', Load(), lineno=989, col_offset=56)), keyword('chatty', Name('True', Load(), lineno=990, col_offset=47)), keyword('connectionchatty', Name('True', Load(), lineno=991, col_offset=57))], None, None, lineno=987, col_offset=21), lineno=987, col_offset=12), Assign([Name('flag', Store(), lineno=992, col_offset=12)], Call(Attribute(Name('threading', Load(), lineno=992, col_offset=19), 'Event', Load(), lineno=992, col_offset=19), [], [], None, None, lineno=992, col_offset=19), lineno=992, col_offset=12), Expr(Call(Attribute(Name('server', Load(), lineno=993, col_offset=12), 'start', Load(), lineno=993, col_offset=12), [Name('flag', Load(), lineno=993, col_offset=25)], [], None, None, lineno=993, col_offset=12), lineno=993, col_offset=12), Expr(Call(Attribute(Name('flag', Load(), lineno=995, col_offset=12), 'wait', Load(), lineno=995, col_offset=12), [], [], None, None, lineno=995, col_offset=12), lineno=995, col_offset=12), Assign([Name('wrapped', Store(), lineno=997, col_offset=12)], Name('False', Load(), lineno=997, col_offset=22), lineno=997, col_offset=12), TryFinally([Assign([Name('s', Store(), lineno=999, col_offset=16)], Call(Attribute(Name('socket', Load(), lineno=999, col_offset=20), 'socket', Load(), lineno=999, col_offset=20), [], [], None, None, lineno=999, col_offset=20), lineno=999, col_offset=16), Expr(Call(Attribute(Name('s', Load(), lineno=1000, col_offset=16), 'setblocking', Load(), lineno=1000, col_offset=16), [Num(1, lineno=1000, col_offset=30)], [], None, None, lineno=1000, col_offset=16), lineno=1000, col_offset=16), Expr(Call(Attribute(Name('s', Load(), lineno=1001, col_offset=16), 'connect', Load(), lineno=1001, col_offset=16), [Tuple([Name('HOST', Load(), lineno=1001, col_offset=27), Attribute(Name('server', Load(), lineno=1001, col_offset=33), 'port', Load(), lineno=1001, col_offset=33)], Load(), lineno=1001, col_offset=27)], [], None, None, lineno=1001, col_offset=16), lineno=1001, col_offset=16), If(Attribute(Name('test_support', Load(), lineno=1002, col_offset=19), 'verbose', Load(), lineno=1002, col_offset=19), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=1003, col_offset=20), 'stdout', Load(), lineno=1003, col_offset=20), 'write', Load(), lineno=1003, col_offset=20), [Str('\n', lineno=1003, col_offset=37)], [], None, None, lineno=1003, col_offset=20), lineno=1003, col_offset=20)], [], lineno=1002, col_offset=16), For(Name('indata', Store(), lineno=1004, col_offset=20), Name('msgs', Load(), lineno=1004, col_offset=30), [If(Attribute(Name('test_support', Load(), lineno=1005, col_offset=23), 'verbose', Load(), lineno=1005, col_offset=23), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=1006, col_offset=24), 'stdout', Load(), lineno=1006, col_offset=24), 'write', Load(), lineno=1006, col_offset=24), [BinOp(Str(' client:  sending %s...\n', lineno=1007, col_offset=28), Mod(), Call(Name('repr', Load(), lineno=1007, col_offset=58), [Name('indata', Load(), lineno=1007, col_offset=63)], [], None, None, lineno=1007, col_offset=58), lineno=1007, col_offset=28)], [], None, None, lineno=1006, col_offset=24), lineno=1006, col_offset=24)], [], lineno=1005, col_offset=20), If(Name('wrapped', Load(), lineno=1008, col_offset=23), [Expr(Call(Attribute(Name('conn', Load(), lineno=1009, col_offset=24), 'write', Load(), lineno=1009, col_offset=24), [Name('indata', Load(), lineno=1009, col_offset=35)], [], None, None, lineno=1009, col_offset=24), lineno=1009, col_offset=24), Assign([Name('outdata', Store(), lineno=1010, col_offset=24)], Call(Attribute(Name('conn', Load(), lineno=1010, col_offset=34), 'read', Load(), lineno=1010, col_offset=34), [], [], None, None, lineno=1010, col_offset=34), lineno=1010, col_offset=24)], [Expr(Call(Attribute(Name('s', Load(), lineno=1012, col_offset=24), 'send', Load(), lineno=1012, col_offset=24), [Name('indata', Load(), lineno=1012, col_offset=31)], [], None, None, lineno=1012, col_offset=24), lineno=1012, col_offset=24), Assign([Name('outdata', Store(), lineno=1013, col_offset=24)], Call(Attribute(Name('s', Load(), lineno=1013, col_offset=34), 'recv', Load(), lineno=1013, col_offset=34), [Num(1024, lineno=1013, col_offset=41)], [], None, None, lineno=1013, col_offset=34), lineno=1013, col_offset=24)], lineno=1008, col_offset=20), If(BoolOp(And(), [Compare(Name('indata', Load(), lineno=1014, col_offset=24), [Eq()], [Str('STARTTLS', lineno=1014, col_offset=34)], lineno=1014, col_offset=24), Call(Attribute(Call(Attribute(Call(Attribute(Name('outdata', Load(), lineno=1015, col_offset=24), 'strip', Load(), lineno=1015, col_offset=24), [], [], None, None, lineno=1015, col_offset=24), 'lower', Load(), lineno=1015, col_offset=24), [], [], None, None, lineno=1015, col_offset=24), 'startswith', Load(), lineno=1015, col_offset=24), [Str('ok', lineno=1015, col_offset=59)], [], None, None, lineno=1015, col_offset=24)], lineno=1014, col_offset=24), [If(Attribute(Name('test_support', Load(), lineno=1017, col_offset=27), 'verbose', Load(), lineno=1017, col_offset=27), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=1018, col_offset=28), 'stdout', Load(), lineno=1018, col_offset=28), 'write', Load(), lineno=1018, col_offset=28), [BinOp(Str(' client:  read %s from server, starting TLS...\n', lineno=1019, col_offset=32), Mod(), Call(Name('repr', Load(), lineno=1020, col_offset=34), [Name('outdata', Load(), lineno=1020, col_offset=39)], [], None, None, lineno=1020, col_offset=34), lineno=1019, col_offset=32)], [], None, None, lineno=1018, col_offset=28), lineno=1018, col_offset=28)], [], lineno=1017, col_offset=24), Assign([Name('conn', Store(), lineno=1021, col_offset=24)], Call(Attribute(Name('ssl', Load(), lineno=1021, col_offset=31), 'wrap_socket', Load(), lineno=1021, col_offset=31), [Name('s', Load(), lineno=1021, col_offset=47)], [keyword('ssl_version', Attribute(Name('ssl', Load(), lineno=1021, col_offset=62), 'PROTOCOL_TLSv1', Load(), lineno=1021, col_offset=62))], None, None, lineno=1021, col_offset=31), lineno=1021, col_offset=24), Assign([Name('wrapped', Store(), lineno=1022, col_offset=24)], Name('True', Load(), lineno=1022, col_offset=34), lineno=1022, col_offset=24)], [If(BoolOp(And(), [Compare(Name('indata', Load(), lineno=1023, col_offset=26), [Eq()], [Str('ENDTLS', lineno=1023, col_offset=36)], lineno=1023, col_offset=26), Call(Attribute(Call(Attribute(Call(Attribute(Name('outdata', Load(), lineno=1024, col_offset=24), 'strip', Load(), lineno=1024, col_offset=24), [], [], None, None, lineno=1024, col_offset=24), 'lower', Load(), lineno=1024, col_offset=24), [], [], None, None, lineno=1024, col_offset=24), 'startswith', Load(), lineno=1024, col_offset=24), [Str('ok', lineno=1024, col_offset=59)], [], None, None, lineno=1024, col_offset=24)], lineno=1023, col_offset=26), [If(Attribute(Name('test_support', Load(), lineno=1026, col_offset=27), 'verbose', Load(), lineno=1026, col_offset=27), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=1027, col_offset=28), 'stdout', Load(), lineno=1027, col_offset=28), 'write', Load(), lineno=1027, col_offset=28), [BinOp(Str(' client:  read %s from server, ending TLS...\n', lineno=1028, col_offset=32), Mod(), Call(Name('repr', Load(), lineno=1029, col_offset=34), [Name('outdata', Load(), lineno=1029, col_offset=39)], [], None, None, lineno=1029, col_offset=34), lineno=1028, col_offset=32)], [], None, None, lineno=1027, col_offset=28), lineno=1027, col_offset=28)], [], lineno=1026, col_offset=24), Assign([Name('s', Store(), lineno=1030, col_offset=24)], Call(Attribute(Name('conn', Load(), lineno=1030, col_offset=28), 'unwrap', Load(), lineno=1030, col_offset=28), [], [], None, None, lineno=1030, col_offset=28), lineno=1030, col_offset=24), Assign([Name('wrapped', Store(), lineno=1031, col_offset=24)], Name('False', Load(), lineno=1031, col_offset=34), lineno=1031, col_offset=24)], [If(Attribute(Name('test_support', Load(), lineno=1033, col_offset=27), 'verbose', Load(), lineno=1033, col_offset=27), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=1034, col_offset=28), 'stdout', Load(), lineno=1034, col_offset=28), 'write', Load(), lineno=1034, col_offset=28), [BinOp(Str(' client:  read %s from server\n', lineno=1035, col_offset=32), Mod(), Call(Name('repr', Load(), lineno=1035, col_offset=68), [Name('outdata', Load(), lineno=1035, col_offset=73)], [], None, None, lineno=1035, col_offset=68), lineno=1035, col_offset=32)], [], None, None, lineno=1034, col_offset=28), lineno=1034, col_offset=28)], [], lineno=1033, col_offset=24)], lineno=1023, col_offset=25)], lineno=1014, col_offset=20)], [], lineno=1004, col_offset=16), If(Attribute(Name('test_support', Load(), lineno=1036, col_offset=19), 'verbose', Load(), lineno=1036, col_offset=19), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=1037, col_offset=20), 'stdout', Load(), lineno=1037, col_offset=20), 'write', Load(), lineno=1037, col_offset=20), [Str(' client:  closing connection.\n', lineno=1037, col_offset=37)], [], None, None, lineno=1037, col_offset=20), lineno=1037, col_offset=20)], [], lineno=1036, col_offset=16), If(Name('wrapped', Load(), lineno=1038, col_offset=19), [Expr(Call(Attribute(Name('conn', Load(), lineno=1039, col_offset=20), 'write', Load(), lineno=1039, col_offset=20), [Str('over\n', lineno=1039, col_offset=31)], [], None, None, lineno=1039, col_offset=20), lineno=1039, col_offset=20)], [Expr(Call(Attribute(Name('s', Load(), lineno=1041, col_offset=20), 'send', Load(), lineno=1041, col_offset=20), [Str('over\n', lineno=1041, col_offset=27)], [], None, None, lineno=1041, col_offset=20), lineno=1041, col_offset=20)], lineno=1038, col_offset=16), Expr(Call(Attribute(Name('s', Load(), lineno=1042, col_offset=16), 'close', Load(), lineno=1042, col_offset=16), [], [], None, None, lineno=1042, col_offset=16), lineno=1042, col_offset=16)], [Expr(Call(Attribute(Name('server', Load(), lineno=1044, col_offset=16), 'stop', Load(), lineno=1044, col_offset=16), [], [], None, None, lineno=1044, col_offset=16), lineno=1044, col_offset=16), Expr(Call(Attribute(Name('server', Load(), lineno=1045, col_offset=16), 'join', Load(), lineno=1045, col_offset=16), [], [], None, None, lineno=1045, col_offset=16), lineno=1045, col_offset=16)], lineno=998, col_offset=12)], [], lineno=983, col_offset=8), FunctionDef('test_socketserver', arguments([Name('self', Param(), lineno=1047, col_offset=30)], None, None, []), [Expr(Str('Using a SocketServer to create and manage SSL connections.', lineno=1048, col_offset=12), lineno=1048, col_offset=12), Assign([Name('server', Store(), lineno=1049, col_offset=12)], Call(Name('SocketServerHTTPSServer', Load(), lineno=1049, col_offset=21), [Name('CERTFILE', Load(), lineno=1049, col_offset=45)], [], None, None, lineno=1049, col_offset=21), lineno=1049, col_offset=12), Assign([Name('flag', Store(), lineno=1050, col_offset=12)], Call(Attribute(Name('threading', Load(), lineno=1050, col_offset=19), 'Event', Load(), lineno=1050, col_offset=19), [], [], None, None, lineno=1050, col_offset=19), lineno=1050, col_offset=12), Expr(Call(Attribute(Name('server', Load(), lineno=1051, col_offset=12), 'start', Load(), lineno=1051, col_offset=12), [Name('flag', Load(), lineno=1051, col_offset=25)], [], None, None, lineno=1051, col_offset=12), lineno=1051, col_offset=12), Expr(Call(Attribute(Name('flag', Load(), lineno=1053, col_offset=12), 'wait', Load(), lineno=1053, col_offset=12), [], [], None, None, lineno=1053, col_offset=12), lineno=1053, col_offset=12), TryFinally([If(Attribute(Name('test_support', Load(), lineno=1056, col_offset=19), 'verbose', Load(), lineno=1056, col_offset=19), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=1057, col_offset=20), 'stdout', Load(), lineno=1057, col_offset=20), 'write', Load(), lineno=1057, col_offset=20), [Str('\n', lineno=1057, col_offset=37)], [], None, None, lineno=1057, col_offset=20), lineno=1057, col_offset=20)], [], lineno=1056, col_offset=16), With(Call(Name('open', Load(), lineno=1058, col_offset=21), [Name('CERTFILE', Load(), lineno=1058, col_offset=26), Str('rb', lineno=1058, col_offset=36)], [], None, None, lineno=1058, col_offset=21), Name('f', Store(), lineno=1058, col_offset=45), [Assign([Name('d1', Store(), lineno=1059, col_offset=20)], Call(Attribute(Name('f', Load(), lineno=1059, col_offset=25), 'read', Load(), lineno=1059, col_offset=25), [], [], None, None, lineno=1059, col_offset=25), lineno=1059, col_offset=20)], lineno=1058, col_offset=21), Assign([Name('d2', Store(), lineno=1060, col_offset=16)], Str('', lineno=1060, col_offset=21), lineno=1060, col_offset=16), Assign([Name('url', Store(), lineno=1062, col_offset=16)], BinOp(Str('https://127.0.0.1:%d/%s', lineno=1062, col_offset=22), Mod(), Tuple([Attribute(Name('server', Load(), lineno=1063, col_offset=20), 'port', Load(), lineno=1063, col_offset=20), Subscript(Call(Attribute(Attribute(Name('os', Load(), lineno=1063, col_offset=33), 'path', Load(), lineno=1063, col_offset=33), 'split', Load(), lineno=1063, col_offset=33), [Name('CERTFILE', Load(), lineno=1063, col_offset=47)], [], None, None, lineno=1063, col_offset=33), Index(Num(1, lineno=1063, col_offset=57)), Load(), lineno=1063, col_offset=33)], Load(), lineno=1063, col_offset=20), lineno=1062, col_offset=22), lineno=1062, col_offset=16), With(Call(Attribute(Name('test_support', Load(), lineno=1064, col_offset=21), 'check_py3k_warnings', Load(), lineno=1064, col_offset=21), [], [], None, None, lineno=1064, col_offset=21), None, [Assign([Name('f', Store(), lineno=1065, col_offset=20)], Call(Attribute(Name('urllib', Load(), lineno=1065, col_offset=24), 'urlopen', Load(), lineno=1065, col_offset=24), [Name('url', Load(), lineno=1065, col_offset=39)], [], None, None, lineno=1065, col_offset=24), lineno=1065, col_offset=20)], lineno=1064, col_offset=21), Assign([Name('dlen', Store(), lineno=1066, col_offset=16)], Call(Attribute(Call(Attribute(Name('f', Load(), lineno=1066, col_offset=23), 'info', Load(), lineno=1066, col_offset=23), [], [], None, None, lineno=1066, col_offset=23), 'getheader', Load(), lineno=1066, col_offset=23), [Str('content-length', lineno=1066, col_offset=42)], [], None, None, lineno=1066, col_offset=23), lineno=1066, col_offset=16), If(BoolOp(And(), [Name('dlen', Load(), lineno=1067, col_offset=19), Compare(Call(Name('int', Load(), lineno=1067, col_offset=29), [Name('dlen', Load(), lineno=1067, col_offset=33)], [], None, None, lineno=1067, col_offset=29), [Gt()], [Num(0, lineno=1067, col_offset=41)], lineno=1067, col_offset=29)], lineno=1067, col_offset=19), [Assign([Name('d2', Store(), lineno=1068, col_offset=20)], Call(Attribute(Name('f', Load(), lineno=1068, col_offset=25), 'read', Load(), lineno=1068, col_offset=25), [Call(Name('int', Load(), lineno=1068, col_offset=32), [Name('dlen', Load(), lineno=1068, col_offset=36)], [], None, None, lineno=1068, col_offset=32)], [], None, None, lineno=1068, col_offset=25), lineno=1068, col_offset=20), If(Attribute(Name('test_support', Load(), lineno=1069, col_offset=23), 'verbose', Load(), lineno=1069, col_offset=23), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=1070, col_offset=24), 'stdout', Load(), lineno=1070, col_offset=24), 'write', Load(), lineno=1070, col_offset=24), [BinOp(Str(" client: read %d bytes from remote server '%s'\n", lineno=1071, col_offset=28), Mod(), Tuple([Call(Name('len', Load(), lineno=1072, col_offset=31), [Name('d2', Load(), lineno=1072, col_offset=35)], [], None, None, lineno=1072, col_offset=31), Name('server', Load(), lineno=1072, col_offset=40)], Load(), lineno=1072, col_offset=31), lineno=1071, col_offset=28)], [], None, None, lineno=1070, col_offset=24), lineno=1070, col_offset=24)], [], lineno=1069, col_offset=20)], [], lineno=1067, col_offset=16), Expr(Call(Attribute(Name('f', Load(), lineno=1073, col_offset=16), 'close', Load(), lineno=1073, col_offset=16), [], [], None, None, lineno=1073, col_offset=16), lineno=1073, col_offset=16), Expr(Call(Attribute(Name('self', Load(), lineno=1074, col_offset=16), 'assertEqual', Load(), lineno=1074, col_offset=16), [Name('d1', Load(), lineno=1074, col_offset=33), Name('d2', Load(), lineno=1074, col_offset=37)], [], None, None, lineno=1074, col_offset=16), lineno=1074, col_offset=16)], [Expr(Call(Attribute(Name('server', Load(), lineno=1076, col_offset=16), 'stop', Load(), lineno=1076, col_offset=16), [], [], None, None, lineno=1076, col_offset=16), lineno=1076, col_offset=16), Expr(Call(Attribute(Name('server', Load(), lineno=1077, col_offset=16), 'join', Load(), lineno=1077, col_offset=16), [], [], None, None, lineno=1077, col_offset=16), lineno=1077, col_offset=16)], lineno=1055, col_offset=12)], [], lineno=1047, col_offset=8), FunctionDef('test_wrapped_accept', arguments([Name('self', Param(), lineno=1079, col_offset=32)], None, None, []), [Expr(Str('Check the accept() method on SSL sockets.', lineno=1080, col_offset=12), lineno=1080, col_offset=12), If(Attribute(Name('test_support', Load(), lineno=1081, col_offset=15), 'verbose', Load(), lineno=1081, col_offset=15), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=1082, col_offset=16), 'stdout', Load(), lineno=1082, col_offset=16), 'write', Load(), lineno=1082, col_offset=16), [Str('\n', lineno=1082, col_offset=33)], [], None, None, lineno=1082, col_offset=16), lineno=1082, col_offset=16)], [], lineno=1081, col_offset=12), Expr(Call(Name('server_params_test', Load(), lineno=1083, col_offset=12), [Name('CERTFILE', Load(), lineno=1083, col_offset=31), Attribute(Name('ssl', Load(), lineno=1083, col_offset=41), 'PROTOCOL_SSLv23', Load(), lineno=1083, col_offset=41), Attribute(Name('ssl', Load(), lineno=1083, col_offset=62), 'CERT_REQUIRED', Load(), lineno=1083, col_offset=62), Name('CERTFILE', Load(), lineno=1084, col_offset=31), Name('CERTFILE', Load(), lineno=1084, col_offset=41), Attribute(Name('ssl', Load(), lineno=1084, col_offset=51), 'PROTOCOL_SSLv23', Load(), lineno=1084, col_offset=51)], [keyword('chatty', Name('True', Load(), lineno=1085, col_offset=38)), keyword('connectionchatty', Name('True', Load(), lineno=1085, col_offset=61)), keyword('wrap_accepting_socket', Name('True', Load(), lineno=1086, col_offset=53))], None, None, lineno=1083, col_offset=12), lineno=1083, col_offset=12)], [], lineno=1079, col_offset=8), FunctionDef('test_asyncore_server', arguments([Name('self', Param(), lineno=1088, col_offset=33)], None, None, []), [Expr(Str('Check the example asyncore integration.', lineno=1089, col_offset=12), lineno=1089, col_offset=12), Assign([Name('indata', Store(), lineno=1090, col_offset=12)], Str('TEST MESSAGE of mixed case\n', lineno=1090, col_offset=21), lineno=1090, col_offset=12), If(Attribute(Name('test_support', Load(), lineno=1092, col_offset=15), 'verbose', Load(), lineno=1092, col_offset=15), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=1093, col_offset=16), 'stdout', Load(), lineno=1093, col_offset=16), 'write', Load(), lineno=1093, col_offset=16), [Str('\n', lineno=1093, col_offset=33)], [], None, None, lineno=1093, col_offset=16), lineno=1093, col_offset=16)], [], lineno=1092, col_offset=12), Assign([Name('server', Store(), lineno=1094, col_offset=12)], Call(Name('AsyncoreEchoServer', Load(), lineno=1094, col_offset=21), [Name('CERTFILE', Load(), lineno=1094, col_offset=40)], [], None, None, lineno=1094, col_offset=21), lineno=1094, col_offset=12), Assign([Name('flag', Store(), lineno=1095, col_offset=12)], Call(Attribute(Name('threading', Load(), lineno=1095, col_offset=19), 'Event', Load(), lineno=1095, col_offset=19), [], [], None, None, lineno=1095, col_offset=19), lineno=1095, col_offset=12), Expr(Call(Attribute(Name('server', Load(), lineno=1096, col_offset=12), 'start', Load(), lineno=1096, col_offset=12), [Name('flag', Load(), lineno=1096, col_offset=25)], [], None, None, lineno=1096, col_offset=12), lineno=1096, col_offset=12), Expr(Call(Attribute(Name('flag', Load(), lineno=1098, col_offset=12), 'wait', Load(), lineno=1098, col_offset=12), [], [], None, None, lineno=1098, col_offset=12), lineno=1098, col_offset=12), TryFinally([Assign([Name('s', Store(), lineno=1101, col_offset=16)], Call(Attribute(Name('ssl', Load(), lineno=1101, col_offset=20), 'wrap_socket', Load(), lineno=1101, col_offset=20), [Call(Attribute(Name('socket', Load(), lineno=1101, col_offset=36), 'socket', Load(), lineno=1101, col_offset=36), [], [], None, None, lineno=1101, col_offset=36)], [], None, None, lineno=1101, col_offset=20), lineno=1101, col_offset=16), Expr(Call(Attribute(Name('s', Load(), lineno=1102, col_offset=16), 'connect', Load(), lineno=1102, col_offset=16), [Tuple([Str('127.0.0.1', lineno=1102, col_offset=27), Attribute(Name('server', Load(), lineno=1102, col_offset=40), 'port', Load(), lineno=1102, col_offset=40)], Load(), lineno=1102, col_offset=27)], [], None, None, lineno=1102, col_offset=16), lineno=1102, col_offset=16), If(Attribute(Name('test_support', Load(), lineno=1103, col_offset=19), 'verbose', Load(), lineno=1103, col_offset=19), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=1104, col_offset=20), 'stdout', Load(), lineno=1104, col_offset=20), 'write', Load(), lineno=1104, col_offset=20), [BinOp(Str(' client:  sending %s...\n', lineno=1105, col_offset=24), Mod(), Call(Name('repr', Load(), lineno=1105, col_offset=55), [Name('indata', Load(), lineno=1105, col_offset=60)], [], None, None, lineno=1105, col_offset=55), lineno=1105, col_offset=24)], [], None, None, lineno=1104, col_offset=20), lineno=1104, col_offset=20)], [], lineno=1103, col_offset=16), Expr(Call(Attribute(Name('s', Load(), lineno=1106, col_offset=16), 'write', Load(), lineno=1106, col_offset=16), [Name('indata', Load(), lineno=1106, col_offset=24)], [], None, None, lineno=1106, col_offset=16), lineno=1106, col_offset=16), Assign([Name('outdata', Store(), lineno=1107, col_offset=16)], Call(Attribute(Name('s', Load(), lineno=1107, col_offset=26), 'read', Load(), lineno=1107, col_offset=26), [], [], None, None, lineno=1107, col_offset=26), lineno=1107, col_offset=16), If(Attribute(Name('test_support', Load(), lineno=1108, col_offset=19), 'verbose', Load(), lineno=1108, col_offset=19), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=1109, col_offset=20), 'stdout', Load(), lineno=1109, col_offset=20), 'write', Load(), lineno=1109, col_offset=20), [BinOp(Str(' client:  read %s\n', lineno=1109, col_offset=37), Mod(), Call(Name('repr', Load(), lineno=1109, col_offset=61), [Name('outdata', Load(), lineno=1109, col_offset=66)], [], None, None, lineno=1109, col_offset=61), lineno=1109, col_offset=37)], [], None, None, lineno=1109, col_offset=20), lineno=1109, col_offset=20)], [], lineno=1108, col_offset=16), If(Compare(Name('outdata', Load(), lineno=1110, col_offset=19), [NotEq()], [Call(Attribute(Name('indata', Load(), lineno=1110, col_offset=30), 'lower', Load(), lineno=1110, col_offset=30), [], [], None, None, lineno=1110, col_offset=30)], lineno=1110, col_offset=19), [Expr(Call(Attribute(Name('self', Load(), lineno=1111, col_offset=20), 'fail', Load(), lineno=1111, col_offset=20), [BinOp(Str('bad data <<%s>> (%d) received; expected <<%s>> (%d)\n', lineno=1112, col_offset=24), Mod(), Tuple([Subscript(Name('outdata', Load(), lineno=1113, col_offset=27), Slice(None, Call(Name('min', Load(), lineno=1113, col_offset=36), [Call(Name('len', Load(), lineno=1113, col_offset=40), [Name('outdata', Load(), lineno=1113, col_offset=44)], [], None, None, lineno=1113, col_offset=40), Num(20, lineno=1113, col_offset=53)], [], None, None, lineno=1113, col_offset=36), None), Load(), lineno=1113, col_offset=27), Call(Name('len', Load(), lineno=1113, col_offset=59), [Name('outdata', Load(), lineno=1113, col_offset=63)], [], None, None, lineno=1113, col_offset=59), Call(Attribute(Subscript(Name('indata', Load(), lineno=1114, col_offset=27), Slice(None, Call(Name('min', Load(), lineno=1114, col_offset=35), [Call(Name('len', Load(), lineno=1114, col_offset=39), [Name('indata', Load(), lineno=1114, col_offset=43)], [], None, None, lineno=1114, col_offset=39), Num(20, lineno=1114, col_offset=51)], [], None, None, lineno=1114, col_offset=35), None), Load(), lineno=1114, col_offset=27), 'lower', Load(), lineno=1114, col_offset=27), [], [], None, None, lineno=1114, col_offset=27), Call(Name('len', Load(), lineno=1114, col_offset=65), [Name('indata', Load(), lineno=1114, col_offset=69)], [], None, None, lineno=1114, col_offset=65)], Load(), lineno=1113, col_offset=27), lineno=1112, col_offset=24)], [], None, None, lineno=1111, col_offset=20), lineno=1111, col_offset=20)], [], lineno=1110, col_offset=16), Expr(Call(Attribute(Name('s', Load(), lineno=1115, col_offset=16), 'write', Load(), lineno=1115, col_offset=16), [Str('over\n', lineno=1115, col_offset=24)], [], None, None, lineno=1115, col_offset=16), lineno=1115, col_offset=16), If(Attribute(Name('test_support', Load(), lineno=1116, col_offset=19), 'verbose', Load(), lineno=1116, col_offset=19), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=1117, col_offset=20), 'stdout', Load(), lineno=1117, col_offset=20), 'write', Load(), lineno=1117, col_offset=20), [Str(' client:  closing connection.\n', lineno=1117, col_offset=37)], [], None, None, lineno=1117, col_offset=20), lineno=1117, col_offset=20)], [], lineno=1116, col_offset=16), Expr(Call(Attribute(Name('s', Load(), lineno=1118, col_offset=16), 'close', Load(), lineno=1118, col_offset=16), [], [], None, None, lineno=1118, col_offset=16), lineno=1118, col_offset=16)], [Expr(Call(Attribute(Name('server', Load(), lineno=1120, col_offset=16), 'stop', Load(), lineno=1120, col_offset=16), [], [], None, None, lineno=1120, col_offset=16), lineno=1120, col_offset=16), Expr(Call(Attribute(Name('server', Load(), lineno=1122, col_offset=16), 'join', Load(), lineno=1122, col_offset=16), [], [], None, None, lineno=1122, col_offset=16), lineno=1122, col_offset=16)], lineno=1100, col_offset=12)], [], lineno=1088, col_offset=8), FunctionDef('test_recv_send', arguments([Name('self', Param(), lineno=1124, col_offset=27)], None, None, []), [Expr(Str('Test recv(), send() and friends.', lineno=1125, col_offset=12), lineno=1125, col_offset=12), If(Attribute(Name('test_support', Load(), lineno=1126, col_offset=15), 'verbose', Load(), lineno=1126, col_offset=15), [Expr(Call(Attribute(Attribute(Name('sys', Load(), lineno=1127, col_offset=16), 'stdout', Load(), lineno=1127, col_offset=16), 'write', Load(), lineno=1127, col_offset=16), [Str('\n', lineno=1127, col_offset=33)], [], None, None, lineno=1127, col_offset=16), lineno=1127, col_offset=16)], [], lineno=1126, col_offset=12), Assign([Name('server', Store(), lineno=1129, col_offset=12)], Call(Name('ThreadedEchoServer', Load(), lineno=1129, col_offset=21), [Name('CERTFILE', Load(), lineno=1129, col_offset=40)], [keyword('certreqs', Attribute(Name('ssl', Load(), lineno=1130, col_offset=49), 'CERT_NONE', Load(), lineno=1130, col_offset=49)), keyword('ssl_version', Attribute(Name('ssl', Load(), lineno=1131, col_offset=52), 'PROTOCOL_TLSv1', Load(), lineno=1131, col_offset=52)), keyword('cacerts', Name('CERTFILE', Load(), lineno=1132, col_offset=48)), keyword('chatty', Name('True', Load(), lineno=1133, col_offset=47)), keyword('connectionchatty', Name('False', Load(), lineno=1134, col_offset=57))], None, None, lineno=1129, col_offset=21), lineno=1129, col_offset=12), Assign([Name('flag', Store(), lineno=1135, col_offset=12)], Call(Attribute(Name('threading', Load(), lineno=1135, col_offset=19), 'Event', Load(), lineno=1135, col_offset=19), [], [], None, None, lineno=1135, col_offset=19), lineno=1135, col_offset=12), Expr(Call(Attribute(Name('server', Load(), lineno=1136, col_offset=12), 'start', Load(), lineno=1136, col_offset=12), [Name('flag', Load(), lineno=1136, col_offset=25)], [], None, None, lineno=1136, col_offset=12), lineno=1136, col_offset=12), Expr(Call(Attribute(Name('flag', Load(), lineno=1138, col_offset=12), 'wait', Load(), lineno=1138, col_offset=12), [], [], None, None, lineno=1138, col_offset=12), lineno=1138, col_offset=12), Assign([Name('s', Store(), lineno=1140, col_offset=12)], Call(Attribute(Name('ssl', Load(), lineno=1140, col_offset=16), 'wrap_socket', Load(), lineno=1140, col_offset=16), [Call(Attribute(Name('socket', Load(), lineno=1140, col_offset=32), 'socket', Load(), lineno=1140, col_offset=32), [], [], None, None, lineno=1140, col_offset=32)], [keyword('server_side', Name('False', Load(), lineno=1141, col_offset=44)), keyword('certfile', Name('CERTFILE', Load(), lineno=1142, col_offset=41)), keyword('ca_certs', Name('CERTFILE', Load(), lineno=1143, col_offset=41)), keyword('cert_reqs', Attribute(Name('ssl', Load(), lineno=1144, col_offset=42), 'CERT_NONE', Load(), lineno=1144, col_offset=42)), keyword('ssl_version', Attribute(Name('ssl', Load(), lineno=1145, col_offset=44), 'PROTOCOL_TLSv1', Load(), lineno=1145, col_offset=44))], None, None, lineno=1140, col_offset=16), lineno=1140, col_offset=12), Expr(Call(Attribute(Name('s', Load(), lineno=1146, col_offset=12), 'connect', Load(), lineno=1146, col_offset=12), [Tuple([Name('HOST', Load(), lineno=1146, col_offset=23), Attribute(Name('server', Load(), lineno=1146, col_offset=29), 'port', Load(), lineno=1146, col_offset=29)], Load(), lineno=1146, col_offset=23)], [], None, None, lineno=1146, col_offset=12), lineno=1146, col_offset=12), TryFinally([FunctionDef('_recv_into', arguments([], None, None, []), [Assign([Name('b', Store(), lineno=1150, col_offset=20)], Call(Name('bytearray', Load(), lineno=1150, col_offset=24), [BinOp(Str('\x00', lineno=1150, col_offset=34), Mult(), Num(100, lineno=1150, col_offset=39), lineno=1150, col_offset=34)], [], None, None, lineno=1150, col_offset=24), lineno=1150, col_offset=20), Assign([Name('count', Store(), lineno=1151, col_offset=20)], Call(Attribute(Name('s', Load(), lineno=1151, col_offset=28), 'recv_into', Load(), lineno=1151, col_offset=28), [Name('b', Load(), lineno=1151, col_offset=40)], [], None, None, lineno=1151, col_offset=28), lineno=1151, col_offset=20), Return(Subscript(Name('b', Load(), lineno=1152, col_offset=27), Slice(None, Name('count', Load(), lineno=1152, col_offset=30), None), Load(), lineno=1152, col_offset=27), lineno=1152, col_offset=20)], [], lineno=1149, col_offset=16), FunctionDef('_recvfrom_into', arguments([], None, None, []), [Assign([Name('b', Store(), lineno=1155, col_offset=20)], Call(Name('bytearray', Load(), lineno=1155, col_offset=24), [BinOp(Str('\x00', lineno=1155, col_offset=34), Mult(), Num(100, lineno=1155, col_offset=39), lineno=1155, col_offset=34)], [], None, None, lineno=1155, col_offset=24), lineno=1155, col_offset=20), Assign([Tuple([Name('count', Store(), lineno=1156, col_offset=20), Name('addr', Store(), lineno=1156, col_offset=27)], Store(), lineno=1156, col_offset=20)], Call(Attribute(Name('s', Load(), lineno=1156, col_offset=34), 'recvfrom_into', Load(), lineno=1156, col_offset=34), [Name('b', Load(), lineno=1156, col_offset=50)], [], None, None, lineno=1156, col_offset=34), lineno=1156, col_offset=20), Return(Subscript(Name('b', Load(), lineno=1157, col_offset=27), Slice(None, Name('count', Load(), lineno=1157, col_offset=30), None), Load(), lineno=1157, col_offset=27), lineno=1157, col_offset=20)], [], lineno=1154, col_offset=16), Assign([Name('send_methods', Store(), lineno=1160, col_offset=16)], List([Tuple([Str('send', lineno=1161, col_offset=21), Attribute(Name('s', Load(), lineno=1161, col_offset=29), 'send', Load(), lineno=1161, col_offset=29), Name('True', Load(), lineno=1161, col_offset=37), List([], Load(), lineno=1161, col_offset=43)], Load(), lineno=1161, col_offset=21), Tuple([Str('sendto', lineno=1162, col_offset=21), Attribute(Name('s', Load(), lineno=1162, col_offset=31), 'sendto', Load(), lineno=1162, col_offset=31), Name('False', Load(), lineno=1162, col_offset=41), List([Str('some.address', lineno=1162, col_offset=49)], Load(), lineno=1162, col_offset=48)], Load(), lineno=1162, col_offset=21), Tuple([Str('sendall', lineno=1163, col_offset=21), Attribute(Name('s', Load(), lineno=1163, col_offset=32), 'sendall', Load(), lineno=1163, col_offset=32), Name('True', Load(), lineno=1163, col_offset=43), List([], Load(), lineno=1163, col_offset=49)], Load(), lineno=1163, col_offset=21)], Load(), lineno=1160, col_offset=31), lineno=1160, col_offset=16), Assign([Name('recv_methods', Store(), lineno=1165, col_offset=16)], List([Tuple([Str('recv', lineno=1166, col_offset=21), Attribute(Name('s', Load(), lineno=1166, col_offset=29), 'recv', Load(), lineno=1166, col_offset=29), Name('True', Load(), lineno=1166, col_offset=37), List([], Load(), lineno=1166, col_offset=43)], Load(), lineno=1166, col_offset=21), Tuple([Str('recvfrom', lineno=1167, col_offset=21), Attribute(Name('s', Load(), lineno=1167, col_offset=33), 'recvfrom', Load(), lineno=1167, col_offset=33), Name('False', Load(), lineno=1167, col_offset=45), List([Str('some.address', lineno=1167, col_offset=53)], Load(), lineno=1167, col_offset=52)], Load(), lineno=1167, col_offset=21), Tuple([Str('recv_into', lineno=1168, col_offset=21), Name('_recv_into', Load(), lineno=1168, col_offset=34), Name('True', Load(), lineno=1168, col_offset=46), List([], Load(), lineno=1168, col_offset=52)], Load(), lineno=1168, col_offset=21), Tuple([Str('recvfrom_into', lineno=1169, col_offset=21), Name('_recvfrom_into', Load(), lineno=1169, col_offset=38), Name('False', Load(), lineno=1169, col_offset=54), List([], Load(), lineno=1169, col_offset=61)], Load(), lineno=1169, col_offset=21)], Load(), lineno=1165, col_offset=31), lineno=1165, col_offset=16), Assign([Name('data_prefix', Store(), lineno=1171, col_offset=16)], Str(u'PREFIX_', lineno=1171, col_offset=30), lineno=1171, col_offset=16), For(Tuple([Name('meth_name', Store(), lineno=1173, col_offset=20), Name('send_meth', Store(), lineno=1173, col_offset=31), Name('expect_success', Store(), lineno=1173, col_offset=42), Name('args', Store(), lineno=1173, col_offset=58)], Store(), lineno=1173, col_offset=20), Name('send_methods', Load(), lineno=1173, col_offset=66), [Assign([Name('indata', Store(), lineno=1174, col_offset=20)], BinOp(Name('data_prefix', Load(), lineno=1174, col_offset=29), Add(), Name('meth_name', Load(), lineno=1174, col_offset=43), lineno=1174, col_offset=29), lineno=1174, col_offset=20), TryExcept([Expr(Call(Name('send_meth', Load(), lineno=1176, col_offset=24), [Call(Attribute(Name('indata', Load(), lineno=1176, col_offset=34), 'encode', Load(), lineno=1176, col_offset=34), [Str('ASCII', lineno=1176, col_offset=48), Str('strict', lineno=1176, col_offset=57)], [], None, None, lineno=1176, col_offset=34)], [], Name('args', Load(), lineno=1176, col_offset=69), None, lineno=1176, col_offset=24), lineno=1176, col_offset=24), Assign([Name('outdata', Store(), lineno=1177, col_offset=24)], Call(Attribute(Name('s', Load(), lineno=1177, col_offset=34), 'read', Load(), lineno=1177, col_offset=34), [], [], None, None, lineno=1177, col_offset=34), lineno=1177, col_offset=24), Assign([Name('outdata', Store(), lineno=1178, col_offset=24)], Call(Attribute(Name('outdata', Load(), lineno=1178, col_offset=34), 'decode', Load(), lineno=1178, col_offset=34), [Str('ASCII', lineno=1178, col_offset=49), Str('strict', lineno=1178, col_offset=58)], [], None, None, lineno=1178, col_offset=34), lineno=1178, col_offset=24), If(Compare(Name('outdata', Load(), lineno=1179, col_offset=27), [NotEq()], [Call(Attribute(Name('indata', Load(), lineno=1179, col_offset=38), 'lower', Load(), lineno=1179, col_offset=38), [], [], None, None, lineno=1179, col_offset=38)], lineno=1179, col_offset=27), [Expr(Call(Attribute(Name('self', Load(), lineno=1180, col_offset=28), 'fail', Load(), lineno=1180, col_offset=28), [BinOp(Str('While sending with <<%s>> bad data <<%r>> (%d) received; expected <<%r>> (%d)\n', lineno=1181, col_offset=32), Mod(), Tuple([Name('meth_name', Load(), lineno=1184, col_offset=36), Subscript(Name('outdata', Load(), lineno=1184, col_offset=47), Slice(None, Num(20, lineno=1184, col_offset=56), None), Load(), lineno=1184, col_offset=47), Call(Name('len', Load(), lineno=1184, col_offset=61), [Name('outdata', Load(), lineno=1184, col_offset=65)], [], None, None, lineno=1184, col_offset=61), Subscript(Name('indata', Load(), lineno=1185, col_offset=36), Slice(None, Num(20, lineno=1185, col_offset=44), None), Load(), lineno=1185, col_offset=36), Call(Name('len', Load(), lineno=1185, col_offset=49), [Name('indata', Load(), lineno=1185, col_offset=53)], [], None, None, lineno=1185, col_offset=49)], Load(), lineno=1184, col_offset=36), lineno=1181, col_offset=32)], [], None, None, lineno=1180, col_offset=28), lineno=1180, col_offset=28)], [], lineno=1179, col_offset=24)], [ExceptHandler(Name('ValueError', Load(), lineno=1188, col_offset=27), Name('e', Store(), lineno=1188, col_offset=41), [If(Name('expect_success', Load(), lineno=1189, col_offset=27), [Expr(Call(Attribute(Name('self', Load(), lineno=1190, col_offset=28), 'fail', Load(), lineno=1190, col_offset=28), [BinOp(Str('Failed to send with method <<%s>>; expected to succeed.\n', lineno=1191, col_offset=32), Mod(), Tuple([Name('meth_name', Load(), lineno=1192, col_offset=60)], Load(), lineno=1192, col_offset=60), lineno=1191, col_offset=32)], [], None, None, lineno=1190, col_offset=28), lineno=1190, col_offset=28)], [], lineno=1189, col_offset=24), If(UnaryOp(Not(), Call(Attribute(Call(Name('str', Load(), lineno=1194, col_offset=31), [Name('e', Load(), lineno=1194, col_offset=35)], [], None, None, lineno=1194, col_offset=31), 'startswith', Load(), lineno=1194, col_offset=31), [Name('meth_name', Load(), lineno=1194, col_offset=49)], [], None, None, lineno=1194, col_offset=31), lineno=1194, col_offset=27), [Expr(Call(Attribute(Name('self', Load(), lineno=1195, col_offset=28), 'fail', Load(), lineno=1195, col_offset=28), [BinOp(Str('Method <<%s>> failed with unexpected exception message: %s\n', lineno=1196, col_offset=32), Mod(), Tuple([Name('meth_name', Load(), lineno=1198, col_offset=36), Name('e', Load(), lineno=1198, col_offset=47)], Load(), lineno=1198, col_offset=36), lineno=1196, col_offset=32)], [], None, None, lineno=1195, col_offset=28), lineno=1195, col_offset=28)], [], lineno=1194, col_offset=24)], lineno=1188, col_offset=20)], [], lineno=1175, col_offset=20)], [], lineno=1173, col_offset=16), For(Tuple([Name('meth_name', Store(), lineno=1202, col_offset=20), Name('recv_meth', Store(), lineno=1202, col_offset=31), Name('expect_success', Store(), lineno=1202, col_offset=42), Name('args', Store(), lineno=1202, col_offset=58)], Store(), lineno=1202, col_offset=20), Name('recv_methods', Load(), lineno=1202, col_offset=66), [Assign([Name('indata', Store(), lineno=1203, col_offset=20)], BinOp(Name('data_prefix', Load(), lineno=1203, col_offset=29), Add(), Name('meth_name', Load(), lineno=1203, col_offset=43), lineno=1203, col_offset=29), lineno=1203, col_offset=20), TryExcept([Expr(Call(Attribute(Name('s', Load(), lineno=1205, col_offset=24), 'send', Load(), lineno=1205, col_offset=24), [Call(Attribute(Name('indata', Load(), lineno=1205, col_offset=31), 'encode', Load(), lineno=1205, col_offset=31), [Str('ASCII', lineno=1205, col_offset=45), Str('strict', lineno=1205, col_offset=54)], [], None, None, lineno=1205, col_offset=31)], [], None, None, lineno=1205, col_offset=24), lineno=1205, col_offset=24), Assign([Name('outdata', Store(), lineno=1206, col_offset=24)], Call(Name('recv_meth', Load(), lineno=1206, col_offset=34), [], [], Name('args', Load(), lineno=1206, col_offset=45), None, lineno=1206, col_offset=34), lineno=1206, col_offset=24), Assign([Name('outdata', Store(), lineno=1207, col_offset=24)], Call(Attribute(Name('outdata', Load(), lineno=1207, col_offset=34), 'decode', Load(), lineno=1207, col_offset=34), [Str('ASCII', lineno=1207, col_offset=49), Str('strict', lineno=1207, col_offset=58)], [], None, None, lineno=1207, col_offset=34), lineno=1207, col_offset=24), If(Compare(Name('outdata', Load(), lineno=1208, col_offset=27), [NotEq()], [Call(Attribute(Name('indata', Load(), lineno=1208, col_offset=38), 'lower', Load(), lineno=1208, col_offset=38), [], [], None, None, lineno=1208, col_offset=38)], lineno=1208, col_offset=27), [Expr(Call(Attribute(Name('self', Load(), lineno=1209, col_offset=28), 'fail', Load(), lineno=1209, col_offset=28), [BinOp(Str('While receiving with <<%s>> bad data <<%r>> (%d) received; expected <<%r>> (%d)\n', lineno=1210, col_offset=32), Mod(), Tuple([Name('meth_name', Load(), lineno=1213, col_offset=36), Subscript(Name('outdata', Load(), lineno=1213, col_offset=47), Slice(None, Num(20, lineno=1213, col_offset=56), None), Load(), lineno=1213, col_offset=47), Call(Name('len', Load(), lineno=1213, col_offset=61), [Name('outdata', Load(), lineno=1213, col_offset=65)], [], None, None, lineno=1213, col_offset=61), Subscript(Name('indata', Load(), lineno=1214, col_offset=36), Slice(None, Num(20, lineno=1214, col_offset=44), None), Load(), lineno=1214, col_offset=36), Call(Name('len', Load(), lineno=1214, col_offset=49), [Name('indata', Load(), lineno=1214, col_offset=53)], [], None, None, lineno=1214, col_offset=49)], Load(), lineno=1213, col_offset=36), lineno=1210, col_offset=32)], [], None, None, lineno=1209, col_offset=28), lineno=1209, col_offset=28)], [], lineno=1208, col_offset=24)], [ExceptHandler(Name('ValueError', Load(), lineno=1217, col_offset=27), Name('e', Store(), lineno=1217, col_offset=41), [If(Name('expect_success', Load(), lineno=1218, col_offset=27), [Expr(Call(Attribute(Name('self', Load(), lineno=1219, col_offset=28), 'fail', Load(), lineno=1219, col_offset=28), [BinOp(Str('Failed to receive with method <<%s>>; expected to succeed.\n', lineno=1220, col_offset=32), Mod(), Tuple([Name('meth_name', Load(), lineno=1221, col_offset=60)], Load(), lineno=1221, col_offset=60), lineno=1220, col_offset=32)], [], None, None, lineno=1219, col_offset=28), lineno=1219, col_offset=28)], [], lineno=1218, col_offset=24), If(UnaryOp(Not(), Call(Attribute(Call(Name('str', Load(), lineno=1223, col_offset=31), [Name('e', Load(), lineno=1223, col_offset=35)], [], None, None, lineno=1223, col_offset=31), 'startswith', Load(), lineno=1223, col_offset=31), [Name('meth_name', Load(), lineno=1223, col_offset=49)], [], None, None, lineno=1223, col_offset=31), lineno=1223, col_offset=27), [Expr(Call(Attribute(Name('self', Load(), lineno=1224, col_offset=28), 'fail', Load(), lineno=1224, col_offset=28), [BinOp(Str('Method <<%s>> failed with unexpected exception message: %s\n', lineno=1225, col_offset=32), Mod(), Tuple([Name('meth_name', Load(), lineno=1227, col_offset=36), Name('e', Load(), lineno=1227, col_offset=47)], Load(), lineno=1227, col_offset=36), lineno=1225, col_offset=32)], [], None, None, lineno=1224, col_offset=28), lineno=1224, col_offset=28)], [], lineno=1223, col_offset=24), Expr(Call(Attribute(Name('s', Load(), lineno=1231, col_offset=24), 'read', Load(), lineno=1231, col_offset=24), [], [], None, None, lineno=1231, col_offset=24), lineno=1231, col_offset=24)], lineno=1217, col_offset=20)], [], lineno=1204, col_offset=20)], [], lineno=1202, col_offset=16), Expr(Call(Attribute(Name('s', Load(), lineno=1233, col_offset=16), 'write', Load(), lineno=1233, col_offset=16), [Call(Attribute(Str('over\n', lineno=1233, col_offset=24), 'encode', Load(), lineno=1233, col_offset=24), [Str('ASCII', lineno=1233, col_offset=40), Str('strict', lineno=1233, col_offset=49)], [], None, None, lineno=1233, col_offset=24)], [], None, None, lineno=1233, col_offset=16), lineno=1233, col_offset=16), Expr(Call(Attribute(Name('s', Load(), lineno=1234, col_offset=16), 'close', Load(), lineno=1234, col_offset=16), [], [], None, None, lineno=1234, col_offset=16), lineno=1234, col_offset=16)], [Expr(Call(Attribute(Name('server', Load(), lineno=1236, col_offset=16), 'stop', Load(), lineno=1236, col_offset=16), [], [], None, None, lineno=1236, col_offset=16), lineno=1236, col_offset=16), Expr(Call(Attribute(Name('server', Load(), lineno=1237, col_offset=16), 'join', Load(), lineno=1237, col_offset=16), [], [], None, None, lineno=1237, col_offset=16), lineno=1237, col_offset=16)], lineno=1147, col_offset=12)], [], lineno=1124, col_offset=8), FunctionDef('test_handshake_timeout', arguments([Name('self', Param(), lineno=1239, col_offset=35)], None, None, []), [Assign([Name('server', Store(), lineno=1241, col_offset=12)], Call(Attribute(Name('socket', Load(), lineno=1241, col_offset=21), 'socket', Load(), lineno=1241, col_offset=21), [Attribute(Name('socket', Load(), lineno=1241, col_offset=35), 'AF_INET', Load(), lineno=1241, col_offset=35)], [], None, None, lineno=1241, col_offset=21), lineno=1241, col_offset=12), Assign([Name('host', Store(), lineno=1242, col_offset=12)], Str('127.0.0.1', lineno=1242, col_offset=19), lineno=1242, col_offset=12), Assign([Name('port', Store(), lineno=1243, col_offset=12)], Call(Attribute(Name('test_support', Load(), lineno=1243, col_offset=19), 'bind_port', Load(), lineno=1243, col_offset=19), [Name('server', Load(), lineno=1243, col_offset=42)], [], None, None, lineno=1243, col_offset=19), lineno=1243, col_offset=12), Assign([Name('started', Store(), lineno=1244, col_offset=12)], Call(Attribute(Name('threading', Load(), lineno=1244, col_offset=22), 'Event', Load(), lineno=1244, col_offset=22), [], [], None, None, lineno=1244, col_offset=22), lineno=1244, col_offset=12), Assign([Name('finish', Store(), lineno=1245, col_offset=12)], Name('False', Load(), lineno=1245, col_offset=21), lineno=1245, col_offset=12), FunctionDef('serve', arguments([], None, None, []), [Expr(Call(Attribute(Name('server', Load(), lineno=1248, col_offset=16), 'listen', Load(), lineno=1248, col_offset=16), [Num(5, lineno=1248, col_offset=30)], [], None, None, lineno=1248, col_offset=16), lineno=1248, col_offset=16), Expr(Call(Attribute(Name('started', Load(), lineno=1249, col_offset=16), 'set', Load(), lineno=1249, col_offset=16), [], [], None, None, lineno=1249, col_offset=16), lineno=1249, col_offset=16), Assign([Name('conns', Store(), lineno=1250, col_offset=16)], List([], Load(), lineno=1250, col_offset=24), lineno=1250, col_offset=16), While(UnaryOp(Not(), Name('finish', Load(), lineno=1251, col_offset=26), lineno=1251, col_offset=22), [Assign([Tuple([Name('r', Store(), lineno=1252, col_offset=20), Name('w', Store(), lineno=1252, col_offset=23), Name('e', Store(), lineno=1252, col_offset=26)], Store(), lineno=1252, col_offset=20)], Call(Attribute(Name('select', Load(), lineno=1252, col_offset=30), 'select', Load(), lineno=1252, col_offset=30), [List([Name('server', Load(), lineno=1252, col_offset=45)], Load(), lineno=1252, col_offset=44), List([], Load(), lineno=1252, col_offset=54), List([], Load(), lineno=1252, col_offset=58), Num(0.1, lineno=1252, col_offset=62)], [], None, None, lineno=1252, col_offset=30), lineno=1252, col_offset=20), If(Compare(Name('server', Load(), lineno=1253, col_offset=23), [In()], [Name('r', Load(), lineno=1253, col_offset=33)], lineno=1253, col_offset=23), [Expr(Call(Attribute(Name('conns', Load(), lineno=1256, col_offset=24), 'append', Load(), lineno=1256, col_offset=24), [Subscript(Call(Attribute(Name('server', Load(), lineno=1256, col_offset=37), 'accept', Load(), lineno=1256, col_offset=37), [], [], None, None, lineno=1256, col_offset=37), Index(Num(0, lineno=1256, col_offset=53)), Load(), lineno=1256, col_offset=37)], [], None, None, lineno=1256, col_offset=24), lineno=1256, col_offset=24)], [], lineno=1253, col_offset=20)], [], lineno=1251, col_offset=16)], [], lineno=1247, col_offset=12), Assign([Name('t', Store(), lineno=1258, col_offset=12)], Call(Attribute(Name('threading', Load(), lineno=1258, col_offset=16), 'Thread', Load(), lineno=1258, col_offset=16), [], [keyword('target', Name('serve', Load(), lineno=1258, col_offset=40))], None, None, lineno=1258, col_offset=16), lineno=1258, col_offset=12), Expr(Call(Attribute(Name('t', Load(), lineno=1259, col_offset=12), 'start', Load(), lineno=1259, col_offset=12), [], [], None, None, lineno=1259, col_offset=12), lineno=1259, col_offset=12), Expr(Call(Attribute(Name('started', Load(), lineno=1260, col_offset=12), 'wait', Load(), lineno=1260, col_offset=12), [], [], None, None, lineno=1260, col_offset=12), lineno=1260, col_offset=12), TryFinally([TryFinally([Assign([Name('c', Store(), lineno=1264, col_offset=20)], Call(Attribute(Name('socket', Load(), lineno=1264, col_offset=24), 'socket', Load(), lineno=1264, col_offset=24), [Attribute(Name('socket', Load(), lineno=1264, col_offset=38), 'AF_INET', Load(), lineno=1264, col_offset=38)], [], None, None, lineno=1264, col_offset=24), lineno=1264, col_offset=20), Expr(Call(Attribute(Name('c', Load(), lineno=1265, col_offset=20), 'settimeout', Load(), lineno=1265, col_offset=20), [Num(0.2, lineno=1265, col_offset=33)], [], None, None, lineno=1265, col_offset=20), lineno=1265, col_offset=20), Expr(Call(Attribute(Name('c', Load(), lineno=1266, col_offset=20), 'connect', Load(), lineno=1266, col_offset=20), [Tuple([Name('host', Load(), lineno=1266, col_offset=31), Name('port', Load(), lineno=1266, col_offset=37)], Load(), lineno=1266, col_offset=31)], [], None, None, lineno=1266, col_offset=20), lineno=1266, col_offset=20), Expr(Call(Attribute(Name('self', Load(), lineno=1268, col_offset=20), 'assertRaisesRegexp', Load(), lineno=1268, col_offset=20), [Attribute(Name('ssl', Load(), lineno=1268, col_offset=44), 'SSLError', Load(), lineno=1268, col_offset=44), Str('timed out', lineno=1268, col_offset=58), Attribute(Name('ssl', Load(), lineno=1269, col_offset=44), 'wrap_socket', Load(), lineno=1269, col_offset=44), Name('c', Load(), lineno=1269, col_offset=61)], [], None, None, lineno=1268, col_offset=20), lineno=1268, col_offset=20)], [Expr(Call(Attribute(Name('c', Load(), lineno=1271, col_offset=20), 'close', Load(), lineno=1271, col_offset=20), [], [], None, None, lineno=1271, col_offset=20), lineno=1271, col_offset=20)], lineno=1263, col_offset=16), TryFinally([Assign([Name('c', Store(), lineno=1273, col_offset=20)], Call(Attribute(Name('socket', Load(), lineno=1273, col_offset=24), 'socket', Load(), lineno=1273, col_offset=24), [Attribute(Name('socket', Load(), lineno=1273, col_offset=38), 'AF_INET', Load(), lineno=1273, col_offset=38)], [], None, None, lineno=1273, col_offset=24), lineno=1273, col_offset=20), Expr(Call(Attribute(Name('c', Load(), lineno=1274, col_offset=20), 'settimeout', Load(), lineno=1274, col_offset=20), [Num(0.2, lineno=1274, col_offset=33)], [], None, None, lineno=1274, col_offset=20), lineno=1274, col_offset=20), Assign([Name('c', Store(), lineno=1275, col_offset=20)], Call(Attribute(Name('ssl', Load(), lineno=1275, col_offset=24), 'wrap_socket', Load(), lineno=1275, col_offset=24), [Name('c', Load(), lineno=1275, col_offset=40)], [], None, None, lineno=1275, col_offset=24), lineno=1275, col_offset=20), Expr(Call(Attribute(Name('self', Load(), lineno=1277, col_offset=20), 'assertRaisesRegexp', Load(), lineno=1277, col_offset=20), [Attribute(Name('ssl', Load(), lineno=1277, col_offset=44), 'SSLError', Load(), lineno=1277, col_offset=44), Str('timed out', lineno=1277, col_offset=58), Attribute(Name('c', Load(), lineno=1278, col_offset=44), 'connect', Load(), lineno=1278, col_offset=44), Tuple([Name('host', Load(), lineno=1278, col_offset=56), Name('port', Load(), lineno=1278, col_offset=62)], Load(), lineno=1278, col_offset=56)], [], None, None, lineno=1277, col_offset=20), lineno=1277, col_offset=20)], [Expr(Call(Attribute(Name('c', Load(), lineno=1280, col_offset=20), 'close', Load(), lineno=1280, col_offset=20), [], [], None, None, lineno=1280, col_offset=20), lineno=1280, col_offset=20)], lineno=1272, col_offset=16)], [Assign([Name('finish', Store(), lineno=1282, col_offset=16)], Name('True', Load(), lineno=1282, col_offset=25), lineno=1282, col_offset=16), Expr(Call(Attribute(Name('t', Load(), lineno=1283, col_offset=16), 'join', Load(), lineno=1283, col_offset=16), [], [], None, None, lineno=1283, col_offset=16), lineno=1283, col_offset=16), Expr(Call(Attribute(Name('server', Load(), lineno=1284, col_offset=16), 'close', Load(), lineno=1284, col_offset=16), [], [], None, None, lineno=1284, col_offset=16), lineno=1284, col_offset=16)], lineno=1262, col_offset=12)], [], lineno=1239, col_offset=8)], [], lineno=814, col_offset=4)], lineno=317, col_offset=0), FunctionDef('test_main', arguments([Name('verbose', Param(), lineno=1287, col_offset=14)], None, None, [Name('False', Load(), lineno=1287, col_offset=22)]), [If(Name('skip_expected', Load(), lineno=1288, col_offset=7), [Raise(Call(Attribute(Name('unittest', Load(), lineno=1289, col_offset=14), 'SkipTest', Load(), lineno=1289, col_offset=14), [Str('No SSL support', lineno=1289, col_offset=32)], [], None, None, lineno=1289, col_offset=14), None, None, lineno=1289, col_offset=8)], [], lineno=1288, col_offset=4), Global(['CERTFILE', 'SVN_PYTHON_ORG_ROOT_CERT'], lineno=1291, col_offset=4), Assign([Name('CERTFILE', Store(), lineno=1292, col_offset=4)], Call(Attribute(Attribute(Name('os', Load(), lineno=1292, col_offset=15), 'path', Load(), lineno=1292, col_offset=15), 'join', Load(), lineno=1292, col_offset=15), [BoolOp(Or(), [Call(Attribute(Attribute(Name('os', Load(), lineno=1292, col_offset=28), 'path', Load(), lineno=1292, col_offset=28), 'dirname', Load(), lineno=1292, col_offset=28), [Name('__file__', Load(), lineno=1292, col_offset=44)], [], None, None, lineno=1292, col_offset=28), Attribute(Name('os', Load(), lineno=1292, col_offset=57), 'curdir', Load(), lineno=1292, col_offset=57)], lineno=1292, col_offset=28), Str('keycert.pem', lineno=1293, col_offset=28)], [], None, None, lineno=1292, col_offset=15), lineno=1292, col_offset=4), Assign([Name('SVN_PYTHON_ORG_ROOT_CERT', Store(), lineno=1294, col_offset=4)], Call(Attribute(Attribute(Name('os', Load(), lineno=1294, col_offset=31), 'path', Load(), lineno=1294, col_offset=31), 'join', Load(), lineno=1294, col_offset=31), [BoolOp(Or(), [Call(Attribute(Attribute(Name('os', Load(), lineno=1295, col_offset=8), 'path', Load(), lineno=1295, col_offset=8), 'dirname', Load(), lineno=1295, col_offset=8), [Name('__file__', Load(), lineno=1295, col_offset=24)], [], None, None, lineno=1295, col_offset=8), Attribute(Name('os', Load(), lineno=1295, col_offset=37), 'curdir', Load(), lineno=1295, col_offset=37)], lineno=1295, col_offset=8), Str('https_svn_python_org_root.pem', lineno=1296, col_offset=8)], [], None, None, lineno=1294, col_offset=31), lineno=1294, col_offset=4), If(BoolOp(Or(), [UnaryOp(Not(), Call(Attribute(Attribute(Name('os', Load(), lineno=1298, col_offset=12), 'path', Load(), lineno=1298, col_offset=12), 'exists', Load(), lineno=1298, col_offset=12), [Name('CERTFILE', Load(), lineno=1298, col_offset=27)], [], None, None, lineno=1298, col_offset=12), lineno=1298, col_offset=8), UnaryOp(Not(), Call(Attribute(Attribute(Name('os', Load(), lineno=1299, col_offset=12), 'path', Load(), lineno=1299, col_offset=12), 'exists', Load(), lineno=1299, col_offset=12), [Name('SVN_PYTHON_ORG_ROOT_CERT', Load(), lineno=1299, col_offset=27)], [], None, None, lineno=1299, col_offset=12), lineno=1299, col_offset=8)], lineno=1298, col_offset=8), [Raise(Call(Attribute(Name('test_support', Load(), lineno=1300, col_offset=14), 'TestFailed', Load(), lineno=1300, col_offset=14), [Str("Can't read certificate files!", lineno=1300, col_offset=38)], [], None, None, lineno=1300, col_offset=14), None, None, lineno=1300, col_offset=8)], [], lineno=1298, col_offset=4), Assign([Name('tests', Store(), lineno=1302, col_offset=4)], List([Name('BasicTests', Load(), lineno=1302, col_offset=13), Name('BasicSocketTests', Load(), lineno=1302, col_offset=25)], Load(), lineno=1302, col_offset=12), lineno=1302, col_offset=4), If(Call(Attribute(Name('test_support', Load(), lineno=1304, col_offset=7), 'is_resource_enabled', Load(), lineno=1304, col_offset=7), [Str('network', lineno=1304, col_offset=40)], [], None, None, lineno=1304, col_offset=7), [Expr(Call(Attribute(Name('tests', Load(), lineno=1305, col_offset=8), 'append', Load(), lineno=1305, col_offset=8), [Name('NetworkedTests', Load(), lineno=1305, col_offset=21)], [], None, None, lineno=1305, col_offset=8), lineno=1305, col_offset=8)], [], lineno=1304, col_offset=4), If(Name('_have_threads', Load(), lineno=1307, col_offset=7), [Assign([Name('thread_info', Store(), lineno=1308, col_offset=8)], Call(Attribute(Name('test_support', Load(), lineno=1308, col_offset=22), 'threading_setup', Load(), lineno=1308, col_offset=22), [], [], None, None, lineno=1308, col_offset=22), lineno=1308, col_offset=8), If(BoolOp(And(), [Name('thread_info', Load(), lineno=1309, col_offset=11), Call(Attribute(Name('test_support', Load(), lineno=1309, col_offset=27), 'is_resource_enabled', Load(), lineno=1309, col_offset=27), [Str('network', lineno=1309, col_offset=60)], [], None, None, lineno=1309, col_offset=27)], lineno=1309, col_offset=11), [Expr(Call(Attribute(Name('tests', Load(), lineno=1310, col_offset=12), 'append', Load(), lineno=1310, col_offset=12), [Name('ThreadedTests', Load(), lineno=1310, col_offset=25)], [], None, None, lineno=1310, col_offset=12), lineno=1310, col_offset=12)], [], lineno=1309, col_offset=8)], [], lineno=1307, col_offset=4), TryFinally([Expr(Call(Attribute(Name('test_support', Load(), lineno=1313, col_offset=8), 'run_unittest', Load(), lineno=1313, col_offset=8), [], [], Name('tests', Load(), lineno=1313, col_offset=35), None, lineno=1313, col_offset=8), lineno=1313, col_offset=8)], [If(Name('_have_threads', Load(), lineno=1315, col_offset=11), [Expr(Call(Attribute(Name('test_support', Load(), lineno=1316, col_offset=12), 'threading_cleanup', Load(), lineno=1316, col_offset=12), [], [], Name('thread_info', Load(), lineno=1316, col_offset=44), None, lineno=1316, col_offset=12), lineno=1316, col_offset=12)], [], lineno=1315, col_offset=8)], lineno=1312, col_offset=4)], [], lineno=1287, col_offset=0), If(Compare(Name('__name__', Load(), lineno=1318, col_offset=3), [Eq()], [Str('__main__', lineno=1318, col_offset=15)], lineno=1318, col_offset=3), [Expr(Call(Name('test_main', Load(), lineno=1319, col_offset=4), [], [], None, None, lineno=1319, col_offset=4), lineno=1319, col_offset=4)], [], lineno=1318, col_offset=0)])
