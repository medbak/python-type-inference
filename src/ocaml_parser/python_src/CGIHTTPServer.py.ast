Module([Expr(Str("CGI-savvy HTTP Server.\n\nThis module builds on SimpleHTTPServer by implementing GET and POST\nrequests to cgi-bin scripts.\n\nIf the os.fork() function is not present (e.g. on Windows),\nos.popen2() is used as a fallback, with slightly altered semantics; if\nthat function is not present either (e.g. on Macintosh), only Python\nscripts are supported, and they are executed by the current process.\n\nIn all cases, the implementation is intentionally naive -- all\nrequests are executed sychronously.\n\nSECURITY WARNING: DON'T USE THIS CODE UNLESS YOU ARE INSIDE A FIREWALL\n-- it may execute arbitrary Python code or external programs.\n\nNote that status code 200 is sent prior to execution of a CGI script, so\nscripts cannot send other status codes such as 302 (redirect).\n", lineno=19, col_offset=-1), lineno=19, col_offset=-1), Assign([Name('__version__', Store(), lineno=22, col_offset=0)], Str('0.4', lineno=22, col_offset=14), lineno=22, col_offset=0), Assign([Name('__all__', Store(), lineno=24, col_offset=0)], List([Str('CGIHTTPRequestHandler', lineno=24, col_offset=11)], Load(), lineno=24, col_offset=10), lineno=24, col_offset=0), Import([alias('os', None)], lineno=26, col_offset=0), Import([alias('sys', None)], lineno=27, col_offset=0), Import([alias('urllib', None)], lineno=28, col_offset=0), Import([alias('BaseHTTPServer', None)], lineno=29, col_offset=0), Import([alias('SimpleHTTPServer', None)], lineno=30, col_offset=0), Import([alias('select', None)], lineno=31, col_offset=0), Import([alias('copy', None)], lineno=32, col_offset=0), ClassDef('CGIHTTPRequestHandler', [Attribute(Name('SimpleHTTPServer', Load(), lineno=35, col_offset=28), 'SimpleHTTPRequestHandler', Load(), lineno=35, col_offset=28)], [Expr(Str('Complete HTTP server with GET, HEAD and POST commands.\n\n    GET and HEAD also support running CGI scripts.\n\n    The POST command is *only* implemented for CGI scripts.\n\n    ', lineno=43, col_offset=-1), lineno=43, col_offset=-1), Assign([Name('have_fork', Store(), lineno=46, col_offset=4)], Call(Name('hasattr', Load(), lineno=46, col_offset=16), [Name('os', Load(), lineno=46, col_offset=24), Str('fork', lineno=46, col_offset=28)], [], None, None, lineno=46, col_offset=16), lineno=46, col_offset=4), Assign([Name('have_popen2', Store(), lineno=47, col_offset=4)], Call(Name('hasattr', Load(), lineno=47, col_offset=18), [Name('os', Load(), lineno=47, col_offset=26), Str('popen2', lineno=47, col_offset=30)], [], None, None, lineno=47, col_offset=18), lineno=47, col_offset=4), Assign([Name('have_popen3', Store(), lineno=48, col_offset=4)], Call(Name('hasattr', Load(), lineno=48, col_offset=18), [Name('os', Load(), lineno=48, col_offset=26), Str('popen3', lineno=48, col_offset=30)], [], None, None, lineno=48, col_offset=18), lineno=48, col_offset=4), Assign([Name('rbufsize', Store(), lineno=52, col_offset=4)], Num(0, lineno=52, col_offset=15), lineno=52, col_offset=4), FunctionDef('do_POST', arguments([Name('self', Param(), lineno=54, col_offset=16)], None, None, []), [Expr(Str('Serve a POST request.\n\n        This is only implemented for CGI scripts.\n\n        ', lineno=59, col_offset=-1), lineno=59, col_offset=-1), If(Call(Attribute(Name('self', Load(), lineno=61, col_offset=11), 'is_cgi', Load(), lineno=61, col_offset=11), [], [], None, None, lineno=61, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=62, col_offset=12), 'run_cgi', Load(), lineno=62, col_offset=12), [], [], None, None, lineno=62, col_offset=12), lineno=62, col_offset=12)], [Expr(Call(Attribute(Name('self', Load(), lineno=64, col_offset=12), 'send_error', Load(), lineno=64, col_offset=12), [Num(501, lineno=64, col_offset=28), Str('Can only POST to CGI scripts', lineno=64, col_offset=33)], [], None, None, lineno=64, col_offset=12), lineno=64, col_offset=12)], lineno=61, col_offset=8)], [], lineno=54, col_offset=4), FunctionDef('send_head', arguments([Name('self', Param(), lineno=66, col_offset=18)], None, None, []), [Expr(Str('Version of send_head that support CGI scripts', lineno=67, col_offset=8), lineno=67, col_offset=8), If(Call(Attribute(Name('self', Load(), lineno=68, col_offset=11), 'is_cgi', Load(), lineno=68, col_offset=11), [], [], None, None, lineno=68, col_offset=11), [Return(Call(Attribute(Name('self', Load(), lineno=69, col_offset=19), 'run_cgi', Load(), lineno=69, col_offset=19), [], [], None, None, lineno=69, col_offset=19), lineno=69, col_offset=12)], [Return(Call(Attribute(Attribute(Name('SimpleHTTPServer', Load(), lineno=71, col_offset=19), 'SimpleHTTPRequestHandler', Load(), lineno=71, col_offset=19), 'send_head', Load(), lineno=71, col_offset=19), [Name('self', Load(), lineno=71, col_offset=71)], [], None, None, lineno=71, col_offset=19), lineno=71, col_offset=12)], lineno=68, col_offset=8)], [], lineno=66, col_offset=4), FunctionDef('is_cgi', arguments([Name('self', Param(), lineno=73, col_offset=15)], None, None, []), [Expr(Str("Test whether self.path corresponds to a CGI script.\n\n        Returns True and updates the cgi_info attribute to the tuple\n        (dir, rest) if self.path requires running a CGI script.\n        Returns False otherwise.\n\n        If any exception is raised, the caller should assume that\n        self.path was rejected as invalid and act accordingly.\n\n        The default implementation tests whether the normalized url\n        path begins with one of the strings in self.cgi_directories\n        (and the next character is a '/' or the end of the string).\n        ", lineno=86, col_offset=-1), lineno=86, col_offset=-1), Assign([Name('splitpath', Store(), lineno=87, col_offset=8)], Call(Name('_url_collapse_path_split', Load(), lineno=87, col_offset=20), [Attribute(Name('self', Load(), lineno=87, col_offset=45), 'path', Load(), lineno=87, col_offset=45)], [], None, None, lineno=87, col_offset=20), lineno=87, col_offset=8), If(Compare(Subscript(Name('splitpath', Load(), lineno=88, col_offset=11), Index(Num(0, lineno=88, col_offset=21)), Load(), lineno=88, col_offset=11), [In()], [Attribute(Name('self', Load(), lineno=88, col_offset=27), 'cgi_directories', Load(), lineno=88, col_offset=27)], lineno=88, col_offset=11), [Assign([Attribute(Name('self', Load(), lineno=89, col_offset=12), 'cgi_info', Store(), lineno=89, col_offset=12)], Name('splitpath', Load(), lineno=89, col_offset=28), lineno=89, col_offset=12), Return(Name('True', Load(), lineno=90, col_offset=19), lineno=90, col_offset=12)], [], lineno=88, col_offset=8), Return(Name('False', Load(), lineno=91, col_offset=15), lineno=91, col_offset=8)], [], lineno=73, col_offset=4), Assign([Name('cgi_directories', Store(), lineno=93, col_offset=4)], List([Str('/cgi-bin', lineno=93, col_offset=23), Str('/htbin', lineno=93, col_offset=35)], Load(), lineno=93, col_offset=22), lineno=93, col_offset=4), FunctionDef('is_executable', arguments([Name('self', Param(), lineno=95, col_offset=22), Name('path', Param(), lineno=95, col_offset=28)], None, None, []), [Expr(Str('Test whether argument path is an executable file.', lineno=96, col_offset=8), lineno=96, col_offset=8), Return(Call(Name('executable', Load(), lineno=97, col_offset=15), [Name('path', Load(), lineno=97, col_offset=26)], [], None, None, lineno=97, col_offset=15), lineno=97, col_offset=8)], [], lineno=95, col_offset=4), FunctionDef('is_python', arguments([Name('self', Param(), lineno=99, col_offset=18), Name('path', Param(), lineno=99, col_offset=24)], None, None, []), [Expr(Str('Test whether argument path is a Python script.', lineno=100, col_offset=8), lineno=100, col_offset=8), Assign([Tuple([Name('head', Store(), lineno=101, col_offset=8), Name('tail', Store(), lineno=101, col_offset=14)], Store(), lineno=101, col_offset=8)], Call(Attribute(Attribute(Name('os', Load(), lineno=101, col_offset=21), 'path', Load(), lineno=101, col_offset=21), 'splitext', Load(), lineno=101, col_offset=21), [Name('path', Load(), lineno=101, col_offset=38)], [], None, None, lineno=101, col_offset=21), lineno=101, col_offset=8), Return(Compare(Call(Attribute(Name('tail', Load(), lineno=102, col_offset=15), 'lower', Load(), lineno=102, col_offset=15), [], [], None, None, lineno=102, col_offset=15), [In()], [Tuple([Str('.py', lineno=102, col_offset=32), Str('.pyw', lineno=102, col_offset=39)], Load(), lineno=102, col_offset=32)], lineno=102, col_offset=15), lineno=102, col_offset=8)], [], lineno=99, col_offset=4), FunctionDef('run_cgi', arguments([Name('self', Param(), lineno=104, col_offset=16)], None, None, []), [Expr(Str('Execute a CGI script.', lineno=105, col_offset=8), lineno=105, col_offset=8), Assign([Name('path', Store(), lineno=106, col_offset=8)], Attribute(Name('self', Load(), lineno=106, col_offset=15), 'path', Load(), lineno=106, col_offset=15), lineno=106, col_offset=8), Assign([Tuple([Name('dir', Store(), lineno=107, col_offset=8), Name('rest', Store(), lineno=107, col_offset=13)], Store(), lineno=107, col_offset=8)], Attribute(Name('self', Load(), lineno=107, col_offset=20), 'cgi_info', Load(), lineno=107, col_offset=20), lineno=107, col_offset=8), Assign([Name('i', Store(), lineno=109, col_offset=8)], Call(Attribute(Name('path', Load(), lineno=109, col_offset=12), 'find', Load(), lineno=109, col_offset=12), [Str('/', lineno=109, col_offset=22), BinOp(Call(Name('len', Load(), lineno=109, col_offset=27), [Name('dir', Load(), lineno=109, col_offset=31)], [], None, None, lineno=109, col_offset=27), Add(), Num(1, lineno=109, col_offset=38), lineno=109, col_offset=27)], [], None, None, lineno=109, col_offset=12), lineno=109, col_offset=8), While(Compare(Name('i', Load(), lineno=110, col_offset=14), [GtE()], [Num(0, lineno=110, col_offset=19)], lineno=110, col_offset=14), [Assign([Name('nextdir', Store(), lineno=111, col_offset=12)], Subscript(Name('path', Load(), lineno=111, col_offset=22), Slice(None, Name('i', Load(), lineno=111, col_offset=28), None), Load(), lineno=111, col_offset=22), lineno=111, col_offset=12), Assign([Name('nextrest', Store(), lineno=112, col_offset=12)], Subscript(Name('path', Load(), lineno=112, col_offset=23), Slice(BinOp(Name('i', Load(), lineno=112, col_offset=28), Add(), Num(1, lineno=112, col_offset=30), lineno=112, col_offset=28), None, None), Load(), lineno=112, col_offset=23), lineno=112, col_offset=12), Assign([Name('scriptdir', Store(), lineno=114, col_offset=12)], Call(Attribute(Name('self', Load(), lineno=114, col_offset=24), 'translate_path', Load(), lineno=114, col_offset=24), [Name('nextdir', Load(), lineno=114, col_offset=44)], [], None, None, lineno=114, col_offset=24), lineno=114, col_offset=12), If(Call(Attribute(Attribute(Name('os', Load(), lineno=115, col_offset=15), 'path', Load(), lineno=115, col_offset=15), 'isdir', Load(), lineno=115, col_offset=15), [Name('scriptdir', Load(), lineno=115, col_offset=29)], [], None, None, lineno=115, col_offset=15), [Assign([Tuple([Name('dir', Store(), lineno=116, col_offset=16), Name('rest', Store(), lineno=116, col_offset=21)], Store(), lineno=116, col_offset=16)], Tuple([Name('nextdir', Load(), lineno=116, col_offset=28), Name('nextrest', Load(), lineno=116, col_offset=37)], Load(), lineno=116, col_offset=28), lineno=116, col_offset=16), Assign([Name('i', Store(), lineno=117, col_offset=16)], Call(Attribute(Name('path', Load(), lineno=117, col_offset=20), 'find', Load(), lineno=117, col_offset=20), [Str('/', lineno=117, col_offset=30), BinOp(Call(Name('len', Load(), lineno=117, col_offset=35), [Name('dir', Load(), lineno=117, col_offset=39)], [], None, None, lineno=117, col_offset=35), Add(), Num(1, lineno=117, col_offset=46), lineno=117, col_offset=35)], [], None, None, lineno=117, col_offset=20), lineno=117, col_offset=16)], [Break( lineno=119, col_offset=16)], lineno=115, col_offset=12)], [], lineno=110, col_offset=8), Assign([Name('i', Store(), lineno=122, col_offset=8)], Call(Attribute(Name('rest', Load(), lineno=122, col_offset=12), 'rfind', Load(), lineno=122, col_offset=12), [Str('?', lineno=122, col_offset=23)], [], None, None, lineno=122, col_offset=12), lineno=122, col_offset=8), If(Compare(Name('i', Load(), lineno=123, col_offset=11), [GtE()], [Num(0, lineno=123, col_offset=16)], lineno=123, col_offset=11), [Assign([Tuple([Name('rest', Store(), lineno=124, col_offset=12), Name('query', Store(), lineno=124, col_offset=18)], Store(), lineno=124, col_offset=12)], Tuple([Subscript(Name('rest', Load(), lineno=124, col_offset=26), Slice(None, Name('i', Load(), lineno=124, col_offset=32), None), Load(), lineno=124, col_offset=26), Subscript(Name('rest', Load(), lineno=124, col_offset=36), Slice(BinOp(Name('i', Load(), lineno=124, col_offset=41), Add(), Num(1, lineno=124, col_offset=43), lineno=124, col_offset=41), None, None), Load(), lineno=124, col_offset=36)], Load(), lineno=124, col_offset=26), lineno=124, col_offset=12)], [Assign([Name('query', Store(), lineno=126, col_offset=12)], Str('', lineno=126, col_offset=20), lineno=126, col_offset=12)], lineno=123, col_offset=8), Assign([Name('i', Store(), lineno=130, col_offset=8)], Call(Attribute(Name('rest', Load(), lineno=130, col_offset=12), 'find', Load(), lineno=130, col_offset=12), [Str('/', lineno=130, col_offset=22)], [], None, None, lineno=130, col_offset=12), lineno=130, col_offset=8), If(Compare(Name('i', Load(), lineno=131, col_offset=11), [GtE()], [Num(0, lineno=131, col_offset=16)], lineno=131, col_offset=11), [Assign([Tuple([Name('script', Store(), lineno=132, col_offset=12), Name('rest', Store(), lineno=132, col_offset=20)], Store(), lineno=132, col_offset=12)], Tuple([Subscript(Name('rest', Load(), lineno=132, col_offset=27), Slice(None, Name('i', Load(), lineno=132, col_offset=33), None), Load(), lineno=132, col_offset=27), Subscript(Name('rest', Load(), lineno=132, col_offset=37), Slice(Name('i', Load(), lineno=132, col_offset=42), None, None), Load(), lineno=132, col_offset=37)], Load(), lineno=132, col_offset=27), lineno=132, col_offset=12)], [Assign([Tuple([Name('script', Store(), lineno=134, col_offset=12), Name('rest', Store(), lineno=134, col_offset=20)], Store(), lineno=134, col_offset=12)], Tuple([Name('rest', Load(), lineno=134, col_offset=27), Str('', lineno=134, col_offset=33)], Load(), lineno=134, col_offset=27), lineno=134, col_offset=12)], lineno=131, col_offset=8), Assign([Name('scriptname', Store(), lineno=136, col_offset=8)], BinOp(BinOp(Name('dir', Load(), lineno=136, col_offset=21), Add(), Str('/', lineno=136, col_offset=27), lineno=136, col_offset=21), Add(), Name('script', Load(), lineno=136, col_offset=33), lineno=136, col_offset=31), lineno=136, col_offset=8), Assign([Name('scriptfile', Store(), lineno=137, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=137, col_offset=21), 'translate_path', Load(), lineno=137, col_offset=21), [Name('scriptname', Load(), lineno=137, col_offset=41)], [], None, None, lineno=137, col_offset=21), lineno=137, col_offset=8), If(UnaryOp(Not(), Call(Attribute(Attribute(Name('os', Load(), lineno=138, col_offset=15), 'path', Load(), lineno=138, col_offset=15), 'exists', Load(), lineno=138, col_offset=15), [Name('scriptfile', Load(), lineno=138, col_offset=30)], [], None, None, lineno=138, col_offset=15), lineno=138, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=139, col_offset=12), 'send_error', Load(), lineno=139, col_offset=12), [Num(404, lineno=139, col_offset=28), BinOp(Str('No such CGI script (%r)', lineno=139, col_offset=33), Mod(), Name('scriptname', Load(), lineno=139, col_offset=61), lineno=139, col_offset=33)], [], None, None, lineno=139, col_offset=12), lineno=139, col_offset=12), Return(None, lineno=140, col_offset=12)], [], lineno=138, col_offset=8), If(UnaryOp(Not(), Call(Attribute(Attribute(Name('os', Load(), lineno=141, col_offset=15), 'path', Load(), lineno=141, col_offset=15), 'isfile', Load(), lineno=141, col_offset=15), [Name('scriptfile', Load(), lineno=141, col_offset=30)], [], None, None, lineno=141, col_offset=15), lineno=141, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=142, col_offset=12), 'send_error', Load(), lineno=142, col_offset=12), [Num(403, lineno=142, col_offset=28), BinOp(Str('CGI script is not a plain file (%r)', lineno=142, col_offset=33), Mod(), Name('scriptname', Load(), lineno=143, col_offset=28), lineno=142, col_offset=33)], [], None, None, lineno=142, col_offset=12), lineno=142, col_offset=12), Return(None, lineno=144, col_offset=12)], [], lineno=141, col_offset=8), Assign([Name('ispy', Store(), lineno=145, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=145, col_offset=15), 'is_python', Load(), lineno=145, col_offset=15), [Name('scriptname', Load(), lineno=145, col_offset=30)], [], None, None, lineno=145, col_offset=15), lineno=145, col_offset=8), If(UnaryOp(Not(), Name('ispy', Load(), lineno=146, col_offset=15), lineno=146, col_offset=11), [If(UnaryOp(Not(), BoolOp(Or(), [Attribute(Name('self', Load(), lineno=147, col_offset=20), 'have_fork', Load(), lineno=147, col_offset=20), Attribute(Name('self', Load(), lineno=147, col_offset=38), 'have_popen2', Load(), lineno=147, col_offset=38), Attribute(Name('self', Load(), lineno=147, col_offset=58), 'have_popen3', Load(), lineno=147, col_offset=58)], lineno=147, col_offset=20), lineno=147, col_offset=15), [Expr(Call(Attribute(Name('self', Load(), lineno=148, col_offset=16), 'send_error', Load(), lineno=148, col_offset=16), [Num(403, lineno=148, col_offset=32), BinOp(Str('CGI script is not a Python script (%r)', lineno=148, col_offset=37), Mod(), Name('scriptname', Load(), lineno=149, col_offset=32), lineno=148, col_offset=37)], [], None, None, lineno=148, col_offset=16), lineno=148, col_offset=16), Return(None, lineno=150, col_offset=16)], [], lineno=147, col_offset=12), If(UnaryOp(Not(), Call(Attribute(Name('self', Load(), lineno=151, col_offset=19), 'is_executable', Load(), lineno=151, col_offset=19), [Name('scriptfile', Load(), lineno=151, col_offset=38)], [], None, None, lineno=151, col_offset=19), lineno=151, col_offset=15), [Expr(Call(Attribute(Name('self', Load(), lineno=152, col_offset=16), 'send_error', Load(), lineno=152, col_offset=16), [Num(403, lineno=152, col_offset=32), BinOp(Str('CGI script is not executable (%r)', lineno=152, col_offset=37), Mod(), Name('scriptname', Load(), lineno=153, col_offset=32), lineno=152, col_offset=37)], [], None, None, lineno=152, col_offset=16), lineno=152, col_offset=16), Return(None, lineno=154, col_offset=16)], [], lineno=151, col_offset=12)], [], lineno=146, col_offset=8), Assign([Name('env', Store(), lineno=158, col_offset=8)], Call(Attribute(Name('copy', Load(), lineno=158, col_offset=14), 'deepcopy', Load(), lineno=158, col_offset=14), [Attribute(Name('os', Load(), lineno=158, col_offset=28), 'environ', Load(), lineno=158, col_offset=28)], [], None, None, lineno=158, col_offset=14), lineno=158, col_offset=8), Assign([Subscript(Name('env', Load(), lineno=159, col_offset=8), Index(Str('SERVER_SOFTWARE', lineno=159, col_offset=12)), Store(), lineno=159, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=159, col_offset=33), 'version_string', Load(), lineno=159, col_offset=33), [], [], None, None, lineno=159, col_offset=33), lineno=159, col_offset=8), Assign([Subscript(Name('env', Load(), lineno=160, col_offset=8), Index(Str('SERVER_NAME', lineno=160, col_offset=12)), Store(), lineno=160, col_offset=8)], Attribute(Attribute(Name('self', Load(), lineno=160, col_offset=29), 'server', Load(), lineno=160, col_offset=29), 'server_name', Load(), lineno=160, col_offset=29), lineno=160, col_offset=8), Assign([Subscript(Name('env', Load(), lineno=161, col_offset=8), Index(Str('GATEWAY_INTERFACE', lineno=161, col_offset=12)), Store(), lineno=161, col_offset=8)], Str('CGI/1.1', lineno=161, col_offset=35), lineno=161, col_offset=8), Assign([Subscript(Name('env', Load(), lineno=162, col_offset=8), Index(Str('SERVER_PROTOCOL', lineno=162, col_offset=12)), Store(), lineno=162, col_offset=8)], Attribute(Name('self', Load(), lineno=162, col_offset=33), 'protocol_version', Load(), lineno=162, col_offset=33), lineno=162, col_offset=8), Assign([Subscript(Name('env', Load(), lineno=163, col_offset=8), Index(Str('SERVER_PORT', lineno=163, col_offset=12)), Store(), lineno=163, col_offset=8)], Call(Name('str', Load(), lineno=163, col_offset=29), [Attribute(Attribute(Name('self', Load(), lineno=163, col_offset=33), 'server', Load(), lineno=163, col_offset=33), 'server_port', Load(), lineno=163, col_offset=33)], [], None, None, lineno=163, col_offset=29), lineno=163, col_offset=8), Assign([Subscript(Name('env', Load(), lineno=164, col_offset=8), Index(Str('REQUEST_METHOD', lineno=164, col_offset=12)), Store(), lineno=164, col_offset=8)], Attribute(Name('self', Load(), lineno=164, col_offset=32), 'command', Load(), lineno=164, col_offset=32), lineno=164, col_offset=8), Assign([Name('uqrest', Store(), lineno=165, col_offset=8)], Call(Attribute(Name('urllib', Load(), lineno=165, col_offset=17), 'unquote', Load(), lineno=165, col_offset=17), [Name('rest', Load(), lineno=165, col_offset=32)], [], None, None, lineno=165, col_offset=17), lineno=165, col_offset=8), Assign([Subscript(Name('env', Load(), lineno=166, col_offset=8), Index(Str('PATH_INFO', lineno=166, col_offset=12)), Store(), lineno=166, col_offset=8)], Name('uqrest', Load(), lineno=166, col_offset=27), lineno=166, col_offset=8), Assign([Subscript(Name('env', Load(), lineno=167, col_offset=8), Index(Str('PATH_TRANSLATED', lineno=167, col_offset=12)), Store(), lineno=167, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=167, col_offset=33), 'translate_path', Load(), lineno=167, col_offset=33), [Name('uqrest', Load(), lineno=167, col_offset=53)], [], None, None, lineno=167, col_offset=33), lineno=167, col_offset=8), Assign([Subscript(Name('env', Load(), lineno=168, col_offset=8), Index(Str('SCRIPT_NAME', lineno=168, col_offset=12)), Store(), lineno=168, col_offset=8)], Name('scriptname', Load(), lineno=168, col_offset=29), lineno=168, col_offset=8), If(Name('query', Load(), lineno=169, col_offset=11), [Assign([Subscript(Name('env', Load(), lineno=170, col_offset=12), Index(Str('QUERY_STRING', lineno=170, col_offset=16)), Store(), lineno=170, col_offset=12)], Name('query', Load(), lineno=170, col_offset=34), lineno=170, col_offset=12)], [], lineno=169, col_offset=8), Assign([Name('host', Store(), lineno=171, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=171, col_offset=15), 'address_string', Load(), lineno=171, col_offset=15), [], [], None, None, lineno=171, col_offset=15), lineno=171, col_offset=8), If(Compare(Name('host', Load(), lineno=172, col_offset=11), [NotEq()], [Subscript(Attribute(Name('self', Load(), lineno=172, col_offset=19), 'client_address', Load(), lineno=172, col_offset=19), Index(Num(0, lineno=172, col_offset=39)), Load(), lineno=172, col_offset=19)], lineno=172, col_offset=11), [Assign([Subscript(Name('env', Load(), lineno=173, col_offset=12), Index(Str('REMOTE_HOST', lineno=173, col_offset=16)), Store(), lineno=173, col_offset=12)], Name('host', Load(), lineno=173, col_offset=33), lineno=173, col_offset=12)], [], lineno=172, col_offset=8), Assign([Subscript(Name('env', Load(), lineno=174, col_offset=8), Index(Str('REMOTE_ADDR', lineno=174, col_offset=12)), Store(), lineno=174, col_offset=8)], Subscript(Attribute(Name('self', Load(), lineno=174, col_offset=29), 'client_address', Load(), lineno=174, col_offset=29), Index(Num(0, lineno=174, col_offset=49)), Load(), lineno=174, col_offset=29), lineno=174, col_offset=8), Assign([Name('authorization', Store(), lineno=175, col_offset=8)], Call(Attribute(Attribute(Name('self', Load(), lineno=175, col_offset=24), 'headers', Load(), lineno=175, col_offset=24), 'getheader', Load(), lineno=175, col_offset=24), [Str('authorization', lineno=175, col_offset=47)], [], None, None, lineno=175, col_offset=24), lineno=175, col_offset=8), If(Name('authorization', Load(), lineno=176, col_offset=11), [Assign([Name('authorization', Store(), lineno=177, col_offset=12)], Call(Attribute(Name('authorization', Load(), lineno=177, col_offset=28), 'split', Load(), lineno=177, col_offset=28), [], [], None, None, lineno=177, col_offset=28), lineno=177, col_offset=12), If(Compare(Call(Name('len', Load(), lineno=178, col_offset=15), [Name('authorization', Load(), lineno=178, col_offset=19)], [], None, None, lineno=178, col_offset=15), [Eq()], [Num(2, lineno=178, col_offset=37)], lineno=178, col_offset=15), [Import([alias('base64', None), alias('binascii', None)], lineno=179, col_offset=16), Assign([Subscript(Name('env', Load(), lineno=180, col_offset=16), Index(Str('AUTH_TYPE', lineno=180, col_offset=20)), Store(), lineno=180, col_offset=16)], Subscript(Name('authorization', Load(), lineno=180, col_offset=35), Index(Num(0, lineno=180, col_offset=49)), Load(), lineno=180, col_offset=35), lineno=180, col_offset=16), If(Compare(Call(Attribute(Subscript(Name('authorization', Load(), lineno=181, col_offset=19), Index(Num(0, lineno=181, col_offset=33)), Load(), lineno=181, col_offset=19), 'lower', Load(), lineno=181, col_offset=19), [], [], None, None, lineno=181, col_offset=19), [Eq()], [Str('basic', lineno=181, col_offset=47)], lineno=181, col_offset=19), [TryExcept([Assign([Name('authorization', Store(), lineno=183, col_offset=24)], Call(Attribute(Name('base64', Load(), lineno=183, col_offset=40), 'decodestring', Load(), lineno=183, col_offset=40), [Subscript(Name('authorization', Load(), lineno=183, col_offset=60), Index(Num(1, lineno=183, col_offset=74)), Load(), lineno=183, col_offset=60)], [], None, None, lineno=183, col_offset=40), lineno=183, col_offset=24)], [ExceptHandler(Attribute(Name('binascii', Load(), lineno=184, col_offset=27), 'Error', Load(), lineno=184, col_offset=27), None, [Pass( lineno=185, col_offset=24)], lineno=184, col_offset=20)], [Assign([Name('authorization', Store(), lineno=187, col_offset=24)], Call(Attribute(Name('authorization', Load(), lineno=187, col_offset=40), 'split', Load(), lineno=187, col_offset=40), [Str(':', lineno=187, col_offset=60)], [], None, None, lineno=187, col_offset=40), lineno=187, col_offset=24), If(Compare(Call(Name('len', Load(), lineno=188, col_offset=27), [Name('authorization', Load(), lineno=188, col_offset=31)], [], None, None, lineno=188, col_offset=27), [Eq()], [Num(2, lineno=188, col_offset=49)], lineno=188, col_offset=27), [Assign([Subscript(Name('env', Load(), lineno=189, col_offset=28), Index(Str('REMOTE_USER', lineno=189, col_offset=32)), Store(), lineno=189, col_offset=28)], Subscript(Name('authorization', Load(), lineno=189, col_offset=49), Index(Num(0, lineno=189, col_offset=63)), Load(), lineno=189, col_offset=49), lineno=189, col_offset=28)], [], lineno=188, col_offset=24)], lineno=182, col_offset=20)], [], lineno=181, col_offset=16)], [], lineno=178, col_offset=12)], [], lineno=176, col_offset=8), If(Compare(Attribute(Attribute(Name('self', Load(), lineno=191, col_offset=11), 'headers', Load(), lineno=191, col_offset=11), 'typeheader', Load(), lineno=191, col_offset=11), [Is()], [Name('None', Load(), lineno=191, col_offset=38)], lineno=191, col_offset=11), [Assign([Subscript(Name('env', Load(), lineno=192, col_offset=12), Index(Str('CONTENT_TYPE', lineno=192, col_offset=16)), Store(), lineno=192, col_offset=12)], Attribute(Attribute(Name('self', Load(), lineno=192, col_offset=34), 'headers', Load(), lineno=192, col_offset=34), 'type', Load(), lineno=192, col_offset=34), lineno=192, col_offset=12)], [Assign([Subscript(Name('env', Load(), lineno=194, col_offset=12), Index(Str('CONTENT_TYPE', lineno=194, col_offset=16)), Store(), lineno=194, col_offset=12)], Attribute(Attribute(Name('self', Load(), lineno=194, col_offset=34), 'headers', Load(), lineno=194, col_offset=34), 'typeheader', Load(), lineno=194, col_offset=34), lineno=194, col_offset=12)], lineno=191, col_offset=8), Assign([Name('length', Store(), lineno=195, col_offset=8)], Call(Attribute(Attribute(Name('self', Load(), lineno=195, col_offset=17), 'headers', Load(), lineno=195, col_offset=17), 'getheader', Load(), lineno=195, col_offset=17), [Str('content-length', lineno=195, col_offset=40)], [], None, None, lineno=195, col_offset=17), lineno=195, col_offset=8), If(Name('length', Load(), lineno=196, col_offset=11), [Assign([Subscript(Name('env', Load(), lineno=197, col_offset=12), Index(Str('CONTENT_LENGTH', lineno=197, col_offset=16)), Store(), lineno=197, col_offset=12)], Name('length', Load(), lineno=197, col_offset=36), lineno=197, col_offset=12)], [], lineno=196, col_offset=8), Assign([Name('referer', Store(), lineno=198, col_offset=8)], Call(Attribute(Attribute(Name('self', Load(), lineno=198, col_offset=18), 'headers', Load(), lineno=198, col_offset=18), 'getheader', Load(), lineno=198, col_offset=18), [Str('referer', lineno=198, col_offset=41)], [], None, None, lineno=198, col_offset=18), lineno=198, col_offset=8), If(Name('referer', Load(), lineno=199, col_offset=11), [Assign([Subscript(Name('env', Load(), lineno=200, col_offset=12), Index(Str('HTTP_REFERER', lineno=200, col_offset=16)), Store(), lineno=200, col_offset=12)], Name('referer', Load(), lineno=200, col_offset=34), lineno=200, col_offset=12)], [], lineno=199, col_offset=8), Assign([Name('accept', Store(), lineno=201, col_offset=8)], List([], Load(), lineno=201, col_offset=17), lineno=201, col_offset=8), For(Name('line', Store(), lineno=202, col_offset=12), Call(Attribute(Attribute(Name('self', Load(), lineno=202, col_offset=20), 'headers', Load(), lineno=202, col_offset=20), 'getallmatchingheaders', Load(), lineno=202, col_offset=20), [Str('accept', lineno=202, col_offset=55)], [], None, None, lineno=202, col_offset=20), [If(Compare(Subscript(Name('line', Load(), lineno=203, col_offset=15), Slice(None, Num(1, lineno=203, col_offset=21), None), Load(), lineno=203, col_offset=15), [In()], [Str('\t\n\r ', lineno=203, col_offset=27)], lineno=203, col_offset=15), [Expr(Call(Attribute(Name('accept', Load(), lineno=204, col_offset=16), 'append', Load(), lineno=204, col_offset=16), [Call(Attribute(Name('line', Load(), lineno=204, col_offset=30), 'strip', Load(), lineno=204, col_offset=30), [], [], None, None, lineno=204, col_offset=30)], [], None, None, lineno=204, col_offset=16), lineno=204, col_offset=16)], [Assign([Name('accept', Store(), lineno=206, col_offset=16)], BinOp(Name('accept', Load(), lineno=206, col_offset=25), Add(), Call(Attribute(Subscript(Name('line', Load(), lineno=206, col_offset=34), Slice(Num(7, lineno=206, col_offset=39), None, None), Load(), lineno=206, col_offset=34), 'split', Load(), lineno=206, col_offset=34), [Str(',', lineno=206, col_offset=49)], [], None, None, lineno=206, col_offset=34), lineno=206, col_offset=25), lineno=206, col_offset=16)], lineno=203, col_offset=12)], [], lineno=202, col_offset=8), Assign([Subscript(Name('env', Load(), lineno=207, col_offset=8), Index(Str('HTTP_ACCEPT', lineno=207, col_offset=12)), Store(), lineno=207, col_offset=8)], Call(Attribute(Str(',', lineno=207, col_offset=29), 'join', Load(), lineno=207, col_offset=29), [Name('accept', Load(), lineno=207, col_offset=38)], [], None, None, lineno=207, col_offset=29), lineno=207, col_offset=8), Assign([Name('ua', Store(), lineno=208, col_offset=8)], Call(Attribute(Attribute(Name('self', Load(), lineno=208, col_offset=13), 'headers', Load(), lineno=208, col_offset=13), 'getheader', Load(), lineno=208, col_offset=13), [Str('user-agent', lineno=208, col_offset=36)], [], None, None, lineno=208, col_offset=13), lineno=208, col_offset=8), If(Name('ua', Load(), lineno=209, col_offset=11), [Assign([Subscript(Name('env', Load(), lineno=210, col_offset=12), Index(Str('HTTP_USER_AGENT', lineno=210, col_offset=16)), Store(), lineno=210, col_offset=12)], Name('ua', Load(), lineno=210, col_offset=37), lineno=210, col_offset=12)], [], lineno=209, col_offset=8), Assign([Name('co', Store(), lineno=211, col_offset=8)], Call(Name('filter', Load(), lineno=211, col_offset=13), [Name('None', Load(), lineno=211, col_offset=20), Call(Attribute(Attribute(Name('self', Load(), lineno=211, col_offset=26), 'headers', Load(), lineno=211, col_offset=26), 'getheaders', Load(), lineno=211, col_offset=26), [Str('cookie', lineno=211, col_offset=50)], [], None, None, lineno=211, col_offset=26)], [], None, None, lineno=211, col_offset=13), lineno=211, col_offset=8), If(Name('co', Load(), lineno=212, col_offset=11), [Assign([Subscript(Name('env', Load(), lineno=213, col_offset=12), Index(Str('HTTP_COOKIE', lineno=213, col_offset=16)), Store(), lineno=213, col_offset=12)], Call(Attribute(Str(', ', lineno=213, col_offset=33), 'join', Load(), lineno=213, col_offset=33), [Name('co', Load(), lineno=213, col_offset=43)], [], None, None, lineno=213, col_offset=33), lineno=213, col_offset=12)], [], lineno=212, col_offset=8), For(Name('k', Store(), lineno=217, col_offset=12), Tuple([Str('QUERY_STRING', lineno=217, col_offset=18), Str('REMOTE_HOST', lineno=217, col_offset=34), Str('CONTENT_LENGTH', lineno=217, col_offset=49), Str('HTTP_USER_AGENT', lineno=218, col_offset=18), Str('HTTP_COOKIE', lineno=218, col_offset=37), Str('HTTP_REFERER', lineno=218, col_offset=52)], Load(), lineno=217, col_offset=18), [Expr(Call(Attribute(Name('env', Load(), lineno=219, col_offset=12), 'setdefault', Load(), lineno=219, col_offset=12), [Name('k', Load(), lineno=219, col_offset=27), Str('', lineno=219, col_offset=30)], [], None, None, lineno=219, col_offset=12), lineno=219, col_offset=12)], [], lineno=217, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=221, col_offset=8), 'send_response', Load(), lineno=221, col_offset=8), [Num(200, lineno=221, col_offset=27), Str('Script output follows', lineno=221, col_offset=32)], [], None, None, lineno=221, col_offset=8), lineno=221, col_offset=8), Assign([Name('decoded_query', Store(), lineno=223, col_offset=8)], Call(Attribute(Name('query', Load(), lineno=223, col_offset=24), 'replace', Load(), lineno=223, col_offset=24), [Str('+', lineno=223, col_offset=38), Str(' ', lineno=223, col_offset=43)], [], None, None, lineno=223, col_offset=24), lineno=223, col_offset=8), If(Attribute(Name('self', Load(), lineno=225, col_offset=11), 'have_fork', Load(), lineno=225, col_offset=11), [Assign([Name('args', Store(), lineno=227, col_offset=12)], List([Name('script', Load(), lineno=227, col_offset=20)], Load(), lineno=227, col_offset=19), lineno=227, col_offset=12), If(Compare(Str('=', lineno=228, col_offset=15), [NotIn()], [Name('decoded_query', Load(), lineno=228, col_offset=26)], lineno=228, col_offset=15), [Expr(Call(Attribute(Name('args', Load(), lineno=229, col_offset=16), 'append', Load(), lineno=229, col_offset=16), [Name('decoded_query', Load(), lineno=229, col_offset=28)], [], None, None, lineno=229, col_offset=16), lineno=229, col_offset=16)], [], lineno=228, col_offset=12), Assign([Name('nobody', Store(), lineno=230, col_offset=12)], Call(Name('nobody_uid', Load(), lineno=230, col_offset=21), [], [], None, None, lineno=230, col_offset=21), lineno=230, col_offset=12), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=231, col_offset=12), 'wfile', Load(), lineno=231, col_offset=12), 'flush', Load(), lineno=231, col_offset=12), [], [], None, None, lineno=231, col_offset=12), lineno=231, col_offset=12), Assign([Name('pid', Store(), lineno=232, col_offset=12)], Call(Attribute(Name('os', Load(), lineno=232, col_offset=18), 'fork', Load(), lineno=232, col_offset=18), [], [], None, None, lineno=232, col_offset=18), lineno=232, col_offset=12), If(Compare(Name('pid', Load(), lineno=233, col_offset=15), [NotEq()], [Num(0, lineno=233, col_offset=22)], lineno=233, col_offset=15), [Assign([Tuple([Name('pid', Store(), lineno=235, col_offset=16), Name('sts', Store(), lineno=235, col_offset=21)], Store(), lineno=235, col_offset=16)], Call(Attribute(Name('os', Load(), lineno=235, col_offset=27), 'waitpid', Load(), lineno=235, col_offset=27), [Name('pid', Load(), lineno=235, col_offset=38), Num(0, lineno=235, col_offset=43)], [], None, None, lineno=235, col_offset=27), lineno=235, col_offset=16), While(Subscript(Call(Attribute(Name('select', Load(), lineno=237, col_offset=22), 'select', Load(), lineno=237, col_offset=22), [List([Attribute(Name('self', Load(), lineno=237, col_offset=37), 'rfile', Load(), lineno=237, col_offset=37)], Load(), lineno=237, col_offset=36), List([], Load(), lineno=237, col_offset=50), List([], Load(), lineno=237, col_offset=54), Num(0, lineno=237, col_offset=58)], [], None, None, lineno=237, col_offset=22), Index(Num(0, lineno=237, col_offset=61)), Load(), lineno=237, col_offset=22), [If(UnaryOp(Not(), Call(Attribute(Attribute(Name('self', Load(), lineno=238, col_offset=27), 'rfile', Load(), lineno=238, col_offset=27), 'read', Load(), lineno=238, col_offset=27), [Num(1, lineno=238, col_offset=43)], [], None, None, lineno=238, col_offset=27), lineno=238, col_offset=23), [Break( lineno=239, col_offset=24)], [], lineno=238, col_offset=20)], [], lineno=237, col_offset=16), If(Name('sts', Load(), lineno=240, col_offset=19), [Expr(Call(Attribute(Name('self', Load(), lineno=241, col_offset=20), 'log_error', Load(), lineno=241, col_offset=20), [Str('CGI script exit status %#x', lineno=241, col_offset=35), Name('sts', Load(), lineno=241, col_offset=65)], [], None, None, lineno=241, col_offset=20), lineno=241, col_offset=20)], [], lineno=240, col_offset=16), Return(None, lineno=242, col_offset=16)], [], lineno=233, col_offset=12), TryExcept([TryExcept([Expr(Call(Attribute(Name('os', Load(), lineno=246, col_offset=20), 'setuid', Load(), lineno=246, col_offset=20), [Name('nobody', Load(), lineno=246, col_offset=30)], [], None, None, lineno=246, col_offset=20), lineno=246, col_offset=20)], [ExceptHandler(Attribute(Name('os', Load(), lineno=247, col_offset=23), 'error', Load(), lineno=247, col_offset=23), None, [Pass( lineno=248, col_offset=20)], lineno=247, col_offset=16)], [], lineno=245, col_offset=16), Expr(Call(Attribute(Name('os', Load(), lineno=249, col_offset=16), 'dup2', Load(), lineno=249, col_offset=16), [Call(Attribute(Attribute(Name('self', Load(), lineno=249, col_offset=24), 'rfile', Load(), lineno=249, col_offset=24), 'fileno', Load(), lineno=249, col_offset=24), [], [], None, None, lineno=249, col_offset=24), Num(0, lineno=249, col_offset=45)], [], None, None, lineno=249, col_offset=16), lineno=249, col_offset=16), Expr(Call(Attribute(Name('os', Load(), lineno=250, col_offset=16), 'dup2', Load(), lineno=250, col_offset=16), [Call(Attribute(Attribute(Name('self', Load(), lineno=250, col_offset=24), 'wfile', Load(), lineno=250, col_offset=24), 'fileno', Load(), lineno=250, col_offset=24), [], [], None, None, lineno=250, col_offset=24), Num(1, lineno=250, col_offset=45)], [], None, None, lineno=250, col_offset=16), lineno=250, col_offset=16), Expr(Call(Attribute(Name('os', Load(), lineno=251, col_offset=16), 'execve', Load(), lineno=251, col_offset=16), [Name('scriptfile', Load(), lineno=251, col_offset=26), Name('args', Load(), lineno=251, col_offset=38), Name('env', Load(), lineno=251, col_offset=44)], [], None, None, lineno=251, col_offset=16), lineno=251, col_offset=16)], [ExceptHandler(None, None, [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=253, col_offset=16), 'server', Load(), lineno=253, col_offset=16), 'handle_error', Load(), lineno=253, col_offset=16), [Attribute(Name('self', Load(), lineno=253, col_offset=41), 'request', Load(), lineno=253, col_offset=41), Attribute(Name('self', Load(), lineno=253, col_offset=55), 'client_address', Load(), lineno=253, col_offset=55)], [], None, None, lineno=253, col_offset=16), lineno=253, col_offset=16), Expr(Call(Attribute(Name('os', Load(), lineno=254, col_offset=16), '_exit', Load(), lineno=254, col_offset=16), [Num(127, lineno=254, col_offset=25)], [], None, None, lineno=254, col_offset=16), lineno=254, col_offset=16)], lineno=252, col_offset=12)], [], lineno=244, col_offset=12)], [Import([alias('subprocess', None)], lineno=258, col_offset=12), Assign([Name('cmdline', Store(), lineno=259, col_offset=12)], List([Name('scriptfile', Load(), lineno=259, col_offset=23)], Load(), lineno=259, col_offset=22), lineno=259, col_offset=12), If(Call(Attribute(Name('self', Load(), lineno=260, col_offset=15), 'is_python', Load(), lineno=260, col_offset=15), [Name('scriptfile', Load(), lineno=260, col_offset=30)], [], None, None, lineno=260, col_offset=15), [Assign([Name('interp', Store(), lineno=261, col_offset=16)], Attribute(Name('sys', Load(), lineno=261, col_offset=25), 'executable', Load(), lineno=261, col_offset=25), lineno=261, col_offset=16), If(Call(Attribute(Call(Attribute(Name('interp', Load(), lineno=262, col_offset=19), 'lower', Load(), lineno=262, col_offset=19), [], [], None, None, lineno=262, col_offset=19), 'endswith', Load(), lineno=262, col_offset=19), [Str('w.exe', lineno=262, col_offset=43)], [], None, None, lineno=262, col_offset=19), [Assign([Name('interp', Store(), lineno=264, col_offset=20)], BinOp(Subscript(Name('interp', Load(), lineno=264, col_offset=29), Slice(None, Num(-5, lineno=264, col_offset=38), None), Load(), lineno=264, col_offset=29), Add(), Subscript(Name('interp', Load(), lineno=264, col_offset=43), Slice(Num(-4, lineno=264, col_offset=51), None, None), Load(), lineno=264, col_offset=43), lineno=264, col_offset=29), lineno=264, col_offset=20)], [], lineno=262, col_offset=16), Assign([Name('cmdline', Store(), lineno=265, col_offset=16)], BinOp(List([Name('interp', Load(), lineno=265, col_offset=27), Str('-u', lineno=265, col_offset=35)], Load(), lineno=265, col_offset=26), Add(), Name('cmdline', Load(), lineno=265, col_offset=43), lineno=265, col_offset=26), lineno=265, col_offset=16)], [], lineno=260, col_offset=12), If(Compare(Str('=', lineno=266, col_offset=15), [NotIn()], [Name('query', Load(), lineno=266, col_offset=26)], lineno=266, col_offset=15), [Expr(Call(Attribute(Name('cmdline', Load(), lineno=267, col_offset=16), 'append', Load(), lineno=267, col_offset=16), [Name('query', Load(), lineno=267, col_offset=31)], [], None, None, lineno=267, col_offset=16), lineno=267, col_offset=16)], [], lineno=266, col_offset=12), Expr(Call(Attribute(Name('self', Load(), lineno=269, col_offset=12), 'log_message', Load(), lineno=269, col_offset=12), [Str('command: %s', lineno=269, col_offset=29), Call(Attribute(Name('subprocess', Load(), lineno=269, col_offset=44), 'list2cmdline', Load(), lineno=269, col_offset=44), [Name('cmdline', Load(), lineno=269, col_offset=68)], [], None, None, lineno=269, col_offset=44)], [], None, None, lineno=269, col_offset=12), lineno=269, col_offset=12), TryExcept([Assign([Name('nbytes', Store(), lineno=271, col_offset=16)], Call(Name('int', Load(), lineno=271, col_offset=25), [Name('length', Load(), lineno=271, col_offset=29)], [], None, None, lineno=271, col_offset=25), lineno=271, col_offset=16)], [ExceptHandler(Tuple([Name('TypeError', Load(), lineno=272, col_offset=20), Name('ValueError', Load(), lineno=272, col_offset=31)], Load(), lineno=272, col_offset=20), None, [Assign([Name('nbytes', Store(), lineno=273, col_offset=16)], Num(0, lineno=273, col_offset=25), lineno=273, col_offset=16)], lineno=272, col_offset=12)], [], lineno=270, col_offset=12), Assign([Name('p', Store(), lineno=274, col_offset=12)], Call(Attribute(Name('subprocess', Load(), lineno=274, col_offset=16), 'Popen', Load(), lineno=274, col_offset=16), [Name('cmdline', Load(), lineno=274, col_offset=33)], [keyword('stdin', Attribute(Name('subprocess', Load(), lineno=275, col_offset=41), 'PIPE', Load(), lineno=275, col_offset=41)), keyword('stdout', Attribute(Name('subprocess', Load(), lineno=276, col_offset=42), 'PIPE', Load(), lineno=276, col_offset=42)), keyword('stderr', Attribute(Name('subprocess', Load(), lineno=277, col_offset=42), 'PIPE', Load(), lineno=277, col_offset=42)), keyword('env', Name('env', Load(), lineno=278, col_offset=39))], None, None, lineno=274, col_offset=16), lineno=274, col_offset=12), If(BoolOp(And(), [Compare(Call(Attribute(Attribute(Name('self', Load(), lineno=280, col_offset=15), 'command', Load(), lineno=280, col_offset=15), 'lower', Load(), lineno=280, col_offset=15), [], [], None, None, lineno=280, col_offset=15), [Eq()], [Str('post', lineno=280, col_offset=39)], lineno=280, col_offset=15), Compare(Name('nbytes', Load(), lineno=280, col_offset=50), [Gt()], [Num(0, lineno=280, col_offset=59)], lineno=280, col_offset=50)], lineno=280, col_offset=15), [Assign([Name('data', Store(), lineno=281, col_offset=16)], Call(Attribute(Attribute(Name('self', Load(), lineno=281, col_offset=23), 'rfile', Load(), lineno=281, col_offset=23), 'read', Load(), lineno=281, col_offset=23), [Name('nbytes', Load(), lineno=281, col_offset=39)], [], None, None, lineno=281, col_offset=23), lineno=281, col_offset=16)], [Assign([Name('data', Store(), lineno=283, col_offset=16)], Name('None', Load(), lineno=283, col_offset=23), lineno=283, col_offset=16)], lineno=280, col_offset=12), While(Subscript(Call(Attribute(Name('select', Load(), lineno=285, col_offset=18), 'select', Load(), lineno=285, col_offset=18), [List([Attribute(Attribute(Name('self', Load(), lineno=285, col_offset=33), 'rfile', Load(), lineno=285, col_offset=33), '_sock', Load(), lineno=285, col_offset=33)], Load(), lineno=285, col_offset=32), List([], Load(), lineno=285, col_offset=52), List([], Load(), lineno=285, col_offset=56), Num(0, lineno=285, col_offset=60)], [], None, None, lineno=285, col_offset=18), Index(Num(0, lineno=285, col_offset=63)), Load(), lineno=285, col_offset=18), [If(UnaryOp(Not(), Call(Attribute(Attribute(Attribute(Name('self', Load(), lineno=286, col_offset=23), 'rfile', Load(), lineno=286, col_offset=23), '_sock', Load(), lineno=286, col_offset=23), 'recv', Load(), lineno=286, col_offset=23), [Num(1, lineno=286, col_offset=45)], [], None, None, lineno=286, col_offset=23), lineno=286, col_offset=19), [Break( lineno=287, col_offset=20)], [], lineno=286, col_offset=16)], [], lineno=285, col_offset=12), Assign([Tuple([Name('stdout', Store(), lineno=288, col_offset=12), Name('stderr', Store(), lineno=288, col_offset=20)], Store(), lineno=288, col_offset=12)], Call(Attribute(Name('p', Load(), lineno=288, col_offset=29), 'communicate', Load(), lineno=288, col_offset=29), [Name('data', Load(), lineno=288, col_offset=43)], [], None, None, lineno=288, col_offset=29), lineno=288, col_offset=12), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=289, col_offset=12), 'wfile', Load(), lineno=289, col_offset=12), 'write', Load(), lineno=289, col_offset=12), [Name('stdout', Load(), lineno=289, col_offset=29)], [], None, None, lineno=289, col_offset=12), lineno=289, col_offset=12), If(Name('stderr', Load(), lineno=290, col_offset=15), [Expr(Call(Attribute(Name('self', Load(), lineno=291, col_offset=16), 'log_error', Load(), lineno=291, col_offset=16), [Str('%s', lineno=291, col_offset=31), Name('stderr', Load(), lineno=291, col_offset=37)], [], None, None, lineno=291, col_offset=16), lineno=291, col_offset=16)], [], lineno=290, col_offset=12), Expr(Call(Attribute(Attribute(Name('p', Load(), lineno=292, col_offset=12), 'stderr', Load(), lineno=292, col_offset=12), 'close', Load(), lineno=292, col_offset=12), [], [], None, None, lineno=292, col_offset=12), lineno=292, col_offset=12), Expr(Call(Attribute(Attribute(Name('p', Load(), lineno=293, col_offset=12), 'stdout', Load(), lineno=293, col_offset=12), 'close', Load(), lineno=293, col_offset=12), [], [], None, None, lineno=293, col_offset=12), lineno=293, col_offset=12), Assign([Name('status', Store(), lineno=294, col_offset=12)], Attribute(Name('p', Load(), lineno=294, col_offset=21), 'returncode', Load(), lineno=294, col_offset=21), lineno=294, col_offset=12), If(Name('status', Load(), lineno=295, col_offset=15), [Expr(Call(Attribute(Name('self', Load(), lineno=296, col_offset=16), 'log_error', Load(), lineno=296, col_offset=16), [Str('CGI script exit status %#x', lineno=296, col_offset=31), Name('status', Load(), lineno=296, col_offset=61)], [], None, None, lineno=296, col_offset=16), lineno=296, col_offset=16)], [Expr(Call(Attribute(Name('self', Load(), lineno=298, col_offset=16), 'log_message', Load(), lineno=298, col_offset=16), [Str('CGI script exited OK', lineno=298, col_offset=33)], [], None, None, lineno=298, col_offset=16), lineno=298, col_offset=16)], lineno=295, col_offset=12)], lineno=225, col_offset=8)], [], lineno=104, col_offset=4)], [], lineno=35, col_offset=0), FunctionDef('_url_collapse_path_split', arguments([Name('path', Param(), lineno=302, col_offset=29)], None, None, []), [Expr(Str("\n    Given a URL path, remove extra '/'s and '.' path elements and collapse\n    any '..' references.\n\n    Implements something akin to RFC-2396 5.2 step 6 to parse relative paths.\n\n    Returns: A tuple of (head, tail) where tail is everything after the final /\n    and head is everything before it.  Head will always start with a '/' and,\n    if it contains anything else, never have a trailing '/'.\n\n    Raises: IndexError if too many '..' occur within the path.\n    ", lineno=314, col_offset=-1), lineno=314, col_offset=-1), Assign([Name('path_parts', Store(), lineno=317, col_offset=4)], List([], Load(), lineno=317, col_offset=17), lineno=317, col_offset=4), For(Name('part', Store(), lineno=318, col_offset=8), Call(Attribute(Name('path', Load(), lineno=318, col_offset=16), 'split', Load(), lineno=318, col_offset=16), [Str('/', lineno=318, col_offset=27)], [], None, None, lineno=318, col_offset=16), [If(Compare(Name('part', Load(), lineno=319, col_offset=11), [Eq()], [Str('.', lineno=319, col_offset=19)], lineno=319, col_offset=11), [Expr(Call(Attribute(Name('path_parts', Load(), lineno=320, col_offset=12), 'append', Load(), lineno=320, col_offset=12), [Str('', lineno=320, col_offset=30)], [], None, None, lineno=320, col_offset=12), lineno=320, col_offset=12)], [Expr(Call(Attribute(Name('path_parts', Load(), lineno=322, col_offset=12), 'append', Load(), lineno=322, col_offset=12), [Name('part', Load(), lineno=322, col_offset=30)], [], None, None, lineno=322, col_offset=12), lineno=322, col_offset=12)], lineno=319, col_offset=8)], [], lineno=318, col_offset=4), Assign([Name('path_parts', Store(), lineno=324, col_offset=4)], BinOp(ListComp(Name('part', Load(), lineno=324, col_offset=18), [comprehension(Name('part', Store(), lineno=324, col_offset=27), Subscript(Name('path_parts', Load(), lineno=324, col_offset=35), Slice(None, Num(-1, lineno=324, col_offset=48), None), Load(), lineno=324, col_offset=35), [Name('part', Load(), lineno=324, col_offset=54)])], lineno=324, col_offset=18), Add(), Subscript(Name('path_parts', Load(), lineno=324, col_offset=62), Slice(Num(-1, lineno=324, col_offset=74), None, None), Load(), lineno=324, col_offset=62), lineno=324, col_offset=17), lineno=324, col_offset=4), If(Name('path_parts', Load(), lineno=325, col_offset=7), [Assign([Name('tail_part', Store(), lineno=326, col_offset=8)], Call(Attribute(Name('path_parts', Load(), lineno=326, col_offset=20), 'pop', Load(), lineno=326, col_offset=20), [], [], None, None, lineno=326, col_offset=20), lineno=326, col_offset=8)], [Assign([Name('tail_part', Store(), lineno=328, col_offset=8)], Str('', lineno=328, col_offset=20), lineno=328, col_offset=8)], lineno=325, col_offset=4), Assign([Name('head_parts', Store(), lineno=329, col_offset=4)], List([], Load(), lineno=329, col_offset=17), lineno=329, col_offset=4), For(Name('part', Store(), lineno=330, col_offset=8), Name('path_parts', Load(), lineno=330, col_offset=16), [If(Compare(Name('part', Load(), lineno=331, col_offset=11), [Eq()], [Str('..', lineno=331, col_offset=19)], lineno=331, col_offset=11), [Expr(Call(Attribute(Name('head_parts', Load(), lineno=332, col_offset=12), 'pop', Load(), lineno=332, col_offset=12), [], [], None, None, lineno=332, col_offset=12), lineno=332, col_offset=12)], [Expr(Call(Attribute(Name('head_parts', Load(), lineno=334, col_offset=12), 'append', Load(), lineno=334, col_offset=12), [Name('part', Load(), lineno=334, col_offset=30)], [], None, None, lineno=334, col_offset=12), lineno=334, col_offset=12)], lineno=331, col_offset=8)], [], lineno=330, col_offset=4), If(BoolOp(And(), [Name('tail_part', Load(), lineno=335, col_offset=7), Compare(Name('tail_part', Load(), lineno=335, col_offset=21), [Eq()], [Str('..', lineno=335, col_offset=34)], lineno=335, col_offset=21)], lineno=335, col_offset=7), [Expr(Call(Attribute(Name('head_parts', Load(), lineno=336, col_offset=8), 'pop', Load(), lineno=336, col_offset=8), [], [], None, None, lineno=336, col_offset=8), lineno=336, col_offset=8), Assign([Name('tail_part', Store(), lineno=337, col_offset=8)], Str('', lineno=337, col_offset=20), lineno=337, col_offset=8)], [], lineno=335, col_offset=4), Return(Tuple([BinOp(Str('/', lineno=338, col_offset=12), Add(), Call(Attribute(Str('/', lineno=338, col_offset=18), 'join', Load(), lineno=338, col_offset=18), [Name('head_parts', Load(), lineno=338, col_offset=27)], [], None, None, lineno=338, col_offset=18), lineno=338, col_offset=12), Name('tail_part', Load(), lineno=338, col_offset=40)], Load(), lineno=338, col_offset=12), lineno=338, col_offset=4)], [], lineno=302, col_offset=0), Assign([Name('nobody', Store(), lineno=341, col_offset=0)], Name('None', Load(), lineno=341, col_offset=9), lineno=341, col_offset=0), FunctionDef('nobody_uid', arguments([], None, None, []), [Expr(Str("Internal routine to get nobody's uid", lineno=344, col_offset=4), lineno=344, col_offset=4), Global(['nobody'], lineno=345, col_offset=4), If(Name('nobody', Load(), lineno=346, col_offset=7), [Return(Name('nobody', Load(), lineno=347, col_offset=15), lineno=347, col_offset=8)], [], lineno=346, col_offset=4), TryExcept([Import([alias('pwd', None)], lineno=349, col_offset=8)], [ExceptHandler(Name('ImportError', Load(), lineno=350, col_offset=11), None, [Return(Num(-1, lineno=351, col_offset=16), lineno=351, col_offset=8)], lineno=350, col_offset=4)], [], lineno=348, col_offset=4), TryExcept([Assign([Name('nobody', Store(), lineno=353, col_offset=8)], Subscript(Call(Attribute(Name('pwd', Load(), lineno=353, col_offset=17), 'getpwnam', Load(), lineno=353, col_offset=17), [Str('nobody', lineno=353, col_offset=30)], [], None, None, lineno=353, col_offset=17), Index(Num(2, lineno=353, col_offset=40)), Load(), lineno=353, col_offset=17), lineno=353, col_offset=8)], [ExceptHandler(Name('KeyError', Load(), lineno=354, col_offset=11), None, [Assign([Name('nobody', Store(), lineno=355, col_offset=8)], BinOp(Num(1, lineno=355, col_offset=17), Add(), Call(Name('max', Load(), lineno=355, col_offset=21), [Call(Name('map', Load(), lineno=355, col_offset=25), [Lambda(arguments([Name('x', Param(), lineno=355, col_offset=36)], None, None, []), Subscript(Name('x', Load(), lineno=355, col_offset=39), Index(Num(2, lineno=355, col_offset=41)), Load(), lineno=355, col_offset=39), lineno=355, col_offset=29), Call(Attribute(Name('pwd', Load(), lineno=355, col_offset=45), 'getpwall', Load(), lineno=355, col_offset=45), [], [], None, None, lineno=355, col_offset=45)], [], None, None, lineno=355, col_offset=25)], [], None, None, lineno=355, col_offset=21), lineno=355, col_offset=17), lineno=355, col_offset=8)], lineno=354, col_offset=4)], [], lineno=352, col_offset=4), Return(Name('nobody', Load(), lineno=356, col_offset=11), lineno=356, col_offset=4)], [], lineno=343, col_offset=0), FunctionDef('executable', arguments([Name('path', Param(), lineno=359, col_offset=15)], None, None, []), [Expr(Str('Test for executable file.', lineno=360, col_offset=4), lineno=360, col_offset=4), TryExcept([Assign([Name('st', Store(), lineno=362, col_offset=8)], Call(Attribute(Name('os', Load(), lineno=362, col_offset=13), 'stat', Load(), lineno=362, col_offset=13), [Name('path', Load(), lineno=362, col_offset=21)], [], None, None, lineno=362, col_offset=13), lineno=362, col_offset=8)], [ExceptHandler(Attribute(Name('os', Load(), lineno=363, col_offset=11), 'error', Load(), lineno=363, col_offset=11), None, [Return(Name('False', Load(), lineno=364, col_offset=15), lineno=364, col_offset=8)], lineno=363, col_offset=4)], [], lineno=361, col_offset=4), Return(Compare(BinOp(Attribute(Name('st', Load(), lineno=365, col_offset=11), 'st_mode', Load(), lineno=365, col_offset=11), BitAnd(), Num(73, lineno=365, col_offset=24), lineno=365, col_offset=11), [NotEq()], [Num(0, lineno=365, col_offset=32)], lineno=365, col_offset=11), lineno=365, col_offset=4)], [], lineno=359, col_offset=0), FunctionDef('test', arguments([Name('HandlerClass', Param(), lineno=368, col_offset=9), Name('ServerClass', Param(), lineno=369, col_offset=9)], None, None, [Name('CGIHTTPRequestHandler', Load(), lineno=368, col_offset=24), Attribute(Name('BaseHTTPServer', Load(), lineno=369, col_offset=23), 'HTTPServer', Load(), lineno=369, col_offset=23)]), [Expr(Call(Attribute(Name('SimpleHTTPServer', Load(), lineno=370, col_offset=4), 'test', Load(), lineno=370, col_offset=4), [Name('HandlerClass', Load(), lineno=370, col_offset=26), Name('ServerClass', Load(), lineno=370, col_offset=40)], [], None, None, lineno=370, col_offset=4), lineno=370, col_offset=4)], [], lineno=368, col_offset=0), If(Compare(Name('__name__', Load(), lineno=373, col_offset=3), [Eq()], [Str('__main__', lineno=373, col_offset=15)], lineno=373, col_offset=3), [Expr(Call(Name('test', Load(), lineno=374, col_offset=4), [], [], None, None, lineno=374, col_offset=4), lineno=374, col_offset=4)], [], lineno=373, col_offset=0)])
