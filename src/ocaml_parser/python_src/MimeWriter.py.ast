Module([Expr(Str("Generic MIME writer.\n\nThis module defines the class MimeWriter.  The MimeWriter class implements\na basic formatter for creating MIME multi-part files.  It doesn't seek around\nthe output file nor does it use large amounts of buffer space. You must write\nthe parts out in the order that they should occur in the final file.\nMimeWriter does buffer the headers you add, allowing you to rearrange their\norder.\n\n", lineno=10, col_offset=-1), lineno=10, col_offset=-1), Import([alias('mimetools', None)], lineno=13, col_offset=0), Assign([Name('__all__', Store(), lineno=15, col_offset=0)], List([Str('MimeWriter', lineno=15, col_offset=11)], Load(), lineno=15, col_offset=10), lineno=15, col_offset=0), Import([alias('warnings', None)], lineno=17, col_offset=0), Expr(Call(Attribute(Name('warnings', Load(), lineno=19, col_offset=0), 'warn', Load(), lineno=19, col_offset=0), [Str('the MimeWriter module is deprecated; use the email package instead', lineno=19, col_offset=14), Name('DeprecationWarning', Load(), lineno=20, col_offset=16), Num(2, lineno=20, col_offset=36)], [], None, None, lineno=19, col_offset=0), lineno=19, col_offset=0), ClassDef('MimeWriter', [], [Expr(Str("Generic MIME writer.\n\n    Methods:\n\n    __init__()\n    addheader()\n    flushheaders()\n    startbody()\n    startmultipartbody()\n    nextpart()\n    lastpart()\n\n    A MIME writer is much more primitive than a MIME parser.  It\n    doesn't seek around on the output file, and it doesn't use large\n    amounts of buffer space, so you have to write the parts in the\n    order they should occur on the output file.  It does buffer the\n    headers you add, allowing you to rearrange their order.\n\n    General usage is:\n\n    f = <open the output file>\n    w = MimeWriter(f)\n    ...call w.addheader(key, value) 0 or more times...\n\n    followed by either:\n\n    f = w.startbody(content_type)\n    ...call f.write(data) for body data...\n\n    or:\n\n    w.startmultipartbody(subtype)\n    for each part:\n        subwriter = w.nextpart()\n        ...use the subwriter's methods to create the subpart...\n    w.lastpart()\n\n    The subwriter is another MimeWriter instance, and should be\n    treated in the same way as the toplevel MimeWriter.  This way,\n    writing recursive body parts is easy.\n\n    Warning: don't forget to call lastpart()!\n\n    XXX There should be more state so calls made in the wrong order\n    are detected.\n\n    Some special cases:\n\n    - startbody() just returns the file passed to the constructor;\n      but don't use this knowledge, as it may be changed.\n\n    - startmultipartbody() actually returns a file as well;\n      this can be used to write the initial 'if you can read this your\n      mailer is not MIME-aware' message.\n\n    - If you call flushheaders(), the headers accumulated so far are\n      written out (and forgotten); this is useful if you don't need a\n      body part at all, e.g. for a subpart of type message/rfc822\n      that's (mis)used to store some header-like information.\n\n    - Passing a keyword argument 'prefix=<flag>' to addheader(),\n      start*body() affects where the header is inserted; 0 means\n      append at the end, 1 means insert at the start; default is\n      append for addheader(), but insert for start*body(), which use\n      it to determine where the Content-Type header goes.\n\n    ", lineno=90, col_offset=-1), lineno=90, col_offset=-1), FunctionDef('__init__', arguments([Name('self', Param(), lineno=92, col_offset=17), Name('fp', Param(), lineno=92, col_offset=23)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=93, col_offset=8), '_fp', Store(), lineno=93, col_offset=8)], Name('fp', Load(), lineno=93, col_offset=19), lineno=93, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=94, col_offset=8), '_headers', Store(), lineno=94, col_offset=8)], List([], Load(), lineno=94, col_offset=24), lineno=94, col_offset=8)], [], lineno=92, col_offset=4), FunctionDef('addheader', arguments([Name('self', Param(), lineno=96, col_offset=18), Name('key', Param(), lineno=96, col_offset=24), Name('value', Param(), lineno=96, col_offset=29), Name('prefix', Param(), lineno=96, col_offset=36)], None, None, [Num(0, lineno=96, col_offset=43)]), [Expr(Str('Add a header line to the MIME message.\n\n        The key is the name of the header, where the value obviously provides\n        the value of the header. The optional argument prefix determines\n        where the header is inserted; 0 means append at the end, 1 means\n        insert at the start. The default is to append.\n\n        ', lineno=104, col_offset=-1), lineno=104, col_offset=-1), Assign([Name('lines', Store(), lineno=105, col_offset=8)], Call(Attribute(Name('value', Load(), lineno=105, col_offset=16), 'split', Load(), lineno=105, col_offset=16), [Str('\n', lineno=105, col_offset=28)], [], None, None, lineno=105, col_offset=16), lineno=105, col_offset=8), While(BoolOp(And(), [Name('lines', Load(), lineno=106, col_offset=14), UnaryOp(Not(), Subscript(Name('lines', Load(), lineno=106, col_offset=28), Index(Num(-1, lineno=106, col_offset=35)), Load(), lineno=106, col_offset=28), lineno=106, col_offset=24)], lineno=106, col_offset=14), [Delete([Subscript(Name('lines', Load(), lineno=106, col_offset=43), Index(Num(-1, lineno=106, col_offset=50)), Del(), lineno=106, col_offset=43)], lineno=106, col_offset=39)], [], lineno=106, col_offset=8), While(BoolOp(And(), [Name('lines', Load(), lineno=107, col_offset=14), UnaryOp(Not(), Subscript(Name('lines', Load(), lineno=107, col_offset=28), Index(Num(0, lineno=107, col_offset=34)), Load(), lineno=107, col_offset=28), lineno=107, col_offset=24)], lineno=107, col_offset=14), [Delete([Subscript(Name('lines', Load(), lineno=107, col_offset=42), Index(Num(0, lineno=107, col_offset=48)), Del(), lineno=107, col_offset=42)], lineno=107, col_offset=38)], [], lineno=107, col_offset=8), For(Name('i', Store(), lineno=108, col_offset=12), Call(Name('range', Load(), lineno=108, col_offset=17), [Num(1, lineno=108, col_offset=23), Call(Name('len', Load(), lineno=108, col_offset=26), [Name('lines', Load(), lineno=108, col_offset=30)], [], None, None, lineno=108, col_offset=26)], [], None, None, lineno=108, col_offset=17), [Assign([Subscript(Name('lines', Load(), lineno=109, col_offset=12), Index(Name('i', Load(), lineno=109, col_offset=18)), Store(), lineno=109, col_offset=12)], BinOp(Str('    ', lineno=109, col_offset=23), Add(), Call(Attribute(Subscript(Name('lines', Load(), lineno=109, col_offset=32), Index(Name('i', Load(), lineno=109, col_offset=38)), Load(), lineno=109, col_offset=32), 'strip', Load(), lineno=109, col_offset=32), [], [], None, None, lineno=109, col_offset=32), lineno=109, col_offset=23), lineno=109, col_offset=12)], [], lineno=108, col_offset=8), Assign([Name('value', Store(), lineno=110, col_offset=8)], BinOp(Call(Attribute(Str('\n', lineno=110, col_offset=16), 'join', Load(), lineno=110, col_offset=16), [Name('lines', Load(), lineno=110, col_offset=26)], [], None, None, lineno=110, col_offset=16), Add(), Str('\n', lineno=110, col_offset=35), lineno=110, col_offset=16), lineno=110, col_offset=8), Assign([Name('line', Store(), lineno=111, col_offset=8)], BinOp(BinOp(Name('key', Load(), lineno=111, col_offset=15), Add(), Str(': ', lineno=111, col_offset=21), lineno=111, col_offset=15), Add(), Name('value', Load(), lineno=111, col_offset=28), lineno=111, col_offset=26), lineno=111, col_offset=8), If(Name('prefix', Load(), lineno=112, col_offset=11), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=113, col_offset=12), '_headers', Load(), lineno=113, col_offset=12), 'insert', Load(), lineno=113, col_offset=12), [Num(0, lineno=113, col_offset=33), Name('line', Load(), lineno=113, col_offset=36)], [], None, None, lineno=113, col_offset=12), lineno=113, col_offset=12)], [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=115, col_offset=12), '_headers', Load(), lineno=115, col_offset=12), 'append', Load(), lineno=115, col_offset=12), [Name('line', Load(), lineno=115, col_offset=33)], [], None, None, lineno=115, col_offset=12), lineno=115, col_offset=12)], lineno=112, col_offset=8)], [], lineno=96, col_offset=4), FunctionDef('flushheaders', arguments([Name('self', Param(), lineno=117, col_offset=21)], None, None, []), [Expr(Str("Writes out and forgets all headers accumulated so far.\n\n        This is useful if you don't need a body part at all; for example,\n        for a subpart of type message/rfc822 that's (mis)used to store some\n        header-like information.\n\n        ", lineno=124, col_offset=-1), lineno=124, col_offset=-1), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=125, col_offset=8), '_fp', Load(), lineno=125, col_offset=8), 'writelines', Load(), lineno=125, col_offset=8), [Attribute(Name('self', Load(), lineno=125, col_offset=28), '_headers', Load(), lineno=125, col_offset=28)], [], None, None, lineno=125, col_offset=8), lineno=125, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=126, col_offset=8), '_headers', Store(), lineno=126, col_offset=8)], List([], Load(), lineno=126, col_offset=24), lineno=126, col_offset=8)], [], lineno=117, col_offset=4), FunctionDef('startbody', arguments([Name('self', Param(), lineno=128, col_offset=18), Name('ctype', Param(), lineno=128, col_offset=24), Name('plist', Param(), lineno=128, col_offset=31), Name('prefix', Param(), lineno=128, col_offset=41)], None, None, [List([], Load(), lineno=128, col_offset=37), Num(1, lineno=128, col_offset=48)]), [Expr(Str('Returns a file-like object for writing the body of the message.\n\n        The content-type is set to the provided ctype, and the optional\n        parameter, plist, provides additional parameters for the\n        content-type declaration.  The optional argument prefix determines\n        where the header is inserted; 0 means append at the end, 1 means\n        insert at the start. The default is to insert at the start.\n\n        ', lineno=137, col_offset=-1), lineno=137, col_offset=-1), For(Tuple([Name('name', Store(), lineno=138, col_offset=12), Name('value', Store(), lineno=138, col_offset=18)], Store(), lineno=138, col_offset=12), Name('plist', Load(), lineno=138, col_offset=27), [Assign([Name('ctype', Store(), lineno=139, col_offset=12)], BinOp(Name('ctype', Load(), lineno=139, col_offset=20), Add(), BinOp(Str(';\n %s="%s"', lineno=139, col_offset=28), Mod(), Tuple([Name('name', Load(), lineno=139, col_offset=47), Name('value', Load(), lineno=139, col_offset=53)], Load(), lineno=139, col_offset=47), lineno=139, col_offset=28), lineno=139, col_offset=20), lineno=139, col_offset=12)], [], lineno=138, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=140, col_offset=8), 'addheader', Load(), lineno=140, col_offset=8), [Str('Content-Type', lineno=140, col_offset=23), Name('ctype', Load(), lineno=140, col_offset=39)], [keyword('prefix', Name('prefix', Load(), lineno=140, col_offset=53))], None, None, lineno=140, col_offset=8), lineno=140, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=141, col_offset=8), 'flushheaders', Load(), lineno=141, col_offset=8), [], [], None, None, lineno=141, col_offset=8), lineno=141, col_offset=8), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=142, col_offset=8), '_fp', Load(), lineno=142, col_offset=8), 'write', Load(), lineno=142, col_offset=8), [Str('\n', lineno=142, col_offset=23)], [], None, None, lineno=142, col_offset=8), lineno=142, col_offset=8), Return(Attribute(Name('self', Load(), lineno=143, col_offset=15), '_fp', Load(), lineno=143, col_offset=15), lineno=143, col_offset=8)], [], lineno=128, col_offset=4), FunctionDef('startmultipartbody', arguments([Name('self', Param(), lineno=145, col_offset=27), Name('subtype', Param(), lineno=145, col_offset=33), Name('boundary', Param(), lineno=145, col_offset=42), Name('plist', Param(), lineno=145, col_offset=57), Name('prefix', Param(), lineno=145, col_offset=67)], None, None, [Name('None', Load(), lineno=145, col_offset=51), List([], Load(), lineno=145, col_offset=63), Num(1, lineno=145, col_offset=74)]), [Expr(Str('Returns a file-like object for writing the body of the message.\n\n        Additionally, this method initializes the multi-part code, where the\n        subtype parameter provides the multipart subtype, the boundary\n        parameter may provide a user-defined boundary specification, and the\n        plist parameter provides optional parameters for the subtype.  The\n        optional argument, prefix, determines where the header is inserted;\n        0 means append at the end, 1 means insert at the start. The default\n        is to insert at the start.  Subparts should be created using the\n        nextpart() method.\n\n        ', lineno=157, col_offset=-1), lineno=157, col_offset=-1), Assign([Attribute(Name('self', Load(), lineno=158, col_offset=8), '_boundary', Store(), lineno=158, col_offset=8)], BoolOp(Or(), [Name('boundary', Load(), lineno=158, col_offset=25), Call(Attribute(Name('mimetools', Load(), lineno=158, col_offset=37), 'choose_boundary', Load(), lineno=158, col_offset=37), [], [], None, None, lineno=158, col_offset=37)], lineno=158, col_offset=25), lineno=158, col_offset=8), Return(Call(Attribute(Name('self', Load(), lineno=159, col_offset=15), 'startbody', Load(), lineno=159, col_offset=15), [BinOp(Str('multipart/', lineno=159, col_offset=30), Add(), Name('subtype', Load(), lineno=159, col_offset=45), lineno=159, col_offset=30), BinOp(List([Tuple([Str('boundary', lineno=160, col_offset=32), Attribute(Name('self', Load(), lineno=160, col_offset=44), '_boundary', Load(), lineno=160, col_offset=44)], Load(), lineno=160, col_offset=32)], Load(), lineno=160, col_offset=30), Add(), Name('plist', Load(), lineno=160, col_offset=63), lineno=160, col_offset=30)], [keyword('prefix', Name('prefix', Load(), lineno=161, col_offset=37))], None, None, lineno=159, col_offset=15), lineno=159, col_offset=8)], [], lineno=145, col_offset=4), FunctionDef('nextpart', arguments([Name('self', Param(), lineno=163, col_offset=17)], None, None, []), [Expr(Str('Returns a new instance of MimeWriter which represents an\n        individual part in a multipart message.\n\n        This may be used to write the part as well as used for creating\n        recursively complex multipart messages. The message must first be\n        initialized with the startmultipartbody() method before using the\n        nextpart() method.\n\n        ', lineno=172, col_offset=-1), lineno=172, col_offset=-1), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=173, col_offset=8), '_fp', Load(), lineno=173, col_offset=8), 'write', Load(), lineno=173, col_offset=8), [BinOp(BinOp(Str('\n--', lineno=173, col_offset=23), Add(), Attribute(Name('self', Load(), lineno=173, col_offset=32), '_boundary', Load(), lineno=173, col_offset=32), lineno=173, col_offset=23), Add(), Str('\n', lineno=173, col_offset=49), lineno=173, col_offset=47)], [], None, None, lineno=173, col_offset=8), lineno=173, col_offset=8), Return(Call(Attribute(Name('self', Load(), lineno=174, col_offset=15), '__class__', Load(), lineno=174, col_offset=15), [Attribute(Name('self', Load(), lineno=174, col_offset=30), '_fp', Load(), lineno=174, col_offset=30)], [], None, None, lineno=174, col_offset=15), lineno=174, col_offset=8)], [], lineno=163, col_offset=4), FunctionDef('lastpart', arguments([Name('self', Param(), lineno=176, col_offset=17)], None, None, []), [Expr(Str('This is used to designate the last part of a multipart message.\n\n        It should always be used when writing multipart messages.\n\n        ', lineno=181, col_offset=-1), lineno=181, col_offset=-1), Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=182, col_offset=8), '_fp', Load(), lineno=182, col_offset=8), 'write', Load(), lineno=182, col_offset=8), [BinOp(BinOp(Str('\n--', lineno=182, col_offset=23), Add(), Attribute(Name('self', Load(), lineno=182, col_offset=32), '_boundary', Load(), lineno=182, col_offset=32), lineno=182, col_offset=23), Add(), Str('--\n', lineno=182, col_offset=49), lineno=182, col_offset=47)], [], None, None, lineno=182, col_offset=8), lineno=182, col_offset=8)], [], lineno=176, col_offset=4)], [], lineno=22, col_offset=0), If(Compare(Name('__name__', Load(), lineno=185, col_offset=3), [Eq()], [Str('__main__', lineno=185, col_offset=15)], lineno=185, col_offset=3), [Import([alias('test.test_MimeWriter', None)], lineno=186, col_offset=4)], [], lineno=185, col_offset=0)])
