Module([Expr(Str('Mailcap file handling.  See RFC 1524.', lineno=1, col_offset=0), lineno=1, col_offset=0), Import([alias('os', None)], lineno=3, col_offset=0), Assign([Name('__all__', Store(), lineno=5, col_offset=0)], List([Str('getcaps', lineno=5, col_offset=11), Str('findmatch', lineno=5, col_offset=21)], Load(), lineno=5, col_offset=10), lineno=5, col_offset=0), FunctionDef('getcaps', arguments([], None, None, []), [Expr(Str('Return a dictionary containing the mailcap database.\n\n    The dictionary maps a MIME type (in all lowercase, e.g. \'text/plain\')\n    to a list of dictionaries corresponding to mailcap entries.  The list\n    collects all the entries for that MIME type from all available mailcap\n    files.  Each dictionary contains key-value pairs for that MIME type,\n    where the viewing command is stored with the key "view".\n\n    ', lineno=18, col_offset=-1), lineno=18, col_offset=-1), Assign([Name('caps', Store(), lineno=19, col_offset=4)], Dict([], [], lineno=19, col_offset=11), lineno=19, col_offset=4), For(Name('mailcap', Store(), lineno=20, col_offset=8), Call(Name('listmailcapfiles', Load(), lineno=20, col_offset=19), [], [], None, None, lineno=20, col_offset=19), [TryExcept([Assign([Name('fp', Store(), lineno=22, col_offset=12)], Call(Name('open', Load(), lineno=22, col_offset=17), [Name('mailcap', Load(), lineno=22, col_offset=22), Str('r', lineno=22, col_offset=31)], [], None, None, lineno=22, col_offset=17), lineno=22, col_offset=12)], [ExceptHandler(Name('IOError', Load(), lineno=23, col_offset=15), None, [Continue( lineno=24, col_offset=12)], lineno=23, col_offset=8)], [], lineno=21, col_offset=8), Assign([Name('morecaps', Store(), lineno=25, col_offset=8)], Call(Name('readmailcapfile', Load(), lineno=25, col_offset=19), [Name('fp', Load(), lineno=25, col_offset=35)], [], None, None, lineno=25, col_offset=19), lineno=25, col_offset=8), Expr(Call(Attribute(Name('fp', Load(), lineno=26, col_offset=8), 'close', Load(), lineno=26, col_offset=8), [], [], None, None, lineno=26, col_offset=8), lineno=26, col_offset=8), For(Tuple([Name('key', Store(), lineno=27, col_offset=12), Name('value', Store(), lineno=27, col_offset=17)], Store(), lineno=27, col_offset=12), Call(Attribute(Name('morecaps', Load(), lineno=27, col_offset=26), 'iteritems', Load(), lineno=27, col_offset=26), [], [], None, None, lineno=27, col_offset=26), [If(UnaryOp(Not(), Compare(Name('key', Load(), lineno=28, col_offset=19), [In()], [Name('caps', Load(), lineno=28, col_offset=26)], lineno=28, col_offset=19), lineno=28, col_offset=15), [Assign([Subscript(Name('caps', Load(), lineno=29, col_offset=16), Index(Name('key', Load(), lineno=29, col_offset=21)), Store(), lineno=29, col_offset=16)], Name('value', Load(), lineno=29, col_offset=28), lineno=29, col_offset=16)], [Assign([Subscript(Name('caps', Load(), lineno=31, col_offset=16), Index(Name('key', Load(), lineno=31, col_offset=21)), Store(), lineno=31, col_offset=16)], BinOp(Subscript(Name('caps', Load(), lineno=31, col_offset=28), Index(Name('key', Load(), lineno=31, col_offset=33)), Load(), lineno=31, col_offset=28), Add(), Name('value', Load(), lineno=31, col_offset=40), lineno=31, col_offset=28), lineno=31, col_offset=16)], lineno=28, col_offset=12)], [], lineno=27, col_offset=8)], [], lineno=20, col_offset=4), Return(Name('caps', Load(), lineno=32, col_offset=11), lineno=32, col_offset=4)], [], lineno=9, col_offset=0), FunctionDef('listmailcapfiles', arguments([], None, None, []), [Expr(Str('Return a list of all mailcap files found on the system.', lineno=35, col_offset=4), lineno=35, col_offset=4), If(Compare(Str('MAILCAPS', lineno=37, col_offset=7), [In()], [Attribute(Name('os', Load(), lineno=37, col_offset=21), 'environ', Load(), lineno=37, col_offset=21)], lineno=37, col_offset=7), [Assign([Name('str', Store(), lineno=38, col_offset=8)], Subscript(Attribute(Name('os', Load(), lineno=38, col_offset=14), 'environ', Load(), lineno=38, col_offset=14), Index(Str('MAILCAPS', lineno=38, col_offset=25)), Load(), lineno=38, col_offset=14), lineno=38, col_offset=8), Assign([Name('mailcaps', Store(), lineno=39, col_offset=8)], Call(Attribute(Name('str', Load(), lineno=39, col_offset=19), 'split', Load(), lineno=39, col_offset=19), [Str(':', lineno=39, col_offset=29)], [], None, None, lineno=39, col_offset=19), lineno=39, col_offset=8)], [If(Compare(Str('HOME', lineno=41, col_offset=11), [In()], [Attribute(Name('os', Load(), lineno=41, col_offset=21), 'environ', Load(), lineno=41, col_offset=21)], lineno=41, col_offset=11), [Assign([Name('home', Store(), lineno=42, col_offset=12)], Subscript(Attribute(Name('os', Load(), lineno=42, col_offset=19), 'environ', Load(), lineno=42, col_offset=19), Index(Str('HOME', lineno=42, col_offset=30)), Load(), lineno=42, col_offset=19), lineno=42, col_offset=12)], [Assign([Name('home', Store(), lineno=45, col_offset=12)], Str('.', lineno=45, col_offset=19), lineno=45, col_offset=12)], lineno=41, col_offset=8), Assign([Name('mailcaps', Store(), lineno=46, col_offset=8)], List([BinOp(Name('home', Load(), lineno=46, col_offset=20), Add(), Str('/.mailcap', lineno=46, col_offset=27), lineno=46, col_offset=20), Str('/etc/mailcap', lineno=46, col_offset=40), Str('/usr/etc/mailcap', lineno=47, col_offset=16), Str('/usr/local/etc/mailcap', lineno=47, col_offset=36)], Load(), lineno=46, col_offset=19), lineno=46, col_offset=8)], lineno=37, col_offset=4), Return(Name('mailcaps', Load(), lineno=48, col_offset=11), lineno=48, col_offset=4)], [], lineno=34, col_offset=0), FunctionDef('readmailcapfile', arguments([Name('fp', Param(), lineno=53, col_offset=20)], None, None, []), [Expr(Str('Read a mailcap file and return a dictionary keyed by MIME type.\n\n    Each MIME type is mapped to an entry consisting of a list of\n    dictionaries; the list will contain more than one such dictionary\n    if a given MIME type appears more than once in the mailcap file.\n    Each dictionary contains key-value pairs for that MIME type, where\n    the viewing command is stored with the key "view".\n    ', lineno=61, col_offset=-1), lineno=61, col_offset=-1), Assign([Name('caps', Store(), lineno=62, col_offset=4)], Dict([], [], lineno=62, col_offset=11), lineno=62, col_offset=4), While(Num(1, lineno=63, col_offset=10), [Assign([Name('line', Store(), lineno=64, col_offset=8)], Call(Attribute(Name('fp', Load(), lineno=64, col_offset=15), 'readline', Load(), lineno=64, col_offset=15), [], [], None, None, lineno=64, col_offset=15), lineno=64, col_offset=8), If(UnaryOp(Not(), Name('line', Load(), lineno=65, col_offset=15), lineno=65, col_offset=11), [Break( lineno=65, col_offset=21)], [], lineno=65, col_offset=8), If(BoolOp(Or(), [Compare(Subscript(Name('line', Load(), lineno=67, col_offset=11), Index(Num(0, lineno=67, col_offset=16)), Load(), lineno=67, col_offset=11), [Eq()], [Str('#', lineno=67, col_offset=22)], lineno=67, col_offset=11), Compare(Call(Attribute(Name('line', Load(), lineno=67, col_offset=29), 'strip', Load(), lineno=67, col_offset=29), [], [], None, None, lineno=67, col_offset=29), [Eq()], [Str('', lineno=67, col_offset=45)], lineno=67, col_offset=29)], lineno=67, col_offset=11), [Continue( lineno=68, col_offset=12)], [], lineno=67, col_offset=8), Assign([Name('nextline', Store(), lineno=69, col_offset=8)], Name('line', Load(), lineno=69, col_offset=19), lineno=69, col_offset=8), While(Compare(Subscript(Name('nextline', Load(), lineno=71, col_offset=14), Slice(Num(-2, lineno=71, col_offset=24), None, None), Load(), lineno=71, col_offset=14), [Eq()], [Str('\\\n', lineno=71, col_offset=31)], lineno=71, col_offset=14), [Assign([Name('nextline', Store(), lineno=72, col_offset=12)], Call(Attribute(Name('fp', Load(), lineno=72, col_offset=23), 'readline', Load(), lineno=72, col_offset=23), [], [], None, None, lineno=72, col_offset=23), lineno=72, col_offset=12), If(UnaryOp(Not(), Name('nextline', Load(), lineno=73, col_offset=19), lineno=73, col_offset=15), [Assign([Name('nextline', Store(), lineno=73, col_offset=29)], Str('\n', lineno=73, col_offset=40), lineno=73, col_offset=29)], [], lineno=73, col_offset=12), Assign([Name('line', Store(), lineno=74, col_offset=12)], BinOp(Subscript(Name('line', Load(), lineno=74, col_offset=19), Slice(None, Num(-2, lineno=74, col_offset=26), None), Load(), lineno=74, col_offset=19), Add(), Name('nextline', Load(), lineno=74, col_offset=31), lineno=74, col_offset=19), lineno=74, col_offset=12)], [], lineno=71, col_offset=8), Assign([Tuple([Name('key', Store(), lineno=76, col_offset=8), Name('fields', Store(), lineno=76, col_offset=13)], Store(), lineno=76, col_offset=8)], Call(Name('parseline', Load(), lineno=76, col_offset=22), [Name('line', Load(), lineno=76, col_offset=32)], [], None, None, lineno=76, col_offset=22), lineno=76, col_offset=8), If(UnaryOp(Not(), BoolOp(And(), [Name('key', Load(), lineno=77, col_offset=16), Name('fields', Load(), lineno=77, col_offset=24)], lineno=77, col_offset=16), lineno=77, col_offset=11), [Continue( lineno=78, col_offset=12)], [], lineno=77, col_offset=8), Assign([Name('types', Store(), lineno=80, col_offset=8)], Call(Attribute(Name('key', Load(), lineno=80, col_offset=16), 'split', Load(), lineno=80, col_offset=16), [Str('/', lineno=80, col_offset=26)], [], None, None, lineno=80, col_offset=16), lineno=80, col_offset=8), For(Name('j', Store(), lineno=81, col_offset=12), Call(Name('range', Load(), lineno=81, col_offset=17), [Call(Name('len', Load(), lineno=81, col_offset=23), [Name('types', Load(), lineno=81, col_offset=27)], [], None, None, lineno=81, col_offset=23)], [], None, None, lineno=81, col_offset=17), [Assign([Subscript(Name('types', Load(), lineno=82, col_offset=12), Index(Name('j', Load(), lineno=82, col_offset=18)), Store(), lineno=82, col_offset=12)], Call(Attribute(Subscript(Name('types', Load(), lineno=82, col_offset=23), Index(Name('j', Load(), lineno=82, col_offset=29)), Load(), lineno=82, col_offset=23), 'strip', Load(), lineno=82, col_offset=23), [], [], None, None, lineno=82, col_offset=23), lineno=82, col_offset=12)], [], lineno=81, col_offset=8), Assign([Name('key', Store(), lineno=83, col_offset=8)], Call(Attribute(Call(Attribute(Str('/', lineno=83, col_offset=14), 'join', Load(), lineno=83, col_offset=14), [Name('types', Load(), lineno=83, col_offset=23)], [], None, None, lineno=83, col_offset=14), 'lower', Load(), lineno=83, col_offset=14), [], [], None, None, lineno=83, col_offset=14), lineno=83, col_offset=8), If(Compare(Name('key', Load(), lineno=85, col_offset=11), [In()], [Name('caps', Load(), lineno=85, col_offset=18)], lineno=85, col_offset=11), [Expr(Call(Attribute(Subscript(Name('caps', Load(), lineno=86, col_offset=12), Index(Name('key', Load(), lineno=86, col_offset=17)), Load(), lineno=86, col_offset=12), 'append', Load(), lineno=86, col_offset=12), [Name('fields', Load(), lineno=86, col_offset=29)], [], None, None, lineno=86, col_offset=12), lineno=86, col_offset=12)], [Assign([Subscript(Name('caps', Load(), lineno=88, col_offset=12), Index(Name('key', Load(), lineno=88, col_offset=17)), Store(), lineno=88, col_offset=12)], List([Name('fields', Load(), lineno=88, col_offset=25)], Load(), lineno=88, col_offset=24), lineno=88, col_offset=12)], lineno=85, col_offset=8)], [], lineno=63, col_offset=4), Return(Name('caps', Load(), lineno=89, col_offset=11), lineno=89, col_offset=4)], [], lineno=53, col_offset=0), FunctionDef('parseline', arguments([Name('line', Param(), lineno=91, col_offset=14)], None, None, []), [Expr(Str('Parse one entry in a mailcap file and return a dictionary.\n\n    The viewing command is stored as the value with the key "view",\n    and the rest of the fields produce key-value pairs in the dict.\n    ', lineno=96, col_offset=-1), lineno=96, col_offset=-1), Assign([Name('fields', Store(), lineno=97, col_offset=4)], List([], Load(), lineno=97, col_offset=13), lineno=97, col_offset=4), Assign([Tuple([Name('i', Store(), lineno=98, col_offset=4), Name('n', Store(), lineno=98, col_offset=7)], Store(), lineno=98, col_offset=4)], Tuple([Num(0, lineno=98, col_offset=11), Call(Name('len', Load(), lineno=98, col_offset=14), [Name('line', Load(), lineno=98, col_offset=18)], [], None, None, lineno=98, col_offset=14)], Load(), lineno=98, col_offset=11), lineno=98, col_offset=4), While(Compare(Name('i', Load(), lineno=99, col_offset=10), [Lt()], [Name('n', Load(), lineno=99, col_offset=14)], lineno=99, col_offset=10), [Assign([Tuple([Name('field', Store(), lineno=100, col_offset=8), Name('i', Store(), lineno=100, col_offset=15)], Store(), lineno=100, col_offset=8)], Call(Name('parsefield', Load(), lineno=100, col_offset=19), [Name('line', Load(), lineno=100, col_offset=30), Name('i', Load(), lineno=100, col_offset=36), Name('n', Load(), lineno=100, col_offset=39)], [], None, None, lineno=100, col_offset=19), lineno=100, col_offset=8), Expr(Call(Attribute(Name('fields', Load(), lineno=101, col_offset=8), 'append', Load(), lineno=101, col_offset=8), [Name('field', Load(), lineno=101, col_offset=22)], [], None, None, lineno=101, col_offset=8), lineno=101, col_offset=8), Assign([Name('i', Store(), lineno=102, col_offset=8)], BinOp(Name('i', Load(), lineno=102, col_offset=12), Add(), Num(1, lineno=102, col_offset=14), lineno=102, col_offset=12), lineno=102, col_offset=8)], [], lineno=99, col_offset=4), If(Compare(Call(Name('len', Load(), lineno=103, col_offset=7), [Name('fields', Load(), lineno=103, col_offset=11)], [], None, None, lineno=103, col_offset=7), [Lt()], [Num(2, lineno=103, col_offset=21)], lineno=103, col_offset=7), [Return(Tuple([Name('None', Load(), lineno=104, col_offset=15), Name('None', Load(), lineno=104, col_offset=21)], Load(), lineno=104, col_offset=15), lineno=104, col_offset=8)], [], lineno=103, col_offset=4), Assign([Tuple([Name('key', Store(), lineno=105, col_offset=4), Name('view', Store(), lineno=105, col_offset=9), Name('rest', Store(), lineno=105, col_offset=15)], Store(), lineno=105, col_offset=4)], Tuple([Subscript(Name('fields', Load(), lineno=105, col_offset=22), Index(Num(0, lineno=105, col_offset=29)), Load(), lineno=105, col_offset=22), Subscript(Name('fields', Load(), lineno=105, col_offset=33), Index(Num(1, lineno=105, col_offset=40)), Load(), lineno=105, col_offset=33), Subscript(Name('fields', Load(), lineno=105, col_offset=44), Slice(Num(2, lineno=105, col_offset=51), None, None), Load(), lineno=105, col_offset=44)], Load(), lineno=105, col_offset=22), lineno=105, col_offset=4), Assign([Name('fields', Store(), lineno=106, col_offset=4)], Dict([Str('view', lineno=106, col_offset=14)], [Name('view', Load(), lineno=106, col_offset=22)], lineno=106, col_offset=13), lineno=106, col_offset=4), For(Name('field', Store(), lineno=107, col_offset=8), Name('rest', Load(), lineno=107, col_offset=17), [Assign([Name('i', Store(), lineno=108, col_offset=8)], Call(Attribute(Name('field', Load(), lineno=108, col_offset=12), 'find', Load(), lineno=108, col_offset=12), [Str('=', lineno=108, col_offset=23)], [], None, None, lineno=108, col_offset=12), lineno=108, col_offset=8), If(Compare(Name('i', Load(), lineno=109, col_offset=11), [Lt()], [Num(0, lineno=109, col_offset=15)], lineno=109, col_offset=11), [Assign([Name('fkey', Store(), lineno=110, col_offset=12)], Name('field', Load(), lineno=110, col_offset=19), lineno=110, col_offset=12), Assign([Name('fvalue', Store(), lineno=111, col_offset=12)], Str('', lineno=111, col_offset=21), lineno=111, col_offset=12)], [Assign([Name('fkey', Store(), lineno=113, col_offset=12)], Call(Attribute(Subscript(Name('field', Load(), lineno=113, col_offset=19), Slice(None, Name('i', Load(), lineno=113, col_offset=26), None), Load(), lineno=113, col_offset=19), 'strip', Load(), lineno=113, col_offset=19), [], [], None, None, lineno=113, col_offset=19), lineno=113, col_offset=12), Assign([Name('fvalue', Store(), lineno=114, col_offset=12)], Call(Attribute(Subscript(Name('field', Load(), lineno=114, col_offset=21), Slice(BinOp(Name('i', Load(), lineno=114, col_offset=27), Add(), Num(1, lineno=114, col_offset=29), lineno=114, col_offset=27), None, None), Load(), lineno=114, col_offset=21), 'strip', Load(), lineno=114, col_offset=21), [], [], None, None, lineno=114, col_offset=21), lineno=114, col_offset=12)], lineno=109, col_offset=8), If(Compare(Name('fkey', Load(), lineno=115, col_offset=11), [In()], [Name('fields', Load(), lineno=115, col_offset=19)], lineno=115, col_offset=11), [Pass( lineno=117, col_offset=12)], [Assign([Subscript(Name('fields', Load(), lineno=119, col_offset=12), Index(Name('fkey', Load(), lineno=119, col_offset=19)), Store(), lineno=119, col_offset=12)], Name('fvalue', Load(), lineno=119, col_offset=27), lineno=119, col_offset=12)], lineno=115, col_offset=8)], [], lineno=107, col_offset=4), Return(Tuple([Name('key', Load(), lineno=120, col_offset=11), Name('fields', Load(), lineno=120, col_offset=16)], Load(), lineno=120, col_offset=11), lineno=120, col_offset=4)], [], lineno=91, col_offset=0), FunctionDef('parsefield', arguments([Name('line', Param(), lineno=122, col_offset=15), Name('i', Param(), lineno=122, col_offset=21), Name('n', Param(), lineno=122, col_offset=24)], None, None, []), [Expr(Str('Separate one key-value pair in a mailcap entry.', lineno=123, col_offset=4), lineno=123, col_offset=4), Assign([Name('start', Store(), lineno=124, col_offset=4)], Name('i', Load(), lineno=124, col_offset=12), lineno=124, col_offset=4), While(Compare(Name('i', Load(), lineno=125, col_offset=10), [Lt()], [Name('n', Load(), lineno=125, col_offset=14)], lineno=125, col_offset=10), [Assign([Name('c', Store(), lineno=126, col_offset=8)], Subscript(Name('line', Load(), lineno=126, col_offset=12), Index(Name('i', Load(), lineno=126, col_offset=17)), Load(), lineno=126, col_offset=12), lineno=126, col_offset=8), If(Compare(Name('c', Load(), lineno=127, col_offset=11), [Eq()], [Str(';', lineno=127, col_offset=16)], lineno=127, col_offset=11), [Break( lineno=128, col_offset=12)], [If(Compare(Name('c', Load(), lineno=129, col_offset=13), [Eq()], [Str('\\', lineno=129, col_offset=18)], lineno=129, col_offset=13), [Assign([Name('i', Store(), lineno=130, col_offset=12)], BinOp(Name('i', Load(), lineno=130, col_offset=16), Add(), Num(2, lineno=130, col_offset=18), lineno=130, col_offset=16), lineno=130, col_offset=12)], [Assign([Name('i', Store(), lineno=132, col_offset=12)], BinOp(Name('i', Load(), lineno=132, col_offset=16), Add(), Num(1, lineno=132, col_offset=18), lineno=132, col_offset=16), lineno=132, col_offset=12)], lineno=129, col_offset=13)], lineno=127, col_offset=8)], [], lineno=125, col_offset=4), Return(Tuple([Call(Attribute(Subscript(Name('line', Load(), lineno=133, col_offset=11), Slice(Name('start', Load(), lineno=133, col_offset=16), Name('i', Load(), lineno=133, col_offset=22), None), Load(), lineno=133, col_offset=11), 'strip', Load(), lineno=133, col_offset=11), [], [], None, None, lineno=133, col_offset=11), Name('i', Load(), lineno=133, col_offset=34)], Load(), lineno=133, col_offset=11), lineno=133, col_offset=4)], [], lineno=122, col_offset=0), FunctionDef('findmatch', arguments([Name('caps', Param(), lineno=138, col_offset=14), Name('MIMEtype', Param(), lineno=138, col_offset=20), Name('key', Param(), lineno=138, col_offset=30), Name('filename', Param(), lineno=138, col_offset=42), Name('plist', Param(), lineno=138, col_offset=64)], None, None, [Str('view', lineno=138, col_offset=34), Str('/dev/null', lineno=138, col_offset=51), List([], Load(), lineno=138, col_offset=70)]), [Expr(Str("Find a match for a mailcap entry.\n\n    Return a tuple containing the command line, and the mailcap entry\n    used; (None, None) if no match is found.  This may invoke the\n    'test' command of several matching entries before deciding which\n    entry to use.\n\n    ", lineno=146, col_offset=-1), lineno=146, col_offset=-1), Assign([Name('entries', Store(), lineno=147, col_offset=4)], Call(Name('lookup', Load(), lineno=147, col_offset=14), [Name('caps', Load(), lineno=147, col_offset=21), Name('MIMEtype', Load(), lineno=147, col_offset=27), Name('key', Load(), lineno=147, col_offset=37)], [], None, None, lineno=147, col_offset=14), lineno=147, col_offset=4), For(Name('e', Store(), lineno=149, col_offset=8), Name('entries', Load(), lineno=149, col_offset=13), [If(Compare(Str('test', lineno=150, col_offset=11), [In()], [Name('e', Load(), lineno=150, col_offset=21)], lineno=150, col_offset=11), [Assign([Name('test', Store(), lineno=151, col_offset=12)], Call(Name('subst', Load(), lineno=151, col_offset=19), [Subscript(Name('e', Load(), lineno=151, col_offset=25), Index(Str('test', lineno=151, col_offset=27)), Load(), lineno=151, col_offset=25), Name('filename', Load(), lineno=151, col_offset=36), Name('plist', Load(), lineno=151, col_offset=46)], [], None, None, lineno=151, col_offset=19), lineno=151, col_offset=12), If(BoolOp(And(), [Name('test', Load(), lineno=152, col_offset=15), Compare(Call(Attribute(Name('os', Load(), lineno=152, col_offset=24), 'system', Load(), lineno=152, col_offset=24), [Name('test', Load(), lineno=152, col_offset=34)], [], None, None, lineno=152, col_offset=24), [NotEq()], [Num(0, lineno=152, col_offset=43)], lineno=152, col_offset=24)], lineno=152, col_offset=15), [Continue( lineno=153, col_offset=16)], [], lineno=152, col_offset=12)], [], lineno=150, col_offset=8), Assign([Name('command', Store(), lineno=154, col_offset=8)], Call(Name('subst', Load(), lineno=154, col_offset=18), [Subscript(Name('e', Load(), lineno=154, col_offset=24), Index(Name('key', Load(), lineno=154, col_offset=26)), Load(), lineno=154, col_offset=24), Name('MIMEtype', Load(), lineno=154, col_offset=32), Name('filename', Load(), lineno=154, col_offset=42), Name('plist', Load(), lineno=154, col_offset=52)], [], None, None, lineno=154, col_offset=18), lineno=154, col_offset=8), Return(Tuple([Name('command', Load(), lineno=155, col_offset=15), Name('e', Load(), lineno=155, col_offset=24)], Load(), lineno=155, col_offset=15), lineno=155, col_offset=8)], [], lineno=149, col_offset=4), Return(Tuple([Name('None', Load(), lineno=156, col_offset=11), Name('None', Load(), lineno=156, col_offset=17)], Load(), lineno=156, col_offset=11), lineno=156, col_offset=4)], [], lineno=138, col_offset=0), FunctionDef('lookup', arguments([Name('caps', Param(), lineno=158, col_offset=11), Name('MIMEtype', Param(), lineno=158, col_offset=17), Name('key', Param(), lineno=158, col_offset=27)], None, None, [Name('None', Load(), lineno=158, col_offset=31)]), [Assign([Name('entries', Store(), lineno=159, col_offset=4)], List([], Load(), lineno=159, col_offset=14), lineno=159, col_offset=4), If(Compare(Name('MIMEtype', Load(), lineno=160, col_offset=7), [In()], [Name('caps', Load(), lineno=160, col_offset=19)], lineno=160, col_offset=7), [Assign([Name('entries', Store(), lineno=161, col_offset=8)], BinOp(Name('entries', Load(), lineno=161, col_offset=18), Add(), Subscript(Name('caps', Load(), lineno=161, col_offset=28), Index(Name('MIMEtype', Load(), lineno=161, col_offset=33)), Load(), lineno=161, col_offset=28), lineno=161, col_offset=18), lineno=161, col_offset=8)], [], lineno=160, col_offset=4), Assign([Name('MIMEtypes', Store(), lineno=162, col_offset=4)], Call(Attribute(Name('MIMEtype', Load(), lineno=162, col_offset=16), 'split', Load(), lineno=162, col_offset=16), [Str('/', lineno=162, col_offset=31)], [], None, None, lineno=162, col_offset=16), lineno=162, col_offset=4), Assign([Name('MIMEtype', Store(), lineno=163, col_offset=4)], BinOp(Subscript(Name('MIMEtypes', Load(), lineno=163, col_offset=15), Index(Num(0, lineno=163, col_offset=25)), Load(), lineno=163, col_offset=15), Add(), Str('/*', lineno=163, col_offset=30), lineno=163, col_offset=15), lineno=163, col_offset=4), If(Compare(Name('MIMEtype', Load(), lineno=164, col_offset=7), [In()], [Name('caps', Load(), lineno=164, col_offset=19)], lineno=164, col_offset=7), [Assign([Name('entries', Store(), lineno=165, col_offset=8)], BinOp(Name('entries', Load(), lineno=165, col_offset=18), Add(), Subscript(Name('caps', Load(), lineno=165, col_offset=28), Index(Name('MIMEtype', Load(), lineno=165, col_offset=33)), Load(), lineno=165, col_offset=28), lineno=165, col_offset=18), lineno=165, col_offset=8)], [], lineno=164, col_offset=4), If(Compare(Name('key', Load(), lineno=166, col_offset=7), [IsNot()], [Name('None', Load(), lineno=166, col_offset=18)], lineno=166, col_offset=7), [Assign([Name('entries', Store(), lineno=167, col_offset=8)], Call(Name('filter', Load(), lineno=167, col_offset=18), [Lambda(arguments([Name('e', Param(), lineno=167, col_offset=32), Name('key', Param(), lineno=167, col_offset=35)], None, None, [Name('key', Load(), lineno=167, col_offset=39)]), Compare(Name('key', Load(), lineno=167, col_offset=44), [In()], [Name('e', Load(), lineno=167, col_offset=51)], lineno=167, col_offset=44), lineno=167, col_offset=25), Name('entries', Load(), lineno=167, col_offset=54)], [], None, None, lineno=167, col_offset=18), lineno=167, col_offset=8)], [], lineno=166, col_offset=4), Return(Name('entries', Load(), lineno=168, col_offset=11), lineno=168, col_offset=4)], [], lineno=158, col_offset=0), FunctionDef('subst', arguments([Name('field', Param(), lineno=170, col_offset=10), Name('MIMEtype', Param(), lineno=170, col_offset=17), Name('filename', Param(), lineno=170, col_offset=27), Name('plist', Param(), lineno=170, col_offset=37)], None, None, [List([], Load(), lineno=170, col_offset=43)]), [Assign([Name('res', Store(), lineno=172, col_offset=4)], Str('', lineno=172, col_offset=10), lineno=172, col_offset=4), Assign([Tuple([Name('i', Store(), lineno=173, col_offset=4), Name('n', Store(), lineno=173, col_offset=7)], Store(), lineno=173, col_offset=4)], Tuple([Num(0, lineno=173, col_offset=11), Call(Name('len', Load(), lineno=173, col_offset=14), [Name('field', Load(), lineno=173, col_offset=18)], [], None, None, lineno=173, col_offset=14)], Load(), lineno=173, col_offset=11), lineno=173, col_offset=4), While(Compare(Name('i', Load(), lineno=174, col_offset=10), [Lt()], [Name('n', Load(), lineno=174, col_offset=14)], lineno=174, col_offset=10), [Assign([Name('c', Store(), lineno=175, col_offset=8)], Subscript(Name('field', Load(), lineno=175, col_offset=12), Index(Name('i', Load(), lineno=175, col_offset=18)), Load(), lineno=175, col_offset=12), lineno=175, col_offset=8), Assign([Name('i', Store(), lineno=175, col_offset=22)], BinOp(Name('i', Load(), lineno=175, col_offset=26), Add(), Num(1, lineno=175, col_offset=28), lineno=175, col_offset=26), lineno=175, col_offset=22), If(Compare(Name('c', Load(), lineno=176, col_offset=11), [NotEq()], [Str('%', lineno=176, col_offset=16)], lineno=176, col_offset=11), [If(Compare(Name('c', Load(), lineno=177, col_offset=15), [Eq()], [Str('\\', lineno=177, col_offset=20)], lineno=177, col_offset=15), [Assign([Name('c', Store(), lineno=178, col_offset=16)], Subscript(Name('field', Load(), lineno=178, col_offset=20), Slice(Name('i', Load(), lineno=178, col_offset=26), BinOp(Name('i', Load(), lineno=178, col_offset=28), Add(), Num(1, lineno=178, col_offset=30), lineno=178, col_offset=28), None), Load(), lineno=178, col_offset=20), lineno=178, col_offset=16), Assign([Name('i', Store(), lineno=178, col_offset=34)], BinOp(Name('i', Load(), lineno=178, col_offset=38), Add(), Num(1, lineno=178, col_offset=40), lineno=178, col_offset=38), lineno=178, col_offset=34)], [], lineno=177, col_offset=12), Assign([Name('res', Store(), lineno=179, col_offset=12)], BinOp(Name('res', Load(), lineno=179, col_offset=18), Add(), Name('c', Load(), lineno=179, col_offset=24), lineno=179, col_offset=18), lineno=179, col_offset=12)], [Assign([Name('c', Store(), lineno=181, col_offset=12)], Subscript(Name('field', Load(), lineno=181, col_offset=16), Index(Name('i', Load(), lineno=181, col_offset=22)), Load(), lineno=181, col_offset=16), lineno=181, col_offset=12), Assign([Name('i', Store(), lineno=181, col_offset=26)], BinOp(Name('i', Load(), lineno=181, col_offset=30), Add(), Num(1, lineno=181, col_offset=32), lineno=181, col_offset=30), lineno=181, col_offset=26), If(Compare(Name('c', Load(), lineno=182, col_offset=15), [Eq()], [Str('%', lineno=182, col_offset=20)], lineno=182, col_offset=15), [Assign([Name('res', Store(), lineno=183, col_offset=16)], BinOp(Name('res', Load(), lineno=183, col_offset=22), Add(), Name('c', Load(), lineno=183, col_offset=28), lineno=183, col_offset=22), lineno=183, col_offset=16)], [If(Compare(Name('c', Load(), lineno=184, col_offset=17), [Eq()], [Str('s', lineno=184, col_offset=22)], lineno=184, col_offset=17), [Assign([Name('res', Store(), lineno=185, col_offset=16)], BinOp(Name('res', Load(), lineno=185, col_offset=22), Add(), Name('filename', Load(), lineno=185, col_offset=28), lineno=185, col_offset=22), lineno=185, col_offset=16)], [If(Compare(Name('c', Load(), lineno=186, col_offset=17), [Eq()], [Str('t', lineno=186, col_offset=22)], lineno=186, col_offset=17), [Assign([Name('res', Store(), lineno=187, col_offset=16)], BinOp(Name('res', Load(), lineno=187, col_offset=22), Add(), Name('MIMEtype', Load(), lineno=187, col_offset=28), lineno=187, col_offset=22), lineno=187, col_offset=16)], [If(Compare(Name('c', Load(), lineno=188, col_offset=17), [Eq()], [Str('{', lineno=188, col_offset=22)], lineno=188, col_offset=17), [Assign([Name('start', Store(), lineno=189, col_offset=16)], Name('i', Load(), lineno=189, col_offset=24), lineno=189, col_offset=16), While(BoolOp(And(), [Compare(Name('i', Load(), lineno=190, col_offset=22), [Lt()], [Name('n', Load(), lineno=190, col_offset=26)], lineno=190, col_offset=22), Compare(Subscript(Name('field', Load(), lineno=190, col_offset=32), Index(Name('i', Load(), lineno=190, col_offset=38)), Load(), lineno=190, col_offset=32), [NotEq()], [Str('}', lineno=190, col_offset=44)], lineno=190, col_offset=32)], lineno=190, col_offset=22), [Assign([Name('i', Store(), lineno=191, col_offset=20)], BinOp(Name('i', Load(), lineno=191, col_offset=24), Add(), Num(1, lineno=191, col_offset=26), lineno=191, col_offset=24), lineno=191, col_offset=20)], [], lineno=190, col_offset=16), Assign([Name('name', Store(), lineno=192, col_offset=16)], Subscript(Name('field', Load(), lineno=192, col_offset=23), Slice(Name('start', Load(), lineno=192, col_offset=29), Name('i', Load(), lineno=192, col_offset=35), None), Load(), lineno=192, col_offset=23), lineno=192, col_offset=16), Assign([Name('i', Store(), lineno=193, col_offset=16)], BinOp(Name('i', Load(), lineno=193, col_offset=20), Add(), Num(1, lineno=193, col_offset=22), lineno=193, col_offset=20), lineno=193, col_offset=16), Assign([Name('res', Store(), lineno=194, col_offset=16)], BinOp(Name('res', Load(), lineno=194, col_offset=22), Add(), Call(Name('findparam', Load(), lineno=194, col_offset=28), [Name('name', Load(), lineno=194, col_offset=38), Name('plist', Load(), lineno=194, col_offset=44)], [], None, None, lineno=194, col_offset=28), lineno=194, col_offset=22), lineno=194, col_offset=16)], [Assign([Name('res', Store(), lineno=199, col_offset=16)], BinOp(BinOp(Name('res', Load(), lineno=199, col_offset=22), Add(), Str('%', lineno=199, col_offset=28), lineno=199, col_offset=22), Add(), Name('c', Load(), lineno=199, col_offset=34), lineno=199, col_offset=32), lineno=199, col_offset=16)], lineno=188, col_offset=17)], lineno=186, col_offset=17)], lineno=184, col_offset=17)], lineno=182, col_offset=12)], lineno=176, col_offset=8)], [], lineno=174, col_offset=4), Return(Name('res', Load(), lineno=200, col_offset=11), lineno=200, col_offset=4)], [], lineno=170, col_offset=0), FunctionDef('findparam', arguments([Name('name', Param(), lineno=202, col_offset=14), Name('plist', Param(), lineno=202, col_offset=20)], None, None, []), [Assign([Name('name', Store(), lineno=203, col_offset=4)], BinOp(Call(Attribute(Name('name', Load(), lineno=203, col_offset=11), 'lower', Load(), lineno=203, col_offset=11), [], [], None, None, lineno=203, col_offset=11), Add(), Str('=', lineno=203, col_offset=26), lineno=203, col_offset=11), lineno=203, col_offset=4), Assign([Name('n', Store(), lineno=204, col_offset=4)], Call(Name('len', Load(), lineno=204, col_offset=8), [Name('name', Load(), lineno=204, col_offset=12)], [], None, None, lineno=204, col_offset=8), lineno=204, col_offset=4), For(Name('p', Store(), lineno=205, col_offset=8), Name('plist', Load(), lineno=205, col_offset=13), [If(Compare(Call(Attribute(Subscript(Name('p', Load(), lineno=206, col_offset=11), Slice(None, Name('n', Load(), lineno=206, col_offset=14), None), Load(), lineno=206, col_offset=11), 'lower', Load(), lineno=206, col_offset=11), [], [], None, None, lineno=206, col_offset=11), [Eq()], [Name('name', Load(), lineno=206, col_offset=28)], lineno=206, col_offset=11), [Return(Subscript(Name('p', Load(), lineno=207, col_offset=19), Slice(Name('n', Load(), lineno=207, col_offset=21), None, None), Load(), lineno=207, col_offset=19), lineno=207, col_offset=12)], [], lineno=206, col_offset=8)], [], lineno=205, col_offset=4), Return(Str('', lineno=208, col_offset=11), lineno=208, col_offset=4)], [], lineno=202, col_offset=0), FunctionDef('test', arguments([], None, None, []), [Import([alias('sys', None)], lineno=214, col_offset=4), Assign([Name('caps', Store(), lineno=215, col_offset=4)], Call(Name('getcaps', Load(), lineno=215, col_offset=11), [], [], None, None, lineno=215, col_offset=11), lineno=215, col_offset=4), If(UnaryOp(Not(), Subscript(Attribute(Name('sys', Load(), lineno=216, col_offset=11), 'argv', Load(), lineno=216, col_offset=11), Slice(Num(1, lineno=216, col_offset=20), None, None), Load(), lineno=216, col_offset=11), lineno=216, col_offset=7), [Expr(Call(Name('show', Load(), lineno=217, col_offset=8), [Name('caps', Load(), lineno=217, col_offset=13)], [], None, None, lineno=217, col_offset=8), lineno=217, col_offset=8), Return(None, lineno=218, col_offset=8)], [], lineno=216, col_offset=4), For(Name('i', Store(), lineno=219, col_offset=8), Call(Name('range', Load(), lineno=219, col_offset=13), [Num(1, lineno=219, col_offset=19), Call(Name('len', Load(), lineno=219, col_offset=22), [Attribute(Name('sys', Load(), lineno=219, col_offset=26), 'argv', Load(), lineno=219, col_offset=26)], [], None, None, lineno=219, col_offset=22), Num(2, lineno=219, col_offset=37)], [], None, None, lineno=219, col_offset=13), [Assign([Name('args', Store(), lineno=220, col_offset=8)], Subscript(Attribute(Name('sys', Load(), lineno=220, col_offset=15), 'argv', Load(), lineno=220, col_offset=15), Slice(Name('i', Load(), lineno=220, col_offset=24), BinOp(Name('i', Load(), lineno=220, col_offset=26), Add(), Num(2, lineno=220, col_offset=28), lineno=220, col_offset=26), None), Load(), lineno=220, col_offset=15), lineno=220, col_offset=8), If(Compare(Call(Name('len', Load(), lineno=221, col_offset=11), [Name('args', Load(), lineno=221, col_offset=15)], [], None, None, lineno=221, col_offset=11), [Lt()], [Num(2, lineno=221, col_offset=23)], lineno=221, col_offset=11), [Print(None, [Str('usage: mailcap [MIMEtype file] ...', lineno=222, col_offset=18)], True, lineno=222, col_offset=12), Return(None, lineno=223, col_offset=12)], [], lineno=221, col_offset=8), Assign([Name('MIMEtype', Store(), lineno=224, col_offset=8)], Subscript(Name('args', Load(), lineno=224, col_offset=19), Index(Num(0, lineno=224, col_offset=24)), Load(), lineno=224, col_offset=19), lineno=224, col_offset=8), Assign([Name('file', Store(), lineno=225, col_offset=8)], Subscript(Name('args', Load(), lineno=225, col_offset=15), Index(Num(1, lineno=225, col_offset=20)), Load(), lineno=225, col_offset=15), lineno=225, col_offset=8), Assign([Tuple([Name('command', Store(), lineno=226, col_offset=8), Name('e', Store(), lineno=226, col_offset=17)], Store(), lineno=226, col_offset=8)], Call(Name('findmatch', Load(), lineno=226, col_offset=21), [Name('caps', Load(), lineno=226, col_offset=31), Name('MIMEtype', Load(), lineno=226, col_offset=37), Str('view', lineno=226, col_offset=47), Name('file', Load(), lineno=226, col_offset=55)], [], None, None, lineno=226, col_offset=21), lineno=226, col_offset=8), If(UnaryOp(Not(), Name('command', Load(), lineno=227, col_offset=15), lineno=227, col_offset=11), [Print(None, [Str('No viewer found for', lineno=228, col_offset=18), Name('type', Load(), lineno=228, col_offset=41)], True, lineno=228, col_offset=12)], [Print(None, [Str('Executing:', lineno=230, col_offset=18), Name('command', Load(), lineno=230, col_offset=32)], True, lineno=230, col_offset=12), Assign([Name('sts', Store(), lineno=231, col_offset=12)], Call(Attribute(Name('os', Load(), lineno=231, col_offset=18), 'system', Load(), lineno=231, col_offset=18), [Name('command', Load(), lineno=231, col_offset=28)], [], None, None, lineno=231, col_offset=18), lineno=231, col_offset=12), If(Name('sts', Load(), lineno=232, col_offset=15), [Print(None, [Str('Exit status:', lineno=233, col_offset=22), Name('sts', Load(), lineno=233, col_offset=38)], True, lineno=233, col_offset=16)], [], lineno=232, col_offset=12)], lineno=227, col_offset=8)], [], lineno=219, col_offset=4)], [], lineno=213, col_offset=0), FunctionDef('show', arguments([Name('caps', Param(), lineno=235, col_offset=9)], None, None, []), [Print(None, [Str('Mailcap files:', lineno=236, col_offset=10)], True, lineno=236, col_offset=4), For(Name('fn', Store(), lineno=237, col_offset=8), Call(Name('listmailcapfiles', Load(), lineno=237, col_offset=14), [], [], None, None, lineno=237, col_offset=14), [Print(None, [BinOp(Str('\t', lineno=237, col_offset=40), Add(), Name('fn', Load(), lineno=237, col_offset=47), lineno=237, col_offset=40)], True, lineno=237, col_offset=34)], [], lineno=237, col_offset=4), Print(None, [], True, lineno=238, col_offset=4), If(UnaryOp(Not(), Name('caps', Load(), lineno=239, col_offset=11), lineno=239, col_offset=7), [Assign([Name('caps', Store(), lineno=239, col_offset=17)], Call(Name('getcaps', Load(), lineno=239, col_offset=24), [], [], None, None, lineno=239, col_offset=24), lineno=239, col_offset=17)], [], lineno=239, col_offset=4), Print(None, [Str('Mailcap entries:', lineno=240, col_offset=10)], True, lineno=240, col_offset=4), Print(None, [], True, lineno=241, col_offset=4), Assign([Name('ckeys', Store(), lineno=242, col_offset=4)], Call(Attribute(Name('caps', Load(), lineno=242, col_offset=12), 'keys', Load(), lineno=242, col_offset=12), [], [], None, None, lineno=242, col_offset=12), lineno=242, col_offset=4), Expr(Call(Attribute(Name('ckeys', Load(), lineno=243, col_offset=4), 'sort', Load(), lineno=243, col_offset=4), [], [], None, None, lineno=243, col_offset=4), lineno=243, col_offset=4), For(Name('type', Store(), lineno=244, col_offset=8), Name('ckeys', Load(), lineno=244, col_offset=16), [Print(None, [Name('type', Load(), lineno=245, col_offset=14)], True, lineno=245, col_offset=8), Assign([Name('entries', Store(), lineno=246, col_offset=8)], Subscript(Name('caps', Load(), lineno=246, col_offset=18), Index(Name('type', Load(), lineno=246, col_offset=23)), Load(), lineno=246, col_offset=18), lineno=246, col_offset=8), For(Name('e', Store(), lineno=247, col_offset=12), Name('entries', Load(), lineno=247, col_offset=17), [Assign([Name('keys', Store(), lineno=248, col_offset=12)], Call(Attribute(Name('e', Load(), lineno=248, col_offset=19), 'keys', Load(), lineno=248, col_offset=19), [], [], None, None, lineno=248, col_offset=19), lineno=248, col_offset=12), Expr(Call(Attribute(Name('keys', Load(), lineno=249, col_offset=12), 'sort', Load(), lineno=249, col_offset=12), [], [], None, None, lineno=249, col_offset=12), lineno=249, col_offset=12), For(Name('k', Store(), lineno=250, col_offset=16), Name('keys', Load(), lineno=250, col_offset=21), [Print(None, [BinOp(Str('  %-15s', lineno=251, col_offset=22), Mod(), Name('k', Load(), lineno=251, col_offset=34), lineno=251, col_offset=22), Subscript(Name('e', Load(), lineno=251, col_offset=37), Index(Name('k', Load(), lineno=251, col_offset=39)), Load(), lineno=251, col_offset=37)], True, lineno=251, col_offset=16)], [], lineno=250, col_offset=12), Print(None, [], True, lineno=252, col_offset=12)], [], lineno=247, col_offset=8)], [], lineno=244, col_offset=4)], [], lineno=235, col_offset=0), If(Compare(Name('__name__', Load(), lineno=254, col_offset=3), [Eq()], [Str('__main__', lineno=254, col_offset=15)], lineno=254, col_offset=3), [Expr(Call(Name('test', Load(), lineno=255, col_offset=4), [], [], None, None, lineno=255, col_offset=4), lineno=255, col_offset=4)], [], lineno=254, col_offset=0)])
