Module([Expr(Str("A dumb and slow but simple dbm clone.\n\nFor database spam, spam.dir contains the index (a text file),\nspam.bak *may* contain a backup of the index (also a text file),\nwhile spam.dat contains the data (a binary file).\n\nXXX TO DO:\n\n- seems to contain a bug when updating...\n\n- reclaim free space (currently, space once occupied by deleted or expanded\nitems is never reused)\n\n- support concurrent access (currently, if two processes take turns making\nupdates, they can mess up the index)\n\n- support efficient access to large databases (currently, the whole index\nis read when the database is opened, and some updates rewrite the whole index)\n\n- support opening for read-only (flag = 'm')\n\n", lineno=22, col_offset=-1), lineno=22, col_offset=-1), Import([alias('os', '_os')], lineno=24, col_offset=0), Import([alias('__builtin__', None)], lineno=25, col_offset=0), Import([alias('UserDict', None)], lineno=26, col_offset=0), Assign([Name('_open', Store(), lineno=28, col_offset=0)], Attribute(Name('__builtin__', Load(), lineno=28, col_offset=8), 'open', Load(), lineno=28, col_offset=8), lineno=28, col_offset=0), Assign([Name('_BLOCKSIZE', Store(), lineno=30, col_offset=0)], Num(512, lineno=30, col_offset=13), lineno=30, col_offset=0), Assign([Name('error', Store(), lineno=32, col_offset=0)], Name('IOError', Load(), lineno=32, col_offset=8), lineno=32, col_offset=0), ClassDef('_Database', [Attribute(Name('UserDict', Load(), lineno=34, col_offset=16), 'DictMixin', Load(), lineno=34, col_offset=16)], [Assign([Name('_os', Store(), lineno=44, col_offset=4)], Name('_os', Load(), lineno=44, col_offset=10), lineno=44, col_offset=4), Assign([Name('_open', Store(), lineno=45, col_offset=4)], Name('_open', Load(), lineno=45, col_offset=12), lineno=45, col_offset=4), FunctionDef('__init__', arguments([Name('self', Param(), lineno=47, col_offset=17), Name('filebasename', Param(), lineno=47, col_offset=23), Name('mode', Param(), lineno=47, col_offset=37)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=48, col_offset=8), '_mode', Store(), lineno=48, col_offset=8)], Name('mode', Load(), lineno=48, col_offset=21), lineno=48, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=55, col_offset=8), '_dirfile', Store(), lineno=55, col_offset=8)], BinOp(BinOp(Name('filebasename', Load(), lineno=55, col_offset=24), Add(), Attribute(Name('_os', Load(), lineno=55, col_offset=39), 'extsep', Load(), lineno=55, col_offset=39), lineno=55, col_offset=24), Add(), Str('dir', lineno=55, col_offset=52), lineno=55, col_offset=50), lineno=55, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=61, col_offset=8), '_datfile', Store(), lineno=61, col_offset=8)], BinOp(BinOp(Name('filebasename', Load(), lineno=61, col_offset=24), Add(), Attribute(Name('_os', Load(), lineno=61, col_offset=39), 'extsep', Load(), lineno=61, col_offset=39), lineno=61, col_offset=24), Add(), Str('dat', lineno=61, col_offset=52), lineno=61, col_offset=50), lineno=61, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=62, col_offset=8), '_bakfile', Store(), lineno=62, col_offset=8)], BinOp(BinOp(Name('filebasename', Load(), lineno=62, col_offset=24), Add(), Attribute(Name('_os', Load(), lineno=62, col_offset=39), 'extsep', Load(), lineno=62, col_offset=39), lineno=62, col_offset=24), Add(), Str('bak', lineno=62, col_offset=52), lineno=62, col_offset=50), lineno=62, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=65, col_offset=8), '_index', Store(), lineno=65, col_offset=8)], Name('None', Load(), lineno=65, col_offset=22), lineno=65, col_offset=8), TryExcept([Assign([Name('f', Store(), lineno=69, col_offset=12)], Call(Name('_open', Load(), lineno=69, col_offset=16), [Attribute(Name('self', Load(), lineno=69, col_offset=22), '_datfile', Load(), lineno=69, col_offset=22), Str('r', lineno=69, col_offset=37)], [], None, None, lineno=69, col_offset=16), lineno=69, col_offset=12)], [ExceptHandler(Name('IOError', Load(), lineno=70, col_offset=15), None, [Assign([Name('f', Store(), lineno=71, col_offset=12)], Call(Name('_open', Load(), lineno=71, col_offset=16), [Attribute(Name('self', Load(), lineno=71, col_offset=22), '_datfile', Load(), lineno=71, col_offset=22), Str('w', lineno=71, col_offset=37)], [], None, None, lineno=71, col_offset=16), lineno=71, col_offset=12), Expr(Call(Attribute(Name('self', Load(), lineno=72, col_offset=12), '_chmod', Load(), lineno=72, col_offset=12), [Attribute(Name('self', Load(), lineno=72, col_offset=24), '_datfile', Load(), lineno=72, col_offset=24)], [], None, None, lineno=72, col_offset=12), lineno=72, col_offset=12)], lineno=70, col_offset=8)], [], lineno=68, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=73, col_offset=8), 'close', Load(), lineno=73, col_offset=8), [], [], None, None, lineno=73, col_offset=8), lineno=73, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=74, col_offset=8), '_update', Load(), lineno=74, col_offset=8), [], [], None, None, lineno=74, col_offset=8), lineno=74, col_offset=8)], [], lineno=47, col_offset=4), FunctionDef('_update', arguments([Name('self', Param(), lineno=77, col_offset=16)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=78, col_offset=8), '_index', Store(), lineno=78, col_offset=8)], Dict([], [], lineno=78, col_offset=22), lineno=78, col_offset=8), TryExcept([Assign([Name('f', Store(), lineno=80, col_offset=12)], Call(Name('_open', Load(), lineno=80, col_offset=16), [Attribute(Name('self', Load(), lineno=80, col_offset=22), '_dirfile', Load(), lineno=80, col_offset=22)], [], None, None, lineno=80, col_offset=16), lineno=80, col_offset=12)], [ExceptHandler(Name('IOError', Load(), lineno=81, col_offset=15), None, [Pass( lineno=82, col_offset=12)], lineno=81, col_offset=8)], [For(Name('line', Store(), lineno=84, col_offset=16), Name('f', Load(), lineno=84, col_offset=24), [Assign([Name('line', Store(), lineno=85, col_offset=16)], Call(Attribute(Name('line', Load(), lineno=85, col_offset=23), 'rstrip', Load(), lineno=85, col_offset=23), [], [], None, None, lineno=85, col_offset=23), lineno=85, col_offset=16), Assign([Tuple([Name('key', Store(), lineno=86, col_offset=16), Name('pos_and_siz_pair', Store(), lineno=86, col_offset=21)], Store(), lineno=86, col_offset=16)], Call(Name('eval', Load(), lineno=86, col_offset=40), [Name('line', Load(), lineno=86, col_offset=45)], [], None, None, lineno=86, col_offset=40), lineno=86, col_offset=16), Assign([Subscript(Attribute(Name('self', Load(), lineno=87, col_offset=16), '_index', Load(), lineno=87, col_offset=16), Index(Name('key', Load(), lineno=87, col_offset=28)), Store(), lineno=87, col_offset=16)], Name('pos_and_siz_pair', Load(), lineno=87, col_offset=35), lineno=87, col_offset=16)], [], lineno=84, col_offset=12), Expr(Call(Attribute(Name('f', Load(), lineno=88, col_offset=12), 'close', Load(), lineno=88, col_offset=12), [], [], None, None, lineno=88, col_offset=12), lineno=88, col_offset=12)], lineno=79, col_offset=8)], [], lineno=77, col_offset=4), FunctionDef('_commit', arguments([Name('self', Param(), lineno=93, col_offset=16)], None, None, []), [If(Compare(Attribute(Name('self', Load(), lineno=97, col_offset=11), '_index', Load(), lineno=97, col_offset=11), [Is()], [Name('None', Load(), lineno=97, col_offset=26)], lineno=97, col_offset=11), [Return(None, lineno=98, col_offset=12)], [], lineno=97, col_offset=8), TryExcept([Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=101, col_offset=12), '_os', Load(), lineno=101, col_offset=12), 'unlink', Load(), lineno=101, col_offset=12), [Attribute(Name('self', Load(), lineno=101, col_offset=28), '_bakfile', Load(), lineno=101, col_offset=28)], [], None, None, lineno=101, col_offset=12), lineno=101, col_offset=12)], [ExceptHandler(Attribute(Attribute(Name('self', Load(), lineno=102, col_offset=15), '_os', Load(), lineno=102, col_offset=15), 'error', Load(), lineno=102, col_offset=15), None, [Pass( lineno=103, col_offset=12)], lineno=102, col_offset=8)], [], lineno=100, col_offset=8), TryExcept([Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=106, col_offset=12), '_os', Load(), lineno=106, col_offset=12), 'rename', Load(), lineno=106, col_offset=12), [Attribute(Name('self', Load(), lineno=106, col_offset=28), '_dirfile', Load(), lineno=106, col_offset=28), Attribute(Name('self', Load(), lineno=106, col_offset=43), '_bakfile', Load(), lineno=106, col_offset=43)], [], None, None, lineno=106, col_offset=12), lineno=106, col_offset=12)], [ExceptHandler(Attribute(Attribute(Name('self', Load(), lineno=107, col_offset=15), '_os', Load(), lineno=107, col_offset=15), 'error', Load(), lineno=107, col_offset=15), None, [Pass( lineno=108, col_offset=12)], lineno=107, col_offset=8)], [], lineno=105, col_offset=8), Assign([Name('f', Store(), lineno=110, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=110, col_offset=12), '_open', Load(), lineno=110, col_offset=12), [Attribute(Name('self', Load(), lineno=110, col_offset=23), '_dirfile', Load(), lineno=110, col_offset=23), Str('w', lineno=110, col_offset=38)], [], None, None, lineno=110, col_offset=12), lineno=110, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=111, col_offset=8), '_chmod', Load(), lineno=111, col_offset=8), [Attribute(Name('self', Load(), lineno=111, col_offset=20), '_dirfile', Load(), lineno=111, col_offset=20)], [], None, None, lineno=111, col_offset=8), lineno=111, col_offset=8), For(Tuple([Name('key', Store(), lineno=112, col_offset=12), Name('pos_and_siz_pair', Store(), lineno=112, col_offset=17)], Store(), lineno=112, col_offset=12), Call(Attribute(Attribute(Name('self', Load(), lineno=112, col_offset=37), '_index', Load(), lineno=112, col_offset=37), 'iteritems', Load(), lineno=112, col_offset=37), [], [], None, None, lineno=112, col_offset=37), [Expr(Call(Attribute(Name('f', Load(), lineno=113, col_offset=12), 'write', Load(), lineno=113, col_offset=12), [BinOp(Str('%r, %r\n', lineno=113, col_offset=20), Mod(), Tuple([Name('key', Load(), lineno=113, col_offset=34), Name('pos_and_siz_pair', Load(), lineno=113, col_offset=39)], Load(), lineno=113, col_offset=34), lineno=113, col_offset=20)], [], None, None, lineno=113, col_offset=12), lineno=113, col_offset=12)], [], lineno=112, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=114, col_offset=8), 'close', Load(), lineno=114, col_offset=8), [], [], None, None, lineno=114, col_offset=8), lineno=114, col_offset=8)], [], lineno=93, col_offset=4), Assign([Name('sync', Store(), lineno=116, col_offset=4)], Name('_commit', Load(), lineno=116, col_offset=11), lineno=116, col_offset=4), FunctionDef('__getitem__', arguments([Name('self', Param(), lineno=118, col_offset=20), Name('key', Param(), lineno=118, col_offset=26)], None, None, []), [Assign([Tuple([Name('pos', Store(), lineno=119, col_offset=8), Name('siz', Store(), lineno=119, col_offset=13)], Store(), lineno=119, col_offset=8)], Subscript(Attribute(Name('self', Load(), lineno=119, col_offset=19), '_index', Load(), lineno=119, col_offset=19), Index(Name('key', Load(), lineno=119, col_offset=31)), Load(), lineno=119, col_offset=19), lineno=119, col_offset=8), Assign([Name('f', Store(), lineno=120, col_offset=8)], Call(Name('_open', Load(), lineno=120, col_offset=12), [Attribute(Name('self', Load(), lineno=120, col_offset=18), '_datfile', Load(), lineno=120, col_offset=18), Str('rb', lineno=120, col_offset=33)], [], None, None, lineno=120, col_offset=12), lineno=120, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=121, col_offset=8), 'seek', Load(), lineno=121, col_offset=8), [Name('pos', Load(), lineno=121, col_offset=15)], [], None, None, lineno=121, col_offset=8), lineno=121, col_offset=8), Assign([Name('dat', Store(), lineno=122, col_offset=8)], Call(Attribute(Name('f', Load(), lineno=122, col_offset=14), 'read', Load(), lineno=122, col_offset=14), [Name('siz', Load(), lineno=122, col_offset=21)], [], None, None, lineno=122, col_offset=14), lineno=122, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=123, col_offset=8), 'close', Load(), lineno=123, col_offset=8), [], [], None, None, lineno=123, col_offset=8), lineno=123, col_offset=8), Return(Name('dat', Load(), lineno=124, col_offset=15), lineno=124, col_offset=8)], [], lineno=118, col_offset=4), FunctionDef('_addval', arguments([Name('self', Param(), lineno=130, col_offset=16), Name('val', Param(), lineno=130, col_offset=22)], None, None, []), [Assign([Name('f', Store(), lineno=131, col_offset=8)], Call(Name('_open', Load(), lineno=131, col_offset=12), [Attribute(Name('self', Load(), lineno=131, col_offset=18), '_datfile', Load(), lineno=131, col_offset=18), Str('rb+', lineno=131, col_offset=33)], [], None, None, lineno=131, col_offset=12), lineno=131, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=132, col_offset=8), 'seek', Load(), lineno=132, col_offset=8), [Num(0, lineno=132, col_offset=15), Num(2, lineno=132, col_offset=18)], [], None, None, lineno=132, col_offset=8), lineno=132, col_offset=8), Assign([Name('pos', Store(), lineno=133, col_offset=8)], Call(Name('int', Load(), lineno=133, col_offset=14), [Call(Attribute(Name('f', Load(), lineno=133, col_offset=18), 'tell', Load(), lineno=133, col_offset=18), [], [], None, None, lineno=133, col_offset=18)], [], None, None, lineno=133, col_offset=14), lineno=133, col_offset=8), Assign([Name('npos', Store(), lineno=134, col_offset=8)], BinOp(BinOp(BinOp(BinOp(Name('pos', Load(), lineno=134, col_offset=17), Add(), Name('_BLOCKSIZE', Load(), lineno=134, col_offset=23), lineno=134, col_offset=17), Sub(), Num(1, lineno=134, col_offset=36), lineno=134, col_offset=34), FloorDiv(), Name('_BLOCKSIZE', Load(), lineno=134, col_offset=42), lineno=134, col_offset=16), Mult(), Name('_BLOCKSIZE', Load(), lineno=134, col_offset=56), lineno=134, col_offset=15), lineno=134, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=135, col_offset=8), 'write', Load(), lineno=135, col_offset=8), [BinOp(Str('\x00', lineno=135, col_offset=16), Mult(), BinOp(Name('npos', Load(), lineno=135, col_offset=22), Sub(), Name('pos', Load(), lineno=135, col_offset=27), lineno=135, col_offset=22), lineno=135, col_offset=16)], [], None, None, lineno=135, col_offset=8), lineno=135, col_offset=8), Assign([Name('pos', Store(), lineno=136, col_offset=8)], Name('npos', Load(), lineno=136, col_offset=14), lineno=136, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=137, col_offset=8), 'write', Load(), lineno=137, col_offset=8), [Name('val', Load(), lineno=137, col_offset=16)], [], None, None, lineno=137, col_offset=8), lineno=137, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=138, col_offset=8), 'close', Load(), lineno=138, col_offset=8), [], [], None, None, lineno=138, col_offset=8), lineno=138, col_offset=8), Return(Tuple([Name('pos', Load(), lineno=139, col_offset=16), Call(Name('len', Load(), lineno=139, col_offset=21), [Name('val', Load(), lineno=139, col_offset=25)], [], None, None, lineno=139, col_offset=21)], Load(), lineno=139, col_offset=16), lineno=139, col_offset=8)], [], lineno=130, col_offset=4), FunctionDef('_setval', arguments([Name('self', Param(), lineno=145, col_offset=16), Name('pos', Param(), lineno=145, col_offset=22), Name('val', Param(), lineno=145, col_offset=27)], None, None, []), [Assign([Name('f', Store(), lineno=146, col_offset=8)], Call(Name('_open', Load(), lineno=146, col_offset=12), [Attribute(Name('self', Load(), lineno=146, col_offset=18), '_datfile', Load(), lineno=146, col_offset=18), Str('rb+', lineno=146, col_offset=33)], [], None, None, lineno=146, col_offset=12), lineno=146, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=147, col_offset=8), 'seek', Load(), lineno=147, col_offset=8), [Name('pos', Load(), lineno=147, col_offset=15)], [], None, None, lineno=147, col_offset=8), lineno=147, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=148, col_offset=8), 'write', Load(), lineno=148, col_offset=8), [Name('val', Load(), lineno=148, col_offset=16)], [], None, None, lineno=148, col_offset=8), lineno=148, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=149, col_offset=8), 'close', Load(), lineno=149, col_offset=8), [], [], None, None, lineno=149, col_offset=8), lineno=149, col_offset=8), Return(Tuple([Name('pos', Load(), lineno=150, col_offset=16), Call(Name('len', Load(), lineno=150, col_offset=21), [Name('val', Load(), lineno=150, col_offset=25)], [], None, None, lineno=150, col_offset=21)], Load(), lineno=150, col_offset=16), lineno=150, col_offset=8)], [], lineno=145, col_offset=4), FunctionDef('_addkey', arguments([Name('self', Param(), lineno=155, col_offset=16), Name('key', Param(), lineno=155, col_offset=22), Name('pos_and_siz_pair', Param(), lineno=155, col_offset=27)], None, None, []), [Assign([Subscript(Attribute(Name('self', Load(), lineno=156, col_offset=8), '_index', Load(), lineno=156, col_offset=8), Index(Name('key', Load(), lineno=156, col_offset=20)), Store(), lineno=156, col_offset=8)], Name('pos_and_siz_pair', Load(), lineno=156, col_offset=27), lineno=156, col_offset=8), Assign([Name('f', Store(), lineno=157, col_offset=8)], Call(Name('_open', Load(), lineno=157, col_offset=12), [Attribute(Name('self', Load(), lineno=157, col_offset=18), '_dirfile', Load(), lineno=157, col_offset=18), Str('a', lineno=157, col_offset=33)], [], None, None, lineno=157, col_offset=12), lineno=157, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=158, col_offset=8), '_chmod', Load(), lineno=158, col_offset=8), [Attribute(Name('self', Load(), lineno=158, col_offset=20), '_dirfile', Load(), lineno=158, col_offset=20)], [], None, None, lineno=158, col_offset=8), lineno=158, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=159, col_offset=8), 'write', Load(), lineno=159, col_offset=8), [BinOp(Str('%r, %r\n', lineno=159, col_offset=16), Mod(), Tuple([Name('key', Load(), lineno=159, col_offset=30), Name('pos_and_siz_pair', Load(), lineno=159, col_offset=35)], Load(), lineno=159, col_offset=30), lineno=159, col_offset=16)], [], None, None, lineno=159, col_offset=8), lineno=159, col_offset=8), Expr(Call(Attribute(Name('f', Load(), lineno=160, col_offset=8), 'close', Load(), lineno=160, col_offset=8), [], [], None, None, lineno=160, col_offset=8), lineno=160, col_offset=8)], [], lineno=155, col_offset=4), FunctionDef('__setitem__', arguments([Name('self', Param(), lineno=162, col_offset=20), Name('key', Param(), lineno=162, col_offset=26), Name('val', Param(), lineno=162, col_offset=31)], None, None, []), [If(UnaryOp(Not(), Compare(Call(Name('type', Load(), lineno=163, col_offset=15), [Name('key', Load(), lineno=163, col_offset=20)], [], None, None, lineno=163, col_offset=15), [Eq(), Eq()], [Call(Name('type', Load(), lineno=163, col_offset=28), [Str('', lineno=163, col_offset=33)], [], None, None, lineno=163, col_offset=28), Call(Name('type', Load(), lineno=163, col_offset=40), [Name('val', Load(), lineno=163, col_offset=45)], [], None, None, lineno=163, col_offset=40)], lineno=163, col_offset=15), lineno=163, col_offset=11), [Raise(Name('TypeError', Load(), lineno=164, col_offset=18), Str('keys and values must be strings', lineno=164, col_offset=29), None, lineno=164, col_offset=12)], [], lineno=163, col_offset=8), If(Compare(Name('key', Load(), lineno=165, col_offset=11), [NotIn()], [Attribute(Name('self', Load(), lineno=165, col_offset=22), '_index', Load(), lineno=165, col_offset=22)], lineno=165, col_offset=11), [Expr(Call(Attribute(Name('self', Load(), lineno=166, col_offset=12), '_addkey', Load(), lineno=166, col_offset=12), [Name('key', Load(), lineno=166, col_offset=25), Call(Attribute(Name('self', Load(), lineno=166, col_offset=30), '_addval', Load(), lineno=166, col_offset=30), [Name('val', Load(), lineno=166, col_offset=43)], [], None, None, lineno=166, col_offset=30)], [], None, None, lineno=166, col_offset=12), lineno=166, col_offset=12)], [Assign([Tuple([Name('pos', Store(), lineno=170, col_offset=12), Name('siz', Store(), lineno=170, col_offset=17)], Store(), lineno=170, col_offset=12)], Subscript(Attribute(Name('self', Load(), lineno=170, col_offset=23), '_index', Load(), lineno=170, col_offset=23), Index(Name('key', Load(), lineno=170, col_offset=35)), Load(), lineno=170, col_offset=23), lineno=170, col_offset=12), Assign([Name('oldblocks', Store(), lineno=171, col_offset=12)], BinOp(BinOp(BinOp(Name('siz', Load(), lineno=171, col_offset=25), Add(), Name('_BLOCKSIZE', Load(), lineno=171, col_offset=31), lineno=171, col_offset=25), Sub(), Num(1, lineno=171, col_offset=44), lineno=171, col_offset=42), FloorDiv(), Name('_BLOCKSIZE', Load(), lineno=171, col_offset=50), lineno=171, col_offset=24), lineno=171, col_offset=12), Assign([Name('newblocks', Store(), lineno=172, col_offset=12)], BinOp(BinOp(BinOp(Call(Name('len', Load(), lineno=172, col_offset=25), [Name('val', Load(), lineno=172, col_offset=29)], [], None, None, lineno=172, col_offset=25), Add(), Name('_BLOCKSIZE', Load(), lineno=172, col_offset=36), lineno=172, col_offset=25), Sub(), Num(1, lineno=172, col_offset=49), lineno=172, col_offset=47), FloorDiv(), Name('_BLOCKSIZE', Load(), lineno=172, col_offset=55), lineno=172, col_offset=24), lineno=172, col_offset=12), If(Compare(Name('newblocks', Load(), lineno=173, col_offset=15), [LtE()], [Name('oldblocks', Load(), lineno=173, col_offset=28)], lineno=173, col_offset=15), [Assign([Subscript(Attribute(Name('self', Load(), lineno=174, col_offset=16), '_index', Load(), lineno=174, col_offset=16), Index(Name('key', Load(), lineno=174, col_offset=28)), Store(), lineno=174, col_offset=16)], Call(Attribute(Name('self', Load(), lineno=174, col_offset=35), '_setval', Load(), lineno=174, col_offset=35), [Name('pos', Load(), lineno=174, col_offset=48), Name('val', Load(), lineno=174, col_offset=53)], [], None, None, lineno=174, col_offset=35), lineno=174, col_offset=16)], [Assign([Subscript(Attribute(Name('self', Load(), lineno=179, col_offset=16), '_index', Load(), lineno=179, col_offset=16), Index(Name('key', Load(), lineno=179, col_offset=28)), Store(), lineno=179, col_offset=16)], Call(Attribute(Name('self', Load(), lineno=179, col_offset=35), '_addval', Load(), lineno=179, col_offset=35), [Name('val', Load(), lineno=179, col_offset=48)], [], None, None, lineno=179, col_offset=35), lineno=179, col_offset=16)], lineno=173, col_offset=12)], lineno=165, col_offset=8)], [], lineno=162, col_offset=4), FunctionDef('__delitem__', arguments([Name('self', Param(), lineno=189, col_offset=20), Name('key', Param(), lineno=189, col_offset=26)], None, None, []), [Delete([Subscript(Attribute(Name('self', Load(), lineno=191, col_offset=12), '_index', Load(), lineno=191, col_offset=12), Index(Name('key', Load(), lineno=191, col_offset=24)), Del(), lineno=191, col_offset=12)], lineno=191, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=196, col_offset=8), '_commit', Load(), lineno=196, col_offset=8), [], [], None, None, lineno=196, col_offset=8), lineno=196, col_offset=8)], [], lineno=189, col_offset=4), FunctionDef('keys', arguments([Name('self', Param(), lineno=198, col_offset=13)], None, None, []), [Return(Call(Attribute(Attribute(Name('self', Load(), lineno=199, col_offset=15), '_index', Load(), lineno=199, col_offset=15), 'keys', Load(), lineno=199, col_offset=15), [], [], None, None, lineno=199, col_offset=15), lineno=199, col_offset=8)], [], lineno=198, col_offset=4), FunctionDef('has_key', arguments([Name('self', Param(), lineno=201, col_offset=16), Name('key', Param(), lineno=201, col_offset=22)], None, None, []), [Return(Compare(Name('key', Load(), lineno=202, col_offset=15), [In()], [Attribute(Name('self', Load(), lineno=202, col_offset=22), '_index', Load(), lineno=202, col_offset=22)], lineno=202, col_offset=15), lineno=202, col_offset=8)], [], lineno=201, col_offset=4), FunctionDef('__contains__', arguments([Name('self', Param(), lineno=204, col_offset=21), Name('key', Param(), lineno=204, col_offset=27)], None, None, []), [Return(Compare(Name('key', Load(), lineno=205, col_offset=15), [In()], [Attribute(Name('self', Load(), lineno=205, col_offset=22), '_index', Load(), lineno=205, col_offset=22)], lineno=205, col_offset=15), lineno=205, col_offset=8)], [], lineno=204, col_offset=4), FunctionDef('iterkeys', arguments([Name('self', Param(), lineno=207, col_offset=17)], None, None, []), [Return(Call(Attribute(Attribute(Name('self', Load(), lineno=208, col_offset=15), '_index', Load(), lineno=208, col_offset=15), 'iterkeys', Load(), lineno=208, col_offset=15), [], [], None, None, lineno=208, col_offset=15), lineno=208, col_offset=8)], [], lineno=207, col_offset=4), Assign([Name('__iter__', Store(), lineno=209, col_offset=4)], Name('iterkeys', Load(), lineno=209, col_offset=15), lineno=209, col_offset=4), FunctionDef('__len__', arguments([Name('self', Param(), lineno=211, col_offset=16)], None, None, []), [Return(Call(Name('len', Load(), lineno=212, col_offset=15), [Attribute(Name('self', Load(), lineno=212, col_offset=19), '_index', Load(), lineno=212, col_offset=19)], [], None, None, lineno=212, col_offset=15), lineno=212, col_offset=8)], [], lineno=211, col_offset=4), FunctionDef('close', arguments([Name('self', Param(), lineno=214, col_offset=14)], None, None, []), [Expr(Call(Attribute(Name('self', Load(), lineno=215, col_offset=8), '_commit', Load(), lineno=215, col_offset=8), [], [], None, None, lineno=215, col_offset=8), lineno=215, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=216, col_offset=8), '_index', Store(), lineno=216, col_offset=8), Attribute(Name('self', Load(), lineno=216, col_offset=22), '_datfile', Store(), lineno=216, col_offset=22), Attribute(Name('self', Load(), lineno=216, col_offset=38), '_dirfile', Store(), lineno=216, col_offset=38), Attribute(Name('self', Load(), lineno=216, col_offset=54), '_bakfile', Store(), lineno=216, col_offset=54)], Name('None', Load(), lineno=216, col_offset=70), lineno=216, col_offset=8)], [], lineno=214, col_offset=4), Assign([Name('__del__', Store(), lineno=218, col_offset=4)], Name('close', Load(), lineno=218, col_offset=14), lineno=218, col_offset=4), FunctionDef('_chmod', arguments([Name('self', Param(), lineno=220, col_offset=16), Name('file', Param(), lineno=220, col_offset=22)], None, None, []), [If(Call(Name('hasattr', Load(), lineno=221, col_offset=11), [Attribute(Name('self', Load(), lineno=221, col_offset=19), '_os', Load(), lineno=221, col_offset=19), Str('chmod', lineno=221, col_offset=29)], [], None, None, lineno=221, col_offset=11), [Expr(Call(Attribute(Attribute(Name('self', Load(), lineno=222, col_offset=12), '_os', Load(), lineno=222, col_offset=12), 'chmod', Load(), lineno=222, col_offset=12), [Name('file', Load(), lineno=222, col_offset=27), Attribute(Name('self', Load(), lineno=222, col_offset=33), '_mode', Load(), lineno=222, col_offset=33)], [], None, None, lineno=222, col_offset=12), lineno=222, col_offset=12)], [], lineno=221, col_offset=8)], [], lineno=220, col_offset=4)], [], lineno=34, col_offset=0), FunctionDef('open', arguments([Name('file', Param(), lineno=225, col_offset=9), Name('flag', Param(), lineno=225, col_offset=15), Name('mode', Param(), lineno=225, col_offset=26)], None, None, [Name('None', Load(), lineno=225, col_offset=20), Num(438, lineno=225, col_offset=31)]), [Expr(Str('Open the database file, filename, and return corresponding object.\n\n    The flag argument, used to control how the database is opened in the\n    other DBM implementations, is ignored in the dumbdbm module; the\n    database is always opened for update, and will be created if it does\n    not exist.\n\n    The optional mode argument is the UNIX mode of the file, used only when\n    the database has to be created.  It defaults to octal code 0666 (and\n    will be modified by the prevailing umask).\n\n    ', lineno=237, col_offset=-1), lineno=237, col_offset=-1), TryExcept([Assign([Name('um', Store(), lineno=242, col_offset=8)], Call(Attribute(Name('_os', Load(), lineno=242, col_offset=13), 'umask', Load(), lineno=242, col_offset=13), [Num(0, lineno=242, col_offset=23)], [], None, None, lineno=242, col_offset=13), lineno=242, col_offset=8), Expr(Call(Attribute(Name('_os', Load(), lineno=243, col_offset=8), 'umask', Load(), lineno=243, col_offset=8), [Name('um', Load(), lineno=243, col_offset=18)], [], None, None, lineno=243, col_offset=8), lineno=243, col_offset=8)], [ExceptHandler(Name('AttributeError', Load(), lineno=244, col_offset=11), None, [Pass( lineno=245, col_offset=8)], lineno=244, col_offset=4)], [Assign([Name('mode', Store(), lineno=248, col_offset=8)], BinOp(Name('mode', Load(), lineno=248, col_offset=15), BitAnd(), UnaryOp(Invert(), Name('um', Load(), lineno=248, col_offset=24), lineno=248, col_offset=23), lineno=248, col_offset=15), lineno=248, col_offset=8)], lineno=241, col_offset=4), Return(Call(Name('_Database', Load(), lineno=250, col_offset=11), [Name('file', Load(), lineno=250, col_offset=21), Name('mode', Load(), lineno=250, col_offset=27)], [], None, None, lineno=250, col_offset=11), lineno=250, col_offset=4)], [], lineno=225, col_offset=0)])
