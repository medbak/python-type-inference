Module([ImportFrom('ctypes', [alias('*', None)], 0, lineno=1, col_offset=0), Import([alias('sys', None), alias('unittest', None)], lineno=2, col_offset=0), Import([alias('os', None)], lineno=3, col_offset=0), ImportFrom('ctypes.util', [alias('find_library', None)], 0, lineno=4, col_offset=0), ImportFrom('ctypes.test', [alias('is_resource_enabled', None)], 0, lineno=5, col_offset=0), Assign([Name('libc_name', Store(), lineno=7, col_offset=0)], Name('None', Load(), lineno=7, col_offset=12), lineno=7, col_offset=0), If(Compare(Attribute(Name('os', Load(), lineno=8, col_offset=3), 'name', Load(), lineno=8, col_offset=3), [Eq()], [Str('nt', lineno=8, col_offset=14)], lineno=8, col_offset=3), [Assign([Name('libc_name', Store(), lineno=9, col_offset=4)], Call(Name('find_library', Load(), lineno=9, col_offset=16), [Str('c', lineno=9, col_offset=29)], [], None, None, lineno=9, col_offset=16), lineno=9, col_offset=4)], [If(Compare(Attribute(Name('os', Load(), lineno=10, col_offset=5), 'name', Load(), lineno=10, col_offset=5), [Eq()], [Str('ce', lineno=10, col_offset=16)], lineno=10, col_offset=5), [Assign([Name('libc_name', Store(), lineno=11, col_offset=4)], Str('coredll', lineno=11, col_offset=16), lineno=11, col_offset=4)], [If(Compare(Attribute(Name('sys', Load(), lineno=12, col_offset=5), 'platform', Load(), lineno=12, col_offset=5), [Eq()], [Str('cygwin', lineno=12, col_offset=21)], lineno=12, col_offset=5), [Assign([Name('libc_name', Store(), lineno=13, col_offset=4)], Str('cygwin1.dll', lineno=13, col_offset=16), lineno=13, col_offset=4)], [Assign([Name('libc_name', Store(), lineno=15, col_offset=4)], Call(Name('find_library', Load(), lineno=15, col_offset=16), [Str('c', lineno=15, col_offset=29)], [], None, None, lineno=15, col_offset=16), lineno=15, col_offset=4)], lineno=12, col_offset=5)], lineno=10, col_offset=5)], lineno=8, col_offset=0), If(Call(Name('is_resource_enabled', Load(), lineno=17, col_offset=3), [Str('printing', lineno=17, col_offset=23)], [], None, None, lineno=17, col_offset=3), [Print(None, [Str('libc_name is', lineno=18, col_offset=10), Name('libc_name', Load(), lineno=18, col_offset=26)], True, lineno=18, col_offset=4)], [], lineno=17, col_offset=0), ClassDef('LoaderTest', [Attribute(Name('unittest', Load(), lineno=20, col_offset=17), 'TestCase', Load(), lineno=20, col_offset=17)], [Assign([Name('unknowndll', Store(), lineno=22, col_offset=4)], Str('xxrandomnamexx', lineno=22, col_offset=17), lineno=22, col_offset=4), If(Compare(Name('libc_name', Load(), lineno=24, col_offset=7), [IsNot()], [Name('None', Load(), lineno=24, col_offset=24)], lineno=24, col_offset=7), [FunctionDef('test_load', arguments([Name('self', Param(), lineno=25, col_offset=22)], None, None, []), [Expr(Call(Name('CDLL', Load(), lineno=26, col_offset=12), [Name('libc_name', Load(), lineno=26, col_offset=17)], [], None, None, lineno=26, col_offset=12), lineno=26, col_offset=12), Expr(Call(Name('CDLL', Load(), lineno=27, col_offset=12), [Call(Attribute(Attribute(Name('os', Load(), lineno=27, col_offset=17), 'path', Load(), lineno=27, col_offset=17), 'basename', Load(), lineno=27, col_offset=17), [Name('libc_name', Load(), lineno=27, col_offset=34)], [], None, None, lineno=27, col_offset=17)], [], None, None, lineno=27, col_offset=12), lineno=27, col_offset=12), Expr(Call(Attribute(Name('self', Load(), lineno=28, col_offset=12), 'assertRaises', Load(), lineno=28, col_offset=12), [Name('OSError', Load(), lineno=28, col_offset=30), Name('CDLL', Load(), lineno=28, col_offset=39), Attribute(Name('self', Load(), lineno=28, col_offset=45), 'unknowndll', Load(), lineno=28, col_offset=45)], [], None, None, lineno=28, col_offset=12), lineno=28, col_offset=12)], [], lineno=25, col_offset=8)], [], lineno=24, col_offset=4), If(BoolOp(And(), [Compare(Name('libc_name', Load(), lineno=30, col_offset=7), [IsNot()], [Name('None', Load(), lineno=30, col_offset=24)], lineno=30, col_offset=7), Compare(Call(Attribute(Attribute(Name('os', Load(), lineno=30, col_offset=33), 'path', Load(), lineno=30, col_offset=33), 'basename', Load(), lineno=30, col_offset=33), [Name('libc_name', Load(), lineno=30, col_offset=50)], [], None, None, lineno=30, col_offset=33), [Eq()], [Str('libc.so.6', lineno=30, col_offset=64)], lineno=30, col_offset=33)], lineno=30, col_offset=7), [FunctionDef('test_load_version', arguments([Name('self', Param(), lineno=31, col_offset=30)], None, None, []), [Expr(Call(Attribute(Name('cdll', Load(), lineno=32, col_offset=12), 'LoadLibrary', Load(), lineno=32, col_offset=12), [Str('libc.so.6', lineno=32, col_offset=29)], [], None, None, lineno=32, col_offset=12), lineno=32, col_offset=12), Expr(Call(Attribute(Name('self', Load(), lineno=34, col_offset=12), 'assertRaises', Load(), lineno=34, col_offset=12), [Name('OSError', Load(), lineno=34, col_offset=30), Attribute(Name('cdll', Load(), lineno=34, col_offset=39), 'LoadLibrary', Load(), lineno=34, col_offset=39), Str('libc.so.9', lineno=34, col_offset=57)], [], None, None, lineno=34, col_offset=12), lineno=34, col_offset=12), Expr(Call(Attribute(Name('self', Load(), lineno=35, col_offset=12), 'assertRaises', Load(), lineno=35, col_offset=12), [Name('OSError', Load(), lineno=35, col_offset=30), Attribute(Name('cdll', Load(), lineno=35, col_offset=39), 'LoadLibrary', Load(), lineno=35, col_offset=39), Attribute(Name('self', Load(), lineno=35, col_offset=57), 'unknowndll', Load(), lineno=35, col_offset=57)], [], None, None, lineno=35, col_offset=12), lineno=35, col_offset=12)], [], lineno=31, col_offset=8)], [], lineno=30, col_offset=4), FunctionDef('test_find', arguments([Name('self', Param(), lineno=37, col_offset=18)], None, None, []), [For(Name('name', Store(), lineno=38, col_offset=12), Tuple([Str('c', lineno=38, col_offset=21), Str('m', lineno=38, col_offset=26)], Load(), lineno=38, col_offset=21), [Assign([Name('lib', Store(), lineno=39, col_offset=12)], Call(Name('find_library', Load(), lineno=39, col_offset=18), [Name('name', Load(), lineno=39, col_offset=31)], [], None, None, lineno=39, col_offset=18), lineno=39, col_offset=12), If(Name('lib', Load(), lineno=40, col_offset=15), [Expr(Call(Attribute(Name('cdll', Load(), lineno=41, col_offset=16), 'LoadLibrary', Load(), lineno=41, col_offset=16), [Name('lib', Load(), lineno=41, col_offset=33)], [], None, None, lineno=41, col_offset=16), lineno=41, col_offset=16), Expr(Call(Name('CDLL', Load(), lineno=42, col_offset=16), [Name('lib', Load(), lineno=42, col_offset=21)], [], None, None, lineno=42, col_offset=16), lineno=42, col_offset=16)], [], lineno=40, col_offset=12)], [], lineno=38, col_offset=8)], [], lineno=37, col_offset=4), If(Compare(Attribute(Name('os', Load(), lineno=44, col_offset=7), 'name', Load(), lineno=44, col_offset=7), [In()], [Tuple([Str('nt', lineno=44, col_offset=19), Str('ce', lineno=44, col_offset=25)], Load(), lineno=44, col_offset=19)], lineno=44, col_offset=7), [FunctionDef('test_load_library', arguments([Name('self', Param(), lineno=45, col_offset=30)], None, None, []), [Expr(Call(Attribute(Name('self', Load(), lineno=46, col_offset=12), 'assertFalse', Load(), lineno=46, col_offset=12), [Compare(Name('libc_name', Load(), lineno=46, col_offset=29), [Is()], [Name('None', Load(), lineno=46, col_offset=42)], lineno=46, col_offset=29)], [], None, None, lineno=46, col_offset=12), lineno=46, col_offset=12), If(Call(Name('is_resource_enabled', Load(), lineno=47, col_offset=15), [Str('printing', lineno=47, col_offset=35)], [], None, None, lineno=47, col_offset=15), [Print(None, [Call(Name('find_library', Load(), lineno=48, col_offset=22), [Str('kernel32', lineno=48, col_offset=35)], [], None, None, lineno=48, col_offset=22)], True, lineno=48, col_offset=16), Print(None, [Call(Name('find_library', Load(), lineno=49, col_offset=22), [Str('user32', lineno=49, col_offset=35)], [], None, None, lineno=49, col_offset=22)], True, lineno=49, col_offset=16)], [], lineno=47, col_offset=12), If(Compare(Attribute(Name('os', Load(), lineno=51, col_offset=15), 'name', Load(), lineno=51, col_offset=15), [Eq()], [Str('nt', lineno=51, col_offset=26)], lineno=51, col_offset=15), [Expr(Attribute(Attribute(Name('windll', Load(), lineno=52, col_offset=16), 'kernel32', Load(), lineno=52, col_offset=16), 'GetModuleHandleW', Load(), lineno=52, col_offset=16), lineno=52, col_offset=16), Expr(Attribute(Subscript(Name('windll', Load(), lineno=53, col_offset=16), Index(Str('kernel32', lineno=53, col_offset=23)), Load(), lineno=53, col_offset=16), 'GetModuleHandleW', Load(), lineno=53, col_offset=16), lineno=53, col_offset=16), Expr(Attribute(Call(Attribute(Name('windll', Load(), lineno=54, col_offset=16), 'LoadLibrary', Load(), lineno=54, col_offset=16), [Str('kernel32', lineno=54, col_offset=35)], [], None, None, lineno=54, col_offset=16), 'GetModuleHandleW', Load(), lineno=54, col_offset=16), lineno=54, col_offset=16), Expr(Attribute(Call(Name('WinDLL', Load(), lineno=55, col_offset=16), [Str('kernel32', lineno=55, col_offset=23)], [], None, None, lineno=55, col_offset=16), 'GetModuleHandleW', Load(), lineno=55, col_offset=16), lineno=55, col_offset=16)], [If(Compare(Attribute(Name('os', Load(), lineno=56, col_offset=17), 'name', Load(), lineno=56, col_offset=17), [Eq()], [Str('ce', lineno=56, col_offset=28)], lineno=56, col_offset=17), [Expr(Attribute(Attribute(Name('windll', Load(), lineno=57, col_offset=16), 'coredll', Load(), lineno=57, col_offset=16), 'GetModuleHandleW', Load(), lineno=57, col_offset=16), lineno=57, col_offset=16), Expr(Attribute(Subscript(Name('windll', Load(), lineno=58, col_offset=16), Index(Str('coredll', lineno=58, col_offset=23)), Load(), lineno=58, col_offset=16), 'GetModuleHandleW', Load(), lineno=58, col_offset=16), lineno=58, col_offset=16), Expr(Attribute(Call(Attribute(Name('windll', Load(), lineno=59, col_offset=16), 'LoadLibrary', Load(), lineno=59, col_offset=16), [Str('coredll', lineno=59, col_offset=35)], [], None, None, lineno=59, col_offset=16), 'GetModuleHandleW', Load(), lineno=59, col_offset=16), lineno=59, col_offset=16), Expr(Attribute(Call(Name('WinDLL', Load(), lineno=60, col_offset=16), [Str('coredll', lineno=60, col_offset=23)], [], None, None, lineno=60, col_offset=16), 'GetModuleHandleW', Load(), lineno=60, col_offset=16), lineno=60, col_offset=16)], [], lineno=56, col_offset=17)], lineno=51, col_offset=12)], [], lineno=45, col_offset=8), FunctionDef('test_load_ordinal_functions', arguments([Name('self', Param(), lineno=62, col_offset=40)], None, None, []), [Import([alias('_ctypes_test', None)], lineno=63, col_offset=12), Assign([Name('dll', Store(), lineno=64, col_offset=12)], Call(Name('WinDLL', Load(), lineno=64, col_offset=18), [Attribute(Name('_ctypes_test', Load(), lineno=64, col_offset=25), '__file__', Load(), lineno=64, col_offset=25)], [], None, None, lineno=64, col_offset=18), lineno=64, col_offset=12), Assign([Name('func_ord', Store(), lineno=66, col_offset=12)], Subscript(Name('dll', Load(), lineno=66, col_offset=23), Index(Num(2, lineno=66, col_offset=27)), Load(), lineno=66, col_offset=23), lineno=66, col_offset=12), Assign([Name('func_name', Store(), lineno=67, col_offset=12)], Attribute(Name('dll', Load(), lineno=67, col_offset=24), 'GetString', Load(), lineno=67, col_offset=24), lineno=67, col_offset=12), Assign([Name('a_ord', Store(), lineno=69, col_offset=12)], Call(Name('addressof', Load(), lineno=69, col_offset=20), [Name('func_ord', Load(), lineno=69, col_offset=30)], [], None, None, lineno=69, col_offset=20), lineno=69, col_offset=12), Assign([Name('a_name', Store(), lineno=70, col_offset=12)], Call(Name('addressof', Load(), lineno=70, col_offset=21), [Name('func_name', Load(), lineno=70, col_offset=31)], [], None, None, lineno=70, col_offset=21), lineno=70, col_offset=12), Assign([Name('f_ord_addr', Store(), lineno=71, col_offset=12)], Attribute(Call(Attribute(Name('c_void_p', Load(), lineno=71, col_offset=25), 'from_address', Load(), lineno=71, col_offset=25), [Name('a_ord', Load(), lineno=71, col_offset=47)], [], None, None, lineno=71, col_offset=25), 'value', Load(), lineno=71, col_offset=25), lineno=71, col_offset=12), Assign([Name('f_name_addr', Store(), lineno=72, col_offset=12)], Attribute(Call(Attribute(Name('c_void_p', Load(), lineno=72, col_offset=26), 'from_address', Load(), lineno=72, col_offset=26), [Name('a_name', Load(), lineno=72, col_offset=48)], [], None, None, lineno=72, col_offset=26), 'value', Load(), lineno=72, col_offset=26), lineno=72, col_offset=12), Expr(Call(Attribute(Name('self', Load(), lineno=73, col_offset=12), 'assertEqual', Load(), lineno=73, col_offset=12), [Call(Name('hex', Load(), lineno=73, col_offset=29), [Name('f_ord_addr', Load(), lineno=73, col_offset=33)], [], None, None, lineno=73, col_offset=29), Call(Name('hex', Load(), lineno=73, col_offset=46), [Name('f_name_addr', Load(), lineno=73, col_offset=50)], [], None, None, lineno=73, col_offset=46)], [], None, None, lineno=73, col_offset=12), lineno=73, col_offset=12), Expr(Call(Attribute(Name('self', Load(), lineno=75, col_offset=12), 'assertRaises', Load(), lineno=75, col_offset=12), [Name('AttributeError', Load(), lineno=75, col_offset=30), Attribute(Name('dll', Load(), lineno=75, col_offset=46), '__getitem__', Load(), lineno=75, col_offset=46), Num(1234, lineno=75, col_offset=63)], [], None, None, lineno=75, col_offset=12), lineno=75, col_offset=12)], [], lineno=62, col_offset=8)], [], lineno=44, col_offset=4), If(Compare(Attribute(Name('os', Load(), lineno=77, col_offset=7), 'name', Load(), lineno=77, col_offset=7), [Eq()], [Str('nt', lineno=77, col_offset=18)], lineno=77, col_offset=7), [FunctionDef('test_1703286_A', arguments([Name('self', Param(), lineno=78, col_offset=27)], None, None, []), [ImportFrom('_ctypes', [alias('LoadLibrary', None), alias('FreeLibrary', None)], 0, lineno=79, col_offset=12), Assign([Name('handle', Store(), lineno=85, col_offset=12)], Call(Name('LoadLibrary', Load(), lineno=85, col_offset=21), [Str('advapi32', lineno=85, col_offset=33)], [], None, None, lineno=85, col_offset=21), lineno=85, col_offset=12), Expr(Call(Name('FreeLibrary', Load(), lineno=86, col_offset=12), [Name('handle', Load(), lineno=86, col_offset=24)], [], None, None, lineno=86, col_offset=12), lineno=86, col_offset=12)], [], lineno=78, col_offset=8), FunctionDef('test_1703286_B', arguments([Name('self', Param(), lineno=88, col_offset=27)], None, None, []), [ImportFrom('_ctypes', [alias('call_function', None)], 0, lineno=93, col_offset=12), Assign([Name('advapi32', Store(), lineno=94, col_offset=12)], Attribute(Name('windll', Load(), lineno=94, col_offset=23), 'advapi32', Load(), lineno=94, col_offset=23), lineno=94, col_offset=12), Expr(Call(Attribute(Name('self', Load(), lineno=97, col_offset=12), 'assertEqual', Load(), lineno=97, col_offset=12), [Num(0, lineno=97, col_offset=29), Call(Attribute(Name('advapi32', Load(), lineno=97, col_offset=32), 'CloseEventLog', Load(), lineno=97, col_offset=32), [Name('None', Load(), lineno=97, col_offset=55)], [], None, None, lineno=97, col_offset=32)], [], None, None, lineno=97, col_offset=12), lineno=97, col_offset=12), Assign([Attribute(Attribute(Attribute(Name('windll', Load(), lineno=98, col_offset=12), 'kernel32', Load(), lineno=98, col_offset=12), 'GetProcAddress', Load(), lineno=98, col_offset=12), 'argtypes', Store(), lineno=98, col_offset=12)], Tuple([Name('c_void_p', Load(), lineno=98, col_offset=54), Name('c_char_p', Load(), lineno=98, col_offset=64)], Load(), lineno=98, col_offset=54), lineno=98, col_offset=12), Assign([Attribute(Attribute(Attribute(Name('windll', Load(), lineno=99, col_offset=12), 'kernel32', Load(), lineno=99, col_offset=12), 'GetProcAddress', Load(), lineno=99, col_offset=12), 'restype', Store(), lineno=99, col_offset=12)], Name('c_void_p', Load(), lineno=99, col_offset=53), lineno=99, col_offset=12), Assign([Name('proc', Store(), lineno=100, col_offset=12)], Call(Attribute(Attribute(Name('windll', Load(), lineno=100, col_offset=19), 'kernel32', Load(), lineno=100, col_offset=19), 'GetProcAddress', Load(), lineno=100, col_offset=19), [Attribute(Name('advapi32', Load(), lineno=100, col_offset=50), '_handle', Load(), lineno=100, col_offset=50), Str('CloseEventLog', lineno=100, col_offset=68)], [], None, None, lineno=100, col_offset=19), lineno=100, col_offset=12), Expr(Call(Attribute(Name('self', Load(), lineno=101, col_offset=12), 'assertTrue', Load(), lineno=101, col_offset=12), [Name('proc', Load(), lineno=101, col_offset=28)], [], None, None, lineno=101, col_offset=12), lineno=101, col_offset=12), Expr(Call(Attribute(Name('self', Load(), lineno=103, col_offset=12), 'assertEqual', Load(), lineno=103, col_offset=12), [Num(0, lineno=103, col_offset=29), Call(Name('call_function', Load(), lineno=103, col_offset=32), [Name('proc', Load(), lineno=103, col_offset=46), Tuple([Name('None', Load(), lineno=103, col_offset=53)], Load(), lineno=103, col_offset=53)], [], None, None, lineno=103, col_offset=32)], [], None, None, lineno=103, col_offset=12), lineno=103, col_offset=12)], [], lineno=88, col_offset=8)], [], lineno=77, col_offset=4)], [], lineno=20, col_offset=0), If(Compare(Name('__name__', Load(), lineno=105, col_offset=3), [Eq()], [Str('__main__', lineno=105, col_offset=15)], lineno=105, col_offset=3), [Expr(Call(Attribute(Name('unittest', Load(), lineno=106, col_offset=4), 'main', Load(), lineno=106, col_offset=4), [], [], None, None, lineno=106, col_offset=4), lineno=106, col_offset=4)], [], lineno=105, col_offset=0)])
