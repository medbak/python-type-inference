Module([Expr(Str('Tests for distutils.command.build_py.', lineno=1, col_offset=0), lineno=1, col_offset=0), Import([alias('os', None)], lineno=3, col_offset=0), Import([alias('sys', None)], lineno=4, col_offset=0), Import([alias('StringIO', None)], lineno=5, col_offset=0), Import([alias('unittest', None)], lineno=6, col_offset=0), ImportFrom('distutils.command.build_py', [alias('build_py', None)], 0, lineno=8, col_offset=0), ImportFrom('distutils.core', [alias('Distribution', None)], 0, lineno=9, col_offset=0), ImportFrom('distutils.errors', [alias('DistutilsFileError', None)], 0, lineno=10, col_offset=0), ImportFrom('distutils.tests', [alias('support', None)], 0, lineno=12, col_offset=0), ClassDef('BuildPyTestCase', [Attribute(Name('support', Load(), lineno=15, col_offset=22), 'TempdirManager', Load(), lineno=15, col_offset=22), Attribute(Name('support', Load(), lineno=16, col_offset=22), 'LoggingSilencer', Load(), lineno=16, col_offset=22), Attribute(Name('unittest', Load(), lineno=17, col_offset=22), 'TestCase', Load(), lineno=17, col_offset=22)], [FunctionDef('_setup_package_data', arguments([Name('self', Param(), lineno=19, col_offset=28)], None, None, []), [Assign([Name('sources', Store(), lineno=20, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=20, col_offset=18), 'mkdtemp', Load(), lineno=20, col_offset=18), [], [], None, None, lineno=20, col_offset=18), lineno=20, col_offset=8), Assign([Name('f', Store(), lineno=21, col_offset=8)], Call(Name('open', Load(), lineno=21, col_offset=12), [Call(Attribute(Attribute(Name('os', Load(), lineno=21, col_offset=17), 'path', Load(), lineno=21, col_offset=17), 'join', Load(), lineno=21, col_offset=17), [Name('sources', Load(), lineno=21, col_offset=30), Str('__init__.py', lineno=21, col_offset=39)], [], None, None, lineno=21, col_offset=17), Str('w', lineno=21, col_offset=55)], [], None, None, lineno=21, col_offset=12), lineno=21, col_offset=8), TryFinally([Expr(Call(Attribute(Name('f', Load(), lineno=23, col_offset=12), 'write', Load(), lineno=23, col_offset=12), [Str('# Pretend this is a package.', lineno=23, col_offset=20)], [], None, None, lineno=23, col_offset=12), lineno=23, col_offset=12)], [Expr(Call(Attribute(Name('f', Load(), lineno=25, col_offset=12), 'close', Load(), lineno=25, col_offset=12), [], [], None, None, lineno=25, col_offset=12), lineno=25, col_offset=12)], lineno=22, col_offset=8), Assign([Name('f', Store(), lineno=26, col_offset=8)], Call(Name('open', Load(), lineno=26, col_offset=12), [Call(Attribute(Attribute(Name('os', Load(), lineno=26, col_offset=17), 'path', Load(), lineno=26, col_offset=17), 'join', Load(), lineno=26, col_offset=17), [Name('sources', Load(), lineno=26, col_offset=30), Str('README.txt', lineno=26, col_offset=39)], [], None, None, lineno=26, col_offset=17), Str('w', lineno=26, col_offset=54)], [], None, None, lineno=26, col_offset=12), lineno=26, col_offset=8), TryFinally([Expr(Call(Attribute(Name('f', Load(), lineno=28, col_offset=12), 'write', Load(), lineno=28, col_offset=12), [Str('Info about this package', lineno=28, col_offset=20)], [], None, None, lineno=28, col_offset=12), lineno=28, col_offset=12)], [Expr(Call(Attribute(Name('f', Load(), lineno=30, col_offset=12), 'close', Load(), lineno=30, col_offset=12), [], [], None, None, lineno=30, col_offset=12), lineno=30, col_offset=12)], lineno=27, col_offset=8), Assign([Name('destination', Store(), lineno=32, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=32, col_offset=22), 'mkdtemp', Load(), lineno=32, col_offset=22), [], [], None, None, lineno=32, col_offset=22), lineno=32, col_offset=8), Assign([Name('dist', Store(), lineno=34, col_offset=8)], Call(Name('Distribution', Load(), lineno=34, col_offset=15), [Dict([Str('packages', lineno=34, col_offset=29), Str('package_dir', lineno=35, col_offset=29)], [List([Str('pkg', lineno=34, col_offset=42)], Load(), lineno=34, col_offset=41), Dict([Str('pkg', lineno=35, col_offset=45)], [Name('sources', Load(), lineno=35, col_offset=52)], lineno=35, col_offset=44)], lineno=34, col_offset=28)], [], None, None, lineno=34, col_offset=15), lineno=34, col_offset=8), Assign([Attribute(Name('dist', Load(), lineno=37, col_offset=8), 'script_name', Store(), lineno=37, col_offset=8)], Call(Attribute(Attribute(Name('os', Load(), lineno=37, col_offset=27), 'path', Load(), lineno=37, col_offset=27), 'join', Load(), lineno=37, col_offset=27), [Name('sources', Load(), lineno=37, col_offset=40), Str('setup.py', lineno=37, col_offset=49)], [], None, None, lineno=37, col_offset=27), lineno=37, col_offset=8), Assign([Subscript(Attribute(Name('dist', Load(), lineno=38, col_offset=8), 'command_obj', Load(), lineno=38, col_offset=8), Index(Str('build', lineno=38, col_offset=25)), Store(), lineno=38, col_offset=8)], Call(Attribute(Name('support', Load(), lineno=38, col_offset=36), 'DummyCommand', Load(), lineno=38, col_offset=36), [], [keyword('force', Num(0, lineno=39, col_offset=18)), keyword('build_lib', Name('destination', Load(), lineno=40, col_offset=22))], None, None, lineno=38, col_offset=36), lineno=38, col_offset=8), Assign([Attribute(Name('dist', Load(), lineno=41, col_offset=8), 'packages', Store(), lineno=41, col_offset=8)], List([Str('pkg', lineno=41, col_offset=25)], Load(), lineno=41, col_offset=24), lineno=41, col_offset=8), Assign([Attribute(Name('dist', Load(), lineno=42, col_offset=8), 'package_data', Store(), lineno=42, col_offset=8)], Dict([Str('pkg', lineno=42, col_offset=29)], [List([Str('README.txt', lineno=42, col_offset=37)], Load(), lineno=42, col_offset=36)], lineno=42, col_offset=28), lineno=42, col_offset=8), Assign([Attribute(Name('dist', Load(), lineno=43, col_offset=8), 'package_dir', Store(), lineno=43, col_offset=8)], Dict([Str('pkg', lineno=43, col_offset=28)], [Name('sources', Load(), lineno=43, col_offset=35)], lineno=43, col_offset=27), lineno=43, col_offset=8), Assign([Name('cmd', Store(), lineno=45, col_offset=8)], Call(Name('build_py', Load(), lineno=45, col_offset=14), [Name('dist', Load(), lineno=45, col_offset=23)], [], None, None, lineno=45, col_offset=14), lineno=45, col_offset=8), Assign([Attribute(Name('cmd', Load(), lineno=46, col_offset=8), 'compile', Store(), lineno=46, col_offset=8)], Num(1, lineno=46, col_offset=22), lineno=46, col_offset=8), Expr(Call(Attribute(Name('cmd', Load(), lineno=47, col_offset=8), 'ensure_finalized', Load(), lineno=47, col_offset=8), [], [], None, None, lineno=47, col_offset=8), lineno=47, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=48, col_offset=8), 'assertEqual', Load(), lineno=48, col_offset=8), [Attribute(Name('cmd', Load(), lineno=48, col_offset=25), 'package_data', Load(), lineno=48, col_offset=25), Attribute(Name('dist', Load(), lineno=48, col_offset=43), 'package_data', Load(), lineno=48, col_offset=43)], [], None, None, lineno=48, col_offset=8), lineno=48, col_offset=8), Expr(Call(Attribute(Name('cmd', Load(), lineno=50, col_offset=8), 'run', Load(), lineno=50, col_offset=8), [], [], None, None, lineno=50, col_offset=8), lineno=50, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=56, col_offset=8), 'assertEqual', Load(), lineno=56, col_offset=8), [Call(Name('len', Load(), lineno=56, col_offset=25), [Call(Attribute(Name('cmd', Load(), lineno=56, col_offset=29), 'get_outputs', Load(), lineno=56, col_offset=29), [], [], None, None, lineno=56, col_offset=29)], [], None, None, lineno=56, col_offset=25), Num(3, lineno=56, col_offset=49)], [], None, None, lineno=56, col_offset=8), lineno=56, col_offset=8), Assign([Name('pkgdest', Store(), lineno=57, col_offset=8)], Call(Attribute(Attribute(Name('os', Load(), lineno=57, col_offset=18), 'path', Load(), lineno=57, col_offset=18), 'join', Load(), lineno=57, col_offset=18), [Name('destination', Load(), lineno=57, col_offset=31), Str('pkg', lineno=57, col_offset=44)], [], None, None, lineno=57, col_offset=18), lineno=57, col_offset=8), Assign([Name('files', Store(), lineno=58, col_offset=8)], Call(Attribute(Name('os', Load(), lineno=58, col_offset=16), 'listdir', Load(), lineno=58, col_offset=16), [Name('pkgdest', Load(), lineno=58, col_offset=27)], [], None, None, lineno=58, col_offset=16), lineno=58, col_offset=8), Return(Name('files', Load(), lineno=59, col_offset=15), lineno=59, col_offset=8)], [], lineno=19, col_offset=4), FunctionDef('test_package_data', arguments([Name('self', Param(), lineno=61, col_offset=26)], None, None, []), [Assign([Name('files', Store(), lineno=62, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=62, col_offset=16), '_setup_package_data', Load(), lineno=62, col_offset=16), [], [], None, None, lineno=62, col_offset=16), lineno=62, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=63, col_offset=8), 'assertTrue', Load(), lineno=63, col_offset=8), [Compare(Str('__init__.py', lineno=63, col_offset=24), [In()], [Name('files', Load(), lineno=63, col_offset=41)], lineno=63, col_offset=24)], [], None, None, lineno=63, col_offset=8), lineno=63, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=64, col_offset=8), 'assertTrue', Load(), lineno=64, col_offset=8), [Compare(Str('README.txt', lineno=64, col_offset=24), [In()], [Name('files', Load(), lineno=64, col_offset=40)], lineno=64, col_offset=24)], [], None, None, lineno=64, col_offset=8), lineno=64, col_offset=8)], [], lineno=61, col_offset=4), FunctionDef('test_package_data_pyc', arguments([Name('self', Param(), lineno=68, col_offset=30)], None, None, []), [Assign([Name('files', Store(), lineno=69, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=69, col_offset=16), '_setup_package_data', Load(), lineno=69, col_offset=16), [], [], None, None, lineno=69, col_offset=16), lineno=69, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=70, col_offset=8), 'assertTrue', Load(), lineno=70, col_offset=8), [Compare(Str('__init__.pyc', lineno=70, col_offset=24), [In()], [Name('files', Load(), lineno=70, col_offset=42)], lineno=70, col_offset=24)], [], None, None, lineno=70, col_offset=8), lineno=70, col_offset=8)], [Call(Attribute(Name('unittest', Load(), lineno=66, col_offset=5), 'skipIf', Load(), lineno=66, col_offset=5), [Compare(Attribute(Attribute(Name('sys', Load(), lineno=66, col_offset=21), 'flags', Load(), lineno=66, col_offset=21), 'optimize', Load(), lineno=66, col_offset=21), [GtE()], [Num(2, lineno=66, col_offset=43)], lineno=66, col_offset=21), Str('pyc files are not written with -O2 and above', lineno=67, col_offset=21)], [], None, None, lineno=66, col_offset=5)], lineno=66, col_offset=4), FunctionDef('test_empty_package_dir', arguments([Name('self', Param(), lineno=72, col_offset=32)], None, None, []), [Assign([Name('cwd', Store(), lineno=74, col_offset=8)], Call(Attribute(Name('os', Load(), lineno=74, col_offset=14), 'getcwd', Load(), lineno=74, col_offset=14), [], [], None, None, lineno=74, col_offset=14), lineno=74, col_offset=8), Assign([Name('sources', Store(), lineno=77, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=77, col_offset=18), 'mkdtemp', Load(), lineno=77, col_offset=18), [], [], None, None, lineno=77, col_offset=18), lineno=77, col_offset=8), Expr(Call(Attribute(Call(Name('open', Load(), lineno=78, col_offset=8), [Call(Attribute(Attribute(Name('os', Load(), lineno=78, col_offset=13), 'path', Load(), lineno=78, col_offset=13), 'join', Load(), lineno=78, col_offset=13), [Name('sources', Load(), lineno=78, col_offset=26), Str('__init__.py', lineno=78, col_offset=35)], [], None, None, lineno=78, col_offset=13), Str('w', lineno=78, col_offset=51)], [], None, None, lineno=78, col_offset=8), 'close', Load(), lineno=78, col_offset=8), [], [], None, None, lineno=78, col_offset=8), lineno=78, col_offset=8), Assign([Name('testdir', Store(), lineno=80, col_offset=8)], Call(Attribute(Attribute(Name('os', Load(), lineno=80, col_offset=18), 'path', Load(), lineno=80, col_offset=18), 'join', Load(), lineno=80, col_offset=18), [Name('sources', Load(), lineno=80, col_offset=31), Str('doc', lineno=80, col_offset=40)], [], None, None, lineno=80, col_offset=18), lineno=80, col_offset=8), Expr(Call(Attribute(Name('os', Load(), lineno=81, col_offset=8), 'mkdir', Load(), lineno=81, col_offset=8), [Name('testdir', Load(), lineno=81, col_offset=17)], [], None, None, lineno=81, col_offset=8), lineno=81, col_offset=8), Expr(Call(Attribute(Call(Name('open', Load(), lineno=82, col_offset=8), [Call(Attribute(Attribute(Name('os', Load(), lineno=82, col_offset=13), 'path', Load(), lineno=82, col_offset=13), 'join', Load(), lineno=82, col_offset=13), [Name('testdir', Load(), lineno=82, col_offset=26), Str('testfile', lineno=82, col_offset=35)], [], None, None, lineno=82, col_offset=13), Str('w', lineno=82, col_offset=48)], [], None, None, lineno=82, col_offset=8), 'close', Load(), lineno=82, col_offset=8), [], [], None, None, lineno=82, col_offset=8), lineno=82, col_offset=8), Expr(Call(Attribute(Name('os', Load(), lineno=84, col_offset=8), 'chdir', Load(), lineno=84, col_offset=8), [Name('sources', Load(), lineno=84, col_offset=17)], [], None, None, lineno=84, col_offset=8), lineno=84, col_offset=8), Assign([Name('old_stdout', Store(), lineno=85, col_offset=8)], Attribute(Name('sys', Load(), lineno=85, col_offset=21), 'stdout', Load(), lineno=85, col_offset=21), lineno=85, col_offset=8), Assign([Attribute(Name('sys', Load(), lineno=86, col_offset=8), 'stdout', Store(), lineno=86, col_offset=8)], Call(Attribute(Name('StringIO', Load(), lineno=86, col_offset=21), 'StringIO', Load(), lineno=86, col_offset=21), [], [], None, None, lineno=86, col_offset=21), lineno=86, col_offset=8), TryFinally([Assign([Name('dist', Store(), lineno=89, col_offset=12)], Call(Name('Distribution', Load(), lineno=89, col_offset=19), [Dict([Str('packages', lineno=89, col_offset=33), Str('package_dir', lineno=90, col_offset=33), Str('package_data', lineno=91, col_offset=33)], [List([Str('pkg', lineno=89, col_offset=46)], Load(), lineno=89, col_offset=45), Dict([Str('pkg', lineno=90, col_offset=49)], [Str('', lineno=90, col_offset=56)], lineno=90, col_offset=48), Dict([Str('pkg', lineno=91, col_offset=50)], [List([Str('doc/*', lineno=91, col_offset=58)], Load(), lineno=91, col_offset=57)], lineno=91, col_offset=49)], lineno=89, col_offset=32)], [], None, None, lineno=89, col_offset=19), lineno=89, col_offset=12), Assign([Attribute(Name('dist', Load(), lineno=93, col_offset=12), 'script_name', Store(), lineno=93, col_offset=12)], Call(Attribute(Attribute(Name('os', Load(), lineno=93, col_offset=31), 'path', Load(), lineno=93, col_offset=31), 'join', Load(), lineno=93, col_offset=31), [Name('sources', Load(), lineno=93, col_offset=44), Str('setup.py', lineno=93, col_offset=53)], [], None, None, lineno=93, col_offset=31), lineno=93, col_offset=12), Assign([Attribute(Name('dist', Load(), lineno=94, col_offset=12), 'script_args', Store(), lineno=94, col_offset=12)], List([Str('build', lineno=94, col_offset=32)], Load(), lineno=94, col_offset=31), lineno=94, col_offset=12), Expr(Call(Attribute(Name('dist', Load(), lineno=95, col_offset=12), 'parse_command_line', Load(), lineno=95, col_offset=12), [], [], None, None, lineno=95, col_offset=12), lineno=95, col_offset=12), TryExcept([Expr(Call(Attribute(Name('dist', Load(), lineno=98, col_offset=16), 'run_commands', Load(), lineno=98, col_offset=16), [], [], None, None, lineno=98, col_offset=16), lineno=98, col_offset=16)], [ExceptHandler(Name('DistutilsFileError', Load(), lineno=99, col_offset=19), None, [Expr(Call(Attribute(Name('self', Load(), lineno=100, col_offset=16), 'fail', Load(), lineno=100, col_offset=16), [Str("failed package_data test when package_dir is ''", lineno=100, col_offset=26)], [], None, None, lineno=100, col_offset=16), lineno=100, col_offset=16)], lineno=99, col_offset=12)], [], lineno=97, col_offset=12)], [Expr(Call(Attribute(Name('os', Load(), lineno=103, col_offset=12), 'chdir', Load(), lineno=103, col_offset=12), [Name('cwd', Load(), lineno=103, col_offset=21)], [], None, None, lineno=103, col_offset=12), lineno=103, col_offset=12), Assign([Attribute(Name('sys', Load(), lineno=104, col_offset=12), 'stdout', Store(), lineno=104, col_offset=12)], Name('old_stdout', Load(), lineno=104, col_offset=25), lineno=104, col_offset=12)], lineno=88, col_offset=8)], [], lineno=72, col_offset=4), FunctionDef('test_dont_write_bytecode', arguments([Name('self', Param(), lineno=106, col_offset=33)], None, None, []), [Assign([Tuple([Name('pkg_dir', Store(), lineno=108, col_offset=8), Name('dist', Store(), lineno=108, col_offset=17)], Store(), lineno=108, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=108, col_offset=24), 'create_dist', Load(), lineno=108, col_offset=24), [], [], None, None, lineno=108, col_offset=24), lineno=108, col_offset=8), Assign([Name('cmd', Store(), lineno=109, col_offset=8)], Call(Name('build_py', Load(), lineno=109, col_offset=14), [Name('dist', Load(), lineno=109, col_offset=23)], [], None, None, lineno=109, col_offset=14), lineno=109, col_offset=8), Assign([Attribute(Name('cmd', Load(), lineno=110, col_offset=8), 'compile', Store(), lineno=110, col_offset=8)], Num(1, lineno=110, col_offset=22), lineno=110, col_offset=8), Assign([Attribute(Name('cmd', Load(), lineno=111, col_offset=8), 'optimize', Store(), lineno=111, col_offset=8)], Num(1, lineno=111, col_offset=23), lineno=111, col_offset=8), Assign([Name('old_dont_write_bytecode', Store(), lineno=113, col_offset=8)], Attribute(Name('sys', Load(), lineno=113, col_offset=34), 'dont_write_bytecode', Load(), lineno=113, col_offset=34), lineno=113, col_offset=8), Assign([Attribute(Name('sys', Load(), lineno=114, col_offset=8), 'dont_write_bytecode', Store(), lineno=114, col_offset=8)], Name('True', Load(), lineno=114, col_offset=34), lineno=114, col_offset=8), TryFinally([Expr(Call(Attribute(Name('cmd', Load(), lineno=116, col_offset=12), 'byte_compile', Load(), lineno=116, col_offset=12), [List([], Load(), lineno=116, col_offset=29)], [], None, None, lineno=116, col_offset=12), lineno=116, col_offset=12)], [Assign([Attribute(Name('sys', Load(), lineno=118, col_offset=12), 'dont_write_bytecode', Store(), lineno=118, col_offset=12)], Name('old_dont_write_bytecode', Load(), lineno=118, col_offset=38), lineno=118, col_offset=12)], lineno=115, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=120, col_offset=8), 'assertTrue', Load(), lineno=120, col_offset=8), [Compare(Str('byte-compiling is disabled', lineno=120, col_offset=24), [In()], [Subscript(Subscript(Attribute(Name('self', Load(), lineno=120, col_offset=56), 'logs', Load(), lineno=120, col_offset=56), Index(Num(0, lineno=120, col_offset=66)), Load(), lineno=120, col_offset=56), Index(Num(1, lineno=120, col_offset=69)), Load(), lineno=120, col_offset=56)], lineno=120, col_offset=24)], [], None, None, lineno=120, col_offset=8), lineno=120, col_offset=8)], [], lineno=106, col_offset=4)], [], lineno=15, col_offset=0), FunctionDef('test_suite', arguments([], None, None, []), [Return(Call(Attribute(Name('unittest', Load(), lineno=123, col_offset=11), 'makeSuite', Load(), lineno=123, col_offset=11), [Name('BuildPyTestCase', Load(), lineno=123, col_offset=30)], [], None, None, lineno=123, col_offset=11), lineno=123, col_offset=4)], [], lineno=122, col_offset=0), If(Compare(Name('__name__', Load(), lineno=125, col_offset=3), [Eq()], [Str('__main__', lineno=125, col_offset=15)], lineno=125, col_offset=3), [Expr(Call(Attribute(Name('unittest', Load(), lineno=126, col_offset=4), 'main', Load(), lineno=126, col_offset=4), [], [keyword('defaultTest', Str('test_suite', lineno=126, col_offset=30))], None, None, lineno=126, col_offset=4), lineno=126, col_offset=4)], [], lineno=125, col_offset=0)])
