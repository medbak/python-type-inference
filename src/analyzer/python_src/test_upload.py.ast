Module([Expr(Str('Tests for distutils.command.upload.', lineno=1, col_offset=0), lineno=1, col_offset=0), Import([alias('sys', None)], lineno=3, col_offset=0), Import([alias('os', None)], lineno=4, col_offset=0), Import([alias('unittest', None)], lineno=5, col_offset=0), ImportFrom('distutils.command', [alias('upload', 'upload_mod')], 0, lineno=7, col_offset=0), ImportFrom('distutils.command.upload', [alias('upload', None)], 0, lineno=8, col_offset=0), ImportFrom('distutils.core', [alias('Distribution', None)], 0, lineno=9, col_offset=0), ImportFrom('distutils.tests', [alias('support', None)], 0, lineno=11, col_offset=0), ImportFrom('distutils.tests.test_config', [alias('PYPIRC', None), alias('PyPIRCCommandTestCase', None)], 0, lineno=12, col_offset=0), Assign([Name('PYPIRC_LONG_PASSWORD', Store(), lineno=14, col_offset=0)], Str('[distutils]\n\nindex-servers =\n    server1\n    server2\n\n[server1]\nusername:me\npassword:aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\n\n[server2]\nusername:meagain\npassword: secret\nrealm:acme\nrepository:http://another.pypi/\n', lineno=30, col_offset=-1), lineno=14, col_offset=0), Assign([Name('PYPIRC_NOPASSWORD', Store(), lineno=33, col_offset=0)], Str('[distutils]\n\nindex-servers =\n    server1\n\n[server1]\nusername:me\n', lineno=41, col_offset=-1), lineno=33, col_offset=0), ClassDef('FakeOpen', [Name('object', Load(), lineno=43, col_offset=15)], [FunctionDef('__init__', arguments([Name('self', Param(), lineno=45, col_offset=17), Name('url', Param(), lineno=45, col_offset=23)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=46, col_offset=8), 'url', Store(), lineno=46, col_offset=8)], Name('url', Load(), lineno=46, col_offset=19), lineno=46, col_offset=8), If(UnaryOp(Not(), Call(Name('isinstance', Load(), lineno=47, col_offset=15), [Name('url', Load(), lineno=47, col_offset=26), Name('str', Load(), lineno=47, col_offset=31)], [], None, None, lineno=47, col_offset=15), lineno=47, col_offset=11), [Assign([Attribute(Name('self', Load(), lineno=48, col_offset=12), 'req', Store(), lineno=48, col_offset=12)], Name('url', Load(), lineno=48, col_offset=23), lineno=48, col_offset=12)], [Assign([Attribute(Name('self', Load(), lineno=50, col_offset=12), 'req', Store(), lineno=50, col_offset=12)], Name('None', Load(), lineno=50, col_offset=23), lineno=50, col_offset=12)], lineno=47, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=51, col_offset=8), 'msg', Store(), lineno=51, col_offset=8)], Str('OK', lineno=51, col_offset=19), lineno=51, col_offset=8)], [], lineno=45, col_offset=4), FunctionDef('getcode', arguments([Name('self', Param(), lineno=53, col_offset=16)], None, None, []), [Return(Num(200, lineno=54, col_offset=15), lineno=54, col_offset=8)], [], lineno=53, col_offset=4)], [], lineno=43, col_offset=0), ClassDef('uploadTestCase', [Name('PyPIRCCommandTestCase', Load(), lineno=57, col_offset=21)], [FunctionDef('setUp', arguments([Name('self', Param(), lineno=59, col_offset=14)], None, None, []), [Expr(Call(Attribute(Call(Name('super', Load(), lineno=60, col_offset=8), [Name('uploadTestCase', Load(), lineno=60, col_offset=14), Name('self', Load(), lineno=60, col_offset=30)], [], None, None, lineno=60, col_offset=8), 'setUp', Load(), lineno=60, col_offset=8), [], [], None, None, lineno=60, col_offset=8), lineno=60, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=61, col_offset=8), 'old_open', Store(), lineno=61, col_offset=8)], Attribute(Name('upload_mod', Load(), lineno=61, col_offset=24), 'urlopen', Load(), lineno=61, col_offset=24), lineno=61, col_offset=8), Assign([Attribute(Name('upload_mod', Load(), lineno=62, col_offset=8), 'urlopen', Store(), lineno=62, col_offset=8)], Attribute(Name('self', Load(), lineno=62, col_offset=29), '_urlopen', Load(), lineno=62, col_offset=29), lineno=62, col_offset=8), Assign([Attribute(Name('self', Load(), lineno=63, col_offset=8), 'last_open', Store(), lineno=63, col_offset=8)], Name('None', Load(), lineno=63, col_offset=25), lineno=63, col_offset=8)], [], lineno=59, col_offset=4), FunctionDef('tearDown', arguments([Name('self', Param(), lineno=65, col_offset=17)], None, None, []), [Assign([Attribute(Name('upload_mod', Load(), lineno=66, col_offset=8), 'urlopen', Store(), lineno=66, col_offset=8)], Attribute(Name('self', Load(), lineno=66, col_offset=29), 'old_open', Load(), lineno=66, col_offset=29), lineno=66, col_offset=8), Expr(Call(Attribute(Call(Name('super', Load(), lineno=67, col_offset=8), [Name('uploadTestCase', Load(), lineno=67, col_offset=14), Name('self', Load(), lineno=67, col_offset=30)], [], None, None, lineno=67, col_offset=8), 'tearDown', Load(), lineno=67, col_offset=8), [], [], None, None, lineno=67, col_offset=8), lineno=67, col_offset=8)], [], lineno=65, col_offset=4), FunctionDef('_urlopen', arguments([Name('self', Param(), lineno=69, col_offset=17), Name('url', Param(), lineno=69, col_offset=23)], None, None, []), [Assign([Attribute(Name('self', Load(), lineno=70, col_offset=8), 'last_open', Store(), lineno=70, col_offset=8)], Call(Name('FakeOpen', Load(), lineno=70, col_offset=25), [Name('url', Load(), lineno=70, col_offset=34)], [], None, None, lineno=70, col_offset=25), lineno=70, col_offset=8), Return(Attribute(Name('self', Load(), lineno=71, col_offset=15), 'last_open', Load(), lineno=71, col_offset=15), lineno=71, col_offset=8)], [], lineno=69, col_offset=4), FunctionDef('test_finalize_options', arguments([Name('self', Param(), lineno=73, col_offset=30)], None, None, []), [Expr(Call(Attribute(Name('self', Load(), lineno=76, col_offset=8), 'write_file', Load(), lineno=76, col_offset=8), [Attribute(Name('self', Load(), lineno=76, col_offset=24), 'rc', Load(), lineno=76, col_offset=24), Name('PYPIRC', Load(), lineno=76, col_offset=33)], [], None, None, lineno=76, col_offset=8), lineno=76, col_offset=8), Assign([Name('dist', Store(), lineno=77, col_offset=8)], Call(Name('Distribution', Load(), lineno=77, col_offset=15), [], [], None, None, lineno=77, col_offset=15), lineno=77, col_offset=8), Assign([Name('cmd', Store(), lineno=78, col_offset=8)], Call(Name('upload', Load(), lineno=78, col_offset=14), [Name('dist', Load(), lineno=78, col_offset=21)], [], None, None, lineno=78, col_offset=14), lineno=78, col_offset=8), Expr(Call(Attribute(Name('cmd', Load(), lineno=79, col_offset=8), 'finalize_options', Load(), lineno=79, col_offset=8), [], [], None, None, lineno=79, col_offset=8), lineno=79, col_offset=8), For(Tuple([Name('attr', Store(), lineno=80, col_offset=12), Name('waited', Store(), lineno=80, col_offset=18)], Store(), lineno=80, col_offset=12), Tuple([Tuple([Str('username', lineno=80, col_offset=30), Str('me', lineno=80, col_offset=42)], Load(), lineno=80, col_offset=30), Tuple([Str('password', lineno=80, col_offset=50), Str('secret', lineno=80, col_offset=62)], Load(), lineno=80, col_offset=50), Tuple([Str('realm', lineno=81, col_offset=30), Str('pypi', lineno=81, col_offset=39)], Load(), lineno=81, col_offset=30), Tuple([Str('repository', lineno=82, col_offset=30), Str('http://pypi.python.org/pypi', lineno=82, col_offset=44)], Load(), lineno=82, col_offset=30)], Load(), lineno=80, col_offset=29), [Expr(Call(Attribute(Name('self', Load(), lineno=83, col_offset=12), 'assertEqual', Load(), lineno=83, col_offset=12), [Call(Name('getattr', Load(), lineno=83, col_offset=29), [Name('cmd', Load(), lineno=83, col_offset=37), Name('attr', Load(), lineno=83, col_offset=42)], [], None, None, lineno=83, col_offset=29), Name('waited', Load(), lineno=83, col_offset=49)], [], None, None, lineno=83, col_offset=12), lineno=83, col_offset=12)], [], lineno=80, col_offset=8)], [], lineno=73, col_offset=4), FunctionDef('test_saved_password', arguments([Name('self', Param(), lineno=85, col_offset=28)], None, None, []), [Expr(Call(Attribute(Name('self', Load(), lineno=87, col_offset=8), 'write_file', Load(), lineno=87, col_offset=8), [Attribute(Name('self', Load(), lineno=87, col_offset=24), 'rc', Load(), lineno=87, col_offset=24), Name('PYPIRC_NOPASSWORD', Load(), lineno=87, col_offset=33)], [], None, None, lineno=87, col_offset=8), lineno=87, col_offset=8), Assign([Name('dist', Store(), lineno=90, col_offset=8)], Call(Name('Distribution', Load(), lineno=90, col_offset=15), [], [], None, None, lineno=90, col_offset=15), lineno=90, col_offset=8), Assign([Name('cmd', Store(), lineno=91, col_offset=8)], Call(Name('upload', Load(), lineno=91, col_offset=14), [Name('dist', Load(), lineno=91, col_offset=21)], [], None, None, lineno=91, col_offset=14), lineno=91, col_offset=8), Expr(Call(Attribute(Name('cmd', Load(), lineno=92, col_offset=8), 'finalize_options', Load(), lineno=92, col_offset=8), [], [], None, None, lineno=92, col_offset=8), lineno=92, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=93, col_offset=8), 'assertEqual', Load(), lineno=93, col_offset=8), [Attribute(Name('cmd', Load(), lineno=93, col_offset=25), 'password', Load(), lineno=93, col_offset=25), Name('None', Load(), lineno=93, col_offset=39)], [], None, None, lineno=93, col_offset=8), lineno=93, col_offset=8), Assign([Attribute(Name('dist', Load(), lineno=97, col_offset=8), 'password', Store(), lineno=97, col_offset=8)], Str('xxx', lineno=97, col_offset=24), lineno=97, col_offset=8), Assign([Name('cmd', Store(), lineno=98, col_offset=8)], Call(Name('upload', Load(), lineno=98, col_offset=14), [Name('dist', Load(), lineno=98, col_offset=21)], [], None, None, lineno=98, col_offset=14), lineno=98, col_offset=8), Expr(Call(Attribute(Name('cmd', Load(), lineno=99, col_offset=8), 'finalize_options', Load(), lineno=99, col_offset=8), [], [], None, None, lineno=99, col_offset=8), lineno=99, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=100, col_offset=8), 'assertEqual', Load(), lineno=100, col_offset=8), [Attribute(Name('cmd', Load(), lineno=100, col_offset=25), 'password', Load(), lineno=100, col_offset=25), Str('xxx', lineno=100, col_offset=39)], [], None, None, lineno=100, col_offset=8), lineno=100, col_offset=8)], [], lineno=85, col_offset=4), FunctionDef('test_upload', arguments([Name('self', Param(), lineno=102, col_offset=20)], None, None, []), [Assign([Name('tmp', Store(), lineno=103, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=103, col_offset=14), 'mkdtemp', Load(), lineno=103, col_offset=14), [], [], None, None, lineno=103, col_offset=14), lineno=103, col_offset=8), Assign([Name('path', Store(), lineno=104, col_offset=8)], Call(Attribute(Attribute(Name('os', Load(), lineno=104, col_offset=15), 'path', Load(), lineno=104, col_offset=15), 'join', Load(), lineno=104, col_offset=15), [Name('tmp', Load(), lineno=104, col_offset=28), Str('xxx', lineno=104, col_offset=33)], [], None, None, lineno=104, col_offset=15), lineno=104, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=105, col_offset=8), 'write_file', Load(), lineno=105, col_offset=8), [Name('path', Load(), lineno=105, col_offset=24)], [], None, None, lineno=105, col_offset=8), lineno=105, col_offset=8), Assign([Tuple([Name('command', Store(), lineno=106, col_offset=8), Name('pyversion', Store(), lineno=106, col_offset=17), Name('filename', Store(), lineno=106, col_offset=28)], Store(), lineno=106, col_offset=8)], Tuple([Str('xxx', lineno=106, col_offset=39), Str('2.6', lineno=106, col_offset=46), Name('path', Load(), lineno=106, col_offset=53)], Load(), lineno=106, col_offset=39), lineno=106, col_offset=8), Assign([Name('dist_files', Store(), lineno=107, col_offset=8)], List([Tuple([Name('command', Load(), lineno=107, col_offset=23), Name('pyversion', Load(), lineno=107, col_offset=32), Name('filename', Load(), lineno=107, col_offset=43)], Load(), lineno=107, col_offset=23)], Load(), lineno=107, col_offset=21), lineno=107, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=108, col_offset=8), 'write_file', Load(), lineno=108, col_offset=8), [Attribute(Name('self', Load(), lineno=108, col_offset=24), 'rc', Load(), lineno=108, col_offset=24), Name('PYPIRC_LONG_PASSWORD', Load(), lineno=108, col_offset=33)], [], None, None, lineno=108, col_offset=8), lineno=108, col_offset=8), Assign([Tuple([Name('pkg_dir', Store(), lineno=111, col_offset=8), Name('dist', Store(), lineno=111, col_offset=17)], Store(), lineno=111, col_offset=8)], Call(Attribute(Name('self', Load(), lineno=111, col_offset=24), 'create_dist', Load(), lineno=111, col_offset=24), [], [keyword('dist_files', Name('dist_files', Load(), lineno=111, col_offset=52)), keyword('author', Str(u'd\xe9d\xe9', lineno=111, col_offset=71))], None, None, lineno=111, col_offset=24), lineno=111, col_offset=8), Assign([Name('cmd', Store(), lineno=112, col_offset=8)], Call(Name('upload', Load(), lineno=112, col_offset=14), [Name('dist', Load(), lineno=112, col_offset=21)], [], None, None, lineno=112, col_offset=14), lineno=112, col_offset=8), Expr(Call(Attribute(Name('cmd', Load(), lineno=113, col_offset=8), 'ensure_finalized', Load(), lineno=113, col_offset=8), [], [], None, None, lineno=113, col_offset=8), lineno=113, col_offset=8), Expr(Call(Attribute(Name('cmd', Load(), lineno=114, col_offset=8), 'run', Load(), lineno=114, col_offset=8), [], [], None, None, lineno=114, col_offset=8), lineno=114, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=117, col_offset=8), 'assertIn', Load(), lineno=117, col_offset=8), [Str('d\xc3\xa9d\xc3\xa9', lineno=117, col_offset=22), Attribute(Attribute(Attribute(Name('self', Load(), lineno=117, col_offset=32), 'last_open', Load(), lineno=117, col_offset=32), 'req', Load(), lineno=117, col_offset=32), 'data', Load(), lineno=117, col_offset=32)], [], None, None, lineno=117, col_offset=8), lineno=117, col_offset=8), Assign([Name('headers', Store(), lineno=118, col_offset=8)], Call(Name('dict', Load(), lineno=118, col_offset=18), [Attribute(Attribute(Attribute(Name('self', Load(), lineno=118, col_offset=23), 'last_open', Load(), lineno=118, col_offset=23), 'req', Load(), lineno=118, col_offset=23), 'headers', Load(), lineno=118, col_offset=23)], [], None, None, lineno=118, col_offset=18), lineno=118, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=119, col_offset=8), 'assertEqual', Load(), lineno=119, col_offset=8), [Subscript(Name('headers', Load(), lineno=119, col_offset=25), Index(Str('Content-length', lineno=119, col_offset=33)), Load(), lineno=119, col_offset=25), Str('2085', lineno=119, col_offset=52)], [], None, None, lineno=119, col_offset=8), lineno=119, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=120, col_offset=8), 'assertTrue', Load(), lineno=120, col_offset=8), [Call(Attribute(Subscript(Name('headers', Load(), lineno=120, col_offset=24), Index(Str('Content-type', lineno=120, col_offset=32)), Load(), lineno=120, col_offset=24), 'startswith', Load(), lineno=120, col_offset=24), [Str('multipart/form-data', lineno=120, col_offset=59)], [], None, None, lineno=120, col_offset=24)], [], None, None, lineno=120, col_offset=8), lineno=120, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=121, col_offset=8), 'assertEqual', Load(), lineno=121, col_offset=8), [Call(Attribute(Attribute(Attribute(Name('self', Load(), lineno=121, col_offset=25), 'last_open', Load(), lineno=121, col_offset=25), 'req', Load(), lineno=121, col_offset=25), 'get_method', Load(), lineno=121, col_offset=25), [], [], None, None, lineno=121, col_offset=25), Str('POST', lineno=121, col_offset=58)], [], None, None, lineno=121, col_offset=8), lineno=121, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=122, col_offset=8), 'assertEqual', Load(), lineno=122, col_offset=8), [Call(Attribute(Attribute(Attribute(Name('self', Load(), lineno=122, col_offset=25), 'last_open', Load(), lineno=122, col_offset=25), 'req', Load(), lineno=122, col_offset=25), 'get_full_url', Load(), lineno=122, col_offset=25), [], [], None, None, lineno=122, col_offset=25), Str('http://pypi.python.org/pypi', lineno=123, col_offset=25)], [], None, None, lineno=122, col_offset=8), lineno=122, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=124, col_offset=8), 'assertTrue', Load(), lineno=124, col_offset=8), [Compare(Str('xxx', lineno=124, col_offset=24), [In()], [Attribute(Attribute(Attribute(Name('self', Load(), lineno=124, col_offset=33), 'last_open', Load(), lineno=124, col_offset=33), 'req', Load(), lineno=124, col_offset=33), 'data', Load(), lineno=124, col_offset=33)], lineno=124, col_offset=24)], [], None, None, lineno=124, col_offset=8), lineno=124, col_offset=8), Assign([Name('auth', Store(), lineno=125, col_offset=8)], Subscript(Attribute(Attribute(Attribute(Name('self', Load(), lineno=125, col_offset=15), 'last_open', Load(), lineno=125, col_offset=15), 'req', Load(), lineno=125, col_offset=15), 'headers', Load(), lineno=125, col_offset=15), Index(Str('Authorization', lineno=125, col_offset=42)), Load(), lineno=125, col_offset=15), lineno=125, col_offset=8), Expr(Call(Attribute(Name('self', Load(), lineno=126, col_offset=8), 'assertFalse', Load(), lineno=126, col_offset=8), [Compare(Str('\n', lineno=126, col_offset=25), [In()], [Name('auth', Load(), lineno=126, col_offset=33)], lineno=126, col_offset=25)], [], None, None, lineno=126, col_offset=8), lineno=126, col_offset=8)], [], lineno=102, col_offset=4)], [], lineno=57, col_offset=0), FunctionDef('test_suite', arguments([], None, None, []), [Return(Call(Attribute(Name('unittest', Load(), lineno=129, col_offset=11), 'makeSuite', Load(), lineno=129, col_offset=11), [Name('uploadTestCase', Load(), lineno=129, col_offset=30)], [], None, None, lineno=129, col_offset=11), lineno=129, col_offset=4)], [], lineno=128, col_offset=0), If(Compare(Name('__name__', Load(), lineno=131, col_offset=3), [Eq()], [Str('__main__', lineno=131, col_offset=15)], lineno=131, col_offset=3), [Expr(Call(Attribute(Name('unittest', Load(), lineno=132, col_offset=4), 'main', Load(), lineno=132, col_offset=4), [], [keyword('defaultTest', Str('test_suite', lineno=132, col_offset=30))], None, None, lineno=132, col_offset=4), lineno=132, col_offset=4)], [], lineno=131, col_offset=0)])
